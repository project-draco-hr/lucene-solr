{
  if (dataOut == null) {
    boolean success=false;
    try {
      dataOut=directory.createOutput(dataFileName,IOContext.DEFAULT);
      CodecUtil.writeHeader(dataOut,DATA_CODEC,VERSION_CURRENT);
      success=true;
    }
  finally {
      if (!success) {
        IOUtils.closeWhileHandlingException(dataOut);
      }
    }
  }
  return dataOut;
}
