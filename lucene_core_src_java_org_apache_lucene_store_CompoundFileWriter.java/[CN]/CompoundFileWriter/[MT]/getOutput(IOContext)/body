{
  if (dataOut == null) {
    boolean success=false;
    try {
      dataOut=directory.createOutput(dataFileName,context);
      CodecUtil.writeSegmentHeader(dataOut,DATA_CODEC,VERSION_CURRENT,segmentID,"");
      success=true;
    }
  finally {
      if (!success) {
        IOUtils.closeWhileHandlingException(dataOut);
      }
    }
  }
  return dataOut;
}
