{
  heartBeater.needHeartBeat();
  try {
    try {
      SolrInputDocumentWritable sidw=(SolrInputDocumentWritable)value;
      batch.add(sidw.getSolrInputDocument());
      if (batch.size() >= batchSize) {
        batchWriter.queueBatch(batch);
        numDocsWritten+=batch.size();
        if (System.currentTimeMillis() >= nextLogTime) {
          LOG.info("docsWritten: {}",numDocsWritten);
          nextLogTime+=10000;
        }
        batch.clear();
      }
    }
 catch (    SolrServerException e) {
      throw new IOException(e);
    }
  }
  finally {
    heartBeater.cancelHeartBeat();
  }
}
