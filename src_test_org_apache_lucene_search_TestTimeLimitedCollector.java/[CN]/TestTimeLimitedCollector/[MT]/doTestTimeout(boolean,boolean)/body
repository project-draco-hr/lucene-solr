{
  MyHitCollector myHc=new MyHitCollector();
  myHc.setSlowDown(SLOW_DOWN);
  HitCollector tlCollector=createTimedCollector(myHc,TIME_ALLOWED,greedy);
  TimeLimitedCollector.TimeExceededException timoutException=null;
  try {
    search(tlCollector);
  }
 catch (  TimeLimitedCollector.TimeExceededException x) {
    timoutException=x;
  }
catch (  Exception e) {
    assertTrue("Unexpected exception: " + e,false);
  }
  assertNotNull("Timeout expected!",timoutException);
  int exceptionDoc=timoutException.getLastDocCollected();
  int lastCollected=myHc.getLastDocCollected();
  assertTrue("doc collected at timeout must be > 0!",exceptionDoc > 0);
  if (greedy) {
    assertTrue("greedy=" + greedy + " exceptionDoc="+ exceptionDoc+ " != lastCollected="+ lastCollected,exceptionDoc == lastCollected);
    assertTrue("greedy, but no hits found!",myHc.hitCount() > 0);
  }
 else {
    assertTrue("greedy=" + greedy + " exceptionDoc="+ exceptionDoc+ " not > lastCollected="+ lastCollected,exceptionDoc > lastCollected);
  }
  assertEquals(timoutException.getTimeAllowed(),TIME_ALLOWED);
  assertTrue("elapsed=" + timoutException.getTimeElapsed() + " <= (allowed-resolution)="+ (TIME_ALLOWED - TimeLimitedCollector.getResolution()),timoutException.getTimeElapsed() > TIME_ALLOWED - TimeLimitedCollector.getResolution());
  if (timoutException.getTimeElapsed() > maxTime(multiThreaded)) {
    System.out.println("Informative: timeout exceeded (no action required: most probably just " + " because the test machine is slower than usual):  " + "lastDoc=" + exceptionDoc + " ,&& allowed="+ timoutException.getTimeAllowed()+ " ,&& elapsed="+ timoutException.getTimeElapsed()+ " >= "+ maxTimeStr(multiThreaded));
  }
}
