{
  super.setUp();
  String zkDir=createTempDir().getAbsolutePath() + File.separator + "zookeeper/server1/data";
  server=new ZkTestServer(zkDir);
  server.setTheTickTime(1000);
  server.run();
  AbstractZkTestCase.tryCleanSolrZkNode(server.getZkHost());
  AbstractZkTestCase.makeSolrZkNode(server.getZkHost());
  zkClient=new SolrZkClient(server.getZkAddress(),TIMEOUT);
  zkStateReader=new ZkStateReader(zkClient);
  seqToThread=Collections.synchronizedMap(new HashMap<Integer,Thread>());
}
