{
  if (DEBUG)   System.out.println("PW       pos=" + position + " payload="+ (payload == null ? "null" : payload.length + " bytes"));
  if (pendingCount == pending.length) {
    push();
  }
  if (pendingCount == -1) {
    wrappedPostingsWriter.addPosition(position,payload);
  }
 else {
    final Position pos=pending[pendingCount++];
    pos.pos=position;
    pos.docID=currentDoc.docID;
    if (payload != null && payload.length > 0) {
      if (pos.payload == null) {
        pos.payload=BytesRef.deepCopyOf(payload);
      }
 else {
        pos.payload.copyBytes(payload);
      }
    }
 else     if (pos.payload != null) {
      pos.payload.length=0;
    }
  }
}
