{
  final int numeric=bits & FIELD_IS_NUMERIC_MASK;
  if (numeric != 0) {
switch (numeric) {
case FIELD_IS_NUMERIC_INT:
      visitor.intField(info,fieldsStream.readInt());
    return;
case FIELD_IS_NUMERIC_LONG:
  visitor.longField(info,fieldsStream.readLong());
return;
case FIELD_IS_NUMERIC_FLOAT:
visitor.floatField(info,Float.intBitsToFloat(fieldsStream.readInt()));
return;
case FIELD_IS_NUMERIC_DOUBLE:
visitor.doubleField(info,Double.longBitsToDouble(fieldsStream.readLong()));
return;
default :
throw new CorruptIndexException("Invalid numeric type: " + Integer.toHexString(numeric));
}
}
 else {
final int length=fieldsStream.readVInt();
byte bytes[]=new byte[length];
fieldsStream.readBytes(bytes,0,length);
if ((bits & FIELD_IS_BINARY) != 0) {
visitor.binaryField(info,bytes);
}
 else {
visitor.stringField(info,new String(bytes,0,bytes.length,IOUtils.CHARSET_UTF_8));
}
}
}
