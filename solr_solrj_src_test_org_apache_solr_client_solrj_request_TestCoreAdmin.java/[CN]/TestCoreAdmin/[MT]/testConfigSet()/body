{
  SolrServer server=getSolrAdmin();
  File testDir=createTestDirectory();
  File newCoreInstanceDir=new File(testDir,"newcore");
  CoreAdminRequest.Create req=new CoreAdminRequest.Create();
  req.setCoreName("corewithconfigset");
  req.setInstanceDir(newCoreInstanceDir.getAbsolutePath());
  req.setConfigSet("configset-2");
  CoreAdminResponse response=req.process(server);
  assertThat((String)response.getResponse().get("core"),is("corewithconfigset"));
  SolrCore core=null;
  try {
    core=cores.getCore("corewithconfigset");
    assertThat(core,is(notNullValue()));
  }
  finally {
    if (core != null)     core.close();
  }
}
