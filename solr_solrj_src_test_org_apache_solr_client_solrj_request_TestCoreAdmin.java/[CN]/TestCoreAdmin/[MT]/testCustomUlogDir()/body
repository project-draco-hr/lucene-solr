{
  SolrServer server=getSolrAdmin();
  File tmp=createTempDir();
  log.info("Creating cores underneath {}",tmp);
  File dataDir=new File(tmp,this.getTestName() + System.currentTimeMillis() + "-"+ "data");
  File newCoreInstanceDir=new File(tmp,this.getTestName() + System.currentTimeMillis() + "-"+ "instance");
  File instanceDir=new File(cores.getSolrHome());
  FileUtils.copyDirectory(instanceDir,new File(newCoreInstanceDir,"newcore"));
  CoreAdminRequest.Create req=new CoreAdminRequest.Create();
  req.setCoreName("newcore");
  req.setInstanceDir(newCoreInstanceDir.getAbsolutePath() + File.separator + "newcore");
  req.setDataDir(dataDir.getAbsolutePath());
  req.setUlogDir(new File(dataDir,"ulog").getAbsolutePath());
  req.setIsLoadOnStartup(false);
  req.setIsTransient(true);
  req.process(server);
  File logDir;
  try (SolrCore coreProveIt=cores.getCore("collection1");SolrCore core=cores.getCore("newcore")){
    assertTrue(core.getCoreDescriptor().isTransient());
    assertFalse(coreProveIt.getCoreDescriptor().isTransient());
    assertFalse(core.getCoreDescriptor().isLoadOnStartup());
    assertTrue(coreProveIt.getCoreDescriptor().isLoadOnStartup());
    logDir=new File(core.getUpdateHandler().getUpdateLog().getLogDir());
  }
   assertEquals(new File(dataDir,"ulog" + File.separator + "tlog").getAbsolutePath(),logDir.getAbsolutePath());
  server.shutdown();
}
