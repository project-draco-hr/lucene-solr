{
  double latRad=Math.toRadians(lat);
  double lonRad=Math.toRadians(lon);
  double diffX=latCenterRad - latRad;
  double diffY=lonCenterRad - lonRad;
  double hsinX=Math.sin(diffX * 0.5);
  double hsinY=Math.sin(diffY * 0.5);
  double h=hsinX * hsinX + (latCenterRad_cos * Math.cos(latRad) * hsinY* hsinY);
  double result=(planetRadius * 2 * Math.atan2(Math.sqrt(h),Math.sqrt(1 - h)));
  lastDistDoc=doc;
  lastDist=result;
  return result;
}
