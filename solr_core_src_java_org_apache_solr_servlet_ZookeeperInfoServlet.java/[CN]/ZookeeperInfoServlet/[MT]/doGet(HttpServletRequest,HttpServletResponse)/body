{
  CoreContainer cores=(CoreContainer)request.getAttribute("org.apache.solr.CoreContainer");
  if (cores == null) {
    throw new ServletException("Missing request attribute org.apache.solr.CoreContainer.");
  }
  final SolrParams params;
  try {
    params=SolrRequestParsers.DEFAULT.parse(null,request.getServletPath(),request).getParams();
  }
 catch (  Exception e) {
    int code=500;
    if (e instanceof SolrException) {
      code=Math.min(599,Math.max(100,((SolrException)e).code()));
    }
    response.sendError(code,e.toString());
    return;
  }
  String path=params.get("path");
  String addr=params.get("addr");
  boolean all="true".equals(params.get("all"));
  if (addr != null && addr.length() == 0) {
    addr=null;
  }
  String detailS=params.get("detail");
  boolean detail=detailS != null && detailS.equals("true");
  String dumpS=params.get("dump");
  boolean dump=dumpS != null && dumpS.equals("true");
  response.setCharacterEncoding("UTF-8");
  response.setContentType("application/json");
  Writer out=new FastWriter(new OutputStreamWriter(response.getOutputStream(),StandardCharsets.UTF_8));
  ZKPrinter printer=new ZKPrinter(response,out,cores.getZkController(),addr);
  printer.detail=detail;
  printer.dump=dump;
  try {
    printer.print(path,all);
  }
  finally {
    printer.close();
  }
  out.flush();
}
