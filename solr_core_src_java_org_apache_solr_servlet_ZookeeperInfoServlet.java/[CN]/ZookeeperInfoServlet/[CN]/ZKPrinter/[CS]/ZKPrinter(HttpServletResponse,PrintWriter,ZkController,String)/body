{
  this.response=response;
  this.out=out;
  this.addr=addr;
  if (addr == null) {
    if (controller != null) {
      keeperAddr=controller.getZkServerAddress();
      zkClient=controller.getZkClient();
      if (zkClient != null && zkClient.isConnected()) {
        return;
      }
 else {
        addr=keeperAddr;
      }
    }
  }
  keeperAddr=addr;
  if (addr == null) {
    response.setStatus(404);
    out.println("{" + "\"status\": 404" + ", \"error\" : \"Zookeeper is not configured for this Solr Core. Please try connecting to an alternate zookeeper address.\""+ "}");
    return;
  }
  try {
    zkClient=new SolrZkClient(addr,10000);
    doClose=true;
  }
 catch (  TimeoutException e) {
    response.setStatus(503);
    out.println("{" + "\"status\": 503" + ", \"error\" : \"Could not connect to zookeeper at '" + addr + "'\""+ "}");
    zkClient=null;
    return;
  }
catch (  InterruptedException e) {
    Thread.currentThread().interrupt();
    response.setStatus(503);
    out.println("{" + "\"status\": 503" + ", \"error\" : \"Could not connect to zookeeper at '" + addr + "'\""+ "}");
    zkClient=null;
    return;
  }
}
