{
  this.zkController=controller;
  this.response=response;
  this.out=out;
  this.addr=addr;
  if (addr == null) {
    if (controller != null) {
      keeperAddr=controller.getZkServerAddress();
      zkClient=controller.getZkClient();
      if (zkClient != null && zkClient.isConnected()) {
        return;
      }
 else {
        addr=keeperAddr;
      }
    }
  }
  keeperAddr=addr;
  if (addr == null) {
    writeError(404,"Zookeeper is not configured for this Solr Core. Please try connecting to an alternate zookeeper address.");
    return;
  }
  try {
    zkClient=new SolrZkClient(addr,10000);
    doClose=true;
  }
 catch (  Exception e) {
    writeError(503,"Could not connect to zookeeper at '" + addr + "'\"");
    zkClient=null;
    return;
  }
}
