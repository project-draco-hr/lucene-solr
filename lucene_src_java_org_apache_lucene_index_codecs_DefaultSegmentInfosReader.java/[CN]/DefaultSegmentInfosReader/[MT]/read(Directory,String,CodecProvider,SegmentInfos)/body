{
  IndexInput input=null;
  try {
    input=openInput(directory,segmentsFileName);
    int format=input.readInt();
    if (format < SegmentInfos.CURRENT_FORMAT)     throw new CorruptIndexException("Unknown (newer than us?) format version: " + format);
    infos.version=input.readLong();
    infos.counter=input.readInt();
    for (int i=input.readInt(); i > 0; i--) {
      infos.add(new SegmentInfo(directory,format,input,codecs));
    }
    infos.userData=input.readStringStringMap();
    finalizeInput(input);
  }
  finally {
    if (input != null) {
      input.close();
    }
  }
}
