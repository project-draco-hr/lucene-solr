{
  String uname=context.getUserPrincipal() == null ? null : context.getUserPrincipal().getName();
  if (predicate != null) {
    try {
      predicate.test(context);
      return new AuthorizationResponse(200);
    }
 catch (    SolrException e) {
      return new AuthorizationResponse(e.code());
    }
  }
  if (uname == null)   uname=context.getParams().get("uname");
  log.info("User request: " + uname);
  if (denyUsers.contains(uname))   return new AuthorizationResponse(403);
 else   return new AuthorizationResponse(200);
}
