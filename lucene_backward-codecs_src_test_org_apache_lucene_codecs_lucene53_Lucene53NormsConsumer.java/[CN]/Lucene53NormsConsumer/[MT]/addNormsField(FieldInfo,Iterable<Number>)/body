{
  meta.writeVInt(field.number);
  long minValue=Long.MAX_VALUE;
  long maxValue=Long.MIN_VALUE;
  int count=0;
  for (  Number nv : values) {
    if (nv == null) {
      throw new IllegalStateException("illegal norms data for field " + field.name + ", got null for value: "+ count);
    }
    final long v=nv.longValue();
    minValue=Math.min(minValue,v);
    maxValue=Math.max(maxValue,v);
    count++;
  }
  if (count != maxDoc) {
    throw new IllegalStateException("illegal norms data for field " + field.name + ", expected count="+ maxDoc+ ", got="+ count);
  }
  if (minValue == maxValue) {
    addConstant(minValue);
  }
 else   if (minValue >= Byte.MIN_VALUE && maxValue <= Byte.MAX_VALUE) {
    addByte1(values);
  }
 else   if (minValue >= Short.MIN_VALUE && maxValue <= Short.MAX_VALUE) {
    addByte2(values);
  }
 else   if (minValue >= Integer.MIN_VALUE && maxValue <= Integer.MAX_VALUE) {
    addByte4(values);
  }
 else {
    addByte8(values);
  }
}
