{
  MergePolicy.OneMerge merge=this.startMerge;
  try {
    message("  merge thread: start");
    while (true) {
      setRunningMerge(merge);
      doMerge(merge);
      merge=writer.getNextMerge();
      if (merge != null) {
        writer.mergeInit(merge);
        message("  merge thread: do another merge " + merge.segString(dir));
      }
 else       break;
    }
    message("  merge thread: done");
  }
 catch (  Throwable exc) {
    if (merge != null) {
      merge.setException(exc);
      writer.addMergeException(merge);
    }
    if (!(exc instanceof MergePolicy.MergeAbortedException)) {
synchronized (ConcurrentMergeScheduler.this) {
        exceptions.add(exc);
      }
      if (!suppressExceptions) {
        anyExceptions=true;
        handleMergeException(exc);
      }
    }
  }
 finally {
synchronized (ConcurrentMergeScheduler.this) {
      boolean removed=mergeThreads.remove(this);
      assert removed;
      ConcurrentMergeScheduler.this.notifyAll();
    }
  }
}
