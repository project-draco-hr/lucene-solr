{
  final DocValuesConsumer delegate=super.fieldsConsumer(state);
  return new DocValuesConsumer(){
    @Override public void addNumericField(    FieldInfo field,    Iterable<Number> values) throws IOException {
      field.putAttribute(Lucene40FieldInfosReader.LEGACY_DV_TYPE_KEY,LegacyDocValuesType.VAR_INTS.name());
      delegate.addNumericField(field,values);
    }
    @Override public void addBinaryField(    FieldInfo field,    Iterable<BytesRef> values) throws IOException {
      field.putAttribute(Lucene40FieldInfosReader.LEGACY_DV_TYPE_KEY,LegacyDocValuesType.BYTES_VAR_STRAIGHT.name());
      delegate.addBinaryField(field,values);
    }
    @Override public void addSortedField(    FieldInfo field,    Iterable<BytesRef> values,    Iterable<Number> docToOrd) throws IOException {
      field.putAttribute(Lucene40FieldInfosReader.LEGACY_DV_TYPE_KEY,LegacyDocValuesType.BYTES_VAR_SORTED.name());
      delegate.addSortedField(field,values,docToOrd);
    }
    @Override public void close() throws IOException {
      delegate.close();
    }
  }
;
}
