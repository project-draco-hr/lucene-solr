{
  SolrCore core=h.getCore();
  SolrEventListener newSearcherListener=core.newSearcherListeners.get(0);
  assertTrue("Not an instance of QuerySenderListener",newSearcherListener instanceof QuerySenderListener);
  QuerySenderListener qsl=(QuerySenderListener)newSearcherListener;
  RefCounted<SolrIndexSearcher> currentSearcherRef=core.getSearcher();
  SolrIndexSearcher currentSearcher=currentSearcherRef.get();
  SolrIndexSearcher dummy=null;
  qsl.newSearcher(currentSearcher,dummy);
  MockQuerySenderListenerReqHandler mock=(MockQuerySenderListenerReqHandler)core.getRequestHandler("mock");
  assertNotNull("Mock is null",mock);
  assertNull("Req (firstsearcher) is not null",mock.req);
  Directory dir=currentSearcher.getIndexReader().directory();
  SolrIndexSearcher newSearcher=new SolrIndexSearcher(core,core.getSchema(),"testQuerySenderNoQuery",dir,true,false);
  qsl.newSearcher(newSearcher,currentSearcher);
  assertNull("Req (newsearcher) is not null",mock.req);
  newSearcher.close();
  currentSearcherRef.decref();
}
