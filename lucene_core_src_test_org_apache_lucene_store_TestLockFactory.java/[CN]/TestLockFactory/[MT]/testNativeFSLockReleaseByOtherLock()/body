{
  NativeFSLockFactory f=new NativeFSLockFactory(TEMP_DIR);
  f.setLockPrefix("test");
  Lock l=f.makeLock("commit");
  Lock l2=f.makeLock("commit");
  assertTrue("failed to obtain lock",l.obtain());
  try {
    assertTrue(l2.isLocked());
    l2.release();
    fail("should not have reached here. LockReleaseFailedException should have been thrown");
  }
 catch (  LockReleaseFailedException e) {
  }
 finally {
    l.release();
  }
}
