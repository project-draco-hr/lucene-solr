{
  Path tempDir=createTempDir(LuceneTestCase.getTestClass().getSimpleName());
  Path lockFile=tempDir.resolve("test.lock");
  Files.createFile(lockFile);
  Directory dir=FSDirectory.open(tempDir,NativeFSLockFactory.INSTANCE);
  Lock l=dir.makeLock("test.lock");
  assertTrue("failed to obtain lock",l.obtain());
  l.close();
  assertFalse("failed to release lock",l.isLocked());
  Files.deleteIfExists(lockFile);
}
