{
  MockDirectoryWrapper dir=new MockDirectoryWrapper(random(),new RAMDirectory(NoLockFactory.INSTANCE));
  dir.setAssertLocks(false);
  IndexWriter writer=new IndexWriter(dir,new IndexWriterConfig(new MockAnalyzer(random())));
  writer.commit();
  IndexWriter writer2=null;
  try {
    writer2=new IndexWriter(dir,new IndexWriterConfig(new MockAnalyzer(random())).setOpenMode(OpenMode.APPEND));
  }
 catch (  Exception e) {
    e.printStackTrace(System.out);
    fail("Should not have hit an IOException with no locking");
  }
  writer.close();
  if (writer2 != null) {
    writer2.close();
  }
}
