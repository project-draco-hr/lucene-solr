{
  Directory dir=new RAMDirectory();
  assertTrue("RAMDirectory did not use correct LockFactory: got " + dir.getLockFactory(),SingleInstanceLockFactory.class.isInstance(dir.getLockFactory()));
  IndexWriter writer=new IndexWriter(dir,new IndexWriterConfig(new MockAnalyzer(random())));
  IndexWriter writer2=null;
  try {
    writer2=new IndexWriter(dir,new IndexWriterConfig(new MockAnalyzer(random())).setOpenMode(OpenMode.APPEND));
    fail("Should have hit an IOException with two IndexWriters on default SingleInstanceLockFactory");
  }
 catch (  IOException e) {
  }
  writer.close();
  if (writer2 != null) {
    writer2.close();
  }
}
