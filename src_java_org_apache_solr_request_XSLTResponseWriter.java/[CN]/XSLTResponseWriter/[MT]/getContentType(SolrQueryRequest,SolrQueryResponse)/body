{
  Transformer t=null;
  try {
    t=getTransformer(request);
  }
 catch (  Exception e) {
    throw new RuntimeException("getTransformer fails in getContentType",e);
  }
  final String mediaTypeFromXslt=t.getOutputProperty("media-type");
  if (mediaTypeFromXslt == null || mediaTypeFromXslt.length() == 0) {
    return DEFAULT_CONTENT_TYPE;
  }
  return mediaTypeFromXslt;
}
