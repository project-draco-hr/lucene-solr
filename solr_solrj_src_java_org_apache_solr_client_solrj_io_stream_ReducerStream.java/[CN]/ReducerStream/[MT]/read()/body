{
  List<Map> maps=new ArrayList();
  while (true) {
    Tuple t=stream.read();
    if (t.EOF) {
      if (maps.size() > 0) {
        stream.pushBack(t);
        Map map1=maps.get(0);
        Map map2=new HashMap();
        map2.putAll(map1);
        Tuple groupHead=new Tuple(map2);
        groupHead.setMaps(maps);
        return groupHead;
      }
 else {
        return t;
      }
    }
    if (currentGroupHead == null) {
      currentGroupHead=t;
      maps.add(t.getMap());
    }
 else {
      if (comp.compare(currentGroupHead,t) == 0) {
        maps.add(t.getMap());
      }
 else {
        Tuple groupHead=currentGroupHead.clone();
        stream.pushBack(t);
        currentGroupHead=null;
        groupHead.setMaps(maps);
        return groupHead;
      }
    }
  }
}
