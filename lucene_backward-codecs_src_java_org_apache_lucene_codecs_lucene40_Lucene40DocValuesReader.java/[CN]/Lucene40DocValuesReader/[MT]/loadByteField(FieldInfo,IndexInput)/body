{
  CodecUtil.checkHeader(input,Lucene40DocValuesFormat.INTS_CODEC_NAME,Lucene40DocValuesFormat.INTS_VERSION_START,Lucene40DocValuesFormat.INTS_VERSION_CURRENT);
  int valueSize=input.readInt();
  if (valueSize != 1) {
    throw new CorruptIndexException("invalid valueSize: " + valueSize,input);
  }
  int maxDoc=state.segmentInfo.getDocCount();
  final byte values[]=new byte[maxDoc];
  input.readBytes(values,0,values.length);
  long bytesUsed=RamUsageEstimator.sizeOf(values);
  instanceInfo.put(field.name,Accountables.namedAccountable("byte array",bytesUsed));
  ramBytesUsed.addAndGet(bytesUsed);
  return new NumericDocValues(){
    @Override public long get(    int docID){
      return values[docID];
    }
  }
;
}
