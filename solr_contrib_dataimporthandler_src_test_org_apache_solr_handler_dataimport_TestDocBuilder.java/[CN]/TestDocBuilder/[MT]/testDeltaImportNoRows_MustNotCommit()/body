{
  DataImporter di=new DataImporter();
  di.loadAndInit(dc_deltaConfig);
  redirectTempProperties(di);
  DIHConfiguration cfg=di.getConfig();
  Entity ent=cfg.getEntities().get(0);
  MockDataSource.setIterator("select * from x",new ArrayList<Map<String,Object>>().iterator());
  MockDataSource.setIterator("select id from x",new ArrayList<Map<String,Object>>().iterator());
  RequestInfo rp=new RequestInfo(null,createMap("command","delta-import"),null);
  SolrWriterImpl swi=new SolrWriterImpl();
  di.runCmd(rp,swi);
  assertEquals(Boolean.FALSE,swi.deleteAllCalled);
  assertEquals(Boolean.FALSE,swi.commitCalled);
  assertEquals(Boolean.TRUE,swi.finishCalled);
  assertEquals(0,swi.docs.size());
  assertEquals(1,di.getDocBuilder().importStatistics.queryCount.get());
  assertEquals(0,di.getDocBuilder().importStatistics.docCount.get());
  assertEquals(0,di.getDocBuilder().importStatistics.rowsCount.get());
}
