{
  if (leftTerms == null || rightTerms == null) {
    assertNull(leftTerms);
    assertNull(rightTerms);
    return;
  }
  assertTermsStatistics(leftTerms,rightTerms);
  boolean bothHavePositions=leftTerms.hasPositions() && rightTerms.hasPositions();
  TermsEnum leftTermsEnum=leftTerms.iterator();
  TermsEnum rightTermsEnum=rightTerms.iterator();
  assertTermsEnum(leftTermsEnum,rightTermsEnum,true,bothHavePositions);
  assertTermsSeeking(leftTerms,rightTerms);
  if (deep) {
    int numIntersections=atLeast(3);
    for (int i=0; i < numIntersections; i++) {
      String re=AutomatonTestUtil.randomRegexp(random());
      CompiledAutomaton automaton=new CompiledAutomaton(new RegExp(re,RegExp.NONE).toAutomaton());
      if (automaton.type == CompiledAutomaton.AUTOMATON_TYPE.NORMAL) {
        TermsEnum leftIntersection=leftTerms.intersect(automaton,null);
        TermsEnum rightIntersection=rightTerms.intersect(automaton,null);
        assertTermsEnum(leftIntersection,rightIntersection,rarely(),bothHavePositions);
      }
    }
  }
}
