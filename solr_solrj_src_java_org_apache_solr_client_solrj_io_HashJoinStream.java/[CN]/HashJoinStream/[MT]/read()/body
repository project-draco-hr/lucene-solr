{
  while (true) {
    Tuple tuple=streamA.read();
    if (tuple.EOF) {
      return tuple;
    }
    if (joinTuples.size() > 0) {
      Tuple t=tuple.clone();
      Tuple j=joinTuples.removeFirst();
      t.fields.putAll(j.fields);
      if (joinTuples.size() > 0) {
        streamA.pushBack(tuple);
      }
      return t;
    }
 else {
      HashKey hashKey=new HashKey(tuple,keys);
      if (hashMap.containsKey(hashKey)) {
        List<Tuple> joinWith=hashMap.get(hashKey);
        for (        Tuple jt : joinWith) {
          joinTuples.add(jt);
        }
        streamA.pushBack(tuple);
      }
    }
  }
}
