{
  final int n=atLeast(10000);
  final FixedBitSet bits=new FixedBitSet(n);
  Random random=random();
  for (int i=0; i < n; i++) {
    int idx=random.nextInt(n);
    bits.flip(idx,idx + 1);
  }
  FixedBitSet verify=bits.clone();
  ScoredDocIDs scoredDocIDs=ScoredDocIdsUtils.createScoredDocIds(bits,n);
  Directory dir=newDirectory();
  IndexReader reader=createReaderWithNDocs(random,n,dir);
  try {
    assertEquals(n - verify.cardinality(),ScoredDocIdsUtils.getComplementSet(scoredDocIDs,reader).size());
  }
  finally {
    reader.close();
    dir.close();
  }
}
