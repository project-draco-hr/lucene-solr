{
  XmlWriter writer=null;
  try {
    writer=createWriter(response.getWriter());
    if (this.format == OutputFormat.ATOM) {
      response.setContentType(XMLMIME_ATOM);
      feed.generateAtom(writer,this.service.getExtensionProfile());
    }
 else {
      response.setContentType(XMLMIME_RSS);
      feed.generateRss(writer,this.service.getExtensionProfile());
    }
  }
  finally {
    if (writer != null)     writer.close();
  }
}
