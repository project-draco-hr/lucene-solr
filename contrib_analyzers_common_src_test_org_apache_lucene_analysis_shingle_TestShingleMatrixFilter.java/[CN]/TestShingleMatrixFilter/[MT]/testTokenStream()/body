{
  ShingleMatrixFilter.defaultSettingsCodec=null;
  TokenStream ts;
  TokenStream tls;
  LinkedList<Token> tokens;
  tokens=new LinkedList<Token>();
  tokens.add(tokenFactory("hello",1,0,4));
  tokens.add(tokenFactory("greetings",0,0,4));
  tokens.add(tokenFactory("world",1,5,10));
  tokens.add(tokenFactory("earth",0,5,10));
  tokens.add(tokenFactory("tellus",0,5,10));
  tls=new TokenListStream(tokens);
  ts=new ShingleMatrixFilter(tls,2,2,new Character('_'),false,new ShingleMatrixFilter.TwoDimensionalNonWeightedSynonymTokenSettingsCodec());
  assertNext(ts,"hello_world");
  assertNext(ts,"greetings_world");
  assertNext(ts,"hello_earth");
  assertNext(ts,"greetings_earth");
  assertNext(ts,"hello_tellus");
  assertNext(ts,"greetings_tellus");
  assertFalse(ts.incrementToken());
  tls.reset();
  ts=new ShingleMatrixFilter(tls,2,2,null,false,new ShingleMatrixFilter.TwoDimensionalNonWeightedSynonymTokenSettingsCodec());
  assertNext(ts,"helloworld",0,10);
  assertNext(ts,"greetingsworld",0,10);
  assertNext(ts,"helloearth",0,10);
  assertNext(ts,"greetingsearth",0,10);
  assertNext(ts,"hellotellus",0,10);
  assertNext(ts,"greetingstellus",0,10);
  assertFalse(ts.incrementToken());
  ShingleMatrixFilter.defaultSettingsCodec=new ShingleMatrixFilter.SimpleThreeDimensionalTokenSettingsCodec();
  tokens=new LinkedList<Token>();
  tokens.add(tokenFactory("hello",1,1f,0,4,ShingleMatrixFilter.TokenPositioner.newColumn));
  tokens.add(tokenFactory("greetings",0,1f,0,4,ShingleMatrixFilter.TokenPositioner.newRow));
  tokens.add(tokenFactory("world",1,1f,5,10,ShingleMatrixFilter.TokenPositioner.newColumn));
  tokens.add(tokenFactory("earth",0,1f,5,10,ShingleMatrixFilter.TokenPositioner.newRow));
  tokens.add(tokenFactory("tellus",0,1f,5,10,ShingleMatrixFilter.TokenPositioner.newRow));
  tls=new TokenListStream(tokens);
  ts=new PrefixAndSuffixAwareTokenFilter(new SingleTokenTokenStream(tokenFactory("^",1,100f,0,0)),tls,new SingleTokenTokenStream(tokenFactory("$",1,50f,0,0)));
  tls=new CachingTokenFilter(ts);
  ts=new ShingleMatrixFilter(tls,2,2,new Character('_'),false);
  assertNext(ts,"^_hello",1,10.049875f,0,4);
  assertNext(ts,"^_greetings",1,10.049875f,0,4);
  assertNext(ts,"hello_world",1,1.4142135f,0,10);
  assertNext(ts,"greetings_world",1,1.4142135f,0,10);
  assertNext(ts,"hello_earth",1,1.4142135f,0,10);
  assertNext(ts,"greetings_earth",1,1.4142135f,0,10);
  assertNext(ts,"hello_tellus",1,1.4142135f,0,10);
  assertNext(ts,"greetings_tellus",1,1.4142135f,0,10);
  assertNext(ts,"world_$",1,7.1414285f,5,10);
  assertNext(ts,"earth_$",1,7.1414285f,5,10);
  assertNext(ts,"tellus_$",1,7.1414285f,5,10);
  assertFalse(ts.incrementToken());
  tls.reset();
  ts=new ShingleMatrixFilter(tls,1,Integer.MAX_VALUE,new Character('_'),false);
  assertNext(ts,"^",1,10.0f,0,0);
  assertNext(ts,"^_hello",1,10.049875f,0,4);
  assertNext(ts,"^_hello_world",1,10.099504f,0,10);
  assertNext(ts,"^_hello_world_$",1,12.328828f,0,10);
  assertNext(ts,"hello",1,1.0f,0,4);
  assertNext(ts,"hello_world",1,1.4142135f,0,10);
  assertNext(ts,"hello_world_$",1,7.2111025f,0,10);
  assertNext(ts,"world",1,1.0f,5,10);
  assertNext(ts,"world_$",1,7.1414285f,5,10);
  assertNext(ts,"$",1,7.071068f,10,10);
  assertNext(ts,"^_greetings",1,10.049875f,0,4);
  assertNext(ts,"^_greetings_world",1,10.099504f,0,10);
  assertNext(ts,"^_greetings_world_$",1,12.328828f,0,10);
  assertNext(ts,"greetings",1,1.0f,0,4);
  assertNext(ts,"greetings_world",1,1.4142135f,0,10);
  assertNext(ts,"greetings_world_$",1,7.2111025f,0,10);
  assertNext(ts,"^_hello_earth",1,10.099504f,0,10);
  assertNext(ts,"^_hello_earth_$",1,12.328828f,0,10);
  assertNext(ts,"hello_earth",1,1.4142135f,0,10);
  assertNext(ts,"hello_earth_$",1,7.2111025f,0,10);
  assertNext(ts,"earth",1,1.0f,5,10);
  assertNext(ts,"earth_$",1,7.1414285f,5,10);
  assertNext(ts,"^_greetings_earth",1,10.099504f,0,10);
  assertNext(ts,"^_greetings_earth_$",1,12.328828f,0,10);
  assertNext(ts,"greetings_earth",1,1.4142135f,0,10);
  assertNext(ts,"greetings_earth_$",1,7.2111025f,0,10);
  assertNext(ts,"^_hello_tellus",1,10.099504f,0,10);
  assertNext(ts,"^_hello_tellus_$",1,12.328828f,0,10);
  assertNext(ts,"hello_tellus",1,1.4142135f,0,10);
  assertNext(ts,"hello_tellus_$",1,7.2111025f,0,10);
  assertNext(ts,"tellus",1,1.0f,5,10);
  assertNext(ts,"tellus_$",1,7.1414285f,5,10);
  assertNext(ts,"^_greetings_tellus",1,10.099504f,0,10);
  assertNext(ts,"^_greetings_tellus_$",1,12.328828f,0,10);
  assertNext(ts,"greetings_tellus",1,1.4142135f,0,10);
  assertNext(ts,"greetings_tellus_$",1,7.2111025f,0,10);
  assertFalse(ts.incrementToken());
  tls.reset();
  ts=new ShingleMatrixFilter(tls,1,Integer.MAX_VALUE,new Character('_'),true);
  assertNext(ts,"^_hello",1,10.049875f,0,4);
  assertNext(ts,"^_hello_world",1,10.099504f,0,10);
  assertNext(ts,"^_hello_world_$",1,12.328828f,0,10);
  assertNext(ts,"hello",1,1.0f,0,4);
  assertNext(ts,"hello_world",1,1.4142135f,0,10);
  assertNext(ts,"hello_world_$",1,7.2111025f,0,10);
  assertNext(ts,"world",1,1.0f,5,10);
  assertNext(ts,"world_$",1,7.1414285f,5,10);
  assertNext(ts,"^_greetings",1,10.049875f,0,4);
  assertNext(ts,"^_greetings_world",1,10.099504f,0,10);
  assertNext(ts,"^_greetings_world_$",1,12.328828f,0,10);
  assertNext(ts,"greetings",1,1.0f,0,4);
  assertNext(ts,"greetings_world",1,1.4142135f,0,10);
  assertNext(ts,"greetings_world_$",1,7.2111025f,0,10);
  assertNext(ts,"^_hello_earth",1,10.099504f,0,10);
  assertNext(ts,"^_hello_earth_$",1,12.328828f,0,10);
  assertNext(ts,"hello_earth",1,1.4142135f,0,10);
  assertNext(ts,"hello_earth_$",1,7.2111025f,0,10);
  assertNext(ts,"earth",1,1.0f,5,10);
  assertNext(ts,"earth_$",1,7.1414285f,5,10);
  assertNext(ts,"^_greetings_earth",1,10.099504f,0,10);
  assertNext(ts,"^_greetings_earth_$",1,12.328828f,0,10);
  assertNext(ts,"greetings_earth",1,1.4142135f,0,10);
  assertNext(ts,"greetings_earth_$",1,7.2111025f,0,10);
  assertNext(ts,"^_hello_tellus",1,10.099504f,0,10);
  assertNext(ts,"^_hello_tellus_$",1,12.328828f,0,10);
  assertNext(ts,"hello_tellus",1,1.4142135f,0,10);
  assertNext(ts,"hello_tellus_$",1,7.2111025f,0,10);
  assertNext(ts,"tellus",1,1.0f,5,10);
  assertNext(ts,"tellus_$",1,7.1414285f,5,10);
  assertNext(ts,"^_greetings_tellus",1,10.099504f,0,10);
  assertNext(ts,"^_greetings_tellus_$",1,12.328828f,0,10);
  assertNext(ts,"greetings_tellus",1,1.4142135f,0,10);
  assertNext(ts,"greetings_tellus_$",1,7.2111025f,0,10);
  assertFalse(ts.incrementToken());
  System.currentTimeMillis();
  tokens=new LinkedList<Token>();
  tokens.add(tokenFactory("hello",1,1f,0,4,ShingleMatrixFilter.TokenPositioner.newColumn));
  tokens.add(tokenFactory("greetings",1,1f,0,4,ShingleMatrixFilter.TokenPositioner.newRow));
  tokens.add(tokenFactory("and",1,1f,0,4,ShingleMatrixFilter.TokenPositioner.sameRow));
  tokens.add(tokenFactory("salutations",1,1f,0,4,ShingleMatrixFilter.TokenPositioner.sameRow));
  tokens.add(tokenFactory("world",1,1f,5,10,ShingleMatrixFilter.TokenPositioner.newColumn));
  tokens.add(tokenFactory("earth",1,1f,5,10,ShingleMatrixFilter.TokenPositioner.newRow));
  tokens.add(tokenFactory("tellus",1,1f,5,10,ShingleMatrixFilter.TokenPositioner.newRow));
  tls=new TokenListStream(tokens);
  ts=new ShingleMatrixFilter(tls,2,3,new Character('_'),false);
  assertNext(ts,"hello_world",1,1.4142135f,0,10);
  assertNext(ts,"greetings_and",1,1.4142135f,0,4);
  assertNext(ts,"greetings_and_salutations",1,1.7320508f,0,4);
  assertNext(ts,"and_salutations",1,1.4142135f,0,4);
  assertNext(ts,"and_salutations_world",1,1.7320508f,0,10);
  assertNext(ts,"salutations_world",1,1.4142135f,0,10);
  assertNext(ts,"hello_earth",1,1.4142135f,0,10);
  assertNext(ts,"and_salutations_earth",1,1.7320508f,0,10);
  assertNext(ts,"salutations_earth",1,1.4142135f,0,10);
  assertNext(ts,"hello_tellus",1,1.4142135f,0,10);
  assertNext(ts,"and_salutations_tellus",1,1.7320508f,0,10);
  assertNext(ts,"salutations_tellus",1,1.4142135f,0,10);
  assertFalse(ts.incrementToken());
  System.currentTimeMillis();
}
