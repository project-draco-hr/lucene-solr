{
  SpatialRelation sect=a.relate(b);
  if (sect == expected)   return;
  msg=((msg == null) ? "" : msg + "\r") + a + " intersect "+ b;
  if (expected == WITHIN || expected == CONTAINS) {
    if (a.getClass().equals(b.getClass()))     assertEquals(msg,a,b);
 else {
      assertTrue(msg,!a.hasArea());
      assertTrue(msg,!b.hasArea());
      Rectangle aBBox=a.getBoundingBox();
      Rectangle bBBox=b.getBoundingBox();
      if (aBBox.getHeight() == 0 && bBBox.getHeight() == 0 && (aBBox.getMaxY() == 90 && bBBox.getMaxY() == 90 || aBBox.getMinY() == -90 && bBBox.getMinY() == -90))       ;
 else       assertEquals(msg,aBBox,bBBox);
    }
  }
 else {
    assertEquals(msg,expected,sect);
  }
}
