{
  if (fieldName != null) {
    this.fieldName=fieldName;
  }
 else {
    this.fieldName=null;
  }
  Map<String,WeightedSpanTerm> terms=new PositionCheckingMap<>();
  this.tokenStream=tokenStream;
  try {
    extract(query,terms);
  }
  finally {
    IOUtils.close(internalReader);
  }
  return terms;
}
