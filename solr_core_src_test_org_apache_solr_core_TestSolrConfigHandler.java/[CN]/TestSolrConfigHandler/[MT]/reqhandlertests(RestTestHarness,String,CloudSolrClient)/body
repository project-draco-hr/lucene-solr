{
  String payload="{\n" + "'create-requesthandler' : { 'name' : '/x', 'class': 'org.apache.solr.handler.DumpRequestHandler' , 'startup' : 'lazy'}\n" + "}";
  runConfigCommand(writeHarness,"/config?wt=json",payload);
  testForResponseElement(writeHarness,testServerBaseUrl,"/config/overlay?wt=json",cloudSolrServer,Arrays.asList("overlay","requestHandler","/x","startup"),"lazy",10);
  payload="{\n" + "'update-requesthandler' : { 'name' : '/x', 'class': 'org.apache.solr.handler.DumpRequestHandler' , 'startup' : 'lazy' , 'a':'b' , 'defaults': {'def_a':'def A val'}}\n" + "}";
  runConfigCommand(writeHarness,"/config?wt=json",payload);
  testForResponseElement(writeHarness,testServerBaseUrl,"/config/overlay?wt=json",cloudSolrServer,Arrays.asList("overlay","requestHandler","/x","a"),"b",10);
  testForResponseElement(writeHarness,testServerBaseUrl,"/x?wt=json&getdefaults=true&json.nl=map",cloudSolrServer,Arrays.asList("getdefaults","def_a"),"def A val",10);
  payload="{\n" + "'delete-requesthandler' : '/x'" + "}";
  runConfigCommand(writeHarness,"/config?wt=json",payload);
  boolean success=false;
  long startTime=System.nanoTime();
  int maxTimeoutSeconds=10;
  while (TimeUnit.SECONDS.convert(System.nanoTime() - startTime,TimeUnit.NANOSECONDS) < maxTimeoutSeconds) {
    String uri="/config/overlay?wt=json";
    Map m=testServerBaseUrl == null ? getRespMap(uri,writeHarness) : TestSolrConfigHandlerConcurrent.getAsMap(testServerBaseUrl + uri,cloudSolrServer);
    if (null == ConfigOverlay.getObjectByPath(m,true,Arrays.asList("overlay","requestHandler","/x","a"))) {
      success=true;
      break;
    }
    Thread.sleep(100);
  }
  assertTrue("Could not delete requestHandler  ",success);
  payload="{\n" + "'create-queryconverter' : { 'name' : 'qc', 'class': 'org.apache.solr.spelling.SpellingQueryConverter'}\n" + "}";
  runConfigCommand(writeHarness,"/config?wt=json",payload);
  testForResponseElement(writeHarness,testServerBaseUrl,"/config?wt=json",cloudSolrServer,Arrays.asList("config","queryConverter","qc","class"),"org.apache.solr.spelling.SpellingQueryConverter",10);
  payload="{\n" + "'update-queryconverter' : { 'name' : 'qc', 'class': 'org.apache.solr.spelling.SuggestQueryConverter'}\n" + "}";
  runConfigCommand(writeHarness,"/config?wt=json",payload);
  testForResponseElement(writeHarness,testServerBaseUrl,"/config?wt=json",cloudSolrServer,Arrays.asList("config","queryConverter","qc","class"),"org.apache.solr.spelling.SuggestQueryConverter",10);
  payload="{\n" + "'delete-queryconverter' : 'qc'" + "}";
  runConfigCommand(writeHarness,"/config?wt=json",payload);
  testForResponseElement(writeHarness,testServerBaseUrl,"/config?wt=json",cloudSolrServer,Arrays.asList("config","queryConverter","qc"),null,10);
  payload="{\n" + "'create-searchcomponent' : { 'name' : 'tc', 'class': 'org.apache.solr.handler.component.TermsComponent'}\n" + "}";
  runConfigCommand(writeHarness,"/config?wt=json",payload);
  testForResponseElement(writeHarness,testServerBaseUrl,"/config?wt=json",cloudSolrServer,Arrays.asList("config","searchComponent","tc","class"),"org.apache.solr.handler.component.TermsComponent",10);
  payload="{\n" + "'update-searchcomponent' : { 'name' : 'tc', 'class': 'org.apache.solr.handler.component.TermVectorComponent' }\n" + "}";
  runConfigCommand(writeHarness,"/config?wt=json",payload);
  testForResponseElement(writeHarness,testServerBaseUrl,"/config?wt=json",cloudSolrServer,Arrays.asList("config","searchComponent","tc","class"),"org.apache.solr.handler.component.TermVectorComponent",10);
  payload="{\n" + "'delete-searchcomponent' : 'tc'" + "}";
  runConfigCommand(writeHarness,"/config?wt=json",payload);
  testForResponseElement(writeHarness,testServerBaseUrl,"/config?wt=json",cloudSolrServer,Arrays.asList("config","searchComponent","tc"),null,10);
  payload="{\n" + "'create-valuesourceparser' : { 'name' : 'cu', 'class': 'org.apache.solr.core.CountUsageValueSourceParser'}\n" + "}";
  runConfigCommand(writeHarness,"/config?wt=json",payload);
  testForResponseElement(writeHarness,testServerBaseUrl,"/config?wt=json",cloudSolrServer,Arrays.asList("config","valueSourceParser","cu","class"),"org.apache.solr.core.CountUsageValueSourceParser",10);
  payload="{\n" + "'update-valuesourceparser' : { 'name' : 'cu', 'class': 'org.apache.solr.search.function.NvlValueSourceParser'}\n" + "}";
  runConfigCommand(writeHarness,"/config?wt=json",payload);
  testForResponseElement(writeHarness,testServerBaseUrl,"/config?wt=json",cloudSolrServer,Arrays.asList("config","valueSourceParser","cu","class"),"org.apache.solr.search.function.NvlValueSourceParser",10);
  payload="{\n" + "'delete-valuesourceparser' : 'cu'" + "}";
  runConfigCommand(writeHarness,"/config?wt=json",payload);
  testForResponseElement(writeHarness,testServerBaseUrl,"/config?wt=json",cloudSolrServer,Arrays.asList("config","valueSourceParser","cu"),null,10);
  payload="{\n" + "'create-transformer' : { 'name' : 'mytrans', 'class': 'org.apache.solr.response.transform.ValueAugmenterFactory', 'value':'5'}\n" + "}";
  runConfigCommand(writeHarness,"/config?wt=json",payload);
  testForResponseElement(writeHarness,testServerBaseUrl,"/config?wt=json",cloudSolrServer,Arrays.asList("config","transformer","mytrans","class"),"org.apache.solr.response.transform.ValueAugmenterFactory",10);
  payload="{\n" + "'update-transformer' : { 'name' : 'mytrans', 'class': 'org.apache.solr.response.transform.ValueAugmenterFactory', 'value':'6'}\n" + "}";
  runConfigCommand(writeHarness,"/config?wt=json",payload);
  testForResponseElement(writeHarness,testServerBaseUrl,"/config?wt=json",cloudSolrServer,Arrays.asList("config","transformer","mytrans","value"),"6",10);
  payload="{\n" + "'delete-transformer' : 'mytrans'" + "}";
  runConfigCommand(writeHarness,"/config?wt=json",payload);
  testForResponseElement(writeHarness,testServerBaseUrl,"/config?wt=json",cloudSolrServer,Arrays.asList("config","transformer","mytrans"),null,10);
}
