{
  if (lastTerm != null) {
    assertTrue(lastTerm.compareTo(term) < 0);
  }
  lastTerm=BytesRef.deepCopyOf(term);
  totTermCount++;
  totPrefixCount+=term.length;
  for (int i=1; i <= term.length; i++) {
    BytesRef prefix=BytesRef.deepCopyOf(term);
    prefix.length=i;
    Integer count=prefixCounts.get(prefix);
    if (count == null) {
      count=1;
    }
 else {
      count+=1;
    }
    prefixCounts.put(prefix,count);
  }
}
