{
  int port=lastPortUsed == -1 ? BASE_PORT : lastPortUsed + 1;
  Server server=null;
  while (true) {
    try {
      server=new Server(port);
      server.setHandler(handler);
      QueuedThreadPool threadPool=new QueuedThreadPool();
      threadPool.setDaemon(true);
      threadPool.setMaxIdleTimeMs(0);
      server.setThreadPool(threadPool);
      server.start();
      lastPortUsed=port;
      return server;
    }
 catch (    SocketException e) {
      stopHttpServer(server);
      ++port;
    }
  }
}
