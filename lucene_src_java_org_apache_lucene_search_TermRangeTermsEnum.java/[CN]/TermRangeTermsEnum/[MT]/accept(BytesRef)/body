{
  if (collator == null) {
    if (!this.includeLower && term.equals(lowerBytesRef))     return AcceptStatus.NO;
    if (upperBytesRef != null) {
      final int cmp=termComp.compare(upperBytesRef,term);
      if ((cmp < 0) || (!includeUpper && cmp == 0)) {
        return AcceptStatus.END;
      }
    }
    return AcceptStatus.YES;
  }
 else {
    if ((includeLower ? collator.compare(term.utf8ToString(),lowerTermText) >= 0 : collator.compare(term.utf8ToString(),lowerTermText) > 0) && (upperTermText == null || (includeUpper ? collator.compare(term.utf8ToString(),upperTermText) <= 0 : collator.compare(term.utf8ToString(),upperTermText) < 0))) {
      return AcceptStatus.YES;
    }
    return AcceptStatus.NO;
  }
}
