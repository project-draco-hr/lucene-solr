{
  String function=expression.getFunctionName();
  if (streamFunctions.containsKey(function)) {
    Class clazz=streamFunctions.get(function);
    if (Expressible.class.isAssignableFrom(clazz) && TupleStream.class.isAssignableFrom(clazz)) {
      TupleStream stream=(TupleStream)createInstance(streamFunctions.get(function),new Class[]{StreamExpression.class,StreamFactory.class},new Object[]{expression,this});
      return stream;
    }
  }
  throw new IOException(String.format(Locale.ROOT,"Invalid stream expression %s - function '%s' is unknown (not mapped to a valid TupleStream)",expression,expression.getFunctionName()));
}
