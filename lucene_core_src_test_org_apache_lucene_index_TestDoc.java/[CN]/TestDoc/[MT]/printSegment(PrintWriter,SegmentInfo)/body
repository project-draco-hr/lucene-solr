{
  SegmentReader reader=new SegmentReader(si,DirectoryReader.DEFAULT_TERMS_INDEX_DIVISOR,newIOContext(random()));
  for (int i=0; i < reader.numDocs(); i++)   out.println(reader.document(i));
  FieldsEnum fis=reader.fields().iterator();
  String field=fis.next();
  while (field != null) {
    Terms terms=fis.terms();
    assertNotNull(terms);
    TermsEnum tis=terms.iterator(null);
    while (tis.next() != null) {
      out.print("  term=" + field + ":"+ tis.term());
      out.println("    DF=" + tis.docFreq());
      DocsAndPositionsEnum positions=tis.docsAndPositions(reader.getLiveDocs(),null,false);
      while (positions.nextDoc() != DocIdSetIterator.NO_MORE_DOCS) {
        out.print(" doc=" + positions.docID());
        out.print(" TF=" + positions.freq());
        out.print(" pos=");
        out.print(positions.nextPosition());
        for (int j=1; j < positions.freq(); j++)         out.print("," + positions.nextPosition());
        out.println("");
      }
    }
    field=fis.next();
  }
  reader.close();
}
