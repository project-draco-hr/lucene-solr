{
  SlowSynonymMap synMap;
  List<String> rules=new ArrayList<String>();
  rules.add("a,b");
  synMap=new SlowSynonymMap(true);
  SlowSynonymFilterFactory.parseRules(rules,synMap,"=>",",",true,null);
  assertEquals(2,synMap.submap.size());
  assertTokIncludes(synMap,"a","a");
  assertTokIncludes(synMap,"a","b");
  assertTokIncludes(synMap,"b","a");
  assertTokIncludes(synMap,"b","b");
  rules.clear();
  rules.add("a,b,c");
  synMap=new SlowSynonymMap(true);
  SlowSynonymFilterFactory.parseRules(rules,synMap,"=>",",",true,null);
  assertEquals(3,synMap.submap.size());
  assertTokIncludes(synMap,"a","a");
  assertTokIncludes(synMap,"a","b");
  assertTokIncludes(synMap,"a","c");
  assertTokIncludes(synMap,"b","a");
  assertTokIncludes(synMap,"b","b");
  assertTokIncludes(synMap,"b","c");
  assertTokIncludes(synMap,"c","a");
  assertTokIncludes(synMap,"c","b");
  assertTokIncludes(synMap,"c","c");
  rules.clear();
  rules.add("a,b1 b2");
  synMap=new SlowSynonymMap(true);
  SlowSynonymFilterFactory.parseRules(rules,synMap,"=>",",",true,null);
  assertEquals(2,synMap.submap.size());
  assertTokIncludes(synMap,"a","a");
  assertTokIncludes(synMap,"a","b1");
  assertTokIncludes(synMap,"a","b2");
  assertEquals(1,getSubSynonymMap(synMap,"b1").submap.size());
  assertTokIncludes(getSubSynonymMap(synMap,"b1"),"b2","a");
  assertTokIncludes(getSubSynonymMap(synMap,"b1"),"b2","b1");
  assertTokIncludes(getSubSynonymMap(synMap,"b1"),"b2","b2");
  rules.clear();
  rules.add("a1 a2,b");
  synMap=new SlowSynonymMap(true);
  SlowSynonymFilterFactory.parseRules(rules,synMap,"=>",",",true,null);
  assertEquals(2,synMap.submap.size());
  assertEquals(1,getSubSynonymMap(synMap,"a1").submap.size());
  assertTokIncludes(getSubSynonymMap(synMap,"a1"),"a2","a1");
  assertTokIncludes(getSubSynonymMap(synMap,"a1"),"a2","a2");
  assertTokIncludes(getSubSynonymMap(synMap,"a1"),"a2","b");
  assertTokIncludes(synMap,"b","a1");
  assertTokIncludes(synMap,"b","a2");
  assertTokIncludes(synMap,"b","b");
}
