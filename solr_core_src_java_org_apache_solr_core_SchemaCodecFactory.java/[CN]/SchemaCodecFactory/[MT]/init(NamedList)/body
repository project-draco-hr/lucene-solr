{
  super.init(args);
  codec=new Lucene410Codec(){
    @Override public PostingsFormat getPostingsFormatForField(    String field){
      final SchemaField schemaField=core.getLatestSchema().getFieldOrNull(field);
      if (schemaField != null) {
        String postingsFormatName=schemaField.getType().getPostingsFormat();
        if (postingsFormatName != null) {
          return PostingsFormat.forName(postingsFormatName);
        }
      }
      return super.getPostingsFormatForField(field);
    }
    @Override public DocValuesFormat getDocValuesFormatForField(    String field){
      final SchemaField schemaField=core.getLatestSchema().getFieldOrNull(field);
      if (schemaField != null) {
        String docValuesFormatName=schemaField.getType().getDocValuesFormat();
        if (docValuesFormatName != null) {
          return DocValuesFormat.forName(docValuesFormatName);
        }
      }
      return super.getDocValuesFormatForField(field);
    }
  }
;
}
