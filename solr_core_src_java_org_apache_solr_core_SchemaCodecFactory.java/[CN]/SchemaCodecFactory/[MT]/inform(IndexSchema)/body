{
  codec=new Lucene42Codec(){
    @Override public PostingsFormat getPostingsFormatForField(    String field){
      final SchemaField fieldOrNull=schema.getFieldOrNull(field);
      if (fieldOrNull == null) {
        throw new IllegalArgumentException("no such field " + field);
      }
      String postingsFormatName=fieldOrNull.getType().getPostingsFormat();
      if (postingsFormatName != null) {
        return PostingsFormat.forName(postingsFormatName);
      }
      return super.getPostingsFormatForField(field);
    }
    @Override public DocValuesFormat getDocValuesFormatForField(    String field){
      final SchemaField fieldOrNull=schema.getFieldOrNull(field);
      if (fieldOrNull == null) {
        throw new IllegalArgumentException("no such field " + field);
      }
      String docValuesFormatName=fieldOrNull.getType().getDocValuesFormat();
      if (docValuesFormatName != null) {
        return DocValuesFormat.forName(docValuesFormatName);
      }
      return super.getDocValuesFormatForField(field);
    }
  }
;
}
