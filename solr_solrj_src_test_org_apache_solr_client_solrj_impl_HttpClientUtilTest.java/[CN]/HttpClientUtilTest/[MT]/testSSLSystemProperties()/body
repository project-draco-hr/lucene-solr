{
  CloseableHttpClient client=HttpClientUtil.createClient(null);
  try {
    SSLTestConfig.setSSLSystemProperties();
    assertNotNull("HTTPS scheme could not be created using the javax.net.ssl.* system properties.",client.getConnectionManager().getSchemeRegistry().get("https"));
    System.clearProperty(HttpClientUtil.SYS_PROP_CHECK_PEER_NAME);
    client.close();
    client=HttpClientUtil.createClient(null);
    assertEquals(BrowserCompatHostnameVerifier.class,getHostnameVerifier(client).getClass());
    System.setProperty(HttpClientUtil.SYS_PROP_CHECK_PEER_NAME,"true");
    client.close();
    client=HttpClientUtil.createClient(null);
    assertEquals(BrowserCompatHostnameVerifier.class,getHostnameVerifier(client).getClass());
    System.setProperty(HttpClientUtil.SYS_PROP_CHECK_PEER_NAME,"");
    client.close();
    client=HttpClientUtil.createClient(null);
    assertEquals(BrowserCompatHostnameVerifier.class,getHostnameVerifier(client).getClass());
    System.setProperty(HttpClientUtil.SYS_PROP_CHECK_PEER_NAME,"false");
    client.close();
    client=HttpClientUtil.createClient(null);
    assertEquals(AllowAllHostnameVerifier.class,getHostnameVerifier(client).getClass());
  }
  finally {
    SSLTestConfig.clearSSLSystemProperties();
    System.clearProperty(HttpClientUtil.SYS_PROP_CHECK_PEER_NAME);
    client.close();
  }
}
