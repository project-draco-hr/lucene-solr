{
  SolrQueryRequest req=req("q","id:1","wt","xlsx","fl","XXX:id,foo_s");
  XSSFSheet resultSheet=getWSResultForQuery(req);
  assertEquals("XXX,foo_s\n1,hi\n",getStringFromSheet(resultSheet));
  String txt=getStringFromSheet(getWSResultForQuery(req("q","id:1","wt","xlsx","fl","XXX:id,YYY:[docid],FOO:foo_s")));
  String[] lines=txt.split("\n");
  assertEquals(2,lines.length);
  assertEquals("XXX,YYY,FOO",lines[0]);
  assertEquals("1,0,hi",lines[1]);
  String funcText=getStringFromSheet(getWSResultForQuery(req("q","*","wt","xlsx","fl","XXX:id,YYY:exists(foo_s1)")));
  String[] funcLines=funcText.split("\n");
  assertEquals(5,funcLines.length);
  assertEquals("XXX,YYY",funcLines[0]);
  assertEquals("1,false",funcLines[1]);
  assertEquals("3,false",funcLines[3]);
}
