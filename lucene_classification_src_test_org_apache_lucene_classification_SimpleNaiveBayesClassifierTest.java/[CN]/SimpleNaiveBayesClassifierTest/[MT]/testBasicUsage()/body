{
  SlowCompositeReaderWrapper compositeReaderWrapper=null;
  try {
    populateIndex();
    SimpleNaiveBayesClassifier simpleNaiveBayesClassifier=new SimpleNaiveBayesClassifier();
    compositeReaderWrapper=new SlowCompositeReaderWrapper(indexWriter.getReader());
    simpleNaiveBayesClassifier.train(compositeReaderWrapper,textFieldName,classFieldName,analyzer);
    String newText="Much is made of what the likes of Facebook, Google and Apple know about users. Truth is, Amazon may know more. ";
    assertEquals("technology",simpleNaiveBayesClassifier.assignClass(newText));
  }
  finally {
    if (compositeReaderWrapper != null)     compositeReaderWrapper.close();
  }
}
