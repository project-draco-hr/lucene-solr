{
  if (obj == this) {
    return true;
  }
  if (obj instanceof AttributeSource) {
    AttributeSource other=(AttributeSource)obj;
    if (hasAttributes()) {
      if (!other.hasAttributes()) {
        return false;
      }
      if (attributes.size() != other.attributes.size()) {
        return false;
      }
      Iterator it=getAttributesIterator();
      while (it.hasNext()) {
        Class attName=it.next().getClass();
        Attribute otherAtt=(Attribute)other.attributes.get(attName);
        if (otherAtt == null || !otherAtt.equals(attributes.get(attName))) {
          return false;
        }
      }
      return true;
    }
 else {
      return !other.hasAttributes();
    }
  }
 else   return false;
}
