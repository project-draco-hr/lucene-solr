{
  AccessController.doPrivileged(new PrivilegedAction<Void>(){
    @Override public Void run(){
      final String systemClassName=System.class.getName(), runtimeClassName=Runtime.class.getName();
      String exitMethodHit=null;
      for (      final StackTraceElement se : Thread.currentThread().getStackTrace()) {
        final String className=se.getClassName(), methodName=se.getMethodName();
        if (("exit".equals(methodName) || "halt".equals(methodName)) && (systemClassName.equals(className) || runtimeClassName.equals(className))) {
          exitMethodHit=className + '#' + methodName+ '('+ status+ ')';
          continue;
        }
        if (exitMethodHit != null) {
          if (className.startsWith(TEST_RUNNER_PACKAGE)) {
            return null;
          }
 else {
            break;
          }
        }
      }
      if (exitMethodHit == null) {
        exitMethodHit="JVM exit method";
      }
      throw new SecurityException(exitMethodHit + " calls are not allowed because they terminate the test runner's JVM.");
    }
  }
);
  super.checkExit(status);
}
