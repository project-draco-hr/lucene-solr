{
  Map entityAttrs=createMap("name","e","url","testdata.xml",XPathEntityProcessor.FOR_EACH,"/root");
  List fields=new ArrayList();
  fields.add(createMap("column","a","xpath","/root/a",DataImporter.MULTI_VALUED,"true"));
  Context c=getContext(null,new VariableResolverImpl(),getDataSource(testXml),Context.FULL_DUMP,fields,entityAttrs);
  XPathEntityProcessor xPathEntityProcessor=new XPathEntityProcessor();
  xPathEntityProcessor.init(c);
  List<Map<String,Object>> result=new ArrayList<Map<String,Object>>();
  while (true) {
    Map<String,Object> row=xPathEntityProcessor.nextRow();
    if (row == null)     break;
    result.add(row);
  }
  List l=(List)result.get(0).get("a");
  assertEquals(3,l.size());
  assertEquals("1",l.get(0));
  assertEquals("2",l.get(1));
  assertEquals("??",l.get(2));
}
