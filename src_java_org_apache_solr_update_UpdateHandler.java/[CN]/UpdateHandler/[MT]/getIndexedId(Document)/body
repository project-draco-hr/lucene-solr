{
  if (idField == null)   throw new SolrException(400,"Operation requires schema to have a unique key field");
  Fieldable[] id=doc.getFieldables(idField.getName());
  if (id == null || id.length < 1)   throw new SolrException(400,"Document is missing uniqueKey field " + idField.getName());
  if (id.length > 1)   throw new SolrException(400,"Document specifies multiple unique ids! " + idField.getName());
  return idFieldType.storedToIndexed(id[0]);
}
