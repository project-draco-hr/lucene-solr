{
  NumberFormat format=new DecimalFormat("000000000");
  Directory dir=newDirectory();
  IndexWriter w=new IndexWriter(dir,new IndexWriterConfig(Version.LUCENE_CURRENT,new WhitespaceAnalyzer(Version.LUCENE_CURRENT)).setOpenMode(OpenMode.CREATE));
  for (int x=0; x < 10; x++) {
    Document doc=createDocument(x,"1",3,format);
    w.addDocument(doc);
  }
  for (int x=15; x < 20; x++) {
    Document doc=createDocument(x,"2",3,format);
    w.addDocument(doc);
  }
  w.close();
  Directory dir1=newDirectory();
  Directory dir2=newDirectory();
  Term splitTerm=new Term("id",new BytesRef(format.format(11)));
  PKIndexSplitter splitter=new PKIndexSplitter(splitTerm,dir,dir1,dir2);
  splitter.split();
  IndexReader ir1=IndexReader.open(dir1);
  IndexReader ir2=IndexReader.open(dir2);
  assertEquals(10,ir1.maxDoc());
  assertEquals(4,ir2.maxDoc());
  ir1.close();
  ir2.close();
  dir1.close();
  dir2.close();
  dir.close();
}
