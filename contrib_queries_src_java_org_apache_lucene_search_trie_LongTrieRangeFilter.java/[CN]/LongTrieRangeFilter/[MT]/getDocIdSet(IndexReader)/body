{
  long minBound=(this.min == null) ? Long.MIN_VALUE : (minInclusive ? this.min.longValue() : (this.min.longValue() + 1L));
  long maxBound=(this.max == null) ? Long.MAX_VALUE : (maxInclusive ? this.max.longValue() : (this.max.longValue() - 1L));
  resetLastNumberOfTerms();
  if (minBound > maxBound) {
    return DocIdSet.EMPTY_DOCIDSET;
  }
 else {
    final OpenBitSet bits=new OpenBitSet(reader.maxDoc());
    final TermDocs termDocs=reader.termDocs();
    try {
      TrieUtils.splitLongRange(new TrieUtils.LongRangeBuilder(){
        public final void addRange(        String minPrefixCoded,        String maxPrefixCoded){
          try {
            fillBits(reader,bits,termDocs,minPrefixCoded,maxPrefixCoded);
          }
 catch (          IOException ioe) {
            throw new RuntimeException(ioe);
          }
        }
      }
,precisionStep,minBound,maxBound);
    }
 catch (    RuntimeException e) {
      if (e.getCause() instanceof IOException)       throw (IOException)e.getCause();
      throw e;
    }
 finally {
      termDocs.close();
    }
    return bits;
  }
}
