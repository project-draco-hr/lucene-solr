{
  int[] docStates=new int[docs];
  for (int i=0; i < docs; i++) {
    Document doc=new Document();
    if (random().nextBoolean()) {
      docStates[i]=1;
      doc.add(newField("some","value",TextField.TYPE_STORED));
    }
    doc.add(newField("all","test",TextField.TYPE_UNSTORED));
    doc.add(newField("id","" + i,TextField.TYPE_STORED));
    writer.addDocument(doc);
  }
  writer.commit();
  int numDeletes=random().nextInt(docs);
  for (int i=0; i < numDeletes; i++) {
    int docID=random().nextInt(docs);
    writer.deleteDocuments(new Term("id","" + docID));
    docStates[docID]=2;
  }
  writer.close();
  return docStates;
}
