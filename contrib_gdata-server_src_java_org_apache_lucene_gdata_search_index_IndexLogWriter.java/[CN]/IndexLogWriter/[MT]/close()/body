{
  if (!this.isClosed.compareAndSet(false,true))   throw new IllegalStateException("Writer is already closed");
  try {
    this.writer.write(ROOT_END);
    this.writer.flush();
  }
  finally {
    this.writer.close();
  }
}
