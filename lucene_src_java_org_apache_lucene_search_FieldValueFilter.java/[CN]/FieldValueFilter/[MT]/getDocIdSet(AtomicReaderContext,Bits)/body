{
  final Bits docsWithField=FieldCache.DEFAULT.getDocsWithField(context.reader,field);
  if (negate) {
    if (docsWithField instanceof MatchAllBits) {
      return null;
    }
    return new FieldCacheDocIdSet(context.reader.maxDoc(),acceptDocs){
      @Override protected final boolean matchDoc(      int doc){
        return !docsWithField.get(doc);
      }
    }
;
  }
 else {
    if (docsWithField instanceof MatchNoBits) {
      return null;
    }
    if (docsWithField instanceof DocIdSet) {
      return BitsFilteredDocIdSet.wrap((DocIdSet)docsWithField,acceptDocs);
    }
    return new FieldCacheDocIdSet(context.reader.maxDoc(),acceptDocs){
      @Override protected final boolean matchDoc(      int doc){
        return docsWithField.get(doc);
      }
    }
;
  }
}
