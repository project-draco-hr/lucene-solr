{
  ResponseBuilder builder=SearchHandler.getResponseBuilder(req);
  if (builder.isDebug()) {
    NamedList stdinfo=SolrPluginUtils.doStandardDebug(req,builder.getQueryString(),builder.getQuery(),builder.getResults().docList);
    NamedList info=builder.getDebugInfo();
    if (info == null) {
      builder.setDebugInfo(stdinfo);
      info=stdinfo;
    }
 else {
      info.addAll(stdinfo);
    }
    if (builder.getQparser() != null) {
      builder.getQparser().addDebugInfo(builder.getDebugInfo());
    }
    if (null != builder.getDebugInfo()) {
      if (null != builder.getFilters()) {
        info.add("filter_queries",req.getParams().getParams(FQ));
        List<String> fqs=new ArrayList<String>(builder.getFilters().size());
        for (        Query fq : builder.getFilters()) {
          fqs.add(QueryParsing.toString(fq,req.getSchema()));
        }
        info.add("parsed_filter_queries",fqs);
      }
      rsp.add("debug",builder.getDebugInfo());
    }
  }
}
