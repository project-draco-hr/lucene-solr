{
  String filter=localParams.get(getParentFilterLocalParamName());
  String scoreMode=localParams.get("score",ScoreMode.None.name());
  QParser parentParser=subQuery(filter,null);
  Query parentQ=parentParser.getQuery();
  String queryText=localParams.get(QueryParsing.V);
  if (queryText == null || queryText.length() == 0) {
    SolrConstantScoreQuery wrapped=new SolrConstantScoreQuery(getFilter(parentQ));
    wrapped.setCache(false);
    return wrapped;
  }
  QParser childrenParser=subQuery(queryText,null);
  Query childrenQuery=childrenParser.getQuery();
  return createQuery(parentQ,childrenQuery,scoreMode);
}
