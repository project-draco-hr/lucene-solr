{
  String value=si.getAttribute(MODE_KEY);
  if (value == null) {
    throw new IllegalStateException("missing value for " + MODE_KEY + " for segment: "+ si.name);
  }
  Mode mode=Mode.valueOf(value);
  return impl(mode).fieldsReader(directory,si,fn,context);
}
