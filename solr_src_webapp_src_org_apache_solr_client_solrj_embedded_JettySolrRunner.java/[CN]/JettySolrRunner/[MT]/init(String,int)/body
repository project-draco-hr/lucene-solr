{
  this.context=context;
  server=new Server(port);
  if (System.getProperty("jetty.testMode") != null) {
    SelectChannelConnector connector=new SelectChannelConnector();
    connector.setPort(port);
    connector.setReuseAddress(true);
    server.setConnectors(new Connector[]{connector});
    server.setSessionIdManager(new HashSessionIdManager(new Random()));
  }
  server.setStopAtShutdown(true);
  Context root=new Context(server,context,Context.SESSIONS);
  root.addServlet(Servlet404.class,"/*");
  dispatchFilter=root.addFilter(SolrDispatchFilter.class,"*",Handler.REQUEST);
}
