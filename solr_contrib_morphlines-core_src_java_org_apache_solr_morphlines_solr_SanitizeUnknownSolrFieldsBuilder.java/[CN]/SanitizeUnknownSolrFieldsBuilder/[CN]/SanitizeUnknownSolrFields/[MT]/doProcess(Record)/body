{
  Collection<Map.Entry> entries=new ArrayList<Map.Entry>(record.getFields().asMap().entrySet());
  for (  Map.Entry<String,Collection<Object>> entry : entries) {
    String key=entry.getKey();
    if (schema.getFieldOrNull(key) == null) {
      LOG.debug("Sanitizing unknown Solr field: {}",key);
      Collection values=entry.getValue();
      if (renameToPrefix != null) {
        record.getFields().putAll(renameToPrefix + key,values);
      }
      values.clear();
    }
  }
  return super.doProcess(record);
}
