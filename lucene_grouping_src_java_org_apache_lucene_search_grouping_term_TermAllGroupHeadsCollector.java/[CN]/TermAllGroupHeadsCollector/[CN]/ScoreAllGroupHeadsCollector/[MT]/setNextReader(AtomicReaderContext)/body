{
  this.readerContext=context;
  groupIndex=FieldCache.DEFAULT.getTermsIndex(context.reader(),groupField);
  ordSet.clear();
  segmentGroupHeads=new GroupHead[groupIndex.numOrd() + 1];
  for (  GroupHead collectedGroup : collectedGroups) {
    int ord;
    if (collectedGroup.groupValue == null) {
      ord=-1;
    }
 else {
      ord=groupIndex.binarySearchLookup(collectedGroup.groupValue,scratchBytesRef);
    }
    if (collectedGroup.groupValue == null || ord >= 0) {
      ordSet.put(ord);
      segmentGroupHeads[ord + 1]=collectedGroup;
    }
  }
}
