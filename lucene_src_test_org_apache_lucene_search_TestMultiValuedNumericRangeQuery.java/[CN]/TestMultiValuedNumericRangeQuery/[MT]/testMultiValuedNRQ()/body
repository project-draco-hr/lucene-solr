{
  Directory directory=newDirectory();
  RandomIndexWriter writer=new RandomIndexWriter(random,directory,newIndexWriterConfig(TEST_VERSION_CURRENT,new MockAnalyzer(random)).setMaxBufferedDocs(_TestUtil.nextInt(random,50,1000)));
  DecimalFormat format=new DecimalFormat("00000000000",new DecimalFormatSymbols(Locale.US));
  int num=(TEST_NIGHTLY ? 5000 : 500) * RANDOM_MULTIPLIER;
  for (int l=0; l < num; l++) {
    Document doc=new Document();
    for (int m=0, c=random.nextInt(10); m <= c; m++) {
      int value=random.nextInt(Integer.MAX_VALUE);
      doc.add(newField("asc",format.format(value),Field.Store.NO,Field.Index.NOT_ANALYZED));
      doc.add(new NumericField("trie",Field.Store.NO,true).setIntValue(value));
    }
    writer.addDocument(doc);
  }
  IndexReader reader=writer.getReader();
  writer.close();
  IndexSearcher searcher=newSearcher(reader);
  num=50 * RANDOM_MULTIPLIER;
  for (int i=0; i < num; i++) {
    int lower=random.nextInt(Integer.MAX_VALUE);
    int upper=random.nextInt(Integer.MAX_VALUE);
    if (lower > upper) {
      int a=lower;
      lower=upper;
      upper=a;
    }
    TermRangeQuery cq=TermRangeQuery.newStringRange("asc",format.format(lower),format.format(upper),true,true);
    NumericRangeQuery<Integer> tq=NumericRangeQuery.newIntRange("trie",lower,upper,true,true);
    TopDocs trTopDocs=searcher.search(cq,1);
    TopDocs nrTopDocs=searcher.search(tq,1);
    assertEquals("Returned count for NumericRangeQuery and TermRangeQuery must be equal",trTopDocs.totalHits,nrTopDocs.totalHits);
  }
  searcher.close();
  reader.close();
  directory.close();
}
