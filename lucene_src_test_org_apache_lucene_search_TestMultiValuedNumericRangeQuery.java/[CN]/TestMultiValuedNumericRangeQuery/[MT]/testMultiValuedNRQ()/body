{
  final Random rnd=newRandom();
  MockRAMDirectory directory=newDirectory(rnd);
  RandomIndexWriter writer=new RandomIndexWriter(rnd,directory);
  DecimalFormat format=new DecimalFormat("00000000000",new DecimalFormatSymbols(Locale.US));
  int num=5000 * RANDOM_MULTIPLIER;
  for (int l=0; l < num; l++) {
    Document doc=new Document();
    for (int m=0, c=rnd.nextInt(10); m <= c; m++) {
      int value=rnd.nextInt(Integer.MAX_VALUE);
      doc.add(new Field("asc",format.format(value),Field.Store.NO,Field.Index.NOT_ANALYZED));
      doc.add(new NumericField("trie",Field.Store.NO,true).setIntValue(value));
    }
    writer.addDocument(doc);
  }
  IndexReader reader=writer.getReader();
  writer.close();
  Searcher searcher=new IndexSearcher(reader);
  num=50 * RANDOM_MULTIPLIER;
  for (int i=0; i < num; i++) {
    int lower=rnd.nextInt(Integer.MAX_VALUE);
    int upper=rnd.nextInt(Integer.MAX_VALUE);
    if (lower > upper) {
      int a=lower;
      lower=upper;
      upper=a;
    }
    TermRangeQuery cq=new TermRangeQuery("asc",format.format(lower),format.format(upper),true,true);
    NumericRangeQuery<Integer> tq=NumericRangeQuery.newIntRange("trie",lower,upper,true,true);
    TopDocs trTopDocs=searcher.search(cq,1);
    TopDocs nrTopDocs=searcher.search(tq,1);
    assertEquals("Returned count for NumericRangeQuery and TermRangeQuery must be equal",trTopDocs.totalHits,nrTopDocs.totalHits);
  }
  searcher.close();
  reader.close();
  directory.close();
}
