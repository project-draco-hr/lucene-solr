{
  BytesRefBuilder scratch=new BytesRefBuilder();
  IndexInput clone=dataIn.clone();
  clone.seek(0);
  long footerStartPos=dataIn.length() - (SimpleTextUtil.CHECKSUM.length + 21);
  ChecksumIndexInput input=new BufferedChecksumIndexInput(clone);
  while (true) {
    SimpleTextUtil.readLine(input,scratch);
    if (input.getFilePointer() >= footerStartPos) {
      if (input.getFilePointer() != footerStartPos) {
        throw new CorruptIndexException("SimpleText failure: footer does not start at expected position current=" + input.getFilePointer() + " vs expected="+ footerStartPos,input);
      }
      SimpleTextUtil.checkFooter(input);
      break;
    }
  }
}
