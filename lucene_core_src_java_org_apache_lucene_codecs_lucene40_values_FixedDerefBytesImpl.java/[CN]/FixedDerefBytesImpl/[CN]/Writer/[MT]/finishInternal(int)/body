{
  final int numValues=hash.size();
  final IndexOutput datOut=getOrCreateDataOut();
  datOut.writeInt(size);
  if (size != -1) {
    final BytesRef bytesRef=new BytesRef(size);
    for (int i=0; i < numValues; i++) {
      hash.get(i,bytesRef);
      datOut.writeBytes(bytesRef.bytes,bytesRef.offset,bytesRef.length);
    }
  }
  final IndexOutput idxOut=getOrCreateIndexOut();
  idxOut.writeInt(numValues);
  writeIndex(idxOut,docCount,numValues,docToEntry);
}
