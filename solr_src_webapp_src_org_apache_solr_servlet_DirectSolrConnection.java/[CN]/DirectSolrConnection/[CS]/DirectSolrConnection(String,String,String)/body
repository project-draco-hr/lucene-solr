{
  if (loggingPath != null) {
    File loggingConfig=new File(loggingPath);
    if (!loggingConfig.exists() && instanceDir != null) {
      loggingConfig=new File(new File(instanceDir),loggingPath);
    }
    if (loggingConfig.exists()) {
      System.setProperty("java.util.logging.config.file",loggingConfig.getAbsolutePath());
    }
 else {
      throw new SolrException(SolrException.ErrorCode.SERVER_ERROR,"can not find logging file: " + loggingConfig);
    }
  }
  if (instanceDir == null) {
    instanceDir=SolrResourceLoader.locateInstanceDir();
  }
  try {
    CoreContainer cores=new CoreContainer(new SolrResourceLoader(instanceDir));
    SolrConfig solrConfig=new SolrConfig(instanceDir,SolrConfig.DEFAULT_CONF_FILE,null);
    CoreDescriptor dcore=new CoreDescriptor(cores,"",solrConfig.getResourceLoader().getInstanceDir());
    IndexSchema indexSchema=new IndexSchema(solrConfig,instanceDir + "/conf/schema.xml",null);
    core=new SolrCore(null,dataDir,solrConfig,indexSchema,dcore);
    cores.register("",core,false);
    parser=new SolrRequestParsers(solrConfig);
  }
 catch (  Exception ee) {
    throw new RuntimeException(ee);
  }
}
