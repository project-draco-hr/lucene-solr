{
  Lookup lookup=lookupClass.newInstance();
  TermFreq[] keys=new TermFreq[this.keys.length];
  for (int i=0; i < keys.length; i++)   keys[i]=new TermFreq(this.keys[i],i);
  lookup.build(new TermFreqArrayIterator(keys));
  File storeDir=TEMP_DIR;
  lookup.store(storeDir);
  lookup=lookupClass.newInstance();
  lookup.load(storeDir);
  long previous=Long.MIN_VALUE;
  for (  TermFreq k : keys) {
    List<LookupResult> list=lookup.lookup(_TestUtil.bytesToCharSequence(k.term,random),false,1);
    assertEquals(1,list.size());
    LookupResult lookupResult=list.get(0);
    assertNotNull(k.term.utf8ToString(),lookupResult.key);
    if (supportsExactWeights) {
      assertEquals(k.term.utf8ToString(),k.v,lookupResult.value);
    }
 else {
      assertTrue(lookupResult.value + ">=" + previous,lookupResult.value >= previous);
      previous=lookupResult.value;
    }
  }
}
