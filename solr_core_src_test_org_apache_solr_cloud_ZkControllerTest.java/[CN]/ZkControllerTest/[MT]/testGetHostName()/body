{
  String zkDir=createTempDir("zkData").toFile().getAbsolutePath();
  CoreContainer cc=null;
  ZkTestServer server=new ZkTestServer(zkDir);
  try {
    server.run();
    AbstractZkTestCase.tryCleanSolrZkNode(server.getZkHost());
    AbstractZkTestCase.makeSolrZkNode(server.getZkHost());
    cc=getCoreContainer();
    ZkController zkController=null;
    try {
      zkController=new ZkController(cc,server.getZkAddress(),TIMEOUT,10000,"http://127.0.0.1","8983","solr",0,60000,true,new CurrentCoreDescriptorProvider(){
        @Override public List<CoreDescriptor> getCurrentDescriptors(){
          return null;
        }
      }
);
    }
 catch (    IllegalArgumentException e) {
      fail("ZkController did not normalize host name correctly");
    }
 finally {
      if (zkController != null)       zkController.close();
    }
  }
  finally {
    if (cc != null) {
      cc.shutdown();
    }
    server.shutdown();
  }
}
