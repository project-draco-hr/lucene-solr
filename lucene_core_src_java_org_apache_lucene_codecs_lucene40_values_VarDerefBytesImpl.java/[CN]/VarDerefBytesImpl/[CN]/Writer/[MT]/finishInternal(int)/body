{
  fillDefault(docCount);
  final int size=hash.size();
  final long[] addresses=new long[size];
  final IndexOutput datOut=getOrCreateDataOut();
  int addr=0;
  final BytesRef bytesRef=new BytesRef();
  for (int i=0; i < size; i++) {
    hash.get(i,bytesRef);
    addresses[i]=addr;
    addr+=writePrefixLength(datOut,bytesRef) + bytesRef.length;
    datOut.writeBytes(bytesRef.bytes,bytesRef.offset,bytesRef.length);
  }
  final IndexOutput idxOut=getOrCreateIndexOut();
  idxOut.writeLong(addr);
  writeIndex(idxOut,docCount,addresses[addresses.length - 1],addresses,docToEntry);
}
