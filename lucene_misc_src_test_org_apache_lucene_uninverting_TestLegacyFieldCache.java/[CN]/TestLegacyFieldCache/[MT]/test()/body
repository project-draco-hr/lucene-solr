{
  FieldCache cache=FieldCache.DEFAULT;
  NumericDocValues doubles=cache.getNumerics(reader,"theDouble",FieldCache.LEGACY_DOUBLE_PARSER,random().nextBoolean());
  assertSame("Second request to cache return same array",doubles,cache.getNumerics(reader,"theDouble",FieldCache.LEGACY_DOUBLE_PARSER,random().nextBoolean()));
  for (int i=0; i < NUM_DOCS; i++) {
    assertEquals(Double.doubleToLongBits(Double.MAX_VALUE - i),doubles.get(i));
  }
  NumericDocValues longs=cache.getNumerics(reader,"theLong",FieldCache.LEGACY_LONG_PARSER,random().nextBoolean());
  assertSame("Second request to cache return same array",longs,cache.getNumerics(reader,"theLong",FieldCache.LEGACY_LONG_PARSER,random().nextBoolean()));
  for (int i=0; i < NUM_DOCS; i++) {
    assertEquals(Long.MAX_VALUE - i,longs.get(i));
  }
  NumericDocValues ints=cache.getNumerics(reader,"theInt",FieldCache.LEGACY_INT_PARSER,random().nextBoolean());
  assertSame("Second request to cache return same array",ints,cache.getNumerics(reader,"theInt",FieldCache.LEGACY_INT_PARSER,random().nextBoolean()));
  for (int i=0; i < NUM_DOCS; i++) {
    assertEquals(Integer.MAX_VALUE - i,ints.get(i));
  }
  NumericDocValues floats=cache.getNumerics(reader,"theFloat",FieldCache.LEGACY_FLOAT_PARSER,random().nextBoolean());
  assertSame("Second request to cache return same array",floats,cache.getNumerics(reader,"theFloat",FieldCache.LEGACY_FLOAT_PARSER,random().nextBoolean()));
  for (int i=0; i < NUM_DOCS; i++) {
    assertEquals(Float.floatToIntBits(Float.MAX_VALUE - i),floats.get(i));
  }
  Bits docsWithField=cache.getDocsWithField(reader,"theLong",null);
  assertSame("Second request to cache return same array",docsWithField,cache.getDocsWithField(reader,"theLong",null));
  assertTrue("docsWithField(theLong) must be class Bits.MatchAllBits",docsWithField instanceof Bits.MatchAllBits);
  assertTrue("docsWithField(theLong) Size: " + docsWithField.length() + " is not: "+ NUM_DOCS,docsWithField.length() == NUM_DOCS);
  for (int i=0; i < docsWithField.length(); i++) {
    assertTrue(docsWithField.get(i));
  }
  docsWithField=cache.getDocsWithField(reader,"sparse",null);
  assertSame("Second request to cache return same array",docsWithField,cache.getDocsWithField(reader,"sparse",null));
  assertFalse("docsWithField(sparse) must not be class Bits.MatchAllBits",docsWithField instanceof Bits.MatchAllBits);
  assertTrue("docsWithField(sparse) Size: " + docsWithField.length() + " is not: "+ NUM_DOCS,docsWithField.length() == NUM_DOCS);
  for (int i=0; i < docsWithField.length(); i++) {
    assertEquals(i % 2 == 0,docsWithField.get(i));
  }
  FieldCache.DEFAULT.purgeByCacheKey(reader.getCoreCacheKey());
}
