{
  if (hasPointVals) {
    if (min == null) {
      min=Double.NEGATIVE_INFINITY;
    }
    if (max == null) {
      max=Double.POSITIVE_INFINITY;
    }
    if (minInclusive == false) {
      min=Math.nextUp(min);
    }
    if (maxInclusive == false) {
      max=Math.nextDown(max);
    }
    return DoublePoint.newRangeQuery(fieldname,min,max);
  }
 else   if (legacyNumericFieldType != null) {
    return LegacyNumericRangeQuery.newDoubleRange(fieldname,legacyNumericFieldType.numericPrecisionStep(),min,max,minInclusive,maxInclusive);
  }
  throw new UnsupportedOperationException("An index is required for this operation.");
}
