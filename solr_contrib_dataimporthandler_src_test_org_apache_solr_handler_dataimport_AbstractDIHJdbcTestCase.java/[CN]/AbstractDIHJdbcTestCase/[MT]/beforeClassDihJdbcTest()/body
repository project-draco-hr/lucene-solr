{
  try {
    Class.forName("org.hsqldb.jdbcDriver").newInstance();
  }
 catch (  Exception e) {
    throw e;
  }
  Connection conn=null;
  Statement s=null;
  PreparedStatement ps=null;
  try {
    conn=DriverManager.getConnection("jdbc:hsqldb:mem:.");
    s=conn.createStatement();
    s.executeUpdate("create table countries(code char(2) not null primary key, country_name varchar(50))");
    s.executeUpdate("create table people(id int not null primary key, name varchar(50), country_codes varchar(100))");
    s.executeUpdate("create table people_sports(id int not null primary key, person_id int, sport_name varchar(50))");
    ps=conn.prepareStatement("insert into countries values (?,?)");
    for (    String[] country : countries) {
      ps.setString(1,country[0]);
      ps.setString(2,country[1]);
      Assert.assertEquals(1,ps.executeUpdate());
    }
    ps.close();
    ps=conn.prepareStatement("insert into people values (?,?,?)");
    for (    Object[] person : people) {
      ps.setInt(1,(Integer)person[0]);
      ps.setString(2,(String)person[1]);
      ps.setString(3,(String)person[2]);
      Assert.assertEquals(1,ps.executeUpdate());
    }
    ps.close();
    ps=conn.prepareStatement("insert into people_sports values (?,?,?)");
    for (    Object[] sport : people_sports) {
      ps.setInt(1,(Integer)sport[0]);
      ps.setInt(2,(Integer)sport[1]);
      ps.setString(3,(String)sport[2]);
      Assert.assertEquals(1,ps.executeUpdate());
    }
    ps.close();
    conn.close();
  }
 catch (  Exception e) {
    throw e;
  }
 finally {
    if (s != null) {
      s.close();
    }
    if (ps != null) {
      ps.close();
    }
    if (conn != null) {
      conn.close();
    }
  }
}
