{
  File lineFile=new File(TEMP_DIR,"test.reuters.lines.txt");
  final int NUM_TRY_DOCS=50;
  String algLines1[]={"# ----- properties ","content.source=org.apache.lucene.benchmark.byTask.feeds.SingleDocSource","content.source.forever=true","line.file.out=" + lineFile.getAbsolutePath().replace('\\','/'),"# ----- alg ","{WriteLineDoc()}:" + NUM_TRY_DOCS};
  Benchmark benchmark=execBenchmark(algLines1);
  BufferedReader r=new BufferedReader(new FileReader(lineFile));
  int numLines=0;
  while (r.readLine() != null)   numLines++;
  r.close();
  assertEquals("did not see the right number of docs; should be " + NUM_TRY_DOCS + " but was "+ numLines,NUM_TRY_DOCS,numLines);
  String algLines2[]={"# ----- properties ","analyzer=org.apache.lucene.analysis.SimpleAnalyzer","content.source=org.apache.lucene.benchmark.byTask.feeds.LineDocSource","docs.file=" + lineFile.getAbsolutePath().replace('\\','/'),"content.source.forever=false","doc.reuse.fields=false","ram.flush.mb=4","# ----- alg ","ResetSystemErase","CreateIndex","{AddDoc}: *","CloseIndex"};
  benchmark=execBenchmark(algLines2);
  IndexWriter iw=new IndexWriter(benchmark.getRunData().getDirectory(),new IndexWriterConfig(TEST_VERSION_CURRENT,new WhitespaceAnalyzer(TEST_VERSION_CURRENT)).setOpenMode(OpenMode.APPEND));
  iw.close();
  IndexReader ir=IndexReader.open(benchmark.getRunData().getDirectory(),true);
  assertEquals(numLines + " lines were created but " + ir.numDocs()+ " docs are in the index",numLines,ir.numDocs());
  ir.close();
  lineFile.delete();
}
