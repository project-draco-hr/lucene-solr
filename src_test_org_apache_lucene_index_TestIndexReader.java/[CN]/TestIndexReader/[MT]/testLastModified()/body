{
  assertFalse(IndexReader.indexExists("there_is_no_such_index"));
  Directory dir=new RAMDirectory();
  assertFalse(IndexReader.indexExists(dir));
  IndexWriter writer=new IndexWriter(dir,new WhitespaceAnalyzer(),true);
  addDocumentWithFields(writer);
  assertTrue(IndexReader.isLocked(dir));
  writer.close();
  assertTrue(IndexReader.indexExists(dir));
  IndexReader reader=IndexReader.open(dir);
  assertFalse(IndexReader.isLocked(dir));
  long version=IndexReader.lastModified(dir);
  reader.close();
  writer=new IndexWriter(dir,new WhitespaceAnalyzer(),true);
  addDocumentWithFields(writer);
  writer.close();
  reader=IndexReader.open(dir);
  assertTrue("old lastModified is " + version + "; new lastModified is "+ IndexReader.lastModified(dir),version <= IndexReader.lastModified(dir));
  reader.close();
}
