{
  File indexDir=_TestUtil.getTempDir("lucenetestdiralreadyclosed");
  try {
    FSDirectory dir=FSDirectory.getDirectory(indexDir);
    IndexWriter w=new IndexWriter(indexDir,new WhitespaceAnalyzer(),IndexWriter.MaxFieldLength.LIMITED);
    w.setUseCompoundFile(false);
    Document doc=new Document();
    w.addDocument(doc);
    w.close();
    assertTrue(new File(indexDir,"_0.fnm").delete());
    try {
      IndexReader.open(indexDir);
      fail("did not hit expected exception");
    }
 catch (    AlreadyClosedException ace) {
      fail("should not have hit AlreadyClosedException");
    }
catch (    FileNotFoundException ioe) {
    }
    dir.close();
    try {
      dir.fileExists("hi");
      fail("did not hit expected exception");
    }
 catch (    AlreadyClosedException ace) {
    }
  }
  finally {
    _TestUtil.rmDir(indexDir);
  }
}
