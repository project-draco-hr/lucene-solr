{
  if (args.length != 4) {
    System.err.println("Usage: QueryDriver <topicsFile> <qrelsFile> <submissionFile> <indexDir>");
    System.err.println("topicsFile: input file containing queries");
    System.err.println("qrelsFile: input file containing relevance judgements");
    System.err.println("submissionFile: output submission file for trec_eval");
    System.err.println("indexDir: index directory");
    System.exit(1);
  }
  File topicsFile=new File(args[0]);
  File qrelsFile=new File(args[1]);
  SubmissionReport submitLog=new SubmissionReport(new PrintWriter(args[2]),"lucene");
  FSDirectory dir=FSDirectory.open(new File(args[3]));
  Searcher searcher=new IndexSearcher(dir,true);
  int maxResults=1000;
  String docNameField="docname";
  PrintWriter logger=new PrintWriter(System.out,true);
  TrecTopicsReader qReader=new TrecTopicsReader();
  QualityQuery qqs[]=qReader.readQueries(new BufferedReader(new FileReader(topicsFile)));
  Judge judge=new TrecJudge(new BufferedReader(new FileReader(qrelsFile)));
  judge.validateData(qqs,logger);
  QualityQueryParser qqParser=new SimpleQQParser("title","body");
  QualityBenchmark qrun=new QualityBenchmark(qqs,qqParser,searcher,docNameField);
  qrun.setMaxResults(maxResults);
  QualityStats stats[]=qrun.execute(judge,submitLog,logger);
  QualityStats avg=QualityStats.average(stats);
  avg.log("SUMMARY",2,logger,"  ");
}
