{
  Directory directory=new RAMDirectory();
  Analyzer analyzer=new SimpleAnalyzer();
  IndexWriter writer=new IndexWriter(directory,analyzer,true,IndexWriter.MaxFieldLength.LIMITED);
  writer.setUseCompoundFile(useCompoundFile);
  String[] docs={"a b c d e","a b c d e a b c d e","a b c d e f g h i j","a c e","e c a","a c e a c e","a c e a b c"};
  for (int j=0; j < docs.length; j++) {
    Document d=new Document();
    d.add(new Field("contents",docs[j],Field.Store.YES,Field.Index.TOKENIZED));
    writer.addDocument(d);
  }
  writer.close();
  Searcher searcher=new IndexSearcher(directory);
  String[] queries={"a b","\"a b\"","\"a b c\"","a c","\"a c\"","\"a c e\""};
  Hits hits=null;
  QueryParser parser=new QueryParser("contents",analyzer);
  parser.setPhraseSlop(4);
  for (int j=0; j < queries.length; j++) {
    Query query=parser.parse(queries[j]);
    out.println("Query: " + query.toString("contents"));
    hits=searcher.search(query);
    out.println(hits.length() + " total results");
    for (int i=0; i < hits.length() && i < 10; i++) {
      Document d=hits.doc(i);
      out.println(i + " " + hits.score(i)+ " "+ d.get("contents"));
    }
  }
  searcher.close();
}
