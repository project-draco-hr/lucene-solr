{
  SolrParams params=req.getParams();
  SolrCore core=req.getCore();
  healthcheck=core.getSolrConfig().get("admin/healthcheck/text()",null);
  String actionParam=params.get("action");
  ACTIONS action=null;
  if (actionParam == null) {
    action=ACTIONS.PING;
  }
 else {
    try {
      action=ACTIONS.valueOf(actionParam.toUpperCase(Locale.ENGLISH));
    }
 catch (    IllegalArgumentException iae) {
      throw new SolrException(SolrException.ErrorCode.BAD_REQUEST,"Unknown action: " + actionParam);
    }
  }
switch (action) {
case PING:
    if (healthcheck != null && !new File(healthcheck).exists()) {
      throw new SolrException(SolrException.ErrorCode.SERVICE_UNAVAILABLE,"Service disabled");
    }
  handlePing(req,rsp);
break;
case ENABLE:
handleEnable(healthcheck,true);
break;
case DISABLE:
handleEnable(healthcheck,false);
break;
case STATUS:
if (healthcheck == null) {
SolrException e=new SolrException(SolrException.ErrorCode.SERVICE_UNAVAILABLE,"healthcheck not configured");
rsp.setException(e);
}
 else {
if (new File(healthcheck).exists()) {
rsp.add("status","enabled");
}
 else {
rsp.add("status","disabled");
}
}
}
}
