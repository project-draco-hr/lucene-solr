{
  if (actual == null) {
    assertEquals(DocValues.EMPTY_SORTED_SET,expected);
    return;
  }
  assertEquals(expected.getValueCount(),actual.getValueCount());
  for (int i=0; i < maxDoc; i++) {
    expected.setDocument(i);
    actual.setDocument(i);
    long expectedOrd;
    while ((expectedOrd=expected.nextOrd()) != NO_MORE_ORDS) {
      assertEquals(expectedOrd,actual.nextOrd());
    }
    assertEquals(NO_MORE_ORDS,actual.nextOrd());
  }
  BytesRef expectedBytes=new BytesRef();
  BytesRef actualBytes=new BytesRef();
  for (long i=0; i < expected.getValueCount(); i++) {
    expected.lookupTerm(expectedBytes);
    actual.lookupTerm(actualBytes);
    assertEquals(expectedBytes,actualBytes);
  }
  assertEquals(expected.getValueCount(),expected.termsEnum(),actual.termsEnum());
}
