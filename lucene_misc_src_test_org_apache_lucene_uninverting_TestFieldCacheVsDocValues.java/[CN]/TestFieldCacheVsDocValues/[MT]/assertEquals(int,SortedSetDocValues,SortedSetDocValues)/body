{
  if (actual == null) {
    assertEquals(expected.getValueCount(),0);
    return;
  }
  assertEquals(expected.getValueCount(),actual.getValueCount());
  for (int i=0; i < maxDoc; i++) {
    expected.setDocument(i);
    actual.setDocument(i);
    long expectedOrd;
    while ((expectedOrd=expected.nextOrd()) != NO_MORE_ORDS) {
      assertEquals(expectedOrd,actual.nextOrd());
    }
    assertEquals(NO_MORE_ORDS,actual.nextOrd());
  }
  for (long i=0; i < expected.getValueCount(); i++) {
    final BytesRef expectedBytes=BytesRef.deepCopyOf(expected.lookupOrd(i));
    final BytesRef actualBytes=actual.lookupOrd(i);
    assertEquals(expectedBytes,actualBytes);
  }
  assertEquals(expected.getValueCount(),expected.termsEnum(),actual.termsEnum());
}
