{
  Map<String,Collection<SearchGroup<BytesRef>>> result=new HashMap<String,Collection<SearchGroup<BytesRef>>>();
  for (  Map.Entry<String,NamedList> command : shardResponse) {
    List<SearchGroup<BytesRef>> searchGroups=new ArrayList<SearchGroup<BytesRef>>();
    @SuppressWarnings("unchecked") NamedList<List<Comparable>> rawSearchGroups=command.getValue();
    for (    Map.Entry<String,List<Comparable>> rawSearchGroup : rawSearchGroups) {
      SearchGroup<BytesRef> searchGroup=new SearchGroup<BytesRef>();
      searchGroup.groupValue=rawSearchGroup.getKey() != null ? new BytesRef(rawSearchGroup.getKey()) : null;
      searchGroup.sortValues=rawSearchGroup.getValue().toArray(new Comparable[rawSearchGroup.getValue().size()]);
      searchGroups.add(searchGroup);
    }
    result.put(command.getKey(),searchGroups);
  }
  return result;
}
