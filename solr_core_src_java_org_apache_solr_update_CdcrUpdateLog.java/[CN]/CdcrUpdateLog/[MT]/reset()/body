{
synchronized (this) {
    for (    CdcrLogReader reader : new ArrayList<>(logPointers.keySet())) {
      reader.close();
    }
    logPointers.clear();
    doClose(prevTlog);
    doClose(tlog);
    for (    TransactionLog log : logs) {
      if (log == prevTlog || log == tlog)       continue;
      doClose(log);
    }
    logs.clear();
    newestLogsOnStartup.clear();
    tlog=prevTlog=null;
    prevMapLog=prevMapLog2=null;
    map.clear();
    if (prevMap != null)     prevMap.clear();
    if (prevMap2 != null)     prevMap2.clear();
    numOldRecords=0;
    oldDeletes.clear();
    deleteByQueries.clear();
    lastDataDir=null;
  }
}
