{
  long count=0;
  final int threshold=Math.min(BOOLEAN_REWRITE_TERM_COUNT_THRESHOLD,BooleanQuery.getMaxClauseCount());
  for (int i=0; i < threshold; ++i) {
    final BytesRef term=termsEnum.next();
    if (term == null) {
      return -count - 1;
    }
    TermState state=termsEnum.termState();
    if (state.isRealTerm() == false) {
      return count;
    }
    int df=termsEnum.docFreq();
    count+=df;
    terms.add(new TermAndState(BytesRef.deepCopyOf(term),state,df,termsEnum.totalTermFreq()));
  }
  return termsEnum.next() == null ? (-count - 1) : count;
}
