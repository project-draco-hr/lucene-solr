{
  mergedDocs=mergeFields();
  mergeTerms();
  mergePerDoc();
  mergeNorms();
  if (fieldInfos.hasVectors()) {
    mergeVectors();
  }
  fieldInfos.write(directory,segment + "." + IndexFileNames.FIELD_INFOS_EXTENSION);
  return mergedDocs;
}
