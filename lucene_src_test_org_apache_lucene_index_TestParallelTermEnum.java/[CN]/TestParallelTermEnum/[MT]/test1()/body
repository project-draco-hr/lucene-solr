{
  ParallelAtomicReader pr=new ParallelAtomicReader.Builder().add(ir1).add(ir2).build();
  Bits liveDocs=pr.getLiveDocs();
  FieldsEnum fe=pr.fields().iterator();
  String f=fe.next();
  assertEquals("field0",f);
  f=fe.next();
  assertEquals("field1",f);
  Terms terms=fe.terms();
  TermsEnum te=terms.iterator(null);
  assertEquals("brown",te.next().utf8ToString());
  DocsEnum td=_TestUtil.docs(random,te,liveDocs,null,false);
  assertTrue(td.nextDoc() != DocsEnum.NO_MORE_DOCS);
  assertEquals(0,td.docID());
  assertEquals(td.nextDoc(),DocsEnum.NO_MORE_DOCS);
  assertEquals("fox",te.next().utf8ToString());
  td=_TestUtil.docs(random,te,liveDocs,td,false);
  assertTrue(td.nextDoc() != DocsEnum.NO_MORE_DOCS);
  assertEquals(0,td.docID());
  assertEquals(td.nextDoc(),DocsEnum.NO_MORE_DOCS);
  assertEquals("jumps",te.next().utf8ToString());
  td=_TestUtil.docs(random,te,liveDocs,td,false);
  assertTrue(td.nextDoc() != DocsEnum.NO_MORE_DOCS);
  assertEquals(0,td.docID());
  assertEquals(td.nextDoc(),DocsEnum.NO_MORE_DOCS);
  assertEquals("quick",te.next().utf8ToString());
  td=_TestUtil.docs(random,te,liveDocs,td,false);
  assertTrue(td.nextDoc() != DocsEnum.NO_MORE_DOCS);
  assertEquals(0,td.docID());
  assertEquals(td.nextDoc(),DocsEnum.NO_MORE_DOCS);
  assertEquals("the",te.next().utf8ToString());
  td=_TestUtil.docs(random,te,liveDocs,td,false);
  assertTrue(td.nextDoc() != DocsEnum.NO_MORE_DOCS);
  assertEquals(0,td.docID());
  assertEquals(td.nextDoc(),DocsEnum.NO_MORE_DOCS);
  assertNull(te.next());
  f=fe.next();
  assertEquals("field2",f);
  terms=fe.terms();
  assertNotNull(terms);
  te=terms.iterator(null);
  assertEquals("brown",te.next().utf8ToString());
  td=_TestUtil.docs(random,te,liveDocs,td,false);
  assertTrue(td.nextDoc() != DocsEnum.NO_MORE_DOCS);
  assertEquals(0,td.docID());
  assertEquals(td.nextDoc(),DocsEnum.NO_MORE_DOCS);
  assertEquals("fox",te.next().utf8ToString());
  td=_TestUtil.docs(random,te,liveDocs,td,false);
  assertTrue(td.nextDoc() != DocsEnum.NO_MORE_DOCS);
  assertEquals(0,td.docID());
  assertEquals(td.nextDoc(),DocsEnum.NO_MORE_DOCS);
  assertEquals("jumps",te.next().utf8ToString());
  td=_TestUtil.docs(random,te,liveDocs,td,false);
  assertTrue(td.nextDoc() != DocsEnum.NO_MORE_DOCS);
  assertEquals(0,td.docID());
  assertEquals(td.nextDoc(),DocsEnum.NO_MORE_DOCS);
  assertEquals("quick",te.next().utf8ToString());
  td=_TestUtil.docs(random,te,liveDocs,td,false);
  assertTrue(td.nextDoc() != DocsEnum.NO_MORE_DOCS);
  assertEquals(0,td.docID());
  assertEquals(td.nextDoc(),DocsEnum.NO_MORE_DOCS);
  assertEquals("the",te.next().utf8ToString());
  td=_TestUtil.docs(random,te,liveDocs,td,false);
  assertTrue(td.nextDoc() != DocsEnum.NO_MORE_DOCS);
  assertEquals(0,td.docID());
  assertEquals(td.nextDoc(),DocsEnum.NO_MORE_DOCS);
  assertNull(te.next());
  f=fe.next();
  assertEquals("field3",f);
  terms=fe.terms();
  assertNotNull(terms);
  te=terms.iterator(null);
  assertEquals("dog",te.next().utf8ToString());
  td=_TestUtil.docs(random,te,liveDocs,td,false);
  assertTrue(td.nextDoc() != DocsEnum.NO_MORE_DOCS);
  assertEquals(0,td.docID());
  assertEquals(td.nextDoc(),DocsEnum.NO_MORE_DOCS);
  assertEquals("fox",te.next().utf8ToString());
  td=_TestUtil.docs(random,te,liveDocs,td,false);
  assertTrue(td.nextDoc() != DocsEnum.NO_MORE_DOCS);
  assertEquals(0,td.docID());
  assertEquals(td.nextDoc(),DocsEnum.NO_MORE_DOCS);
  assertEquals("jumps",te.next().utf8ToString());
  td=_TestUtil.docs(random,te,liveDocs,td,false);
  assertTrue(td.nextDoc() != DocsEnum.NO_MORE_DOCS);
  assertEquals(0,td.docID());
  assertEquals(td.nextDoc(),DocsEnum.NO_MORE_DOCS);
  assertEquals("lazy",te.next().utf8ToString());
  td=_TestUtil.docs(random,te,liveDocs,td,false);
  assertTrue(td.nextDoc() != DocsEnum.NO_MORE_DOCS);
  assertEquals(0,td.docID());
  assertEquals(td.nextDoc(),DocsEnum.NO_MORE_DOCS);
  assertEquals("over",te.next().utf8ToString());
  td=_TestUtil.docs(random,te,liveDocs,td,false);
  assertTrue(td.nextDoc() != DocsEnum.NO_MORE_DOCS);
  assertEquals(0,td.docID());
  assertEquals(td.nextDoc(),DocsEnum.NO_MORE_DOCS);
  assertEquals("the",te.next().utf8ToString());
  td=_TestUtil.docs(random,te,liveDocs,td,false);
  assertTrue(td.nextDoc() != DocsEnum.NO_MORE_DOCS);
  assertEquals(0,td.docID());
  assertEquals(td.nextDoc(),DocsEnum.NO_MORE_DOCS);
  assertNull(te.next());
}
