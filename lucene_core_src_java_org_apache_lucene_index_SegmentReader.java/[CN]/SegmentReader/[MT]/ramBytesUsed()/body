{
  ensureOpen();
  long ramBytesUsed=BASE_RAM_BYTES_USED;
  ramBytesUsed+=dvGens.size() * LONG_RAM_BYTES_USED;
  ramBytesUsed+=dvProducers.size() * RamUsageEstimator.NUM_BYTES_OBJECT_REF;
  ramBytesUsed+=dvProducersByField.size() * 2 * RamUsageEstimator.NUM_BYTES_OBJECT_REF;
  if (dvProducers != null) {
    for (    DocValuesProducer producer : dvProducers) {
      ramBytesUsed+=producer.ramBytesUsed();
    }
  }
  if (core != null) {
    ramBytesUsed+=core.ramBytesUsed();
  }
  return ramBytesUsed;
}
