{
  Directory dvDir=dir;
  String segmentSuffix="";
  if (gen.longValue() != -1) {
    dvDir=si.info.dir;
    segmentSuffix=Long.toString(gen.longValue(),Character.MAX_RADIX);
  }
  SegmentReadState srs=new SegmentReadState(dvDir,si.info,new FieldInfos(infos.toArray(new FieldInfo[infos.size()])),context,segmentSuffix);
  return new DocValuesRefCount(dvFormat.fieldsProducer(srs));
}
