{
  Directory dvDir=dir;
  String segmentSuffix="";
  if (gen.longValue() != -1) {
    dvDir=si.info.dir;
    segmentSuffix=Long.toString(gen.longValue(),Character.MAX_RADIX);
  }
  SegmentReadState srs=new SegmentReadState(dvDir,si.info,new FieldInfos(infos.toArray(new FieldInfo[infos.size()])),context,segmentSuffix);
  return new RefCount<DocValuesProducer>(dvFormat.fieldsProducer(srs)){
    @Override protected void release() throws IOException {
      object.close();
    }
  }
;
}
