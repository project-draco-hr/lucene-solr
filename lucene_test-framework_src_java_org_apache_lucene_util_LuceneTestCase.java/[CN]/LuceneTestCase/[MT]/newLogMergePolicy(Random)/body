{
  LogMergePolicy logmp=r.nextBoolean() ? new LogDocMergePolicy() : new LogByteSizeMergePolicy();
  logmp.setUseCompoundFile(r.nextBoolean());
  logmp.setCalibrateSizeByDeletes(r.nextBoolean());
  if (rarely(r)) {
    logmp.setMergeFactor(_TestUtil.nextInt(r,2,9));
  }
 else {
    logmp.setMergeFactor(_TestUtil.nextInt(r,10,50));
  }
  return logmp;
}
