{
  LogMergePolicy logmp=r.nextBoolean() ? new LogDocMergePolicy() : new LogByteSizeMergePolicy();
  logmp.setUseCompoundFile(r.nextBoolean());
  logmp.setCalibrateSizeByDeletes(r.nextBoolean());
  if (rarely(r)) {
    logmp.setMergeFactor(_TestUtil.nextInt(r,2,9));
  }
 else {
    logmp.setMergeFactor(_TestUtil.nextInt(r,10,50));
  }
  logmp.setUseCompoundFile(r.nextBoolean());
  logmp.setNoCFSRatio(0.1 + r.nextDouble() * 0.8);
  if (rarely()) {
    logmp.setMaxCFSSegmentSizeMB(0.2 + r.nextDouble() * 2.0);
  }
  return logmp;
}
