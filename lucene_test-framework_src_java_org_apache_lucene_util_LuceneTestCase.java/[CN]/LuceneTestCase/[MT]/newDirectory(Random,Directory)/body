{
  Directory impl=newDirectoryImpl(r,TEST_DIRECTORY);
  for (  String file : d.listAll()) {
    if (file.startsWith(IndexFileNames.SEGMENTS) || IndexFileNames.CODEC_FILE_PATTERN.matcher(file).matches()) {
      impl.copyFrom(d,file,file,newIOContext(r));
    }
  }
  return wrapDirectory(r,impl,rarely(r));
}
