{
  if (clazzName.equals("random")) {
    if (rarely(random)) {
      clazzName=RandomPicks.randomFrom(random,CORE_DIRECTORIES);
    }
 else {
      clazzName="RAMDirectory";
    }
  }
  try {
    final Class<? extends Directory> clazz=CommandLineUtil.loadDirectoryClass(clazzName);
    if (FSDirectory.class.isAssignableFrom(clazz)) {
      final Path dir=createTempDir("index-" + clazzName);
      return newFSDirectoryImpl(clazz.asSubclass(FSDirectory.class),dir,lf);
    }
    try {
      Constructor<? extends Directory> pathCtor=clazz.getConstructor(Path.class,LockFactory.class);
      final Path dir=createTempDir("index");
      return pathCtor.newInstance(dir,lf);
    }
 catch (    NoSuchMethodException nsme) {
    }
    if (!(lf instanceof FSLockFactory)) {
      try {
        return clazz.getConstructor(LockFactory.class).newInstance(lf);
      }
 catch (      NoSuchMethodException nsme) {
      }
    }
    return clazz.newInstance();
  }
 catch (  Exception e) {
    Rethrow.rethrow(e);
    throw null;
  }
}
