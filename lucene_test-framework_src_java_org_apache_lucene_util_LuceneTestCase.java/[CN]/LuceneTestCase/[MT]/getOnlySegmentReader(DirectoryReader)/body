{
  List<LeafReaderContext> subReaders=reader.leaves();
  if (subReaders.size() != 1) {
    throw new IllegalArgumentException(reader + " has " + subReaders.size()+ " segments instead of exactly one");
  }
  final LeafReader r=subReaders.get(0).reader();
  assertTrue(r instanceof SegmentReader);
  return (SegmentReader)r;
}
