{
  File base=getBaseTempDirForTestClass();
  int attempt=0;
  File f;
  do {
    if (attempt++ >= TEMP_NAME_RETRY_THRESHOLD) {
      throw new RuntimeException("Failed to get a temporary name too many times, check your temp directory and consider manually cleaning it: " + base.getAbsolutePath());
    }
    f=new File(base,prefix + "-" + String.format(Locale.ENGLISH,"%03d",attempt)+ suffix);
  }
 while (!f.createNewFile());
  registerToRemoveAfterSuite(f);
  return f;
}
