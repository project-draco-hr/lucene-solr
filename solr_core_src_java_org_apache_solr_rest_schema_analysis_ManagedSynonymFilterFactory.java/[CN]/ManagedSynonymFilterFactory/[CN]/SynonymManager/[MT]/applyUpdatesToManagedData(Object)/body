{
  if (!(updates instanceof Map)) {
    throw new ResourceException(Status.CLIENT_ERROR_BAD_REQUEST,"Unsupported data format (" + updates.getClass().getName() + "); expected a JSON object (Map)!");
  }
  boolean ignoreCase=getIgnoreCase();
  boolean madeChanges=false;
  Map<String,Object> jsonMap=(Map<String,Object>)updates;
  for (  String term : jsonMap.keySet()) {
    term=applyCaseSetting(ignoreCase,term);
    Set<String> output=synonymMappings.get(term);
    Object val=jsonMap.get(term);
    if (val instanceof String) {
      String strVal=applyCaseSetting(ignoreCase,(String)val);
      if (output == null) {
        output=new TreeSet<>();
        synonymMappings.put(term,output);
      }
      if (output.add(strVal)) {
        madeChanges=true;
      }
    }
 else     if (val instanceof List) {
      List<String> vals=(List<String>)val;
      if (output == null) {
        output=new TreeSet<>();
        synonymMappings.put(term,output);
      }
      for (      String nextVal : vals) {
        if (output.add(applyCaseSetting(ignoreCase,nextVal))) {
          madeChanges=true;
        }
      }
    }
 else {
      throw new ResourceException(Status.CLIENT_ERROR_BAD_REQUEST,"Unsupported value " + val + " for "+ term+ "; expected single value or a JSON array!");
    }
  }
  return madeChanges ? synonymMappings : null;
}
