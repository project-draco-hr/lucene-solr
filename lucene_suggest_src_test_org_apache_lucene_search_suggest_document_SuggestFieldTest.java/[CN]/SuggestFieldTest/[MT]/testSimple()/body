{
  Analyzer analyzer=new MockAnalyzer(random());
  RandomIndexWriter iw=new RandomIndexWriter(random(),dir,iwcWithSuggestField(analyzer,"suggest_field"));
  Document document=new Document();
  document.add(newSuggestField("suggest_field","abc",3l));
  document.add(newSuggestField("suggest_field","abd",4l));
  document.add(newSuggestField("suggest_field","The Foo Fighters",2l));
  iw.addDocument(document);
  document.clear();
  document.add(newSuggestField("suggest_field","abcdd",5));
  iw.addDocument(document);
  if (rarely()) {
    iw.commit();
  }
  DirectoryReader reader=iw.getReader();
  SuggestIndexSearcher suggestIndexSearcher=new SuggestIndexSearcher(reader,analyzer);
  TopSuggestDocs lookupDocs=suggestIndexSearcher.suggest("suggest_field","ab",3);
  assertSuggestions(lookupDocs,new Entry("abcdd",5),new Entry("abd",4),new Entry("abc",3));
  reader.close();
  iw.close();
}
