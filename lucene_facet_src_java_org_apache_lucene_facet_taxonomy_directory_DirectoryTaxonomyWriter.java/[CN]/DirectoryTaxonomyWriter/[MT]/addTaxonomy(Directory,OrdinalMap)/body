{
  ensureOpen();
  DirectoryReader r=DirectoryReader.open(taxoDir);
  try {
    final int size=r.numDocs();
    final OrdinalMap ordinalMap=map;
    ordinalMap.setSize(size);
    int base=0;
    TermsEnum te=null;
    DocsEnum docs=null;
    for (    final AtomicReaderContext ctx : r.leaves()) {
      final AtomicReader ar=ctx.reader();
      final Terms terms=ar.terms(Consts.FULL);
      te=terms.iterator(te);
      while (te.next() != null) {
        String value=te.term().utf8ToString();
        CategoryPath cp=new CategoryPath(value,Consts.DEFAULT_DELIMITER);
        final int ordinal=addCategory(cp);
        docs=te.docs(null,docs,DocsEnum.FLAG_NONE);
        ordinalMap.addMapping(docs.nextDoc() + base,ordinal);
      }
      base+=ar.maxDoc();
    }
    ordinalMap.addDone();
  }
  finally {
    r.close();
  }
}
