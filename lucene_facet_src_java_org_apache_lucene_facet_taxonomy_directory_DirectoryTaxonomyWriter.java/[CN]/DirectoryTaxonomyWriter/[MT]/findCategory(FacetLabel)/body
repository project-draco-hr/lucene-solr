{
  int res=cache.get(categoryPath);
  if (res >= 0 || cacheIsComplete) {
    return res;
  }
  cacheMisses.incrementAndGet();
  perhapsFillCache();
  res=cache.get(categoryPath);
  if (res >= 0 || cacheIsComplete) {
    return res;
  }
  initReaderManager();
  int doc=-1;
  DirectoryReader reader=readerManager.acquire();
  try {
    final BytesRef catTerm=new BytesRef(FacetsConfig.pathToString(categoryPath.components,categoryPath.length));
    PostingsEnum docs=null;
    for (    LeafReaderContext ctx : reader.leaves()) {
      Terms terms=ctx.reader().terms(Consts.FULL);
      if (terms != null) {
        TermsEnum termsEnum=terms.iterator();
        if (termsEnum.seekExact(catTerm)) {
          docs=termsEnum.postings(docs,0);
          doc=docs.nextDoc() + ctx.docBase;
          break;
        }
      }
    }
  }
  finally {
    readerManager.release(reader);
  }
  if (doc > 0) {
    addToCache(categoryPath,doc);
  }
  return doc;
}
