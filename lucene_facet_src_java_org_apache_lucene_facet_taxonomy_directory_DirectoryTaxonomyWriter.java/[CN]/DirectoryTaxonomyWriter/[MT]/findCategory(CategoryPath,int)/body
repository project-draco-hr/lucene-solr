{
  int res=cache.get(categoryPath,prefixLen);
  if (res >= 0 || cacheIsComplete) {
    return res;
  }
  cacheMisses.incrementAndGet();
  perhapsFillCache();
  res=cache.get(categoryPath,prefixLen);
  if (res >= 0 || cacheIsComplete) {
    return res;
  }
  initReaderManager();
  int doc=-1;
  DirectoryReader reader=readerManager.acquire();
  try {
    final BytesRef catTerm=new BytesRef(categoryPath.toString(delimiter,prefixLen));
    for (    AtomicReaderContext ctx : reader.leaves()) {
      DocsEnum docs=ctx.reader().termDocsEnum(null,Consts.FULL,catTerm,0);
      if (docs != null) {
        doc=docs.nextDoc() + ctx.docBase;
        break;
      }
    }
  }
  finally {
    readerManager.release(reader);
  }
  if (doc > 0) {
    addToCache(categoryPath,prefixLen,doc);
  }
  return doc;
}
