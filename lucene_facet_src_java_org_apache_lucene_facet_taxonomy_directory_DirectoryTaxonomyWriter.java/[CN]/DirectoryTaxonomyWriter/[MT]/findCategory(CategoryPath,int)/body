{
  int res=cache.get(categoryPath,prefixLen);
  if (res >= 0) {
    return res;
  }
  if (cacheIsComplete) {
    return -1;
  }
  cacheMisses++;
  if (perhapsFillCache()) {
    return cache.get(categoryPath,prefixLen);
  }
  if (reader == null) {
    openInternalReader();
  }
  int base=0;
  int doc=-1;
  for (  AtomicReader r : reader.getSequentialSubReaders()) {
    DocsEnum docs=r.termDocsEnum(null,Consts.FULL,new BytesRef(categoryPath.toString(delimiter,prefixLen)),false);
    if (docs != null) {
      doc=docs.nextDoc() + base;
      break;
    }
    base+=r.maxDoc();
  }
  if (doc > 0) {
    addToCache(categoryPath,prefixLen,doc);
  }
  return doc;
}
