{
  Codec codec=getCodec();
  for (  Version v : getVersions()) {
    Directory dir=newDirectory();
    SegmentInfo info=new SegmentInfo(dir,v,"_123",1,false,codec,Collections.<String,String>emptyMap(),StringHelper.randomId());
    info.setFiles(Collections.<String>emptySet());
    codec.segmentInfoFormat().getSegmentInfoWriter().write(dir,info,IOContext.DEFAULT);
    SegmentInfo info2=codec.segmentInfoFormat().getSegmentInfoReader().read(dir,"_123",IOContext.DEFAULT);
    assertEquals(info2.getVersion(),v);
    dir.close();
  }
}
