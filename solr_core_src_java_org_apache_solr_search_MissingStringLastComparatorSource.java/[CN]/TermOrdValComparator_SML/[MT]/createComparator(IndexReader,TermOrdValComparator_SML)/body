{
  parent.termsIndex=FieldCache.DEFAULT.getTermsIndex(reader,parent.field);
  final PackedInts.Reader docToOrd=parent.termsIndex.getDocToOrd();
  PerSegmentComparator perSegComp;
  if (docToOrd instanceof Direct8) {
    perSegComp=new ByteOrdComparator(((Direct8)docToOrd).getArray(),parent);
  }
 else   if (docToOrd instanceof Direct16) {
    perSegComp=new ShortOrdComparator(((Direct16)docToOrd).getArray(),parent);
  }
 else   if (docToOrd instanceof Direct32) {
    perSegComp=new IntOrdComparator(((Direct32)docToOrd).getArray(),parent);
  }
 else {
    perSegComp=new AnyOrdComparator(docToOrd,parent);
  }
  if (perSegComp.bottomSlot != -1) {
    perSegComp.setBottom(perSegComp.bottomSlot);
  }
  parent.current=perSegComp;
  return perSegComp;
}
