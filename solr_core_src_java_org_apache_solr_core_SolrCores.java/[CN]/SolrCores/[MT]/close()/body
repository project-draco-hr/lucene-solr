{
  Collection<SolrCore> coreList=new ArrayList<SolrCore>();
  do {
    coreList.clear();
synchronized (modifyLock) {
      coreList.addAll(cores.values());
      cores.clear();
      coreList.addAll(transientCores.values());
      transientCores.clear();
      coreList.addAll(pendingCloses);
      pendingCloses.clear();
    }
    for (    SolrCore core : coreList) {
      try {
        core.close();
      }
 catch (      Throwable t) {
        SolrException.log(CoreContainer.log,"Error shutting down core",t);
      }
    }
  }
 while (coreList.size() > 0);
}
