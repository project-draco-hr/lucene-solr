{
  final BasicClientCookie cookie=new BasicClientCookie("name","value");
  final CookieOrigin origin=new CookieOrigin("www.somedomain.com",80,"/",false);
  final CookieAttributeHandler h=new SolrPortAwareCookieSpecFactory.PortAwareDomainHandler();
  cookie.setDomain(".somedomain.com");
  h.validate(cookie,origin);
  cookie.setDomain(".otherdomain.com");
  try {
    h.validate(cookie,origin);
    Assert.fail("MalformedCookieException should have been thrown");
  }
 catch (  final MalformedCookieException ex) {
  }
  cookie.setDomain("www.otherdomain.com");
  try {
    h.validate(cookie,origin);
    Assert.fail("MalformedCookieException should have been thrown");
  }
 catch (  final MalformedCookieException ex) {
  }
}
