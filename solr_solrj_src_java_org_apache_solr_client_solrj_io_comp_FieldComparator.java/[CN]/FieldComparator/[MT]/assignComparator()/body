{
  if (ComparatorOrder.DESCENDING == order) {
    comparator=new ComparatorLambda(){
      public int compare(      Tuple leftTuple,      Tuple rightTuple){
        Comparable leftComp=(Comparable)leftTuple.get(leftField);
        Comparable rightComp=(Comparable)rightTuple.get(rightField);
        return rightComp.compareTo(leftComp);
      }
    }
;
  }
 else {
    comparator=new ComparatorLambda(){
      public int compare(      Tuple leftTuple,      Tuple rightTuple){
        Comparable leftComp=(Comparable)leftTuple.get(leftField);
        Comparable rightComp=(Comparable)rightTuple.get(rightField);
        return leftComp.compareTo(rightComp);
      }
    }
;
  }
}
