{
  if (ComparatorOrder.DESCENDING == order) {
    comparator=new ComparatorLambda(){
      @Override public int compare(      Tuple leftTuple,      Tuple rightTuple){
        Comparable leftComp=(Comparable)leftTuple.get(leftFieldName);
        Comparable rightComp=(Comparable)rightTuple.get(rightFieldName);
        if (leftComp == rightComp) {
          return 0;
        }
        if (null == leftComp) {
          return 1;
        }
        if (null == rightComp) {
          return -1;
        }
        return rightComp.compareTo(leftComp);
      }
    }
;
  }
 else {
    comparator=new ComparatorLambda(){
      @Override public int compare(      Tuple leftTuple,      Tuple rightTuple){
        Comparable leftComp=(Comparable)leftTuple.get(leftFieldName);
        Comparable rightComp=(Comparable)rightTuple.get(rightFieldName);
        if (leftComp == rightComp) {
          return 0;
        }
        if (null == leftComp) {
          return -1;
        }
        if (null == rightComp) {
          return 1;
        }
        return leftComp.compareTo(rightComp);
      }
    }
;
  }
}
