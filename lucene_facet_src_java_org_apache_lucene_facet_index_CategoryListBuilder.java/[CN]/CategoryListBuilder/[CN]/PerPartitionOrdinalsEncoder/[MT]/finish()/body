{
  IOUtils.closeWhileHandlingException(partitionEncoder.values());
  HashMap<String,BytesRef> bytes=new HashMap<String,BytesRef>();
  for (  Entry<String,UnsafeByteArrayOutputStream> e : partitionBytes.entrySet()) {
    UnsafeByteArrayOutputStream ubaos=e.getValue();
    bytes.put(e.getKey(),new BytesRef(ubaos.toByteArray(),ubaos.getStartPos(),ubaos.length()));
  }
  return bytes;
}
