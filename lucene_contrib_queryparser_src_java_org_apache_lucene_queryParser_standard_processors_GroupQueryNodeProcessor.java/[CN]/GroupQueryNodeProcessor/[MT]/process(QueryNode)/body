{
  if (!getQueryConfigHandler().hasAttribute(DefaultOperatorAttribute.class)) {
    throw new IllegalArgumentException("DefaultOperatorAttribute should be set on the QueryConfigHandler");
  }
  this.usingAnd=Operator.AND == getQueryConfigHandler().getAttribute(DefaultOperatorAttribute.class).getOperator();
  if (queryTree instanceof GroupQueryNode) {
    queryTree=((GroupQueryNode)queryTree).getChild();
  }
  this.queryNodeList=new ArrayList<QueryNode>();
  this.latestNodeVerified=false;
  readTree(queryTree);
  List<QueryNode> actualQueryNodeList=this.queryNodeList;
  for (int i=0; i < actualQueryNodeList.size(); i++) {
    QueryNode node=actualQueryNodeList.get(i);
    if (node instanceof GroupQueryNode) {
      actualQueryNodeList.set(i,process(node));
    }
  }
  this.usingAnd=false;
  if (queryTree instanceof BooleanQueryNode) {
    queryTree.set(actualQueryNodeList);
    return queryTree;
  }
 else {
    return new BooleanQueryNode(actualQueryNodeList);
  }
}
