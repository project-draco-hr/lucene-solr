{
  rootTransformerName="TripleThreatTransformer";
  h.query("/dataimport",generateRequest());
  int totalDocs=((totalPeople() * 3) + (numDeleted * 2));
  int totalAddedDocs=(totalPeople() + numDeleted);
  assertQ(req("q","*:*","rows","" + (totalPeople() * 3),"sort","id asc"),"//*[@numFound='" + totalDocs + "']");
  assertQ(req("id:TripleThreat-1-*"),"//*[@numFound='" + totalAddedDocs + "']");
  assertQ(req("id:TripleThreat-2-*"),"//*[@numFound='" + totalAddedDocs + "']");
  if (personNameExists("Michael") && countryCodeExists("NR")) {
    assertQ("Michael and NR are assured to be in the database.  Therefore the transformer should have added leahciM and RN on the same document as id:TripleThreat-1-3",req("+id:TripleThreat-1-3 +NAME_mult_s:Michael +NAME_mult_s:leahciM  +COUNTRY_CODES_mult_s:NR +COUNTRY_CODES_mult_s:RN"),"//*[@numFound='1']");
  }
  assertQ(req("AddAColumn_s:Added"),"//*[@numFound='" + totalAddedDocs + "']");
  Assert.assertTrue("Expecting " + numToExpect + " database calls, but DIH reported "+ totalDatabaseRequests(),totalDatabaseRequests() == numToExpect);
}
