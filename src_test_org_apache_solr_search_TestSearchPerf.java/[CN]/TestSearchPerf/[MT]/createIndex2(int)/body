{
  SolrQueryRequest req=lrf.makeRequest();
  SolrQueryResponse rsp=new SolrQueryResponse();
  UpdateRequestProcessorChain processorChain=req.getCore().getUpdateProcessingChain(null);
  UpdateRequestProcessor processor=processorChain.createProcessor(req,rsp);
  for (int i=0; i < nDocs; i++) {
    SolrInputDocument doc=new SolrInputDocument();
    doc.addField("id",Float.toString(i));
    doc.addField("foomany_s",t(r.nextInt(nDocs * 10)));
    AddUpdateCommand cmd=new AddUpdateCommand();
    cmd.solrDoc=doc;
    processor.processAdd(cmd);
  }
  processor.finish();
  req.close();
  assertU(commit());
  req=lrf.makeRequest();
  assertEquals(nDocs,req.getSearcher().maxDoc());
  req.close();
}
