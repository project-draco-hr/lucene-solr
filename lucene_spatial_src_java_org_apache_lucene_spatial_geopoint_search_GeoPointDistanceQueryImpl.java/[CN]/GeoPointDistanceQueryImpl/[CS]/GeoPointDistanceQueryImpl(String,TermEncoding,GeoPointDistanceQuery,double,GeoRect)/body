{
  super(field,termEncoding,bbox.minLat,bbox.maxLat,bbox.minLon,bbox.maxLon);
  distanceQuery=q;
  centerLon=centerLonUnwrapped;
  if (bbox.maxLon - centerLon < 90 && centerLon - bbox.minLon < 90) {
    maxPartialDistance=Math.max(SloppyMath.haversinSortKey(distanceQuery.centerLat,centerLon,distanceQuery.centerLat,bbox.maxLon),SloppyMath.haversinSortKey(distanceQuery.centerLat,centerLon,bbox.maxLat,centerLon));
  }
 else {
    maxPartialDistance=Double.POSITIVE_INFINITY;
  }
}
