{
  boolean failed=false;
  int hits=0;
  Directory directory=newDirectory();
  Analyzer indexerAnalyzer=new MockAnalyzer(random());
  IndexWriterConfig config=new IndexWriterConfig(indexerAnalyzer);
  IndexWriter writer=new IndexWriter(directory,config);
  String FIELD="content";
  Document d=new Document();
  d.add(new TextField(FIELD,"clockwork orange",Field.Store.YES));
  writer.addDocument(d);
  writer.close();
  IndexReader indexReader=DirectoryReader.open(directory);
  IndexSearcher searcher=newSearcher(indexReader);
  BooleanQuery query=new BooleanQuery();
  SpanQuery sq1=new SpanTermQuery(new Term(FIELD,"clockwork"));
  SpanQuery sq2=new SpanTermQuery(new Term(FIELD,"clckwork"));
  query.add(sq1,BooleanClause.Occur.SHOULD);
  query.add(sq2,BooleanClause.Occur.SHOULD);
  TopScoreDocCollector collector=TopScoreDocCollector.create(1000,true);
  searcher.search(query,collector);
  hits=collector.topDocs().scoreDocs.length;
  for (  ScoreDoc scoreDoc : collector.topDocs().scoreDocs) {
    System.out.println(scoreDoc.doc);
  }
  indexReader.close();
  assertEquals("Bug in boolean query composed of span queries",failed,false);
  assertEquals("Bug in boolean query composed of span queries",hits,1);
  directory.close();
}
