{
  if (reader.maxDoc() == first) {
    return;
  }
  DocsAndPositionsEnum positions=MultiFields.getTermPositionsEnum(reader,null,Consts.FIELD_PAYLOADS,Consts.PAYLOAD_PARENT_BYTES_REF,DocsAndPositionsEnum.FLAG_PAYLOADS);
  if (positions == null || positions.advance(first) == DocIdSetIterator.NO_MORE_DOCS) {
    throw new CorruptIndexException("Missing parent data for category " + first);
  }
  int num=reader.maxDoc();
  for (int i=first; i < num; i++) {
    if (positions.docID() == i) {
      if (positions.freq() == 0) {
        throw new CorruptIndexException("Missing parent data for category " + i);
      }
      parentOrdinals[i]=positions.nextPosition();
      if (positions.nextDoc() == DocIdSetIterator.NO_MORE_DOCS) {
        if (i + 1 < num) {
          throw new CorruptIndexException("Missing parent data for category " + (i + 1));
        }
        break;
      }
    }
 else {
      throw new CorruptIndexException("Missing parent data for category " + i);
    }
  }
}
