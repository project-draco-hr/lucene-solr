{
  Files.walkFileTree(fileRoot,new SimpleFileVisitor<Path>(){
    void checkPathOnZk(    Path path){
      String znode=zkRoot + path.toAbsolutePath().toString().substring(fileRoot.toAbsolutePath().toString().length());
      try {
        assertTrue("Should have found " + znode + " on Zookeeper",zkClient.exists(znode,true));
      }
 catch (      Exception e) {
        fail("Caught unexpected exception " + e.getMessage() + " Znode we were checking "+ znode);
      }
    }
    @Override public FileVisitResult visitFile(    Path file,    BasicFileAttributes attrs) throws IOException {
      assertTrue("Path should start at proper place!",file.startsWith(fileRoot));
      checkPathOnZk(file);
      return FileVisitResult.CONTINUE;
    }
    @Override public FileVisitResult preVisitDirectory(    Path dir,    BasicFileAttributes attrs) throws IOException {
      checkPathOnZk(dir);
      return FileVisitResult.CONTINUE;
    }
  }
);
}
