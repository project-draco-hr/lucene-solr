{
  String result=super.init(config,core);
  final SolrParams initParams=SolrParams.toSolrParams(config);
  HashMap<String,Object> initAttributes=new HashMap<String,Object>();
  extractCarrotAttributes(initParams,initAttributes);
  BasicPreprocessingPipelineDescriptor.attributeBuilder(initAttributes).stemmerFactory(LuceneCarrot2StemmerFactory.class).tokenizerFactory(LuceneCarrot2TokenizerFactory.class).lexicalDataFactory(SolrStopwordsCarrot2LexicalDataFactory.class);
  initAttributes.put("solrIndexSchema",core.getSchema());
  DefaultLexicalDataFactoryDescriptor.attributeBuilder(initAttributes).resourceLookup(new ResourceLookup(new SolrResourceLocator(core,initParams),new ClassLoaderLocator(core.getResourceLoader().getClassLoader())));
  this.controller.init(initAttributes);
  this.idFieldName=core.getSchema().getUniqueKeyField().getName();
  String carrotAlgorithmClassName=initParams.get(CarrotParams.ALGORITHM);
  Class<?> algorithmClass=core.getResourceLoader().findClass(carrotAlgorithmClassName);
  if (!IClusteringAlgorithm.class.isAssignableFrom(algorithmClass)) {
    throw new IllegalArgumentException("Class provided as " + CarrotParams.ALGORITHM + " must implement "+ IClusteringAlgorithm.class.getName());
  }
  this.clusteringAlgorithmClass=(Class<? extends IClusteringAlgorithm>)algorithmClass;
  return result;
}
