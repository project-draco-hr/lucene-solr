{
  if (node == null)   return null;
  NamedNodeMap attrs=node.getAttributes();
  String analyzerName=DOMUtil.getAttr(attrs,"class");
  if (analyzerName != null) {
    return (Analyzer)solrConfig.newInstance(analyzerName);
  }
  XPath xpath=XPathFactory.newInstance().newXPath();
  Node tokNode=(Node)xpath.evaluate("./tokenizer",node,XPathConstants.NODE);
  NodeList nList=(NodeList)xpath.evaluate("./filter",node,XPathConstants.NODESET);
  if (tokNode == null) {
    throw new SolrException(SolrException.ErrorCode.SERVER_ERROR,"analyzer without class or tokenizer & filter list");
  }
  TokenizerFactory tfac=readTokenizerFactory(solrConfig,tokNode);
  ArrayList<TokenFilterFactory> filters=new ArrayList<TokenFilterFactory>();
  for (int i=0; i < nList.getLength(); i++) {
    TokenFilterFactory filt=readTokenFilterFactory(solrConfig,nList.item(i));
    if (filt != null)     filters.add(filt);
  }
  return new TokenizerChain(tfac,filters.toArray(new TokenFilterFactory[filters.size()]));
}
