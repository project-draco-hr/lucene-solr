{
  Permission p=new Permission();
  String name=(String)m.get(NAME);
  if (!m.containsKey("role"))   throw new SolrException(SolrException.ErrorCode.BAD_REQUEST,"role not specified");
  p.role=readValueAsSet(m,"role");
  if (well_known_permissions.containsKey(name)) {
    HashSet<String> disAllowed=new HashSet<>(knownKeys);
    disAllowed.remove("role");
    disAllowed.remove(NAME);
    for (    String s : disAllowed) {
      if (m.containsKey(s))       throw new SolrException(SolrException.ErrorCode.BAD_REQUEST,s + " is not a valid key for the permission : " + name);
    }
    p.predicate=(Predicate<AuthorizationContext>)((Map)well_known_permissions.get(name)).get(Predicate.class.getName());
    m=well_known_permissions.get(name);
  }
  p.name=name;
  p.path=readSetSmart(name,m,"path");
  p.collections=readSetSmart(name,m,"collection");
  p.method=readSetSmart(name,m,"method");
  p.params=(Map<String,Object>)m.get("params");
  return p;
}
