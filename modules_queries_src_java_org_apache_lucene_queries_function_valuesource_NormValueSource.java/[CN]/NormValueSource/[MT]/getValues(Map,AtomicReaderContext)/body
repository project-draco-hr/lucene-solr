{
  IndexSearcher searcher=(IndexSearcher)context.get("searcher");
  final TFIDFSimilarity similarity=IDFValueSource.asTFIDF(searcher.getSimilarity(),field);
  if (similarity == null) {
    throw new UnsupportedOperationException("requires a TFIDFSimilarity (such as DefaultSimilarity)");
  }
  DocValues dv=readerContext.reader().normValues(field);
  if (dv == null) {
    return new ConstDoubleDocValues(0.0,this);
  }
  final byte[] norms=(byte[])dv.getSource().getArray();
  return new FloatDocValues(this){
    @Override public float floatVal(    int doc){
      return similarity.decodeNormValue(norms[doc]);
    }
  }
;
}
