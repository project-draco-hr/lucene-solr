{
  InputStream is=null;
  try {
    File f=new File(resource);
    if (!f.isAbsolute()) {
      f=new File(getConfigDir() + resource);
    }
    if (f.isFile() && f.canRead()) {
      return new FileInputStream(f);
    }
 else {
      f=new File(resource);
      if (f.isFile() && f.canRead()) {
        return new FileInputStream(f);
      }
    }
    ClassLoader loader=getClassLoader();
    is=loader.getResourceAsStream(resource);
  }
 catch (  Exception e) {
    throw new RuntimeException("Error opening " + resource,e);
  }
  if (is == null) {
    throw new RuntimeException("Can't find resource '" + resource + "' in classpath or '"+ getConfigDir()+ "', cwd="+ System.getProperty("user.dir"));
  }
  return is;
}
