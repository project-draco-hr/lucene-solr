{
  if (null == classLoader) {
    ClassLoader loader=Thread.currentThread().getContextClassLoader();
    File f=new File(instanceDir + "lib/");
    if (f.canRead() && f.isDirectory()) {
      File[] jarFiles=f.listFiles();
      URL[] jars=new URL[jarFiles.length];
      try {
        for (int j=0; j < jarFiles.length; j++) {
          jars[j]=jarFiles[j].toURI().toURL();
          log.info("Adding '" + jars[j].toString() + "' to Solr classloader");
        }
        loader=URLClassLoader.newInstance(jars,loader);
      }
 catch (      MalformedURLException e) {
        SolrException.log(log,"Can't construct solr lib class loader",e);
      }
    }
    classLoader=loader;
  }
  return classLoader;
}
