{
  if (loader == null) {
    loader=new SolrResourceLoader(null);
  }
  this.loader=loader;
  this.name=name;
  this.prefix=(prefix != null && !prefix.endsWith("/")) ? prefix + '/' : prefix;
  InputStream lis=is;
  try {
    if (lis == null) {
      lis=loader.openConfig(name);
    }
    javax.xml.parsers.DocumentBuilder builder=DocumentBuilderFactory.newInstance().newDocumentBuilder();
    doc=builder.parse(lis);
    DOMUtil.substituteProperties(doc,loader.getCoreProperties());
  }
 catch (  ParserConfigurationException e) {
    SolrException.log(log,"Exception during parsing file: " + name,e);
    throw e;
  }
catch (  SAXException e) {
    SolrException.log(log,"Exception during parsing file: " + name,e);
    throw e;
  }
catch (  SolrException e) {
    SolrException.log(log,"Error in " + name,e);
    throw e;
  }
 finally {
    if (lis != is)     lis.close();
  }
}
