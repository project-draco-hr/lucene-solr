{
  if (consumer == null) {
    if (fieldInfo.getNormType() != null && fieldInfo.getNormType() != type) {
      throw new IllegalArgumentException("cannot change Norm type from " + fieldInfo.getNormType() + " to "+ type+ " for field \""+ fieldInfo.name+ "\"");
    }
    if (!DocValues.isNumber(type) && !DocValues.isFloat(type)) {
      throw new IllegalArgumentException("Norm type must be numeric (got type " + type + " for field \""+ fieldInfo.name+ "\"");
    }
    fieldInfo.setNormValueType(type);
    consumer=parent.newConsumer(docState.docWriter.newPerDocWriteState(""),fieldInfo,type);
    this.initType=type;
  }
  if (initType != type) {
    throw new IllegalArgumentException("NormTypes for field: " + fieldInfo.name + " doesn't match "+ initType+ " != "+ type);
  }
  return consumer;
}
