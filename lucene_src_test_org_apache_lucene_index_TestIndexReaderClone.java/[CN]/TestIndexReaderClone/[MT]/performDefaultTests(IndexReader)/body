{
  float norm1=Similarity.getDefault().decodeNormValue(r1.norms("field1")[4]);
  IndexReader pr1Clone=(IndexReader)r1.clone();
  pr1Clone.deleteDocument(10);
  pr1Clone.setNorm(4,"field1",0.5f);
  assertTrue(Similarity.getDefault().decodeNormValue(r1.norms("field1")[4]) == norm1);
  assertTrue(Similarity.getDefault().decodeNormValue(pr1Clone.norms("field1")[4]) != norm1);
  assertTrue(!r1.isDeleted(10));
  assertTrue(pr1Clone.isDeleted(10));
  try {
    r1.deleteDocument(11);
    fail("Tried to delete doc 11 and an exception should have been thrown");
  }
 catch (  Exception exception) {
  }
  pr1Clone.close();
}
