{
  if (scratch == null)   scratch=getWorldCell();
  NRCell[] cellsByLevel=((NRCell)scratch).cellsByLevel;
  boolean isLeaf=term.bytes[term.offset + term.length - 1] == 0;
  int lenNoLeaf=isLeaf ? term.length - 1 : term.length;
  NRCell result=cellsByLevel[levelByTermLen[lenNoLeaf]];
  if (cellsByLevel[0].termBuf == null)   cellsByLevel[0].termBuf=result.term.bytes;
  result.term.bytes=term.bytes;
  result.term.offset=term.offset;
  result.term.length=lenNoLeaf;
  result.reset();
  if (isLeaf)   result.setLeaf();
  result.cellNumber=-1;
  return result;
}
