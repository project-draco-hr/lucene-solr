{
  if (!(start instanceof LevelledValue && end instanceof LevelledValue))   throw new IllegalArgumentException("Must pass " + LevelledValue.class + " but got "+ start.getClass());
  LevelledValue startLV=(LevelledValue)start;
  LevelledValue endLV=(LevelledValue)end;
  startLV=startLV.getLVAtLevel(truncateStartVals(startLV,0));
  endLV=endLV.getLVAtLevel(truncateEndVals(endLV,0));
  int cmp=comparePrefixLV(startLV,endLV);
  if (cmp > 0) {
    throw new IllegalArgumentException("Wrong order: " + start + " TO "+ end);
  }
  if (cmp == 0) {
    if (startLV.getLevel() == endLV.getLevel()) {
      return startLV;
    }
 else     if (endLV.getLevel() > startLV.getLevel()) {
      if (truncateStartVals(endLV,startLV.getLevel()) == startLV.getLevel()) {
        return endLV;
      }
    }
 else {
      if (truncateEndVals(startLV,endLV.getLevel()) == endLV.getLevel()) {
        return startLV;
      }
    }
  }
  return new NRShape(startLV,endLV);
}
