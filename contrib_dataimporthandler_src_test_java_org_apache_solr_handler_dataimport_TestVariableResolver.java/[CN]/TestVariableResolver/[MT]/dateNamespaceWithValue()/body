{
  VariableResolverImpl vri=new VariableResolverImpl();
  ContextImpl context=new ContextImpl(null,vri,null,0,Collections.EMPTY_MAP,null,null);
  vri.context=context;
  vri.addNamespace("dataimporter.functions",EvaluatorBag.getFunctionsNamespace(Collections.EMPTY_LIST,null));
  Map<String,Object> ns=new HashMap<String,Object>();
  Date d=new Date();
  ns.put("dt",d);
  vri.addNamespace("A",ns);
  Assert.assertEquals(new SimpleDateFormat("yyyy-MM-dd HH:mm:ss").format(d),vri.replaceTokens("${dataimporter.functions.formatDate(A.dt,'yyyy-MM-dd HH:mm:ss')}"));
}
