{
  final VariableResolverImpl resolver=new VariableResolverImpl();
  final Map<String,Evaluator> evaluators=new HashMap<String,Evaluator>();
  evaluators.put("formatDate",EvaluatorBag.getDateFormatEvaluator());
  evaluators.put("test",new Evaluator(){
    public String evaluate(    VariableResolver resolver,    String expression){
      return "Hello World";
    }
  }
);
  resolver.addNamespace("dataimporter.functions",EvaluatorBag.getFunctionsNamespace(resolver,evaluators));
  String s=resolver.replaceTokens("${dataimporter.functions.formatDate('NOW',yyyy-MM-dd HH:mm)}");
  Assert.assertEquals(new SimpleDateFormat("yyyy-MM-dd HH:mm").format(new Date()),s);
  Assert.assertEquals("Hello World",resolver.replaceTokens("${dataimporter.functions.test('TEST')}"));
}
