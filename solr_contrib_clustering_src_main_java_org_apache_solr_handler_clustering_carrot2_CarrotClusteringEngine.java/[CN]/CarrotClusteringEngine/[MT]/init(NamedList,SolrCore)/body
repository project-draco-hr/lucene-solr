{
  String result=super.init(config,core);
  SolrParams initParams=SolrParams.toSolrParams(config);
  HashMap<String,Object> initAttributes=new HashMap<String,Object>();
  extractCarrotAttributes(initParams,initAttributes);
  initAttributes.put("PreprocessingPipeline.languageModelFactory",LuceneLanguageModelFactory.class);
  this.controller.init(initAttributes);
  this.idFieldName=core.getSchema().getUniqueKeyField().getName();
  String carrotAlgorithmClassName=initParams.get(CarrotParams.ALGORITHM);
  Class<?> algorithmClass=core.getResourceLoader().findClass(carrotAlgorithmClassName);
  if (!IClusteringAlgorithm.class.isAssignableFrom(algorithmClass)) {
    throw new IllegalArgumentException("Class provided as " + CarrotParams.ALGORITHM + " must implement "+ IClusteringAlgorithm.class.getName());
  }
  this.clusteringAlgorithmClass=(Class<? extends IClusteringAlgorithm>)algorithmClass;
  return result;
}
