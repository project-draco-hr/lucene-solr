{
  this.internalHttpClient=(client == null);
  this.client=new HttpSolrClient.Builder(solrServerUrl).withHttpClient(client).build();
  this.client.setFollowRedirects(false);
  queue=new LinkedBlockingQueue<>(queueSize);
  this.threadCount=threadCount;
  runners=new LinkedList<>();
  this.streamDeletes=streamDeletes;
  if (es != null) {
    scheduler=es;
    shutdownExecutor=false;
  }
 else {
    scheduler=ExecutorUtil.newMDCAwareCachedThreadPool(new SolrjNamedThreadFactory("concurrentUpdateScheduler"));
    shutdownExecutor=true;
  }
}
