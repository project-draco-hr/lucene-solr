{
  lock=new CountDownLatch(1);
  try {
synchronized (runners) {
      while (!runners.isEmpty()) {
        try {
          runners.wait(250);
        }
 catch (        InterruptedException e) {
          Thread.interrupted();
        }
        if (scheduler.isShutdown())         break;
        int queueSize=queue.size();
        if (queueSize > 0 && runners.isEmpty()) {
          log.warn("No more runners, but queue still has " + queueSize + " adding more runners to process remaining requests on queue");
          addRunner();
        }
      }
    }
  }
  finally {
    lock.countDown();
    lock=null;
  }
}
