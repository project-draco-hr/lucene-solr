{
  if (!isSSLMode()) {
    return null;
  }
  SslContextFactory factory=new SslContextFactory(false);
  try {
    factory.setSslContext(buildServerSSLContext());
  }
 catch (  Exception e) {
    throw new RuntimeException("ssl context init failure: " + e.getMessage(),e);
  }
  factory.setNeedClientAuth(isClientAuthMode());
  return factory;
}
