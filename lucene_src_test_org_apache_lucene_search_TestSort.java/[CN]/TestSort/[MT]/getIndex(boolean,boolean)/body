{
  Directory indexStore=newDirectory();
  dirs.add(indexStore);
  RandomIndexWriter writer=new RandomIndexWriter(random,indexStore,newIndexWriterConfig(TEST_VERSION_CURRENT,new MockAnalyzer(random)).setMergePolicy(newLogMergePolicy()));
  final ValueType stringDVType;
  if (dvStringSorted) {
    stringDVType=random.nextBoolean() ? ValueType.BYTES_VAR_SORTED : ValueType.BYTES_FIXED_SORTED;
  }
 else {
    if (random.nextBoolean()) {
      stringDVType=random.nextBoolean() ? ValueType.BYTES_FIXED_STRAIGHT : ValueType.BYTES_FIXED_DEREF;
    }
 else {
      stringDVType=random.nextBoolean() ? ValueType.BYTES_VAR_STRAIGHT : ValueType.BYTES_VAR_DEREF;
    }
  }
  FieldType ft1=new FieldType();
  ft1.setStored(true);
  FieldType ft2=new FieldType();
  ft2.setIndexed(true);
  for (int i=0; i < data.length; ++i) {
    if (((i % 2) == 0 && even) || ((i % 2) == 1 && odd)) {
      Document doc=new Document();
      doc.add(new Field("tracer",data[i][0],ft1));
      doc.add(new TextField("contents",data[i][1]));
      if (data[i][2] != null) {
        Field f=new StringField("int",data[i][2]);
        if (supportsDocValues) {
          f=IndexDocValuesField.build(f,ValueType.VAR_INTS);
        }
        doc.add(f);
      }
      if (data[i][3] != null) {
        Field f=new StringField("float",data[i][3]);
        if (supportsDocValues) {
          f=IndexDocValuesField.build(f,ValueType.FLOAT_32);
        }
        doc.add(f);
      }
      if (data[i][4] != null) {
        Field f=new StringField("string",data[i][4]);
        if (supportsDocValues) {
          f=IndexDocValuesField.build(f,stringDVType);
        }
        doc.add(f);
      }
      if (data[i][5] != null)       doc.add(new StringField("custom",data[i][5]));
      if (data[i][6] != null)       doc.add(new StringField("i18n",data[i][6]));
      if (data[i][7] != null)       doc.add(new StringField("long",data[i][7]));
      if (data[i][8] != null) {
        Field f=new StringField("double",data[i][8]);
        if (supportsDocValues) {
          f=IndexDocValuesField.build(f,ValueType.FLOAT_64);
        }
        doc.add(f);
      }
      if (data[i][9] != null)       doc.add(new StringField("short",data[i][9]));
      if (data[i][10] != null)       doc.add(new StringField("byte",data[i][10]));
      if (data[i][11] != null)       doc.add(new StringField("parser",data[i][11]));
      for (      IndexableField f : doc.getFields()) {
        ((Field)f).setBoost(2.0f);
      }
      writer.addDocument(doc);
    }
  }
  IndexReader reader=writer.getReader();
  writer.close();
  IndexSearcher s=newSearcher(reader);
  s.setDefaultFieldSortScoring(true,true);
  return s;
}
