{
  FieldType fieldType=sf.getType();
  if (TrieDateField.class.isInstance(fieldType)) {
    return new DateStatsValues(sf,calcDistinct);
  }
 else   if (TrieField.class.isInstance(fieldType)) {
    return new NumericStatsValues(sf,calcDistinct);
  }
 else   if (StrField.class.isInstance(fieldType)) {
    return new StringStatsValues(sf,calcDistinct);
  }
 else   if (sf.getType().getClass().equals(EnumField.class)) {
    return new EnumStatsValues(sf,calcDistinct);
  }
 else {
    throw new SolrException(SolrException.ErrorCode.BAD_REQUEST,"Field type " + fieldType + " is not currently supported");
  }
}
