{
  final Iterator<Token> toks=Arrays.asList(tokens).iterator();
  RemoveDuplicatesTokenFilterFactory factory=new RemoveDuplicatesTokenFilterFactory();
  final TokenStream ts=factory.create(new TokenStream(){
    TermAttribute termAtt=(TermAttribute)addAttribute(TermAttribute.class);
    OffsetAttribute offsetAtt=(OffsetAttribute)addAttribute(OffsetAttribute.class);
    PositionIncrementAttribute posIncAtt=(PositionIncrementAttribute)addAttribute(PositionIncrementAttribute.class);
    public boolean incrementToken(){
      if (toks.hasNext()) {
        clearAttributes();
        Token tok=toks.next();
        termAtt.setTermBuffer(tok.term());
        offsetAtt.setOffset(tok.startOffset(),tok.endOffset());
        posIncAtt.setPositionIncrement(tok.getPositionIncrement());
        return true;
      }
 else {
        return false;
      }
    }
  }
);
  assertTokenStreamContents(ts,expected.split("\\s"));
}
