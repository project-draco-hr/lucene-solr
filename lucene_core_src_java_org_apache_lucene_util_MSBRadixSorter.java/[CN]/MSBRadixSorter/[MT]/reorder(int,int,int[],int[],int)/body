{
  for (int i=0; i < HISTOGRAM_SIZE; ++i) {
    final int limit=endOffsets[i];
    for (int h1=startOffsets[i]; h1 < limit; h1=startOffsets[i]) {
      final int b=getBucket(from + h1,k);
      final int h2=startOffsets[b]++;
      swap(from + h1,from + h2);
    }
  }
}
