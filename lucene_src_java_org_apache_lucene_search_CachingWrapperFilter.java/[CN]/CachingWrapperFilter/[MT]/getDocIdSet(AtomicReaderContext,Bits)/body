{
  final IndexReader reader=context.reader;
  final Object coreKey=reader.getCoreCacheKey();
  final boolean doCacheSubAcceptDocs=recacheDeletes && acceptDocs == reader.getLiveDocs();
  final Bits subAcceptDocs;
  if (doCacheSubAcceptDocs) {
    subAcceptDocs=acceptDocs;
  }
 else {
    subAcceptDocs=null;
  }
  DocIdSet docIdSet=cache.get(reader,coreKey,subAcceptDocs);
  if (docIdSet != null) {
    hitCount++;
  }
 else {
    missCount++;
    docIdSet=docIdSetToCache(filter.getDocIdSet(context,subAcceptDocs),reader);
    cache.put(coreKey,subAcceptDocs,docIdSet);
  }
  if (doCacheSubAcceptDocs) {
    return docIdSet;
  }
 else {
    return BitsFilteredDocIdSet.wrap(docIdSet,acceptDocs);
  }
}
