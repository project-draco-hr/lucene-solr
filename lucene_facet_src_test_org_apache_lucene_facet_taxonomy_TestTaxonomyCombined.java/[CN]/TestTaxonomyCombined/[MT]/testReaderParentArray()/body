{
  Directory indexDir=newDirectory();
  TaxonomyWriter tw=new DirectoryTaxonomyWriter(indexDir);
  fillTaxonomy(tw);
  tw.close();
  TaxonomyReader tr=new DirectoryTaxonomyReader(indexDir);
  int[] parents=tr.getParallelTaxonomyArrays().parents();
  assertEquals(tr.getSize(),parents.length);
  for (int i=0; i < tr.getSize(); i++) {
    assertEquals(tr.getParent(i),parents[i]);
  }
  tr.close();
  indexDir.close();
}
