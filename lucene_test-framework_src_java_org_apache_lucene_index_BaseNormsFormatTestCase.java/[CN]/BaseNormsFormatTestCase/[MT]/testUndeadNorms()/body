{
  Directory dir=newDirectory();
  RandomIndexWriter w=new RandomIndexWriter(random(),dir);
  int numDocs=atLeast(500);
  List<Integer> toDelete=new ArrayList<>();
  for (int i=0; i < numDocs; i++) {
    Document doc=new Document();
    doc.add(new StringField("id","" + i,Field.Store.NO));
    if (random().nextInt(5) == 1) {
      toDelete.add(i);
      doc.add(new TextField("content","some content",Field.Store.NO));
    }
    w.addDocument(doc);
  }
  for (  Integer id : toDelete) {
    w.deleteDocuments(new Term("id","" + id));
  }
  w.forceMerge(1);
  IndexReader r=w.getReader();
  assertFalse(r.hasDeletions());
  NumericDocValues norms=MultiDocValues.getNormValues(r,"content");
  assertNotNull(norms);
  for (int i=0; i < r.maxDoc(); i++) {
    assertEquals(0,norms.get(i));
  }
  r.close();
  w.close();
  dir.close();
}
