{
  if (infoStream.isEnabled("IW")) {
    infoStream.message("IW","commit: start");
  }
synchronized (commitLock) {
    ensureOpen(false);
    if (infoStream.isEnabled("IW")) {
      infoStream.message("IW","commit: enter lock");
    }
    if (pendingCommit == null) {
      if (infoStream.isEnabled("IW")) {
        infoStream.message("IW","commit: now prepare");
      }
      prepareCommitInternal(mergePolicy);
    }
 else {
      if (infoStream.isEnabled("IW")) {
        infoStream.message("IW","commit: already prepared");
      }
    }
    finishCommit();
  }
}
