{
synchronized (commitLock) {
    if (shouldClose()) {
      if (hitOOM) {
        rollbackInternal();
      }
 else {
        closeInternal(waitForMerges,!hitOOM);
      }
    }
  }
}
