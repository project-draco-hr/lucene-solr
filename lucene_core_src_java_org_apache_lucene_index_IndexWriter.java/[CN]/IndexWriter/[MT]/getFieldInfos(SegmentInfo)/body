{
  Directory cfsDir=null;
  try {
    if (info.getUseCompoundFile()) {
      cfsDir=new CompoundFileDirectory(directory,IndexFileNames.segmentFileName(info.name,"",IndexFileNames.COMPOUND_FILE_EXTENSION),IOContext.READONCE,false);
    }
 else {
      cfsDir=directory;
    }
    return info.getCodec().fieldInfosFormat().getFieldInfosReader().read(cfsDir,info.name,IOContext.READONCE);
  }
  finally {
    if (info.getUseCompoundFile() && cfsDir != null) {
      cfsDir.close();
    }
  }
}
