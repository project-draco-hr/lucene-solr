{
  if (pendingNumDocs.addAndGet(numDocs) > actualMaxDocs) {
    pendingNumDocs.addAndGet(-numDocs);
    throw new IllegalStateException("number of documents in the index cannot exceed " + actualMaxDocs);
  }
}
