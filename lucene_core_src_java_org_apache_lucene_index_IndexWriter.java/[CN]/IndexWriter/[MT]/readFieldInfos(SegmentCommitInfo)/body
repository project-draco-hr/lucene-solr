{
  Codec codec=si.info.getCodec();
  FieldInfosFormat reader=codec.fieldInfosFormat();
  if (si.hasFieldUpdates()) {
    final String segmentSuffix=Long.toString(si.getFieldInfosGen(),Character.MAX_RADIX);
    return reader.read(si.info.dir,si.info,segmentSuffix,IOContext.READONCE);
  }
 else   if (si.info.getUseCompoundFile()) {
    try (Directory cfs=codec.compoundFormat().getCompoundReader(si.info.dir,si.info,IOContext.DEFAULT)){
      return reader.read(cfs,si.info,"",IOContext.READONCE);
    }
   }
 else {
    return reader.read(si.info.dir,si.info,"",IOContext.READONCE);
  }
}
