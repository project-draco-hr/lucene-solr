{
  ensureOpen();
  try {
    boolean success=false;
    try {
      long seqNo=docWriter.updateDocument(doc,analyzer,term);
      if (seqNo < 0) {
        seqNo=-seqNo;
        processEvents(true,false);
      }
      success=true;
      return seqNo;
    }
  finally {
      if (!success) {
        if (infoStream.isEnabled("IW")) {
          infoStream.message("IW","hit exception updating document");
        }
      }
    }
  }
 catch (  AbortingException|VirtualMachineError tragedy) {
    tragicEvent(tragedy,"updateDocument");
    return -1;
  }
}
