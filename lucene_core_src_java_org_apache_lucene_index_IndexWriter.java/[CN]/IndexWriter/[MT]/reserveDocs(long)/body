{
  if (pendingNumDocs.addAndGet(numDocs) > actualMaxDocs) {
    pendingNumDocs.addAndGet(-numDocs);
    throw new IllegalArgumentException("number of documents in the index cannot exceed " + actualMaxDocs + " (current document count is "+ pendingNumDocs.get()+ "; added numDocs is "+ numDocs+ ")");
  }
}
