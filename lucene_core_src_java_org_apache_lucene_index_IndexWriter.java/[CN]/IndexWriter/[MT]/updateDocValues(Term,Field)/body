{
  ensureOpen();
  DocValuesUpdate[] dvUpdates=new DocValuesUpdate[updates.length];
  for (int i=0; i < updates.length; i++) {
    final Field f=updates[i];
    final DocValuesType dvType=f.fieldType().docValueType();
    if (dvType == null) {
      throw new NullPointerException("DocValuesType cannot be null (field: \"" + f.name() + "\")");
    }
    if (dvType == DocValuesType.NO) {
      throw new IllegalArgumentException("can only update NUMERIC or BINARY fields! field=" + f.name());
    }
    if (!globalFieldNumberMap.contains(f.name(),dvType)) {
      throw new IllegalArgumentException("can only update existing docvalues fields! field=" + f.name() + ", type="+ dvType);
    }
switch (dvType) {
case NUMERIC:
      dvUpdates[i]=new NumericDocValuesUpdate(term,f.name(),(Long)f.numericValue());
    break;
case BINARY:
  dvUpdates[i]=new BinaryDocValuesUpdate(term,f.name(),f.binaryValue());
break;
default :
throw new IllegalArgumentException("can only update NUMERIC or BINARY fields: field=" + f.name() + ", type="+ dvType);
}
}
try {
if (docWriter.updateDocValues(dvUpdates)) {
processEvents(true,false);
}
}
 catch (OutOfMemoryError oom) {
tragicEvent(oom,"updateDocValues");
}
}
