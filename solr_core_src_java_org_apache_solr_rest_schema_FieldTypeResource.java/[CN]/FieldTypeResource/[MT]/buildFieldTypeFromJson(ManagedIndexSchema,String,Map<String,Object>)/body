{
  if (1 == fieldTypeJson.size() && fieldTypeJson.containsKey(IndexSchema.FIELD_TYPE)) {
    fieldTypeJson=(Map<String,Object>)fieldTypeJson.get(IndexSchema.FIELD_TYPE);
  }
  String bodyTypeName=(String)fieldTypeJson.get(IndexSchema.NAME);
  if (bodyTypeName == null) {
    fieldTypeJson.put(IndexSchema.NAME,fieldTypeName);
  }
 else {
    if (!fieldTypeName.equals(bodyTypeName)) {
      String message="Field type name in the request body '" + bodyTypeName + "' doesn't match field type name in the request URL '"+ fieldTypeName+ "'";
      log.error(message);
      throw new SolrException(ErrorCode.BAD_REQUEST,message);
    }
  }
  String className=(String)fieldTypeJson.get(FieldType.CLASS_NAME);
  if (className == null) {
    String message="Missing required '" + FieldType.CLASS_NAME + "' property!";
    log.error(message);
    throw new SolrException(ErrorCode.BAD_REQUEST,message);
  }
  return oldSchema.newFieldType(fieldTypeName,className,fieldTypeJson);
}
