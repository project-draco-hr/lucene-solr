{
  codec.writeTag(NamedListCodec.SOLRDOCLST);
  List l=new ArrayList(3);
  l.add((long)ids.matches());
  l.add((long)ids.offset());
  Float maxScore=null;
  if (includeScore && ids.hasScores()) {
    maxScore=ids.maxScore();
  }
  l.add(maxScore);
  codec.writeArray(l);
  int sz=ids.size();
  codec.writeTag(NamedListCodec.ARR,sz);
  DocIterator iterator=ids.iterator();
  for (int i=0; i < sz; i++) {
    int id=iterator.nextDoc();
    Document doc=searcher.doc(id,returnFields);
    SolrDocument sdoc=getDoc(doc);
    if (includeScore && ids.hasScores()) {
      sdoc.addField("score",iterator.score());
    }
    codec.writeSolrDocument(sdoc);
  }
}
