{
  Analyzer analyzer=new MockAnalyzer();
  Directory directory=newDirectory();
  IndexWriter iwriter=new IndexWriter(directory,new IndexWriterConfig(TEST_VERSION_CURRENT,analyzer).setMaxFieldLength(25000));
  Document doc=new Document();
  String longTerm="longtermlongtermlongtermlongtermlongtermlongtermlongtermlongtermlongtermlongtermlongtermlongtermlongtermlongtermlongtermlongtermlongtermlongterm";
  String text="This is the text to be indexed. " + longTerm;
  doc.add(new Field("fieldname",text,Field.Store.YES,Field.Index.ANALYZED));
  iwriter.addDocument(doc);
  iwriter.close();
  IndexSearcher isearcher=new IndexSearcher(directory,true);
  assertEquals(1,isearcher.search(new TermQuery(new Term("fieldname",longTerm)),1).totalHits);
  QueryParser parser=new QueryParser(TEST_VERSION_CURRENT,"fieldname",analyzer);
  Query query=parser.parse("text");
  ScoreDoc[] hits=isearcher.search(query,null,1).scoreDocs;
  assertEquals(1,hits.length);
  for (int i=0; i < hits.length; i++) {
    Document hitDoc=isearcher.doc(hits[i].doc);
    assertEquals(text,hitDoc.get("fieldname"));
  }
  isearcher.close();
  directory.close();
}
