{
  if (field.hasDocValues() && !field.indexed()) {
    return DocValuesRangeQuery.newBytesRefRange(field.getName(),part1 == null ? null : new BytesRef(toInternal(part1)),part2 == null ? null : new BytesRef(toInternal(part2)),minInclusive,maxInclusive);
  }
 else {
    MultiTermQuery rangeQuery=TermRangeQuery.newStringRange(field.getName(),part1 == null ? null : toInternal(part1),part2 == null ? null : toInternal(part2),minInclusive,maxInclusive);
    rangeQuery.setRewriteMethod(getRewriteMethod(parser,field));
    return rangeQuery;
  }
}
