{
  int hasTested29=0;
  for (int i=0; i < oldNames.length; i++) {
    unzip(getDataFile("index." + oldNames[i] + ".zip"),oldNames[i]);
    String fullPath=fullDir(oldNames[i]);
    Directory dir=FSDirectory.open(new File(fullPath));
    if (oldNames[i].startsWith("29.")) {
      assertCompressedFields29(dir,true);
      hasTested29++;
    }
    IndexWriter w=new IndexWriter(dir,new IndexWriterConfig(TEST_VERSION_CURRENT,new WhitespaceAnalyzer(TEST_VERSION_CURRENT)));
    w.optimize();
    w.close();
    _TestUtil.checkIndex(dir);
    if (oldNames[i].startsWith("29.")) {
      assertCompressedFields29(dir,false);
      hasTested29++;
    }
    dir.close();
    rmDir(oldNames[i]);
  }
  assertEquals("test for compressed field should have run 4 times",4,hasTested29);
}
