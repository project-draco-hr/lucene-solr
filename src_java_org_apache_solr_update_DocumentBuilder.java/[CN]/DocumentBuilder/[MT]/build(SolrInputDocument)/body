{
  this.startDoc();
  for (  String name : doc.getFieldNames()) {
    Float boost=doc.getBoost(name);
    if (boost == null) {
      boost=new Float(1);
    }
    for (    Object v : doc.getFieldValues(name)) {
      if (v instanceof Date) {
        SchemaField sfield=schema.getField(name);
        if (sfield.getType() instanceof DateField) {
          DateField df=(DateField)sfield.getType();
          this.addField(name,df.toInternal((Date)v) + 'Z',boost);
          continue;
        }
      }
      this.addField(name,v == null ? null : v.toString(),boost);
    }
  }
  Document luceneDoc=this.getDoc();
  if (doc.getBoost(null) != null) {
    luceneDoc.setBoost(doc.getBoost(null));
  }
  return luceneDoc;
}
