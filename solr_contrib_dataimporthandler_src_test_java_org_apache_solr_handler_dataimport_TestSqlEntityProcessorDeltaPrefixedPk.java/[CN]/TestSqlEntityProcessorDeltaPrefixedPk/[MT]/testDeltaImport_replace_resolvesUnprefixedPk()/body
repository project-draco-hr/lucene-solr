{
  add1document();
  MockDataSource.clearCache();
  List deltaRows=new ArrayList();
  deltaRows.add(createMap("id","1"));
  MockDataSource.setIterator(DELTA_QUERY,deltaRows.iterator());
  MockDataSource.setIterator(DELETED_PK_QUERY,EMPTY_LIST.iterator());
  List rows=new ArrayList();
  rows.add(createMap("id","1","desc","baz"));
  MockDataSource.setIterator("select * from x where id='1'",rows.iterator());
  runDeltaImport(dataConfig_delta);
  assertQ(req("*:* OR testDeltaImport_replace_resolvesUnprefixedPk"),"//*[@numFound='1']");
  assertQ(req("id:1"),"//*[@numFound='1']");
  assertQ(req("desc:bar"),"//*[@numFound='0']");
  assertQ(req("desc:baz"),"//*[@numFound='1']");
}
