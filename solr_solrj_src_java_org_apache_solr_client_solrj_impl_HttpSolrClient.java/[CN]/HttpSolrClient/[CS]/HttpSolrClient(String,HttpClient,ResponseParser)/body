{
  this.baseUrl=baseURL;
  if (baseUrl.endsWith("/")) {
    baseUrl=baseUrl.substring(0,baseUrl.length() - 1);
  }
  if (baseUrl.indexOf('?') >= 0) {
    throw new RuntimeException("Invalid base url for solrj.  The base URL must not contain parameters: " + baseUrl);
  }
  if (client != null) {
    httpClient=client;
    internalClient=false;
  }
 else {
    internalClient=true;
    ModifiableSolrParams params=new ModifiableSolrParams();
    params.set(HttpClientUtil.PROP_MAX_CONNECTIONS,128);
    params.set(HttpClientUtil.PROP_MAX_CONNECTIONS_PER_HOST,32);
    params.set(HttpClientUtil.PROP_FOLLOW_REDIRECTS,followRedirects);
    httpClient=HttpClientUtil.createClient(params);
  }
  this.parser=parser;
}
