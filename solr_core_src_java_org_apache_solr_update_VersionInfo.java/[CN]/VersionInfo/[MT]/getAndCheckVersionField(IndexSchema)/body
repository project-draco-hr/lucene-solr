{
  final String errPrefix=VERSION_FIELD + " field must exist in schema and be searchable (indexed or docValues) and retrievable(stored or docValues) and not multiValued";
  SchemaField sf=schema.getFieldOrNull(VERSION_FIELD);
  if (null == sf) {
    throw new SolrException(SolrException.ErrorCode.SERVER_ERROR,errPrefix + " (" + VERSION_FIELD+ " does not exist)");
  }
  if (!sf.indexed() && !sf.hasDocValues()) {
    throw new SolrException(SolrException.ErrorCode.SERVER_ERROR,errPrefix + " (" + VERSION_FIELD+ " not searchable");
  }
  if (!sf.stored() && !sf.hasDocValues()) {
    throw new SolrException(SolrException.ErrorCode.SERVER_ERROR,errPrefix + " (" + VERSION_FIELD+ " not retrievable");
  }
  if (sf.multiValued()) {
    throw new SolrException(SolrException.ErrorCode.SERVER_ERROR,errPrefix + " (" + VERSION_FIELD+ " is multiValued");
  }
  return sf;
}
