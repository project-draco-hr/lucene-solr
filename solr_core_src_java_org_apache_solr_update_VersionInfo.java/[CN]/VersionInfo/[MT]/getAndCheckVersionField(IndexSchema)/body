{
  final String errPrefix=VERSION_FIELD + " field must exist in schema, using indexed=\"true\" or docValues=\"true\", stored=\"true\" and multiValued=\"false\"";
  SchemaField sf=schema.getFieldOrNull(VERSION_FIELD);
  if (null == sf) {
    throw new SolrException(SolrException.ErrorCode.SERVER_ERROR,errPrefix + " (" + VERSION_FIELD+ " does not exist)");
  }
  if (!sf.indexed() && !sf.hasDocValues()) {
    throw new SolrException(SolrException.ErrorCode.SERVER_ERROR,errPrefix + " (" + VERSION_FIELD+ " must be either indexed or have docValues");
  }
  if (!sf.stored()) {
    throw new SolrException(SolrException.ErrorCode.SERVER_ERROR,errPrefix + " (" + VERSION_FIELD+ " is not stored");
  }
  if (sf.multiValued()) {
    throw new SolrException(SolrException.ErrorCode.SERVER_ERROR,errPrefix + " (" + VERSION_FIELD+ " is multiValued");
  }
  return sf;
}
