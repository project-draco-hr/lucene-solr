{
  final double closestX;
  double ctr_x=getXAxis();
  if (ctr_x < r.getMinX())   closestX=r.getMinX();
 else   if (ctr_x > r.getMaxX())   closestX=r.getMaxX();
 else   closestX=ctr_x;
  final double closestY;
  double ctr_y=getYAxis();
  if (ctr_y < r.getMinY())   closestY=r.getMinY();
 else   if (ctr_y > r.getMaxY())   closestY=r.getMaxY();
 else   closestY=ctr_y;
  boolean didContainOnClosestXY=false;
  if (ctr_x == closestX) {
    double deltaY=Math.abs(ctr_y - closestY);
    double distYCirc=(ctr_y < closestY ? enclosingBox.getMaxY() - ctr_y : ctr_y - enclosingBox.getMinY());
    if (deltaY > distYCirc)     return SpatialRelation.DISJOINT;
  }
 else   if (ctr_y == closestY) {
    double deltaX=Math.abs(ctr_x - closestX);
    double distXCirc=(ctr_x < closestX ? enclosingBox.getMaxX() - ctr_x : ctr_x - enclosingBox.getMinX());
    if (deltaX > distXCirc)     return SpatialRelation.DISJOINT;
  }
 else {
    didContainOnClosestXY=true;
    if (!contains(closestX,closestY))     return SpatialRelation.DISJOINT;
  }
  if (bboxSect != SpatialRelation.CONTAINS)   return SpatialRelation.INTERSECTS;
  double farthestX=r.getMaxX() - ctr_x > ctr_x - r.getMinX() ? r.getMaxX() : r.getMinX();
  double farthestY=r.getMaxY() - ctr_y > ctr_y - r.getMinY() ? r.getMaxY() : r.getMinY();
  if (contains(farthestX,farthestY))   return SpatialRelation.CONTAINS;
  return SpatialRelation.INTERSECTS;
}
