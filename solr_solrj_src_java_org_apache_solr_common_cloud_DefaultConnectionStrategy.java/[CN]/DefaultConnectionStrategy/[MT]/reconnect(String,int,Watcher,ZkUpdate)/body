{
  log.info("Starting reconnect to ZooKeeper attempts ...");
  executor=Executors.newScheduledThreadPool(1);
  executor.schedule(new Runnable(){
    private int delay=1000;
    public void run(){
      log.info("Attempting the connect...");
      boolean connected=false;
      try {
        updater.update(new SolrZooKeeper(serverAddress,zkClientTimeout,watcher));
        log.info("Reconnected to ZooKeeper");
        connected=true;
      }
 catch (      Exception e) {
        log.error("",e);
        log.info("Reconnect to ZooKeeper failed");
      }
      if (connected) {
        executor.shutdownNow();
      }
 else {
        if (delay < 240000) {
          delay=delay * 2;
        }
        executor.schedule(this,delay,TimeUnit.MILLISECONDS);
      }
    }
  }
,1000,TimeUnit.MILLISECONDS);
}
