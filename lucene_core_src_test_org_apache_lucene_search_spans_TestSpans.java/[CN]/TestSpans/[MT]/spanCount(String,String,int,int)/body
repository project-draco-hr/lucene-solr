{
  SpanQuery iq=spanTermQuery(field,include);
  SpanQuery eq=spanTermQuery(field,exclude);
  SpanQuery snq=spanNotQuery(iq,eq,pre,post);
  Spans spans=snq.createWeight(searcher,false).getSpans(searcher.getIndexReader().leaves().get(0),SpanWeight.Postings.POSITIONS);
  int i=0;
  if (spans != null) {
    while (spans.nextDoc() != Spans.NO_MORE_DOCS) {
      while (spans.nextStartPosition() != Spans.NO_MORE_POSITIONS) {
        i++;
      }
    }
  }
  return i;
}
