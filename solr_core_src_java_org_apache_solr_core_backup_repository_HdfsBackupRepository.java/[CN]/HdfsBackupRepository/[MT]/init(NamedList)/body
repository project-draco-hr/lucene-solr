{
  this.config=args;
  factory=new HdfsDirectoryFactory();
  factory.init(args);
  this.hdfsConfig=factory.getConf();
  if (args.get(HDFS_UMASK_MODE_PARAM) != null) {
    String umaskVal=(String)args.get(HDFS_UMASK_MODE_PARAM);
    this.hdfsConfig.set(FsPermission.UMASK_LABEL,umaskVal);
  }
  String hdfsSolrHome=(String)Preconditions.checkNotNull(args.get(HdfsDirectoryFactory.HDFS_HOME),"Please specify " + HdfsDirectoryFactory.HDFS_HOME + " property.");
  Path path=new Path(hdfsSolrHome);
  while (path != null) {
    baseHdfsPath=path;
    path=path.getParent();
  }
  try {
    this.fileSystem=FileSystem.get(this.baseHdfsPath.toUri(),this.hdfsConfig);
  }
 catch (  IOException e) {
    throw new SolrException(ErrorCode.SERVER_ERROR,e);
  }
}
