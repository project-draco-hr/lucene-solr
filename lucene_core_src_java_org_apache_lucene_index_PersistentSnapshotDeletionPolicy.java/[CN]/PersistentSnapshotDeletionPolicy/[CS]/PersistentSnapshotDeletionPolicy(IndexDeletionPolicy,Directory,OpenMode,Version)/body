{
  super(primary);
  writer=new IndexWriter(dir,new IndexWriterConfig(matchVersion,null).setOpenMode(mode));
  if (mode != OpenMode.APPEND) {
    writer.commit();
  }
  try {
    loadPriorSnapshots(dir);
  }
 catch (  RuntimeException e) {
    writer.close();
    throw e;
  }
catch (  IOException e) {
    writer.close();
    throw e;
  }
}
