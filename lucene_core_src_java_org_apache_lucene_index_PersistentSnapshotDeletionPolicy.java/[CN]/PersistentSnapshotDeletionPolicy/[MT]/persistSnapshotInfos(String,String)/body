{
  writer.deleteAll();
  Document d=new Document();
  d.add(new StoredField(SNAPSHOTS_ID,""));
  for (  Entry<String,String> e : super.getSnapshots().entrySet()) {
    d.add(new StoredField(e.getKey(),e.getValue()));
  }
  if (id != null) {
    d.add(new StoredField(id,segment));
  }
  writer.addDocument(d);
  writer.commit();
}
