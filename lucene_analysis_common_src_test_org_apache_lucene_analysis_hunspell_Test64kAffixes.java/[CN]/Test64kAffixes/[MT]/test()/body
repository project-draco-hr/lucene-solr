{
  File tempDir=createTempDir("64kaffixes");
  File affix=new File(tempDir,"64kaffixes.aff");
  File dict=new File(tempDir,"64kaffixes.dic");
  BufferedWriter affixWriter=new BufferedWriter(new OutputStreamWriter(new FileOutputStream(affix),StandardCharsets.UTF_8));
  affixWriter.write("SET UTF-8\nFLAG num\nSFX 1 Y 65536\n");
  for (int i=0; i < 65536; i++) {
    affixWriter.write("SFX 1 0 " + Integer.toHexString(i) + " .\n");
  }
  affixWriter.write("SFX 2 Y 1\nSFX 2 0 s\n");
  affixWriter.close();
  BufferedWriter dictWriter=new BufferedWriter(new OutputStreamWriter(new FileOutputStream(dict),StandardCharsets.UTF_8));
  dictWriter.write("1\ndrink/2\n");
  dictWriter.close();
  try (InputStream affStream=new FileInputStream(affix);InputStream dictStream=new FileInputStream(dict)){
    Dictionary dictionary=new Dictionary(affStream,dictStream);
    Stemmer stemmer=new Stemmer(dictionary);
    List<CharsRef> stems=stemmer.stem("drinks");
    assertEquals(1,stems.size());
    assertEquals("drink",stems.get(0).toString());
  }
 }
