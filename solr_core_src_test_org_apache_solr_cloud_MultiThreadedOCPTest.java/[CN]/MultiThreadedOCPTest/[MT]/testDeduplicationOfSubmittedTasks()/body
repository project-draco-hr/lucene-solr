{
  SolrClient client=createNewSolrClient("",getBaseUrl((HttpSolrClient)clients.get(0)));
  Create createCollectionRequest=new Create();
  createCollectionRequest.setCollectionName("ocptest_shardsplit2");
  createCollectionRequest.setNumShards(4);
  createCollectionRequest.setConfigName("conf1");
  createCollectionRequest.setAsyncId("3000");
  createCollectionRequest.process(client);
  SplitShard splitShardRequest=new SplitShard();
  splitShardRequest.setCollectionName("ocptest_shardsplit2");
  splitShardRequest.setShardName(SHARD1);
  splitShardRequest.setAsyncId("3001");
  splitShardRequest.process(client);
  splitShardRequest=new SplitShard();
  splitShardRequest.setCollectionName("ocptest_shardsplit2");
  splitShardRequest.setShardName(SHARD2);
  splitShardRequest.setAsyncId("3002");
  splitShardRequest.process(client);
  splitShardRequest=new SplitShard();
  splitShardRequest.setCollectionName("ocptest_shardsplit2");
  splitShardRequest.setShardName(SHARD1);
  splitShardRequest.setAsyncId("3002");
  CollectionAdminResponse response=splitShardRequest.process(client);
  NamedList r=response.getResponse();
  assertEquals("Duplicate request was supposed to exist but wasn't found. De-duplication of submitted task failed.","Task with the same requestid already exists.",r.get("error"));
  for (int i=3001; i <= 3002; i++) {
    String state=getRequestStateAfterCompletion(i + "",REQUEST_STATUS_TIMEOUT,client);
    assertTrue("Task " + i + " did not complete, final state: "+ state,state.equals("completed"));
  }
}
