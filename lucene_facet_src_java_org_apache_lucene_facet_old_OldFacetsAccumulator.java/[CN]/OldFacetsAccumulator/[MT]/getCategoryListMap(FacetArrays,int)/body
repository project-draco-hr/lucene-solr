{
  HashMap<CategoryListIterator,Aggregator> categoryLists=new HashMap<CategoryListIterator,Aggregator>();
  FacetIndexingParams indexingParams=searchParams.indexingParams;
  for (  FacetRequest facetRequest : searchParams.facetRequests) {
    Aggregator categoryAggregator=createAggregator(facetRequest,facetArrays);
    CategoryListIterator cli=indexingParams.getCategoryListParams(facetRequest.categoryPath).createCategoryListIterator(partition);
    Aggregator old=categoryLists.put(cli,categoryAggregator);
    if (old != null && !old.equals(categoryAggregator)) {
      throw new RuntimeException("Overriding existing category list with different aggregator");
    }
  }
  return categoryLists;
}
