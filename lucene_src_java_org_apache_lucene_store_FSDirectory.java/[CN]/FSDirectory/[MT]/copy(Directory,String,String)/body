{
  if (to instanceof FSDirectory) {
    FSDirectory target=(FSDirectory)to;
    target.ensureCanWrite(dest);
    FileChannel input=null;
    FileChannel output=null;
    IOException priorException=null;
    try {
      input=new FileInputStream(new File(directory,src)).getChannel();
      output=new FileOutputStream(new File(target.directory,dest)).getChannel();
      output.transferFrom(input,0,input.size());
    }
 catch (    IOException ioe) {
      priorException=ioe;
    }
 finally {
      IOUtils.closeSafely(priorException,input,output);
    }
  }
 else {
    super.copy(to,src,dest);
  }
}
