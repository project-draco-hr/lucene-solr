{
  Permission p=new Permission();
  String name=(String)m.get(NAME);
  if (!m.containsKey("role"))   throw new SolrException(SolrException.ErrorCode.BAD_REQUEST,"role not specified");
  p.role=readValueAsSet(m,"role");
  if (PermissionNameProvider.Name.get(name) != null) {
    p.wellknownName=PermissionNameProvider.Name.get(name);
    HashSet<String> disAllowed=new HashSet<>(knownKeys);
    disAllowed.remove("role");
    disAllowed.remove(NAME);
    disAllowed.remove("collection");
    disAllowed.remove("index");
    for (    String s : disAllowed) {
      if (m.containsKey(s))       throw new SolrException(SolrException.ErrorCode.BAD_REQUEST,s + " is not a valid key for the permission : " + name);
    }
  }
  p.name=name;
  p.path=readSetSmart(name,m,"path");
  p.collections=readSetSmart(name,m,"collection");
  p.method=readSetSmart(name,m,"method");
  p.params=(Map<String,Object>)m.get("params");
  return p;
}
