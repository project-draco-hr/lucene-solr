{
  Set<String> result=new HashSet<>();
  Object val=m.get(key);
  if (val == null) {
    if ("collection".equals(key)) {
      return m.containsKey(key) ? singleton(null) : singleton("*");
    }
    return null;
  }
  if (val instanceof Collection) {
    Collection list=(Collection)val;
    for (    Object o : list)     result.add(String.valueOf(o));
  }
 else   if (val instanceof String) {
    result.add((String)val);
  }
 else {
    throw new RuntimeException("Bad value for : " + key);
  }
  return result.isEmpty() ? null : Collections.unmodifiableSet(result);
}
