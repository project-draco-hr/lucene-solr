{
  try {
    IndexCommit commit=getLastCommit(dir);
    if (commit != null && commit.getSegmentsFileName().equals(segmentsFile)) {
      Set<String> commitFiles=new HashSet<String>();
      commitFiles.addAll(commit.getFileNames());
      commitFiles.add(IndexFileNames.SEGMENTS_GEN);
      Matcher matcher=IndexFileNames.CODEC_FILE_PATTERN.matcher("");
      for (      String file : dir.listAll()) {
        if (!commitFiles.contains(file) && (matcher.reset(file).matches() || file.startsWith(IndexFileNames.SEGMENTS))) {
          try {
            dir.deleteFile(file);
          }
 catch (          Throwable t) {
          }
        }
      }
    }
  }
 catch (  Throwable t) {
  }
}
