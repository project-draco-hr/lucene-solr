{
  boolean legal=true;
  Set<Map> setA=new HashSet<>();
  for (  SolrDocument sdoc : a) {
    setA.add(new HashMap(sdoc));
  }
  Set<Map> setB=new HashSet<>();
  for (  SolrDocument sdoc : b) {
    setB.add(new HashMap(sdoc));
  }
  Set<Map> onlyInA=new HashSet<>(setA);
  onlyInA.removeAll(setB);
  Set<Map> onlyInB=new HashSet<>(setB);
  onlyInB.removeAll(setA);
  if (onlyInA.size() == 0 && onlyInB.size() == 0) {
    throw new IllegalArgumentException("No difference between list a and b");
  }
  System.err.println("###### Only in " + aName + ": "+ onlyInA);
  System.err.println("###### Only in " + bName + ": "+ onlyInB);
  for (  Map doc : onlyInA) {
    if (bAddFails == null || !bAddFails.contains(doc.get("id"))) {
      legal=false;
    }
 else {
      System.err.println("###### Only in " + aName + ": "+ doc.get("id")+ ", but this is expected because we found an add fail for "+ doc.get("id"));
    }
  }
  for (  Map doc : onlyInB) {
    if (bDeleteFails == null || !bDeleteFails.contains(doc.get("id"))) {
      legal=false;
    }
 else {
      System.err.println("###### Only in " + bName + ": "+ doc.get("id")+ ", but this is expected because we found a delete fail for "+ doc.get("id"));
    }
  }
  return legal;
}
