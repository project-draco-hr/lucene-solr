{
  if (lastCommit == null) {
    throw new IllegalStateException("no index commits to snapshot !");
  }
  if (snapshot == null)   snapshot=lastCommit.getSegmentsFileName();
 else   throw new IllegalStateException("snapshot is already set; please call release() first");
  return lastCommit;
}
