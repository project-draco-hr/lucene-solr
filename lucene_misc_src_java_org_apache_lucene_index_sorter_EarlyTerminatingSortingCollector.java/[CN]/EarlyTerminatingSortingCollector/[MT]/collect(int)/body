{
  in.collect(doc);
  if (++numCollected >= segmentTotalCollect) {
    throw new CollectionTerminatedException();
  }
}
