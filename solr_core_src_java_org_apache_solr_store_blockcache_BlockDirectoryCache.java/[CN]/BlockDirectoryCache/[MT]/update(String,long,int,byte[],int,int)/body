{
  Integer file=names.get(name);
  if (file == null) {
    file=counter.incrementAndGet();
    names.put(name,file);
  }
  BlockCacheKey blockCacheKey=new BlockCacheKey();
  blockCacheKey.setPath(path);
  blockCacheKey.setBlock(blockId);
  blockCacheKey.setFile(file);
  blockCache.store(blockCacheKey,blockOffset,buffer,offset,length);
  if (keys != null) {
    keys.add(blockCacheKey);
  }
}
