{
  if (multiValued) {
    boolean exists=false;
    if (setValues != null) {
      setValues.setDocument(doc);
      int term;
      while ((term=(int)setValues.nextOrd()) != SortedSetDocValues.NO_MORE_ORDS) {
        exists=true;
        final BytesRef value=setValues.lookupOrd(term);
        parent.collectField(doc,name,parser.parse(value));
      }
    }
    if (!exists) {
      parent.collectField(doc,name,FacetingAccumulator.MISSING_VALUE);
    }
  }
 else {
    if (numField) {
      if (numValues != null) {
        long v=numValues.get(doc);
        if (v != 0 || numValuesBits.get(doc)) {
          parent.collectField(doc,name,((NumericParser)parser).parseNum(v));
        }
 else {
          parent.collectField(doc,name,FacetingAccumulator.MISSING_VALUE);
        }
      }
 else {
        parent.collectField(doc,name,FacetingAccumulator.MISSING_VALUE);
      }
    }
 else {
      if (sortValues != null) {
        final int ord=sortValues.getOrd(doc);
        if (ord < 0) {
          parent.collectField(doc,name,FacetingAccumulator.MISSING_VALUE);
        }
 else {
          parent.collectField(doc,name,parser.parse(sortValues.lookupOrd(ord)));
        }
      }
 else {
        parent.collectField(doc,name,FacetingAccumulator.MISSING_VALUE);
      }
    }
  }
}
