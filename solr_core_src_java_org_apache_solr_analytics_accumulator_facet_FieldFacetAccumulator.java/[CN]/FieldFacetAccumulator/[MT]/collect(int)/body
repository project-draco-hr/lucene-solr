{
  if (multiValued) {
    boolean exists=false;
    if (setValues != null) {
      setValues.setDocument(doc);
      int term;
      while ((term=(int)setValues.nextOrd()) != SortedSetDocValues.NO_MORE_ORDS) {
        exists=true;
        setValues.lookupOrd(term,value);
        parent.collectField(doc,name,parser.parse(value));
      }
    }
    if (!exists) {
      parent.collectField(doc,name,FacetingAccumulator.MISSING_VALUE);
    }
  }
 else {
    if (numField) {
      long v=numValues.get(doc);
      if (v != 0 || numValuesBits.get(doc)) {
        parent.collectField(doc,name,((NumericParser)parser).parseNum(numValues.get(doc)));
      }
 else {
        parent.collectField(doc,name,FacetingAccumulator.MISSING_VALUE);
      }
    }
 else {
      sortValues.get(doc,value);
      if (BytesRef.EMPTY_BYTES == value.bytes) {
        parent.collectField(doc,name,FacetingAccumulator.MISSING_VALUE);
      }
 else {
        parent.collectField(doc,name,parser.parse(value));
      }
    }
  }
}
