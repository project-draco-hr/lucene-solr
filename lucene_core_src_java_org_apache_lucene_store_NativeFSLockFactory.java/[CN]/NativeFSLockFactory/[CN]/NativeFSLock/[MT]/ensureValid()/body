{
  if (closed) {
    throw new AlreadyClosedException("Lock instance already released: " + this);
  }
  if (!LOCK_HELD.contains(path.toString())) {
    throw new AlreadyClosedException("Lock path unexpectedly cleared from map: " + this);
  }
  if (!lock.isValid()) {
    throw new AlreadyClosedException("FileLock invalidated by an external force: " + this);
  }
  long size=channel.size();
  if (size != 0) {
    throw new AlreadyClosedException("Unexpected lock file size: " + size + ", (lock="+ this+ ")");
  }
  FileTime ctime=Files.readAttributes(path,BasicFileAttributes.class).creationTime();
  if (!creationTime.equals(ctime)) {
    throw new AlreadyClosedException("Underlying file changed by an external force at " + creationTime + ", (lock="+ this+ ")");
  }
}
