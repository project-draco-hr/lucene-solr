{
  LockFactory lockFactory;
  try {
    lockFactory=Class.forName(lockFactoryClassName).asSubclass(LockFactory.class).newInstance();
  }
 catch (  IllegalAccessException|InstantiationException|ClassCastException|ClassNotFoundException e) {
    throw new IOException("Cannot instantiate lock factory " + lockFactoryClassName);
  }
  Path lockDir=Paths.get(lockDirName);
  if (lockFactory instanceof FSLockFactory) {
    ((FSLockFactory)lockFactory).setLockDir(lockDir);
  }
  lockFactory.setLockPrefix("test");
  return lockFactory;
}
