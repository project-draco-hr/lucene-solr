{
  assertNextEvent(JSONParser.OBJECT_START);
  DeleteUpdateCommand cmd=new DeleteUpdateCommand(req);
  cmd.commitWithin=commitWithin;
  while (true) {
    int ev=parser.nextEvent();
    if (ev == JSONParser.STRING) {
      String key=parser.getString();
      if (parser.wasKey()) {
        if ("id".equals(key)) {
          cmd.setId(parser.getString());
        }
 else         if ("query".equals(key)) {
          cmd.setQuery(parser.getString());
        }
 else         if ("commitWithin".equals(key)) {
          cmd.commitWithin=Integer.parseInt(parser.getString());
        }
 else {
          throw new SolrException(SolrException.ErrorCode.BAD_REQUEST,"Unknown key: " + key + " ["+ parser.getPosition()+ "]");
        }
      }
 else {
        throw new SolrException(SolrException.ErrorCode.BAD_REQUEST,"invalid string: " + key + " at ["+ parser.getPosition()+ "]");
      }
    }
 else     if (ev == JSONParser.OBJECT_END) {
      if (cmd.getId() == null && cmd.getQuery() == null) {
        throw new SolrException(SolrException.ErrorCode.BAD_REQUEST,"Missing id or query for delete [" + parser.getPosition() + "]");
      }
      return cmd;
    }
 else {
      throw new SolrException(SolrException.ErrorCode.BAD_REQUEST,"Got: " + JSONParser.getEventString(ev) + " at ["+ parser.getPosition()+ "]");
    }
  }
}
