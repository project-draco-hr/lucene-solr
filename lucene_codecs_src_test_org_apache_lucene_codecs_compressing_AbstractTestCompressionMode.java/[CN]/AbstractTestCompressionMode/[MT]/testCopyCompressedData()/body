{
  final byte[] uncompressed=randomArray();
  final byte[] compressed=compress(uncompressed);
  GrowableByteArrayDataOutput out=new GrowableByteArrayDataOutput(uncompressed.length);
  mode.newUncompressor().copyCompressedData(new ByteArrayDataInput(compressed),out);
  assertArrayEquals(compressed,Arrays.copyOf(out.bytes,out.length));
}
