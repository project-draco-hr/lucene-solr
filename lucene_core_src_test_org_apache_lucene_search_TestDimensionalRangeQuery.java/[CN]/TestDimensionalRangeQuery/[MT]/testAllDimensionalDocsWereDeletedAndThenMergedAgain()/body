{
  Directory dir=getDirectory();
  IndexWriterConfig iwc=newIndexWriterConfig();
  iwc.setCodec(getCodec());
  IndexWriter w=new IndexWriter(dir,iwc);
  Document doc=new Document();
  doc.add(new StringField("id","0",Field.Store.NO));
  doc.add(new DimensionalLongField("value",0L));
  w.addDocument(doc);
  w.addDocument(new Document());
  w.commit();
  doc=new Document();
  doc.add(new StringField("id","0",Field.Store.NO));
  doc.add(new DimensionalLongField("value",0L));
  w.addDocument(doc);
  w.addDocument(new Document());
  w.deleteDocuments(new Term("id","0"));
  w.forceMerge(1);
  doc=new Document();
  doc.add(new StringField("id","0",Field.Store.NO));
  doc.add(new DimensionalLongField("value",0L));
  w.addDocument(doc);
  w.addDocument(new Document());
  w.deleteDocuments(new Term("id","0"));
  w.forceMerge(1);
  IOUtils.close(w,dir);
}
