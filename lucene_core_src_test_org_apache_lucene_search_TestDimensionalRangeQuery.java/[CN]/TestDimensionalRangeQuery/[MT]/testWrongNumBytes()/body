{
  Directory dir=getDirectory();
  IndexWriterConfig iwc=newIndexWriterConfig();
  iwc.setCodec(getCodec());
  RandomIndexWriter w=new RandomIndexWriter(random(),dir,iwc);
  Document doc=new Document();
  doc.add(new DimensionalLongField("value",Long.MIN_VALUE));
  w.addDocument(doc);
  IndexReader r=w.getReader();
  IndexSearcher s=new IndexSearcher(r);
  byte[][] point=new byte[1][];
  point[0]=new byte[10];
  try {
    s.count(new DimensionalRangeQuery("value",point,new boolean[]{true},point,new boolean[]{true}));
  }
 catch (  IllegalArgumentException iae) {
    assertEquals("field=\"value\" was indexed with bytesPerDim=8 but this query has bytesPerDim=10",iae.getMessage());
  }
  IOUtils.close(r,w,dir);
}
