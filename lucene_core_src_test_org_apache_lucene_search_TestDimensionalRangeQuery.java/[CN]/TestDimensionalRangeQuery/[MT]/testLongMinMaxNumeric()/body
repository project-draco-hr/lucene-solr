{
  Directory dir=getDirectory();
  IndexWriterConfig iwc=newIndexWriterConfig();
  iwc.setCodec(getCodec());
  RandomIndexWriter w=new RandomIndexWriter(random(),dir,iwc);
  Document doc=new Document();
  doc.add(new DimensionalField("value",Long.MIN_VALUE));
  w.addDocument(doc);
  doc=new Document();
  doc.add(new DimensionalField("value",Long.MAX_VALUE));
  w.addDocument(doc);
  IndexReader r=w.getReader();
  IndexSearcher s=newSearcher(r);
  assertEquals(2,s.count(new DimensionalRangeQuery("value",Long.MIN_VALUE,true,Long.MAX_VALUE,true)));
  assertEquals(1,s.count(new DimensionalRangeQuery("value",Long.MIN_VALUE,true,Long.MAX_VALUE,false)));
  assertEquals(1,s.count(new DimensionalRangeQuery("value",Long.MIN_VALUE,false,Long.MAX_VALUE,true)));
  assertEquals(0,s.count(new DimensionalRangeQuery("value",Long.MIN_VALUE,false,Long.MAX_VALUE,false)));
  assertEquals(2,s.count(new DimensionalRangeQuery("value",(byte[])null,true,null,true)));
  IOUtils.close(r,w,dir);
}
