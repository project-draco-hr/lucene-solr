{
  final String version=input.readString();
  final int docCount=input.readInt();
  final Map<String,String> attributes=input.readStringStringMap();
  final int numNormGen=input.readInt();
  final Map<Integer,Long> normGen;
  if (numNormGen == SegmentInfo.NO) {
    normGen=null;
  }
 else {
    normGen=new HashMap<Integer,Long>();
    for (int j=0; j < numNormGen; j++) {
      normGen.put(j,input.readLong());
    }
  }
  final boolean isCompoundFile=input.readByte() == SegmentInfo.YES;
  final Map<String,String> diagnostics=input.readStringStringMap();
  final Set<String> files=input.readStringSet();
  SegmentInfo info=new SegmentInfo(dir,version,name,docCount,normGen,isCompoundFile,null,diagnostics,Collections.unmodifiableMap(attributes));
  info.setFiles(files);
  return info;
}
