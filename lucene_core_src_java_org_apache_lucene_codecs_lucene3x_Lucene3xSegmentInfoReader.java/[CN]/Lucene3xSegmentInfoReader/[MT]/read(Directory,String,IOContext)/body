{
  String fileName=IndexFileNames.segmentFileName(segmentName,"",Lucene3xSegmentInfoFormat.SI_EXTENSION);
  boolean success=false;
  IndexInput input=directory.openInput(fileName,context);
  try {
    SegmentInfo si=readUpgradedSegmentInfo(segmentName,directory,input);
    success=true;
    return si;
  }
  finally {
    if (!success) {
      IOUtils.closeWhileHandlingException(input);
    }
 else {
      input.close();
    }
  }
}
