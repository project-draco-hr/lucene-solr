{
  List fields=new ArrayList();
  fields.add(AbstractDataImportHandlerTest.createMap("column","id"));
  fields.add(AbstractDataImportHandlerTest.createMap("column","desc"));
  String q="select * from x";
  Map<String,String> entityAttrs=AbstractDataImportHandlerTest.createMap("query",q,"where","id=x.id");
  MockDataSource ds=new MockDataSource();
  VariableResolverImpl vr=new VariableResolverImpl();
  Map xNamespace=AbstractDataImportHandlerTest.createMap("id",0);
  vr.addNamespace("x",xNamespace);
  Context context=AbstractDataImportHandlerTest.getContext(null,vr,ds,0,fields,entityAttrs);
  doWhereTest(q,context,ds,xNamespace);
}
