{
  final int mul=asc ? 1 : -1;
  if (field.equals("_docid_")) {
    return new Comparator<Doc>(){
      @Override public int compare(      Doc o1,      Doc o2){
        return (o1.order - o2.order) * mul;
      }
    }
;
  }
  if (field.equals("score")) {
    return createComparator("score_f",asc,sortMissingLast,sortMissingFirst);
  }
  return new Comparator<Doc>(){
    @Override public int compare(    Doc o1,    Doc o2){
      Comparable v1=o1.getFirstValue(field);
      Comparable v2=o2.getFirstValue(field);
      int c=0;
      if (v1 == v2) {
        c=0;
      }
 else       if (v1 == null) {
        if (sortMissingLast)         c=mul;
 else         if (sortMissingFirst)         c=-mul;
 else         c=-1;
      }
 else       if (v2 == null) {
        if (sortMissingLast)         c=-mul;
 else         if (sortMissingFirst)         c=mul;
 else         c=1;
      }
 else {
        c=v1.compareTo(v2);
      }
      c=c * mul;
      return c;
    }
  }
;
}
