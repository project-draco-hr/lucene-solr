{
  Evaluator dateFormatEval=EvaluatorBag.getDateFormatEvaluator();
  ContextImpl context=new ContextImpl(null,resolver,null,Context.FULL_DUMP,Collections.EMPTY_MAP,null,null);
  Calendar calendar=new GregorianCalendar();
  calendar.add(Calendar.DAY_OF_YEAR,-2);
  assertEquals(new SimpleDateFormat("yyyy-MM-dd HH:mm").format(calendar.getTime()),dateFormatEval.evaluate("'NOW-2DAYS','yyyy-MM-dd HH:mm'",context));
  calendar=new GregorianCalendar();
  Date date=calendar.getTime();
  Map<String,Object> map=new HashMap<String,Object>();
  map.put("key",date);
  resolver.addNamespace("A",map);
  assertEquals(new SimpleDateFormat("yyyy-MM-dd HH:mm").format(date),dateFormatEval.evaluate("A.key, 'yyyy-MM-dd HH:mm'",context));
}
