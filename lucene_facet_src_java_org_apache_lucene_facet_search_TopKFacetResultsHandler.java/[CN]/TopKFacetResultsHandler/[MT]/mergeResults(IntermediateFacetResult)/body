{
  int ordinal=taxonomyReader.getOrdinal(facetRequest.getCategoryPath());
  MutableFacetResultNode resNode=new MutableFacetResultNode(ordinal,0);
  int totalFacets=0;
  Heap<FacetResultNode> heap=null;
  for (  IntermediateFacetResult tmpFres : tmpResults) {
    TopKFacetResult fres=(TopKFacetResult)tmpFres;
    totalFacets+=fres.getNumValidDescendants();
    resNode.increaseValue(fres.getFacetResultNode().getValue());
    Heap<FacetResultNode> tmpHeap=fres.getHeap();
    if (heap == null) {
      heap=tmpHeap;
      continue;
    }
    for (int i=tmpHeap.size(); i > 0; i--) {
      FacetResultNode a=heap.insertWithOverflow(tmpHeap.pop());
      if (a != null) {
        resNode.increaseResidue(a.getResidue());
      }
    }
  }
  TopKFacetResult res=new TopKFacetResult(facetRequest,resNode,totalFacets);
  res.setHeap(heap);
  return res;
}
