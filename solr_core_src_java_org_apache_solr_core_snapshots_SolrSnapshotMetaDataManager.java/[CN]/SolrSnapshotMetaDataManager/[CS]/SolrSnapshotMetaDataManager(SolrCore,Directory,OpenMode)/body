{
  this.solrCore=solrCore;
  this.dir=dir;
  if (mode == OpenMode.CREATE) {
    deleteSnapshotMetadataFiles();
  }
  loadFromSnapshotMetadataFile();
  if (mode == OpenMode.APPEND && nextWriteGen == 0) {
    throw new IllegalStateException("no snapshots stored in this directory");
  }
}
