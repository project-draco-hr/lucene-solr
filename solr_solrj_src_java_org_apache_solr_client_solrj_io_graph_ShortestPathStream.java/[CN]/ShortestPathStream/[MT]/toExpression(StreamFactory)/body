{
  StreamExpression expression=new StreamExpression(factory.getFunctionName(this.getClass()));
  expression.addParameter(collection);
  Set<Map.Entry> entries=queryParams.entrySet();
  for (  Map.Entry param : entries) {
    String value=param.getValue().toString();
    value=value.replace("\"","\\\"");
    expression.addParameter(new StreamExpressionNamedParameter(param.getKey().toString(),value));
  }
  expression.addParameter(new StreamExpressionNamedParameter("zkHost",zkHost));
  expression.addParameter(new StreamExpressionNamedParameter("maxDepth",Integer.toString(maxDepth)));
  expression.addParameter(new StreamExpressionNamedParameter("threads",Integer.toString(threads)));
  expression.addParameter(new StreamExpressionNamedParameter("partitionSize",Integer.toString(joinBatchSize)));
  expression.addParameter(new StreamExpressionNamedParameter("from",fromNode));
  expression.addParameter(new StreamExpressionNamedParameter("to",toNode));
  expression.addParameter(new StreamExpressionNamedParameter("edge",fromField + "=" + toField));
  return expression;
}
