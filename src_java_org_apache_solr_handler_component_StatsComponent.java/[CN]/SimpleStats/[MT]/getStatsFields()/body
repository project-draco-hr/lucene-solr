{
  NamedList<NamedList<Number>> res=new SimpleOrderedMap<NamedList<Number>>();
  String[] statsFs=params.getParams(StatsParams.STATS_FIELD);
  if (null != statsFs) {
    for (    String f : statsFs) {
      String[] facets=params.getFieldParams(f,StatsParams.STATS_FACET);
      if (facets == null) {
        facets=new String[0];
      }
      SchemaField sf=searcher.getSchema().getField(f);
      FieldType ft=sf.getType();
      if (ft.isTokenized() || sf.multiValued()) {
        UnInvertedField uif=UnInvertedField.getUnInvertedField(f,searcher);
        StatsValues allstats=uif.getStats(searcher,docs,facets);
        if (allstats != null) {
          res.add(f,(NamedList)allstats.getStatsValues());
        }
 else {
          res.add(f,null);
        }
      }
 else {
        res.add(f,getFieldCacheStats(f,facets));
      }
    }
  }
  return res;
}
