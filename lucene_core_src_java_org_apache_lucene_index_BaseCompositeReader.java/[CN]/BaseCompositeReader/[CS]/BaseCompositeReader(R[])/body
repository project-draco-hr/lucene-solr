{
  this.subReaders=subReaders;
  this.subReadersList=Collections.unmodifiableList(Arrays.asList(subReaders));
  starts=new int[subReaders.length + 1];
  long maxDoc=0, numDocs=0;
  for (int i=0; i < subReaders.length; i++) {
    starts[i]=(int)maxDoc;
    final IndexReader r=subReaders[i];
    maxDoc+=r.maxDoc();
    numDocs+=r.numDocs();
    r.registerParentReader(this);
  }
  if (maxDoc > IndexWriter.getActualMaxDocs()) {
    if (this instanceof DirectoryReader) {
      throw new CorruptIndexException("Too many documents: an index cannot exceed " + IndexWriter.getActualMaxDocs() + " but readers have total maxDoc="+ maxDoc,Arrays.toString(subReaders));
    }
 else {
      throw new IllegalArgumentException("Too many documents: composite IndexReaders cannot exceed " + IndexWriter.getActualMaxDocs() + " but readers have total maxDoc="+ maxDoc);
    }
  }
  this.maxDoc=Math.toIntExact(maxDoc);
  starts[subReaders.length]=this.maxDoc;
  this.numDocs=Math.toIntExact(numDocs);
}
