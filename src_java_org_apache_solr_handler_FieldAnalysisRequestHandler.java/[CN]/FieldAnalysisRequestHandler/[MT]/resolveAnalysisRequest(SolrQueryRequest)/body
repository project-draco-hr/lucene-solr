{
  SolrParams solrParams=req.getParams();
  FieldAnalysisRequest analysisRequest=new FieldAnalysisRequest();
  boolean useDefaultSearchField=true;
  if (solrParams.get(AnalysisParams.FIELD_TYPE) != null) {
    analysisRequest.setFieldTypes(Arrays.asList(solrParams.get(AnalysisParams.FIELD_TYPE).split(",")));
    useDefaultSearchField=false;
  }
  if (solrParams.get(AnalysisParams.FIELD_NAME) != null) {
    analysisRequest.setFieldNames(Arrays.asList(solrParams.get(AnalysisParams.FIELD_NAME).split(",")));
    useDefaultSearchField=false;
  }
  if (useDefaultSearchField) {
    analysisRequest.addFieldName(req.getSchema().getSolrQueryParser(null).getField());
  }
  analysisRequest.setQuery(solrParams.get(AnalysisParams.QUERY,solrParams.get(CommonParams.Q)));
  analysisRequest.setFieldValue(solrParams.get(AnalysisParams.FIELD_VALUE));
  analysisRequest.setShowMatch(solrParams.getBool(AnalysisParams.SHOW_MATCH,false));
  return analysisRequest;
}
