{
  String masterUrl=solrParams == null ? null : solrParams.get(MASTER_URL);
  if (!snapPullLock.tryLock())   return false;
  try {
    if (masterUrl != null) {
      if (tempSnapPuller != null && tempSnapPuller != snapPuller) {
        tempSnapPuller.destroy();
      }
      NamedList<Object> nl=solrParams.toNamedList();
      nl.remove(SnapPuller.POLL_INTERVAL);
      tempSnapPuller=new SnapPuller(nl,this,core);
    }
 else {
      tempSnapPuller=snapPuller;
    }
    return tempSnapPuller.fetchLatestIndex(core,forceReplication);
  }
 catch (  Exception e) {
    SolrException.log(LOG,"SnapPull failed ",e);
  }
 finally {
    if (snapPuller != null) {
      tempSnapPuller=snapPuller;
    }
    snapPullLock.unlock();
  }
  return false;
}
