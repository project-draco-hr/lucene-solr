{
  Directory dir=null;
  try {
    try {
      dir=core.getDirectoryFactory().get(core.getDataDir(),DirContext.META_DATA,core.getSolrConfig().indexConfig.lockType);
      if (!dir.fileExists(SnapPuller.REPLICATION_PROPERTIES)) {
        return new Properties();
      }
      final IndexInput input=dir.openInput(SnapPuller.REPLICATION_PROPERTIES,IOContext.DEFAULT);
      try {
        final InputStream is=new PropertiesInputStream(input);
        Properties props=new Properties();
        props.load(new InputStreamReader(is,CHARSET_UTF_8));
        return props;
      }
  finally {
        input.close();
      }
    }
  finally {
      if (dir != null) {
        core.getDirectoryFactory().release(dir);
      }
    }
  }
 catch (  IOException e) {
    throw new SolrException(ErrorCode.SERVER_ERROR,e);
  }
}
