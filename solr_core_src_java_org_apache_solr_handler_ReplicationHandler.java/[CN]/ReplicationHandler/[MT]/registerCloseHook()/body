{
  core.addCloseHook(new CloseHook(){
    @Override public void preClose(    SolrCore core){
      if (snapPuller != null) {
        snapPuller.destroy();
      }
      if (tempSnapPuller != null && tempSnapPuller != snapPuller) {
        tempSnapPuller.destroy();
      }
    }
    @Override public void postClose(    SolrCore core){
    }
  }
);
}
