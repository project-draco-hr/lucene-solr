{
  core.addCloseHook(new CloseHook(){
    @Override public void preClose(    SolrCore core){
      try {
        if (executorService != null)         executorService.shutdown();
      }
  finally {
        try {
          if (pollingIndexFetcher != null) {
            pollingIndexFetcher.destroy();
          }
        }
  finally {
          if (executorService != null)           ExecutorUtil.shutdownNowAndAwaitTermination(executorService);
        }
      }
      if (currentIndexFetcher != null && currentIndexFetcher != pollingIndexFetcher) {
        currentIndexFetcher.destroy();
      }
    }
    @Override public void postClose(    SolrCore core){
    }
  }
);
}
