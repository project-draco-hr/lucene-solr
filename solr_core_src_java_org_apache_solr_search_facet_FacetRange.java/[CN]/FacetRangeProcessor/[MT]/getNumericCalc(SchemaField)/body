{
  Calc calc;
  final FieldType ft=sf.getType();
  if (ft instanceof TrieField) {
    final TrieField trie=(TrieField)ft;
switch (trie.getType()) {
case FLOAT:
      calc=new FloatCalc(sf);
    break;
case DOUBLE:
  calc=new DoubleCalc(sf);
break;
case INTEGER:
calc=new IntCalc(sf);
break;
case LONG:
calc=new LongCalc(sf);
break;
case DATE:
calc=new DateCalc(sf,null);
break;
default :
throw new SolrException(SolrException.ErrorCode.BAD_REQUEST,"Expected numeric field type :" + sf);
}
}
 else {
throw new SolrException(SolrException.ErrorCode.BAD_REQUEST,"Expected numeric field type :" + sf);
}
return calc;
}
