{
  this.config=config;
  try {
    String sourceClass=config.get("content.source","org.apache.lucene.benchmark.byTask.feeds.SingleDocSource");
    source=(ContentSource)Class.forName(sourceClass).newInstance();
    source.setConfig(config);
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
  boolean stored=config.get("doc.stored",false);
  boolean tokenized=config.get("doc.tokenized",true);
  boolean termVec=config.get("doc.term.vector",false);
  storeVal=(stored ? Field.Store.YES : Field.Store.NO);
  indexVal=(tokenized ? Field.Index.ANALYZED : Field.Index.NOT_ANALYZED);
  boolean termVecPositions=config.get("doc.term.vector.positions",false);
  boolean termVecOffsets=config.get("doc.term.vector.offsets",false);
  if (termVecPositions && termVecOffsets) {
    termVecVal=TermVector.WITH_POSITIONS_OFFSETS;
  }
 else   if (termVecPositions) {
    termVecVal=TermVector.WITH_POSITIONS;
  }
 else   if (termVecOffsets) {
    termVecVal=TermVector.WITH_OFFSETS;
  }
 else   if (termVec) {
    termVecVal=TermVector.YES;
  }
 else {
    termVecVal=TermVector.NO;
  }
  storeBytes=config.get("doc.store.body.bytes",false);
  reuseFields=config.get("doc.reuse.fields",true);
  if (!reuseFields) {
    localDocState=new DocState(false,storeVal,indexVal,termVecVal);
  }
 else {
    docState=new ThreadLocal();
  }
}
