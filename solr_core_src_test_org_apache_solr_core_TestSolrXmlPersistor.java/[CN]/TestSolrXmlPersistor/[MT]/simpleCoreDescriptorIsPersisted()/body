{
  final String solrxml="<solr><cores></cores></solr>";
  final File solrHomeDirectory=new File(TEMP_DIR,"ZkControllerTest");
  try {
    if (solrHomeDirectory.exists()) {
      FileUtils.deleteDirectory(solrHomeDirectory);
    }
    copyMinFullSetup(solrHomeDirectory);
    CoreContainer cc=new CoreContainer(solrHomeDirectory.getAbsolutePath());
    final CoreDescriptor cd=new CoreDescriptor(cc,"testcore","instance/dir/");
    List<CoreDescriptor> cds=ImmutableList.of(cd);
    SolrXMLCoresLocator persistor=new SolrXMLCoresLocator(solrxml,null);
    assertEquals(persistor.buildSolrXML(cds),"<solr><cores>" + SolrXMLCoresLocator.NEWLINE + "    <core name=\"testcore\" instanceDir=\"instance/dir/\"/>"+ SolrXMLCoresLocator.NEWLINE+ "</cores></solr>");
  }
  finally {
    if (solrHomeDirectory.exists()) {
      FileUtils.deleteDirectory(solrHomeDirectory);
    }
  }
}
