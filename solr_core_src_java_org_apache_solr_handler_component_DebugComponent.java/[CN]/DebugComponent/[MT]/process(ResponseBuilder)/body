{
  if (rb.isDebug()) {
    DocList results=null;
    if (rb.getResults() != null) {
      results=rb.getResults().docList;
    }
    NamedList stdinfo=SolrPluginUtils.doStandardDebug(rb.req,rb.getQueryString(),rb.wrap(rb.getQuery()),results,rb.isDebugQuery(),rb.isDebugResults());
    NamedList info=rb.getDebugInfo();
    if (info == null) {
      rb.setDebugInfo(stdinfo);
      info=stdinfo;
    }
 else {
      info.addAll(stdinfo);
    }
    if (rb.req.getJSON() != null) {
      info.add(JSON,rb.req.getJSON());
    }
    if (rb.isDebugQuery() && rb.getQparser() != null) {
      rb.getQparser().addDebugInfo(rb.getDebugInfo());
    }
    if (null != rb.getDebugInfo()) {
      if (rb.isDebugQuery() && null != rb.getFilters()) {
        info.add("filter_queries",rb.req.getParams().getParams(FQ));
        List<String> fqs=new ArrayList<>(rb.getFilters().size());
        for (        Query fq : rb.getFilters()) {
          fqs.add(QueryParsing.toString(fq,rb.req.getSchema()));
        }
        info.add("parsed_filter_queries",fqs);
      }
      rb.rsp.add("debug",rb.getDebugInfo());
    }
  }
}
