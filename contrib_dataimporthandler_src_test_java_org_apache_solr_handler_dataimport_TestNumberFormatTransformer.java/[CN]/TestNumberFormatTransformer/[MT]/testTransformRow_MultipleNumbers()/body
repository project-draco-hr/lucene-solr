{
  List fields=new ArrayList();
  fields.add(AbstractDataImportHandlerTest.createMap(DataImporter.COLUMN,"inputs"));
  fields.add(AbstractDataImportHandlerTest.createMap(DataImporter.COLUMN,"outputs",RegexTransformer.SRC_COL_NAME,"inputs",NumberFormatTransformer.FORMAT_STYLE,NumberFormatTransformer.NUMBER));
  List inputs=new ArrayList();
  inputs.add("123,567");
  inputs.add("245,678");
  Map row=AbstractDataImportHandlerTest.createMap("inputs",inputs);
  VariableResolverImpl resolver=new VariableResolverImpl();
  resolver.addNamespace("e",row);
  Context context=AbstractDataImportHandlerTest.getContext(null,resolver,null,0,fields,null);
  new NumberFormatTransformer().transformRow(row,context);
  List output=new ArrayList();
  output.add(new Long(123567));
  output.add(new Long(245678));
  Map outputRow=AbstractDataImportHandlerTest.createMap("inputs",inputs,"outputs",output);
  Assert.assertEquals(outputRow,row);
}
