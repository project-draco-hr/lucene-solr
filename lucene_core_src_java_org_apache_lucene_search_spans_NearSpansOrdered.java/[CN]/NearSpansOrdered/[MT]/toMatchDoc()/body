{
  subSpansToFirstStartPosition();
  while (true) {
    if (!stretchToOrder()) {
      if (conjunction.nextDoc() == NO_MORE_DOCS) {
        return NO_MORE_DOCS;
      }
      subSpansToFirstStartPosition();
    }
 else {
      if (shrinkToAfterShortestMatch()) {
        atFirstInCurrentDoc=true;
        return conjunction.docID();
      }
      if (oneExhaustedInCurrentDoc) {
        if (conjunction.nextDoc() == NO_MORE_DOCS) {
          return NO_MORE_DOCS;
        }
        subSpansToFirstStartPosition();
      }
    }
  }
}
