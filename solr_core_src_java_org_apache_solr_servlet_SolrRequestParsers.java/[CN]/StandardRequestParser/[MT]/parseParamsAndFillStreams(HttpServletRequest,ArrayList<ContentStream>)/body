{
  String method=req.getMethod().toUpperCase(Locale.ROOT);
  if ("GET".equals(method) || "HEAD".equals(method)) {
    return SolrRequestParsers.parseQueryString(req.getQueryString());
  }
  if ("POST".equals(method)) {
    if (formdata.isFormData(req)) {
      return formdata.parseParamsAndFillStreams(req,streams);
    }
    if (ServletFileUpload.isMultipartContent(req)) {
      return multipart.parseParamsAndFillStreams(req,streams);
    }
    return raw.parseParamsAndFillStreams(req,streams);
  }
  throw new SolrException(SolrException.ErrorCode.BAD_REQUEST,"Unsupported method: " + method);
}
