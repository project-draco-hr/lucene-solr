{
  SolrQueryResponse solrResp=new SolrQueryResponse();
  final NamedList<Object> responseHeader=new SimpleOrderedMap<Object>();
  solrResp.add("responseHeader",responseHeader);
  NamedList toLog=solrResp.getToLog();
  toLog.add("webapp",req.getContextPath());
  toLog.add("path",solrReq.getContext().get("path"));
  toLog.add("params","{" + solrReq.getParamString() + "}");
  handler.handleRequest(solrReq,solrResp);
  SolrCore.setResponseHeaderValues(handler,solrReq,solrResp);
  StringBuilder sb=new StringBuilder();
  for (int i=0; i < toLog.size(); i++) {
    String name=toLog.getName(i);
    Object val=toLog.getVal(i);
    sb.append(name).append("=").append(val).append(" ");
  }
  QueryResponseWriter respWriter=SolrCore.DEFAULT_RESPONSE_WRITERS.get(solrReq.getParams().get(CommonParams.WT));
  if (respWriter == null)   respWriter=SolrCore.DEFAULT_RESPONSE_WRITERS.get("standard");
  writeResponse(solrResp,response,respWriter,solrReq,Method.getMethod(req.getMethod()));
}
