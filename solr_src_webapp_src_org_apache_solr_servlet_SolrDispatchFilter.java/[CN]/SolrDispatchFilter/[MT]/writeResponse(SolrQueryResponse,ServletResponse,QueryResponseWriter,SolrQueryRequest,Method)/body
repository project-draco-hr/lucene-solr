{
  if (solrRsp.getException() != null) {
    sendError((HttpServletResponse)response,solrRsp.getException());
  }
 else {
    final String ct=responseWriter.getContentType(solrReq,solrRsp);
    if (null != ct)     response.setContentType(ct);
    if (Method.HEAD != reqMethod) {
      if (responseWriter instanceof BinaryQueryResponseWriter) {
        BinaryQueryResponseWriter binWriter=(BinaryQueryResponseWriter)responseWriter;
        binWriter.write(response.getOutputStream(),solrReq,solrRsp);
      }
 else {
        PrintWriter out=response.getWriter();
        responseWriter.write(out,solrReq,solrRsp);
      }
    }
  }
}
