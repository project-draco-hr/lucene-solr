{
  checkDestroyed();
  if (schema.getName() == null)   throw new IllegalStateException("schema has no name -- is not associated with any service");
  if (this.indexerMap.containsKey(schema.getName()))   throw new IllegalStateException("schema for service " + schema.getName() + " is already registered");
  if (LOG.isInfoEnabled())   LOG.info("add new IndexSchema for service " + schema.getName() + " -- "+ schema);
  try {
    ServiceIndex bean=createIndexer(schema);
    ReferenceCounter<IndexSearcher> searcher=getNewServiceSearcher(bean.getDirectory());
    bean.setSearcher(searcher);
    this.indexerMap.put(schema.getName(),bean);
  }
 catch (  IOException e) {
    LOG.error("Can not create indexer for service " + schema.getName(),e);
    throw new GdataIndexerException("Can not create indexer for service " + schema.getName(),e);
  }
}
