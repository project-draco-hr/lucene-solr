{
  out.writeVInt(field.number);
  long totBytes=0;
  for (  BytesRef v : values) {
    totBytes+=v.length;
  }
  if (totBytes > Integer.MAX_VALUE) {
    throw new IllegalStateException("too many facets in one segment: Facet42DocValues cannot handle more than 2 GB facet data per segment");
  }
  out.writeVInt((int)totBytes);
  for (  BytesRef v : values) {
    out.writeBytes(v.bytes,v.offset,v.length);
  }
  PackedInts.Writer w=PackedInts.getWriter(out,maxDoc + 1,PackedInts.bitsRequired(totBytes + 1),acceptableOverheadRatio);
  int address=0;
  for (  BytesRef v : values) {
    w.add(address);
    address+=v.length;
  }
  w.add(address);
  w.finish();
}
