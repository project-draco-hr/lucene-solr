{
  super.setUp();
  if (h != null) {
    log.warn("HACK: closing previous test harness");
    h.close();
    h=null;
  }
  zkDir=dataDir.getAbsolutePath() + File.separator + "zookeeper/server1/data";
  zkServer=new ZkTestServer(zkDir);
  zkServer.run();
  System.setProperty("zkHost",zkServer.getZkAddress());
  buildZooKeeper(zkServer.getZkHost(),zkServer.getZkAddress(),getSolrConfigFile(),getSchemaFile());
  log.info("####SETUP_START " + getName());
  dataDir.mkdirs();
  System.setProperty("solr.test.sys.prop1","propone");
  System.setProperty("solr.test.sys.prop2","proptwo");
  CoreContainer.Initializer init=new CoreContainer.Initializer(){
{
      this.dataDir=AbstractZkTestCase.dataDir.getAbsolutePath();
    }
  }
;
  h=new TestHarness("",init);
  lrf=h.getRequestFactory("standard",0,20,"version","2.2");
  log.info("####SETUP_END " + getName());
}
