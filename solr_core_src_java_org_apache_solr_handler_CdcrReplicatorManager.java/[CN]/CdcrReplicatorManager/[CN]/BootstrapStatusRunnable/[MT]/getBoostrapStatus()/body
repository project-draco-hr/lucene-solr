{
  try {
    Replica leader=state.getClient().getZkStateReader().getLeaderRetry(targetCollection,shard,30000);
    String leaderCoreUrl=leader.getCoreUrl();
    HttpClient httpClient=state.getClient().getLbClient().getHttpClient();
    try (HttpSolrClient client=new HttpSolrClient.Builder(leaderCoreUrl).withHttpClient(httpClient).build()){
      NamedList response=sendCdcrCommand(client,CdcrParams.CdcrAction.BOOTSTRAP_STATUS);
      String status=(String)response.get(RESPONSE_STATUS);
      BootstrapStatus bootstrapStatus=BootstrapStatus.valueOf(status.toUpperCase(Locale.ROOT));
      if (bootstrapStatus == BootstrapStatus.RUNNING) {
        return BootstrapStatus.RUNNING;
      }
 else       if (bootstrapStatus == BootstrapStatus.COMPLETED) {
        return BootstrapStatus.COMPLETED;
      }
 else       if (bootstrapStatus == BootstrapStatus.FAILED) {
        return BootstrapStatus.FAILED;
      }
 else       if (bootstrapStatus == BootstrapStatus.NOTFOUND) {
        log.warn("Bootstrap process was not found on target collection: {} shard: {}, leader: {}",targetCollection,shard,leaderCoreUrl);
        return BootstrapStatus.NOTFOUND;
      }
 else       if (bootstrapStatus == BootstrapStatus.CANCELLED) {
        return BootstrapStatus.CANCELLED;
      }
 else {
        throw new SolrException(SolrException.ErrorCode.SERVER_ERROR,"Unknown status: " + status + " returned by BOOTSTRAP_STATUS command");
      }
    }
   }
 catch (  Exception e) {
    log.error("Exception during bootstrap status request",e);
    return BootstrapStatus.UNKNOWN;
  }
}
