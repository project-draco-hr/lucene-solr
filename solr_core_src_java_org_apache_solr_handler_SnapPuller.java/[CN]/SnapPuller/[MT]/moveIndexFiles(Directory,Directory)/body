{
  if (LOG.isDebugEnabled()) {
    try {
      LOG.info("From dir files:" + Arrays.asList(tmpIdxDir.listAll()));
      LOG.info("To dir files:" + Arrays.asList(indexDir.listAll()));
    }
 catch (    IOException e) {
      throw new RuntimeException(e);
    }
  }
  String segmentsFile=null;
  List<String> movedfiles=new ArrayList<String>();
  for (  Map<String,Object> f : filesDownloaded) {
    String fname=(String)f.get(NAME);
    if (fname.startsWith("segments_")) {
      segmentsFile=fname;
      continue;
    }
    if (!moveAFile(tmpIdxDir,indexDir,fname,movedfiles))     return false;
    movedfiles.add(fname);
  }
  if (segmentsFile != null) {
    if (!moveAFile(tmpIdxDir,indexDir,segmentsFile,movedfiles))     return false;
  }
  return true;
}
