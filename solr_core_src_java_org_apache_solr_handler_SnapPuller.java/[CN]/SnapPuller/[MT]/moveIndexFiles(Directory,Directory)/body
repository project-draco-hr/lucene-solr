{
  String segmentsFile=null;
  List<String> movedfiles=new ArrayList<String>();
  for (  Map<String,Object> f : filesDownloaded) {
    String fname=(String)f.get(NAME);
    if (fname.startsWith("segments_")) {
      segmentsFile=fname;
      continue;
    }
    if (!moveAFile(tmpIdxDir,indexDir,fname,movedfiles))     return false;
    movedfiles.add(fname);
  }
  if (segmentsFile != null) {
    if (!moveAFile(tmpIdxDir,indexDir,segmentsFile,movedfiles))     return false;
  }
  return true;
}
