{
  SolrQueryRequest req=new LocalSolrQueryRequest(solrCore,new ModifiableSolrParams());
  solrCore.getUpdateHandler().newIndexWriter(isFullCopyNeeded);
  try {
    Future[] waitSearcher=new Future[1];
    solrCore.getSearcher(true,false,waitSearcher,true);
    if (waitSearcher[0] != null) {
      try {
        waitSearcher[0].get();
      }
 catch (      InterruptedException e) {
        SolrException.log(LOG,e);
      }
catch (      ExecutionException e) {
        SolrException.log(LOG,e);
      }
    }
    CommitUpdateCommand cuc=new CommitUpdateCommand(req,false);
    cuc.waitSearcher=false;
    cuc.openSearcher=false;
    solrCore.getUpdateHandler().commit(cuc);
  }
  finally {
    req.close();
  }
}
