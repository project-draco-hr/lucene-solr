{
  if (connTimeout == null && readTimeout == null && client != null)   return client;
  ThreadSafeClientConnManager mgr=new ThreadSafeClientConnManager();
  mgr.setDefaultMaxPerRoute(10000);
  mgr.setMaxTotal(10000);
  DefaultHttpClient httpClient=new DefaultHttpClient(mgr);
  httpClient.getParams().setIntParameter(CoreConnectionPNames.SO_TIMEOUT,readTimeout == null ? 20000 : Integer.parseInt(readTimeout));
  httpClient.getParams().setIntParameter(CoreConnectionPNames.CONNECTION_TIMEOUT,connTimeout == null ? 5000 : Integer.parseInt(connTimeout));
  if (client == null && connTimeout == null && readTimeout == null)   client=httpClient;
  if (httpBasicAuthUser != null && httpBasicAuthPassword != null) {
    httpClient.getCredentialsProvider().setCredentials(AuthScope.ANY,new UsernamePasswordCredentials(httpBasicAuthUser,httpBasicAuthPassword));
  }
  return httpClient;
}
