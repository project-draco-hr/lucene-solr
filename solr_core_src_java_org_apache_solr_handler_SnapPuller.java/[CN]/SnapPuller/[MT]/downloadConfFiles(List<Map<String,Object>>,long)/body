{
  LOG.info("Starting download of configuration files from master: " + confFilesToDownload);
  confFilesDownloaded=Collections.synchronizedList(new ArrayList<Map<String,Object>>());
  File tmpconfDir=new File(solrCore.getResourceLoader().getConfigDir(),"conf." + getDateAsStr(new Date()));
  try {
    boolean status=tmpconfDir.mkdirs();
    if (!status) {
      throw new SolrException(SolrException.ErrorCode.SERVER_ERROR,"Failed to create temporary config folder: " + tmpconfDir.getName());
    }
    for (    Map<String,Object> file : confFilesToDownload) {
      String saveAs=(String)(file.get(ALIAS) == null ? file.get(NAME) : file.get(ALIAS));
      fileFetcher=new FileFetcher(tmpconfDir,file,saveAs,true,latestGeneration);
      currentFile=file;
      fileFetcher.fetchFile();
      confFilesDownloaded.add(new HashMap<String,Object>(file));
    }
    terminateAndWaitFsyncService();
    copyTmpConfFiles2Conf(tmpconfDir);
  }
  finally {
    delTree(tmpconfDir);
  }
}
