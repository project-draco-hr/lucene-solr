{
  SolrCore core=cc.getCore(coreName);
  if (core == null) {
    SolrException.log(log,"SolrCore not found - cannot recover:" + coreName);
    return;
  }
  try {
    SolrQueryRequest req=new LocalSolrQueryRequest(core,new ModifiableSolrParams());
    SolrQueryResponse rsp=new SolrQueryResponse();
    SolrRequestInfo.setRequestInfo(new SolrRequestInfo(req,rsp));
    log.info("Starting recovery process.  core=" + coreName + " recoveringAfterStartup="+ recoveringAfterStartup);
    try {
      doRecovery(core);
    }
 catch (    KeeperException e) {
      log.error("",e);
      throw new ZooKeeperException(SolrException.ErrorCode.SERVER_ERROR,"",e);
    }
catch (    InterruptedException e) {
      Thread.currentThread().interrupt();
      SolrException.log(log,"",e);
      throw new ZooKeeperException(SolrException.ErrorCode.SERVER_ERROR,"",e);
    }
  }
  finally {
    if (core != null)     core.close();
    SolrRequestInfo.clearRequestInfo();
  }
}
