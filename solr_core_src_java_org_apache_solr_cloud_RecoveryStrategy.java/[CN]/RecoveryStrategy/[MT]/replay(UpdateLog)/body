{
  Future<RecoveryInfo> future=ulog.applyBufferedUpdates();
  if (future == null) {
    log.info("No replay needed. core=" + coreName);
  }
 else {
    log.info("Replaying buffered documents. core=" + coreName);
    RecoveryInfo report=future.get();
    if (report.failed) {
      SolrException.log(log,"Replay failed");
      throw new SolrException(ErrorCode.SERVER_ERROR,"Replay failed");
    }
  }
  return future;
}
