{
  Directory dir=newDirectory();
  RandomIndexWriter iw=new RandomIndexWriter(random(),dir);
  BytesRef bytes=new BytesRef(2);
  BinaryTokenStream tokenStream=new BinaryTokenStream(bytes);
  for (int i=0; i < 256; i++) {
    bytes.bytes[0]=(byte)i;
    bytes.bytes[1]=(byte)(255 - i);
    bytes.length=2;
    Document doc=new Document();
    FieldType customType=new FieldType();
    customType.setStored(true);
    doc.add(new Field("id","" + i,customType));
    doc.add(new TextField("bytes",tokenStream));
    iw.addDocument(doc);
  }
  IndexReader ir=iw.getReader();
  iw.close();
  IndexSearcher is=newSearcher(ir);
  for (int i=0; i < 256; i++) {
    bytes.bytes[0]=(byte)i;
    bytes.bytes[1]=(byte)(255 - i);
    bytes.length=2;
    TopDocs docs=is.search(new TermQuery(new Term("bytes",bytes)),5);
    assertEquals(1,docs.totalHits);
    assertEquals("" + i,is.doc(docs.scoreDocs[0].doc).get("id"));
  }
  ir.close();
  dir.close();
}
