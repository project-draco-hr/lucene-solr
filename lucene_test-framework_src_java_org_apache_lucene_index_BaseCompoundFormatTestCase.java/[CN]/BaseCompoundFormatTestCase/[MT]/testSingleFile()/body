{
  int data[]=new int[]{0,1,10,100};
  for (int i=0; i < data.length; i++) {
    String testfile="_" + i + ".test";
    Directory dir=newDirectory();
    createSequenceFile(dir,testfile,(byte)0,data[i]);
    SegmentInfo si=newSegmentInfo(dir,"_" + i);
    si.getCodec().compoundFormat().write(dir,si,Collections.singleton(testfile),MergeState.CheckAbort.NONE,IOContext.DEFAULT);
    Directory cfs=si.getCodec().compoundFormat().getCompoundReader(dir,si,IOContext.DEFAULT);
    IndexInput expected=dir.openInput(testfile,newIOContext(random()));
    IndexInput actual=cfs.openInput(testfile,newIOContext(random()));
    assertSameStreams(testfile,expected,actual);
    assertSameSeekBehavior(testfile,expected,actual);
    expected.close();
    actual.close();
    cfs.close();
    dir.close();
  }
}
