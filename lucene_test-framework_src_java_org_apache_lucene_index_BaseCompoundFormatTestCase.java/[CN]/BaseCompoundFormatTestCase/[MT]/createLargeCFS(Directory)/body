{
  List<String> files=new ArrayList<>();
  for (int i=0; i < 20; i++) {
    createSequenceFile(dir,"_123.f" + i,(byte)0,2000);
    files.add("_123.f" + i);
  }
  SegmentInfo si=newSegmentInfo(dir,"_123");
  si.getCodec().compoundFormat().write(dir,si,files,MergeState.CheckAbort.NONE,IOContext.DEFAULT);
  Directory cfs=si.getCodec().compoundFormat().getCompoundReader(dir,si,IOContext.DEFAULT);
  return cfs;
}
