{
  final String testfile="_123.test";
  Directory dir=newDirectory();
  IndexOutput out=dir.createOutput(testfile,IOContext.DEFAULT);
  out.writeInt(3);
  out.close();
  SegmentInfo si=newSegmentInfo(dir,"_123");
  si.setFiles(Collections.singleton(testfile));
  si.getCodec().compoundFormat().write(dir,si,IOContext.DEFAULT);
  Directory cfs=si.getCodec().compoundFormat().getCompoundReader(dir,si,IOContext.DEFAULT);
  assertEquals(1,cfs.listAll().length);
  cfs.close();
  cfs.close();
  dir.close();
}
