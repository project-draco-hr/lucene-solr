{
  final String testfile="_123.test";
  Directory dir=newDirectory();
  IndexOutput out=dir.createOutput(testfile,IOContext.DEFAULT);
  out.writeInt(3);
  out.close();
  SegmentInfo si=newSegmentInfo(dir,"_123");
  si.getCodec().compoundFormat().write(dir,si,Collections.<String>emptyList(),MergeState.CheckAbort.NONE,IOContext.DEFAULT);
  Directory cfs=si.getCodec().compoundFormat().getCompoundReader(dir,si,IOContext.DEFAULT);
  try {
    cfs.makeLock("foobar");
    fail("didn't get expected exception");
  }
 catch (  UnsupportedOperationException expected) {
  }
  cfs.close();
  dir.close();
}
