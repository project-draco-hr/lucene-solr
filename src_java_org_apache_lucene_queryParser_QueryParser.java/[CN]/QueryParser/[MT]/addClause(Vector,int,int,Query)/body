{
  boolean required, prohibited;
  if (conj == CONJ_AND) {
    BooleanClause c=(BooleanClause)clauses.elementAt(clauses.size() - 1);
    if (!c.prohibited)     c.required=true;
  }
  if (operator == DEFAULT_OPERATOR_AND && conj == CONJ_OR) {
    BooleanClause c=(BooleanClause)clauses.elementAt(clauses.size() - 1);
    if (!c.prohibited)     c.required=false;
  }
  if (q == null)   return;
  if (operator == DEFAULT_OPERATOR_OR) {
    prohibited=(mods == MOD_NOT);
    required=(mods == MOD_REQ);
    if (conj == CONJ_AND && !prohibited) {
      required=true;
    }
  }
 else {
    prohibited=(mods == MOD_NOT);
    required=(!prohibited && conj != CONJ_OR);
  }
  clauses.addElement(new BooleanClause(q,required,prohibited));
}
