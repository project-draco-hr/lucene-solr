{
  if (useOldRangeQuery) {
    return new RangeQuery(new Term(field,part1),new Term(field,part2),inclusive,rangeCollator);
  }
 else {
    return new ConstantScoreRangeQuery(field,part1,part2,inclusive,inclusive,rangeCollator);
  }
}
