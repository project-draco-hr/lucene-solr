{
  Directory dir=newDirectory();
  int maxPointsInLeaf=TestUtil.nextInt(random(),16,2048);
  int maxPointsSortInHeap=TestUtil.nextInt(random(),maxPointsInLeaf,1024 * 1024);
  IndexWriterConfig iwc=newIndexWriterConfig();
  iwc.setCodec(TestUtil.alwaysDocValuesFormat(new Geo3DDocValuesFormat(PlanetModel.WGS84,maxPointsInLeaf,maxPointsSortInHeap)));
  IndexWriter w=new IndexWriter(dir,iwc);
  Document doc=new Document();
  doc.add(new Geo3DPointField("field",PlanetModel.WGS84,toRadians(50.7345267),toRadians(-97.5303555)));
  w.addDocument(doc);
  IndexReader r=DirectoryReader.open(w,true);
  IndexSearcher s=newSearcher(r,false);
  assertEquals(1,s.search(new PointInGeo3DShapeQuery(PlanetModel.WGS84,"field",GeoCircleFactory.makeGeoCircle(PlanetModel.WGS84,toRadians(50),toRadians(-97),Math.PI / 180.)),1).totalHits);
  w.close();
  r.close();
  dir.close();
}
