{
  checkDestroyed();
  checkInitialized();
  String serviceName=entry.getServiceConfig().getName();
  if (LOG.isInfoEnabled())   LOG.info("New Indexer Task submitted - Action: " + action + " for service: "+ serviceName);
  ServiceIndex bean=this.indexerMap.get(serviceName);
  if (bean == null)   throw new RuntimeException("no indexer for service " + serviceName + " registered");
  Lock lock=bean.getLock();
  lock.lock();
  try {
    IndexSchema schema=bean.getSchema();
    boolean commitAfter=bean.incrementActionAndReset(schema.getCommitAfterDocuments());
    IndexDocumentBuilder<IndexDocument> callable=new IndexDocumentBuilderTask<IndexDocument>(entry,bean.getSchema(),action,commitAfter,bean.getOptimize(schema.getOptimizeAfterCommit()));
    sumbitTask(callable,bean.getIndexer());
  }
  finally {
    lock.unlock();
  }
}
