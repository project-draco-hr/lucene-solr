{
  clearAttributes();
  if (finiteStrings == null) {
    Automaton automaton=toAutomaton(input);
    Set<IntsRef> strings=Operations.getFiniteStrings(automaton,maxGraphExpansions);
    posInc=strings.size();
    finiteStrings=strings.iterator();
  }
  if (finiteStrings.hasNext()) {
    posAttr.setPositionIncrement(posInc);
    posInc=0;
    Util.toBytesRef(finiteStrings.next(),bytesAtt.builder());
    if (charTermAttribute != null) {
      charTermAttribute.setLength(0);
      charTermAttribute.append(bytesAtt.toUTF16());
    }
    if (payload != null) {
      payloadAttr.setPayload(this.payload);
    }
    return true;
  }
  return false;
}
