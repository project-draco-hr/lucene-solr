{
  if (termArrays.isEmpty()) {
    return new MatchNoDocsQuery();
  }
 else   if (termArrays.size() == 1) {
    Term[] terms=termArrays.get(0);
    BooleanQuery.Builder builder=new BooleanQuery.Builder();
    builder.setDisableCoord(true);
    for (int i=0; i < terms.length; i++) {
      builder.add(new TermQuery(terms[i]),BooleanClause.Occur.SHOULD);
    }
    return builder.build();
  }
 else {
    return super.rewrite(reader);
  }
}
