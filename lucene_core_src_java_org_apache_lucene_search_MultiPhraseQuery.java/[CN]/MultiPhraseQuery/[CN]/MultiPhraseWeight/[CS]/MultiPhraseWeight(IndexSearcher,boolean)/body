{
  super(MultiPhraseQuery.this);
  this.needsScores=needsScores;
  this.similarity=searcher.getSimilarity();
  final IndexReaderContext context=searcher.getTopReaderContext();
  ArrayList<TermStatistics> allTermStats=new ArrayList<>();
  for (  final Term[] terms : termArrays) {
    for (    Term term : terms) {
      TermContext termContext=termContexts.get(term);
      if (termContext == null) {
        termContext=TermContext.build(context,term);
        termContexts.put(term,termContext);
      }
      allTermStats.add(searcher.termStatistics(term,termContext));
    }
  }
  stats=similarity.computeWeight(getBoost(),searcher.collectionStatistics(field),allTermStats.toArray(new TermStatistics[allTermStats.size()]));
}
