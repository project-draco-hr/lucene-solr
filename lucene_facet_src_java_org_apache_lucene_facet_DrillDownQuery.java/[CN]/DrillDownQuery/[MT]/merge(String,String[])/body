{
  int index=drillDownDims.get(dim);
  if (query.getClauses().length == drillDownDims.size() + 1) {
    index++;
  }
  ConstantScoreQuery q=(ConstantScoreQuery)query.clauses().get(index).getQuery();
  if ((q.getQuery() instanceof BooleanQuery) == false) {
    throw new RuntimeException("cannot merge with custom Query");
  }
  String indexedField=config.getDimConfig(dim).indexFieldName;
  BooleanQuery bq=(BooleanQuery)q.getQuery();
  bq.add(new TermQuery(term(indexedField,dim,path)),Occur.SHOULD);
}
