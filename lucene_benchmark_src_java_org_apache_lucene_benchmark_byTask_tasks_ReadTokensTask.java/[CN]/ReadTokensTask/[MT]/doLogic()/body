{
  List<Field> fields=doc.getFields();
  Analyzer analyzer=getRunData().getAnalyzer();
  int tokenCount=0;
  for (  final IndexableField field : fields) {
    if (!field.fieldType().tokenized() || field instanceof IntField || field instanceof LongField|| field instanceof FloatField|| field instanceof DoubleField) {
      continue;
    }
    final TokenStream stream=field.tokenStream(analyzer);
    stream.reset();
    TermToBytesRefAttribute termAtt=stream.getAttribute(TermToBytesRefAttribute.class);
    while (stream.incrementToken()) {
      termAtt.fillBytesRef();
      tokenCount++;
    }
  }
  totalTokenCount+=tokenCount;
  return tokenCount;
}
