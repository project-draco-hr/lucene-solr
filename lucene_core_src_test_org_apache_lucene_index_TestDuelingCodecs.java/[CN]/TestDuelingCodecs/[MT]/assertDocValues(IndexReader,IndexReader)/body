{
  Set<String> leftFields=getDVFields(leftReader);
  Set<String> rightFields=getDVFields(rightReader);
  assertEquals(info,leftFields,rightFields);
  for (  String field : leftFields) {
{
      NumericDocValues leftValues=MultiDocValues.getNumericValues(leftReader,field);
      NumericDocValues rightValues=MultiDocValues.getNumericValues(rightReader,field);
      if (leftValues != null && rightValues != null) {
        assertDocValues(leftReader.maxDoc(),leftValues,rightValues);
      }
 else {
        assertNull(info,leftValues);
        assertNull(info,rightValues);
      }
    }
{
      BinaryDocValues leftValues=MultiDocValues.getBinaryValues(leftReader,field);
      BinaryDocValues rightValues=MultiDocValues.getBinaryValues(rightReader,field);
      if (leftValues != null && rightValues != null) {
        BytesRef scratchLeft=new BytesRef();
        BytesRef scratchRight=new BytesRef();
        for (int docID=0; docID < leftReader.maxDoc(); docID++) {
          leftValues.get(docID,scratchLeft);
          rightValues.get(docID,scratchRight);
          assertEquals(info,scratchLeft,scratchRight);
        }
      }
 else {
        assertNull(info,leftValues);
        assertNull(info,rightValues);
      }
    }
{
      SortedDocValues leftValues=MultiDocValues.getSortedValues(leftReader,field);
      SortedDocValues rightValues=MultiDocValues.getSortedValues(rightReader,field);
      if (leftValues != null && rightValues != null) {
        assertEquals(info,leftValues.getValueCount(),rightValues.getValueCount());
        BytesRef scratchLeft=new BytesRef();
        BytesRef scratchRight=new BytesRef();
        for (int i=0; i < leftValues.getValueCount(); i++) {
          leftValues.lookupOrd(i,scratchLeft);
          rightValues.lookupOrd(i,scratchRight);
          assertEquals(info,scratchLeft,scratchRight);
        }
        for (int docID=0; docID < leftReader.maxDoc(); docID++) {
          leftValues.get(docID,scratchLeft);
          rightValues.get(docID,scratchRight);
          assertEquals(info,scratchLeft,scratchRight);
        }
      }
 else {
        assertNull(info,leftValues);
        assertNull(info,rightValues);
      }
    }
  }
}
