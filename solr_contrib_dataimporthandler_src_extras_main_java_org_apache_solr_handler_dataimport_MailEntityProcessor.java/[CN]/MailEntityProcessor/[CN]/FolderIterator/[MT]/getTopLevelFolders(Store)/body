{
  if (folderNames != null)   topLevelFolders=Arrays.asList(folderNames.split(","));
  for (int i=0; topLevelFolders != null && i < topLevelFolders.size(); i++) {
    try {
      folders.add(mailbox.getFolder(topLevelFolders.get(i)));
    }
 catch (    MessagingException e) {
      if (folders.size() == 0 && i == topLevelFolders.size() - 1)       throw new DataImportHandlerException(DataImportHandlerException.SEVERE,"Folder retreival failed");
    }
  }
  if (topLevelFolders == null || topLevelFolders.size() == 0) {
    try {
      folders.add(mailBox.getDefaultFolder());
    }
 catch (    MessagingException e) {
      throw new DataImportHandlerException(DataImportHandlerException.SEVERE,"Folder retreival failed");
    }
  }
}
