{
  try {
    Properties props=new Properties();
    props.setProperty("mail.store.protocol",protocol);
    props.setProperty("mail.imap.fetchsize","" + fetchSize);
    props.setProperty("mail.imap.timeout","" + rTimeout);
    props.setProperty("mail.imap.connectiontimeout","" + cTimeout);
    Session session=Session.getDefaultInstance(props,null);
    mailbox=session.getStore(protocol);
    mailbox.connect(host,user,password);
    LOG.info("Connected to mailbox");
    return true;
  }
 catch (  MessagingException e) {
    throw new DataImportHandlerException(DataImportHandlerException.SEVERE,"Connection failed",e);
  }
}
