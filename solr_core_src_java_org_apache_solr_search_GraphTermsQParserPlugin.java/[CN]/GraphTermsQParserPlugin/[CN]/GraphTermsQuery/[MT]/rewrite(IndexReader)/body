{
  if (this.finalContexts == null) {
    this.finalContexts=new ArrayList();
    this.finalTerms=new ArrayList();
    List<LeafReaderContext> contexts=reader.leaves();
    TermContext[] termContexts=new TermContext[this.queryTerms.length];
    collectTermContext(reader,contexts,termContexts,this.queryTerms);
    for (int i=0; i < termContexts.length; i++) {
      TermContext termContext=termContexts[i];
      if (termContext != null && termContext.docFreq() < this.maxDocFreq) {
        this.finalContexts.add(termContext);
        this.finalTerms.add(queryTerms[i]);
      }
    }
  }
  return this;
}
