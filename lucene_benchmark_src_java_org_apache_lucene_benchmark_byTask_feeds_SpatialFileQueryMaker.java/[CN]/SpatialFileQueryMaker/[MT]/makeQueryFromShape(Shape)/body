{
  SpatialArgs args=new SpatialArgs(operation,shape);
  if (!Double.isNaN(distErrPct))   args.setDistErrPct(distErrPct);
  Query filterQuery=strategy.makeQuery(args);
  if (score) {
    ValueSource valueSource=strategy.makeDistanceValueSource(shape.getCenter());
    return new BooleanQuery.Builder().add(new FunctionQuery(valueSource),BooleanClause.Occur.MUST).add(filterQuery,BooleanClause.Occur.FILTER).build();
  }
 else {
    return filterQuery;
  }
}
