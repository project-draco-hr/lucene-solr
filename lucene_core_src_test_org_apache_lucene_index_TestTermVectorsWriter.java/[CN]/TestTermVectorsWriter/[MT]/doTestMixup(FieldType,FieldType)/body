{
  Directory dir=newDirectory();
  RandomIndexWriter iw=new RandomIndexWriter(random(),dir);
  for (int i=0; i < 3; i++) {
    Document doc=new Document();
    doc.add(new StringField("id",Integer.toString(i),Field.Store.NO));
    iw.addDocument(doc);
  }
  Document doc=new Document();
  doc.add(new Field("field","value1",ft1));
  doc.add(new Field("field","value2",ft2));
  try {
    iw.addDocument(doc);
    fail("didn't hit expected exception");
  }
 catch (  IllegalArgumentException iae) {
    assertNotNull(iae.getMessage());
    assertTrue(iae.getMessage().startsWith("all instances of a given field name must have the same term vectors settings"));
  }
  IndexReader ir=iw.getReader();
  assertEquals(3,ir.numDocs());
  ir.close();
  iw.close();
  dir.close();
}
