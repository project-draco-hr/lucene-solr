{
  Directory dir=newDirectory();
  IndexWriterConfig iwc=new IndexWriterConfig(new MockAnalyzer(random()));
  IndexWriter iw=new IndexWriter(dir,iwc);
  Document doc=new Document();
  iw.addDocument(doc);
  FieldType ft=new FieldType(StoredField.TYPE);
  ft.setStoreTermVectors(true);
  ft.freeze();
  doc.add(new Field("field","value",ft));
  try {
    iw.addDocument(doc);
    fail("should have hit exc");
  }
 catch (  IllegalArgumentException iae) {
  }
  IndexReader r=DirectoryReader.open(iw);
  assertEquals(1,r.numDocs());
  iw.close();
  r.close();
  dir.close();
}
