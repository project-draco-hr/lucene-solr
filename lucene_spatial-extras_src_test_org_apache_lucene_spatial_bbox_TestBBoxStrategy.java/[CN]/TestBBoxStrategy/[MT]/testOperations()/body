{
  if (random().nextInt(4) > 0) {
    this.ctx=SpatialContext.GEO;
  }
 else {
    SpatialContextFactory factory=new SpatialContextFactory();
    factory.geo=false;
    factory.worldBounds=new RectangleImpl(-300,300,-100,100,null);
    this.ctx=factory.newSpatialContext();
  }
  if (random().nextBoolean()) {
    this.strategy=BBoxStrategy.newInstance(ctx,"bbox");
  }
 else {
    this.strategy=BBoxStrategy.newLegacyInstance(ctx,"bbox");
  }
  if (random().nextBoolean()) {
    FieldType fieldType=new FieldType(((BBoxStrategy)strategy).getFieldType());
    fieldType.setDocValuesType(DocValuesType.NONE);
    strategy=new BBoxStrategy(ctx,strategy.getFieldName(),fieldType);
  }
  for (  SpatialOperation operation : SpatialOperation.values()) {
    if (operation == SpatialOperation.Overlaps)     continue;
    testOperationRandomShapes(operation);
    deleteAll();
    commit();
  }
}
