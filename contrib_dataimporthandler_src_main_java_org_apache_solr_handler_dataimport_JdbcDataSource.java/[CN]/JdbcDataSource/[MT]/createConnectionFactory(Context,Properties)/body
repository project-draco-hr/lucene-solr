{
  final String url=initProps.getProperty(URL);
  String driver=initProps.getProperty(DRIVER);
  if (url == null)   throw new DataImportHandlerException(DataImportHandlerException.SEVERE,"JDBC URL cannot be null");
  try {
    if (driver != null)     Class.forName(driver);
  }
 catch (  ClassNotFoundException e) {
    throw new DataImportHandlerException(DataImportHandlerException.SEVERE,"driver could not be loaded");
  }
  factory=new Callable<Connection>(){
    public Connection call() throws Exception {
      LOG.info("Creating a connection for entity " + context.getEntityAttribute(DataImporter.NAME) + " with URL: "+ url);
      long start=System.currentTimeMillis();
      Connection c=DriverManager.getConnection(url,initProps);
      LOG.info("Time taken for getConnection(): " + (System.currentTimeMillis() - start));
      return c;
    }
  }
;
}
