{
  if (resultSet == null)   return null;
  Map<String,Object> result=new HashMap<String,Object>();
  for (  String colName : colNames) {
    try {
      if (!convertType) {
        result.put(colName,resultSet.getObject(colName));
        continue;
      }
      Integer type=fieldNameVsType.get(colName);
      if (type == null)       type=Types.VARCHAR;
switch (type) {
case Types.INTEGER:
        result.put(colName,resultSet.getInt(colName));
      break;
case Types.FLOAT:
    result.put(colName,resultSet.getFloat(colName));
  break;
case Types.BIGINT:
result.put(colName,resultSet.getLong(colName));
break;
case Types.DOUBLE:
result.put(colName,resultSet.getDouble(colName));
break;
case Types.DATE:
result.put(colName,resultSet.getDate(colName));
break;
case Types.BOOLEAN:
result.put(colName,resultSet.getBoolean(colName));
break;
case Types.BLOB:
result.put(colName,resultSet.getBytes(colName));
break;
default :
result.put(colName,resultSet.getString(colName));
break;
}
}
 catch (SQLException e) {
logError("Error reading data ",e);
throw new DataImportHandlerException(DataImportHandlerException.SEVERE,"Error reading data from database",e);
}
}
return result;
}
