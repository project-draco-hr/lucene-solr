{
  StringBuilder fooField=new StringBuilder();
  StringBuilder termField=new StringBuilder();
  final int numFooTerms=random.nextInt(250 * RANDOM_MULTIPLIER);
  for (int i=0; i < numFooTerms; i++) {
    fooField.append(" ");
    fooField.append(randomTerm());
  }
  final int numTermTerms=random.nextInt(250 * RANDOM_MULTIPLIER);
  for (int i=0; i < numTermTerms; i++) {
    termField.append(" ");
    termField.append(randomTerm());
  }
  MockRAMDirectory ramdir=newDirectory(random);
  Analyzer analyzer=randomAnalyzer();
  IndexWriter writer=new IndexWriter(ramdir,new IndexWriterConfig(TEST_VERSION_CURRENT,analyzer).setCodecProvider(_TestUtil.alwaysCodec("Standard")));
  Document doc=new Document();
  Field field1=new Field("foo",fooField.toString(),Field.Store.NO,Field.Index.ANALYZED);
  Field field2=new Field("term",termField.toString(),Field.Store.NO,Field.Index.ANALYZED);
  doc.add(field1);
  doc.add(field2);
  writer.addDocument(doc);
  writer.close();
  MemoryIndex memory=new MemoryIndex();
  memory.addField("foo",fooField.toString(),analyzer);
  memory.addField("term",termField.toString(),analyzer);
  assertAllQueries(memory,ramdir,analyzer);
  ramdir.close();
}
