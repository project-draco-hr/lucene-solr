{
  if (!isSSLMode()) {
    return null;
  }
  SslContextFactory factory=new SslContextFactory(false);
  if (getKeyStore() != null)   factory.setKeyStorePath(getKeyStore());
  if (getKeyStorePassword() != null)   factory.setKeyStorePassword(getKeyStorePassword());
  factory.setNeedClientAuth(isClientAuthMode());
  if (isClientAuthMode()) {
    if (getTrustStore() != null)     factory.setTrustStorePath(getTrustStore());
    if (getTrustStorePassword() != null)     factory.setTrustStorePassword(getTrustStorePassword());
  }
  return factory;
}
