{
  if (sslConfig == null) {
    if (Boolean.getBoolean("tests.jettySsl")) {
      return configureSslFromSysProps();
    }
    return null;
  }
  if (!sslConfig.isSSLMode())   return null;
  SslContextFactory factory=new SslContextFactory(false);
  if (sslConfig.getKeyStore() != null)   factory.setKeyStorePath(sslConfig.getKeyStore());
  if (sslConfig.getKeyStorePassword() != null)   factory.setKeyStorePassword(sslConfig.getKeyStorePassword());
  factory.setNeedClientAuth(sslConfig.isClientAuthMode());
  if (sslConfig.isClientAuthMode()) {
    if (sslConfig.getTrustStore() != null)     factory.setTrustStorePath(sslConfig.getTrustStore());
    if (sslConfig.getTrustStorePassword() != null)     factory.setTrustStorePassword(sslConfig.getTrustStorePassword());
  }
  return factory;
}
