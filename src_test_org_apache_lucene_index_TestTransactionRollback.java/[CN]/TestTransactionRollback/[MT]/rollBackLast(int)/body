{
  String ids="-" + id;
  IndexCommit last=null;
  Collection commits=IndexReader.listCommits(dir);
  for (Iterator iterator=commits.iterator(); iterator.hasNext(); ) {
    IndexCommit commit=(IndexCommit)iterator.next();
    String ud=commit.getUserData();
    if (ud != null)     if (ud.endsWith(ids))     last=commit;
  }
  if (last == null)   throw new RuntimeException("Couldn't find commit point " + id);
  IndexWriter w=new IndexWriter(dir,new WhitespaceAnalyzer(),new RollbackDeletionPolicy(id),MaxFieldLength.UNLIMITED,last);
  w.commit("Rolled back to 1-" + id);
  w.close();
}
