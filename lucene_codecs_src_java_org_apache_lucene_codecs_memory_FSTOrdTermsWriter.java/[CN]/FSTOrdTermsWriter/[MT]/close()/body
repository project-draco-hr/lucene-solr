{
  IOException ioe=null;
  try {
    final long blockDirStart=blockOut.getFilePointer();
    blockOut.writeVInt(fields.size());
    for (    FieldMetaData field : fields) {
      blockOut.writeVInt(field.fieldInfo.number);
      blockOut.writeVLong(field.numTerms);
      if (field.fieldInfo.getIndexOptions() != IndexOptions.DOCS_ONLY) {
        blockOut.writeVLong(field.sumTotalTermFreq);
      }
      blockOut.writeVLong(field.sumDocFreq);
      blockOut.writeVInt(field.docCount);
      blockOut.writeVInt(field.longsSize);
      blockOut.writeVLong(field.statsOut.getFilePointer());
      blockOut.writeVLong(field.metaLongsOut.getFilePointer());
      blockOut.writeVLong(field.metaBytesOut.getFilePointer());
      field.skipOut.writeTo(blockOut);
      field.statsOut.writeTo(blockOut);
      field.metaLongsOut.writeTo(blockOut);
      field.metaBytesOut.writeTo(blockOut);
      field.dict.save(indexOut);
    }
    writeTrailer(blockOut,blockDirStart);
  }
 catch (  IOException ioe2) {
    ioe=ioe2;
  }
 finally {
    IOUtils.closeWhileHandlingException(ioe,blockOut,indexOut,postingsWriter);
  }
}
