{
  if (numTerms > 0 && numTerms % SKIP_INTERVAL == 0) {
    bufferSkip();
  }
  final long longs[]=new long[longsSize];
  final long delta=state.totalTermFreq - state.docFreq;
  if (state.totalTermFreq > 0) {
    if (delta == 0) {
      statsOut.writeVInt(state.docFreq << 1 | 1);
    }
 else {
      statsOut.writeVInt(state.docFreq << 1);
      statsOut.writeVLong(state.totalTermFreq - state.docFreq);
    }
  }
 else {
    statsOut.writeVInt(state.docFreq);
  }
  postingsWriter.encodeTerm(longs,metaBytesOut,fieldInfo,state,true);
  for (int i=0; i < longsSize; i++) {
    metaLongsOut.writeVLong(longs[i] - lastLongs[i]);
    lastLongs[i]=longs[i];
  }
  metaLongsOut.writeVLong(metaBytesOut.getFilePointer() - lastMetaBytesFP);
  builder.add(Util.toIntsRef(text,scratchTerm),numTerms);
  numTerms++;
  lastMetaBytesFP=metaBytesOut.getFilePointer();
}
