{
  clearIndex();
  final String f="bday_dt";
  assertU(adoc("id","1",f,"1976-07-04T12:08:56.235Z"));
  assertU(adoc("id","2",f,"1976-07-05T00:00:00.000Z"));
  assertU(adoc("id","3",f,"1976-07-15T00:07:67.890Z"));
  assertU(commit());
  assertU(adoc("id","4",f,"1976-07-21T00:07:67.890Z"));
  assertU(adoc("id","5",f,"1976-07-13T12:12:25.255Z"));
  assertU(adoc("id","6",f,"1976-07-03T17:01:23.456Z"));
  assertU(adoc("id","7",f,"1976-07-12T12:12:25.255Z"));
  assertU(adoc("id","8",f,"1976-07-15T15:15:15.155Z"));
  assertU(adoc("id","9",f,"1907-07-12T13:13:23.235Z"));
  assertU(adoc("id","10",f,"1976-07-03T11:02:45.678Z"));
  assertU(commit());
  assertU(adoc("id","11",f,"1907-07-12T12:12:25.255Z"));
  assertU(adoc("id","12",f,"2007-07-30T07:07:07.070Z"));
  assertU(adoc("id","13",f,"1976-07-30T22:22:22.222Z"));
  assertU(adoc("id","14",f,"1976-07-05T22:22:22.222Z"));
  assertU(commit());
  final String preFoo="//lst[@name='facet_dates']/lst[@name='foo']";
  final String preBar="//lst[@name='facet_dates']/lst[@name='bar']";
  assertQ("check counts for month of facet by day",req("q","*:*","rows","0","facet","true","facet.date","{!key=foo " + "facet.date.start=1976-07-01T00:00:00.000Z " + "facet.date.end=1976-07-01T00:00:00.000Z+1MONTH "+ "facet.date.gap=+1DAY "+ "facet.date.other=all "+ "}"+ f,"facet.date","{!key=bar " + "facet.date.start=1976-07-01T00:00:00.000Z " + "facet.date.end=1976-07-01T00:00:00.000Z+7DAY "+ "facet.date.gap=+1DAY "+ "}"+ f),"*[count(" + preFoo + "/int)=34]",preFoo + "/int[@name='1976-07-01T00:00:00Z'][.='0'  ]",preFoo + "/int[@name='1976-07-02T00:00:00Z'][.='0'  ]",preFoo + "/int[@name='1976-07-03T00:00:00Z'][.='2'  ]",preFoo + "/int[@name='1976-07-04T00:00:00Z'][.='2'  ]",preFoo + "/int[@name='1976-07-05T00:00:00Z'][.='2'  ]",preFoo + "/int[@name='1976-07-06T00:00:00Z'][.='0']",preFoo + "/int[@name='1976-07-07T00:00:00Z'][.='0']",preFoo + "/int[@name='1976-07-08T00:00:00Z'][.='0']",preFoo + "/int[@name='1976-07-09T00:00:00Z'][.='0']",preFoo + "/int[@name='1976-07-10T00:00:00Z'][.='0']",preFoo + "/int[@name='1976-07-11T00:00:00Z'][.='0']",preFoo + "/int[@name='1976-07-12T00:00:00Z'][.='1'  ]",preFoo + "/int[@name='1976-07-13T00:00:00Z'][.='1'  ]",preFoo + "/int[@name='1976-07-14T00:00:00Z'][.='0']",preFoo + "/int[@name='1976-07-15T00:00:00Z'][.='2'  ]",preFoo + "/int[@name='1976-07-16T00:00:00Z'][.='0']",preFoo + "/int[@name='1976-07-17T00:00:00Z'][.='0']",preFoo + "/int[@name='1976-07-18T00:00:00Z'][.='0']",preFoo + "/int[@name='1976-07-19T00:00:00Z'][.='0']",preFoo + "/int[@name='1976-07-21T00:00:00Z'][.='1'  ]",preFoo + "/int[@name='1976-07-22T00:00:00Z'][.='0']",preFoo + "/int[@name='1976-07-23T00:00:00Z'][.='0']",preFoo + "/int[@name='1976-07-24T00:00:00Z'][.='0']",preFoo + "/int[@name='1976-07-25T00:00:00Z'][.='0']",preFoo + "/int[@name='1976-07-26T00:00:00Z'][.='0']",preFoo + "/int[@name='1976-07-27T00:00:00Z'][.='0']",preFoo + "/int[@name='1976-07-28T00:00:00Z'][.='0']",preFoo + "/int[@name='1976-07-29T00:00:00Z'][.='0']",preFoo + "/int[@name='1976-07-30T00:00:00Z'][.='1'  ]",preFoo + "/int[@name='1976-07-31T00:00:00Z'][.='0']",preFoo + "/int[@name='before' ][.='2']",preFoo + "/int[@name='after'  ][.='1']",preFoo + "/int[@name='between'][.='11']","*[count(" + preBar + "/int)=7]",preBar + "/int[@name='1976-07-01T00:00:00Z'][.='0'  ]",preBar + "/int[@name='1976-07-02T00:00:00Z'][.='0'  ]",preBar + "/int[@name='1976-07-03T00:00:00Z'][.='2'  ]",preBar + "/int[@name='1976-07-04T00:00:00Z'][.='2'  ]",preBar + "/int[@name='1976-07-05T00:00:00Z'][.='2'  ]",preBar + "/int[@name='1976-07-06T00:00:00Z'][.='0']",preBar + "/int[@name='1976-07-07T00:00:00Z'][.='0']");
  clearIndex();
  assertU(commit());
}
