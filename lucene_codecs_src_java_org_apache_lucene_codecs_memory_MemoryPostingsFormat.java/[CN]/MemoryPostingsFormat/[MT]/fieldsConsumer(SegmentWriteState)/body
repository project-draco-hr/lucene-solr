{
  final String fileName=IndexFileNames.segmentFileName(state.segmentInfo.name,state.segmentSuffix,EXTENSION);
  final IndexOutput out=state.directory.createOutput(fileName,state.context);
  return new PushFieldsConsumer(state){
    @Override public TermsConsumer addField(    FieldInfo field){
      return new TermsWriter(out,field,doPackFST,acceptableOverheadRatio);
    }
    @Override public void close() throws IOException {
      try {
        out.writeVInt(0);
      }
  finally {
        out.close();
      }
    }
  }
;
}
