{
  version=CodecUtil.checkHeader(termsIn,PulsingPostingsWriter.CODEC,PulsingPostingsWriter.VERSION_START,PulsingPostingsWriter.VERSION_CURRENT);
  maxPositions=termsIn.readVInt();
  wrappedPostingsReader.init(termsIn);
  if (wrappedPostingsReader instanceof PulsingPostingsReader || version < PulsingPostingsWriter.VERSION_META_ARRAY) {
    fields=null;
  }
 else {
    fields=new TreeMap<>();
    String summaryFileName=IndexFileNames.segmentFileName(segmentState.segmentInfo.name,segmentState.segmentSuffix,PulsingPostingsWriter.SUMMARY_EXTENSION);
    IndexInput in=null;
    try {
      in=segmentState.directory.openInput(summaryFileName,segmentState.context);
      CodecUtil.checkHeader(in,PulsingPostingsWriter.CODEC,version,PulsingPostingsWriter.VERSION_CURRENT);
      int numField=in.readVInt();
      for (int i=0; i < numField; i++) {
        int fieldNum=in.readVInt();
        int longsSize=in.readVInt();
        fields.put(fieldNum,longsSize);
      }
    }
  finally {
      IOUtils.closeWhileHandlingException(in);
    }
  }
}
