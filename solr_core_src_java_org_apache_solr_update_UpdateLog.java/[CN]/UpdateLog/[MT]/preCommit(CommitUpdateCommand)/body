{
synchronized (this) {
    if (debug) {
      log.debug("TLOG: preCommit");
    }
    if (getState() != State.ACTIVE && (cmd.getFlags() & UpdateCommand.REPLAY) == 0) {
      return;
    }
    newMap();
    if (prevTlog != null) {
      globalStrings=prevTlog.getGlobalStrings();
    }
    prevTlog=tlog;
    tlog=null;
    id++;
  }
}
