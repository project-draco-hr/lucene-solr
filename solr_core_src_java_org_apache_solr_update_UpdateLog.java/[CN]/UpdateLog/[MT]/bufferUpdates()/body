{
  recoveryInfo=new RecoveryInfo();
  versionInfo.blockUpdates();
  try {
    if (state != State.ACTIVE)     return;
    if (log.isInfoEnabled()) {
      log.info("Starting to buffer updates. " + this);
    }
synchronized (this) {
      recoveryInfo.positionOfStart=tlog == null ? 0 : tlog.snapshot();
    }
    state=State.BUFFERING;
    operationFlags|=FLAG_GAP;
  }
  finally {
    versionInfo.unblockUpdates();
  }
}
