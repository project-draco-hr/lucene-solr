{
  debug=log.isDebugEnabled();
  trace=log.isTraceEnabled();
synchronized (this) {
    if (!cmd.softCommit)     return;
    newMap();
    map=new HashMap<BytesRef,LogPtr>();
    if (debug) {
      log.debug("TLOG: preSoftCommit: prevMap=" + System.identityHashCode(prevMap) + " new map="+ System.identityHashCode(map));
    }
  }
}
