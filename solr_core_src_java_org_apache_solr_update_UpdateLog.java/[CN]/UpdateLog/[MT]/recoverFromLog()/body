{
  recoveryInfo=new RecoveryInfo();
  List<TransactionLog> recoverLogs=new ArrayList<>(1);
  for (  TransactionLog ll : newestLogsOnStartup) {
    if (!ll.try_incref())     continue;
    try {
      if (ll.endsWithCommit()) {
        ll.decref();
        continue;
      }
    }
 catch (    IOException e) {
      log.error("Error inspecting tlog " + ll,e);
      ll.decref();
      continue;
    }
    recoverLogs.add(ll);
  }
  if (recoverLogs.isEmpty())   return null;
  ExecutorCompletionService<RecoveryInfo> cs=new ExecutorCompletionService<>(recoveryExecutor);
  LogReplayer replayer=new LogReplayer(recoverLogs,false);
  versionInfo.blockUpdates();
  try {
    state=State.REPLAYING;
  }
  finally {
    versionInfo.unblockUpdates();
  }
  return cs.submit(replayer,recoveryInfo);
}
