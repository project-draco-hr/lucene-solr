{
  versionInfo.blockUpdates();
  try {
    cancelApplyBufferUpdate=false;
    if (state != State.BUFFERING)     return null;
    if (tlog == null) {
      state=State.ACTIVE;
      return null;
    }
    tlog.incref();
    state=State.APPLYING_BUFFERED;
    operationFlags&=~FLAG_GAP;
  }
  finally {
    versionInfo.unblockUpdates();
  }
  if (recoveryExecutor.isShutdown()) {
    tlog.decref();
    throw new RuntimeException("executor is not running...");
  }
  ExecutorCompletionService<RecoveryInfo> cs=new ExecutorCompletionService<RecoveryInfo>(recoveryExecutor);
  LogReplayer replayer=new LogReplayer(Arrays.asList(new TransactionLog[]{tlog}),true);
  return cs.submit(replayer,recoveryInfo);
}
