{
  Set<Node> removeNodes=new HashSet<Node>();
  Set<Node> nodes=deletes.keySet();
  for (  Node node : nodes) {
    List<DeleteRequest> dlist=deletes.get(node);
    if (dlist == null || dlist.size() < limit)     return false;
    UpdateRequestExt ureq=new UpdateRequestExt();
    addCommit(ureq,ccmd);
    ModifiableSolrParams combinedParams=new ModifiableSolrParams();
    for (    DeleteRequest dReq : dlist) {
      DeleteUpdateCommand cmd=dReq.cmd;
      combinedParams.add(dReq.params);
      if (cmd.isDeleteById()) {
        ureq.deleteById(cmd.getId(),cmd.getVersion());
      }
 else {
        ureq.deleteByQuery(cmd.query);
      }
      if (commitParams != null)       combinedParams.add(commitParams);
      if (ureq.getParams() == null)       ureq.setParams(new ModifiableSolrParams());
      ureq.getParams().add(combinedParams);
    }
    removeNodes.add(node);
    submit(ureq,node);
  }
  for (  Node node : removeNodes) {
    deletes.remove(node);
  }
  return true;
}
