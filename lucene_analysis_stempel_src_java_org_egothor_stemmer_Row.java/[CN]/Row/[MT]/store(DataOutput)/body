{
  os.writeInt(cells.size());
  Iterator<Character> i=cells.keySet().iterator();
  for (; i.hasNext(); ) {
    Character c=i.next();
    Cell e=at(c);
    if (e.cmd < 0 && e.ref < 0) {
      continue;
    }
    os.writeChar(c.charValue());
    os.writeInt(e.cmd);
    os.writeInt(e.cnt);
    os.writeInt(e.ref);
    os.writeInt(e.skip);
  }
}
