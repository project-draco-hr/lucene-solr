{
  this.schema=schema;
  this.name="Searcher@" + Integer.toHexString(hashCode()) + (name != null ? " " + name : "");
  log.info("Opening " + this.name);
  reader=r;
  searcher=new IndexSearcher(r);
  this.closeReader=closeReader;
  searcher.setSimilarity(schema.getSimilarity());
  cachingEnabled=enableCache;
  if (cachingEnabled) {
    ArrayList<SolrCache> clist=new ArrayList<SolrCache>();
    filterCache=filterCacheConfig == null ? null : filterCacheConfig.newInstance();
    if (filterCache != null)     clist.add(filterCache);
    queryResultCache=queryResultCacheConfig == null ? null : queryResultCacheConfig.newInstance();
    if (queryResultCache != null)     clist.add(queryResultCache);
    documentCache=documentCacheConfig == null ? null : documentCacheConfig.newInstance();
    if (documentCache != null)     clist.add(documentCache);
    if (userCacheConfigs == null) {
      cacheMap=noGenericCaches;
    }
 else {
      cacheMap=new HashMap<String,SolrCache>(userCacheConfigs.length);
      for (      CacheConfig userCacheConfig : userCacheConfigs) {
        SolrCache cache=null;
        if (userCacheConfig != null)         cache=userCacheConfig.newInstance();
        if (cache != null) {
          cacheMap.put(cache.name(),cache);
          clist.add(cache);
        }
      }
    }
    cacheList=clist.toArray(new SolrCache[clist.size()]);
  }
 else {
    filterCache=null;
    queryResultCache=null;
    documentCache=null;
    cacheMap=noGenericCaches;
    cacheList=noCaches;
  }
}
