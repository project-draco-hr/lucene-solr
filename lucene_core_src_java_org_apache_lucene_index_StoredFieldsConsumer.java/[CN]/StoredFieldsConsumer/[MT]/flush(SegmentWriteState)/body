{
  if (state.numDocs > 0) {
    initFieldsWriter(state.context);
    fill(state.numDocs);
  }
  if (fieldsWriter != null) {
    try {
      fieldsWriter.finish(state.fieldInfos,state.numDocs);
    }
  finally {
      fieldsWriter.close();
      fieldsWriter=null;
      lastDocID=0;
    }
  }
}
