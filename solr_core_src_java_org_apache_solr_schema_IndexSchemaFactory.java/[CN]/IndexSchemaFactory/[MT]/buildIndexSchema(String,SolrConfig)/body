{
  PluginInfo info=config.getPluginInfo(IndexSchemaFactory.class.getName());
  IndexSchemaFactory factory;
  if (null != info) {
    factory=config.getResourceLoader().newInstance(info.className,IndexSchemaFactory.class);
    factory.init(info.initArgs);
  }
 else {
    if (config.luceneMatchVersion.onOrAfter(Version.LUCENE_6_0_0)) {
      factory=new ManagedIndexSchemaFactory();
    }
 else {
      factory=new ClassicIndexSchemaFactory();
    }
  }
  IndexSchema schema=factory.create(resourceName,config);
  return schema;
}
