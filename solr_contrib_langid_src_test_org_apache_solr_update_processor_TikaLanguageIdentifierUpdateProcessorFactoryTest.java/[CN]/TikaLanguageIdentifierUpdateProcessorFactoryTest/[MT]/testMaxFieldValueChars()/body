{
  SolrInputDocument doc=new SolrInputDocument();
  String valueF1="Apache Lucene is a free/open source information retrieval software library, originally created in Java by Doug Cutting. It is supported by the Apache Software Foundation and is released under the Apache Software License.";
  String valueF2="An open-source search server based on the Lucene Java search library. News, documentation, resources, and download.";
  doc.addField("foo_s",valueF1);
  ModifiableSolrParams parameters=new ModifiableSolrParams();
  parameters.add("langid.fl","foo_s");
  parameters.add("langid.langField","language");
  parameters.add("langid.enforceSchema","false");
  TikaLanguageIdentifierUpdateProcessor p=(TikaLanguageIdentifierUpdateProcessor)createLangIdProcessor(parameters);
  assertEquals(valueF1,p.concatFields(doc).trim());
  parameters=new ModifiableSolrParams();
  parameters.add("langid.fl","foo_s");
  parameters.add("langid.langField","language");
  parameters.add("langid.enforceSchema","false");
  parameters.add("langid.maxFieldValueChars","6");
  p=(TikaLanguageIdentifierUpdateProcessor)createLangIdProcessor(parameters);
  assertEquals("Apache",p.concatFields(doc).trim());
  doc.addField("bar_s",valueF2);
  parameters=new ModifiableSolrParams();
  parameters.add("langid.fl","foo_s,bar_s");
  parameters.add("langid.langField","language");
  parameters.add("langid.enforceSchema","false");
  p=(TikaLanguageIdentifierUpdateProcessor)createLangIdProcessor(parameters);
  assertEquals(valueF1 + " " + valueF2,p.concatFields(doc).trim());
  parameters=new ModifiableSolrParams();
  parameters.add("langid.fl","foo_s,bar_s");
  parameters.add("langid.langField","language");
  parameters.add("langid.enforceSchema","false");
  parameters.add("langid.maxFieldValueChars","6");
  p=(TikaLanguageIdentifierUpdateProcessor)createLangIdProcessor(parameters);
  assertEquals("Apache" + " " + "An ope",p.concatFields(doc).trim());
  parameters=new ModifiableSolrParams();
  parameters.add("langid.fl","foo_s,bar_s");
  parameters.add("langid.langField","language");
  parameters.add("langid.enforceSchema","false");
  parameters.add("langid.maxFieldValueChars","100000");
  p=(TikaLanguageIdentifierUpdateProcessor)createLangIdProcessor(parameters);
  assertEquals(valueF1 + " " + valueF2,p.concatFields(doc).trim());
}
