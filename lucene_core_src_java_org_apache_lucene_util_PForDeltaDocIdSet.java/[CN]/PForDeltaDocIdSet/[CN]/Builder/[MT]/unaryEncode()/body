{
  int current=0;
  for (int i=0, doc=-1; i < BLOCK_SIZE; ++i) {
    doc+=1 + buffer[i];
    while (doc >= 8) {
      data.writeByte((byte)current);
      current=0;
      doc-=8;
    }
    current|=1 << doc;
  }
  if (current != 0) {
    data.writeByte((byte)current);
  }
}
