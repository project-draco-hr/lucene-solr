{
  if (doc <= previousDoc) {
    throw new IllegalArgumentException("Doc IDs must be provided in order, but previousDoc=" + previousDoc + " and doc="+ doc);
  }
  buffer[bufferSize++]=doc - previousDoc - 1;
  if (bufferSize == BLOCK_SIZE) {
    encodeBlock();
    bufferSize=0;
  }
  previousDoc=doc;
  ++cardinality;
  return this;
}
