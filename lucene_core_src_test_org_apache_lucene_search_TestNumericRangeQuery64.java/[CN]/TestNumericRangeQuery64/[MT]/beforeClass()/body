{
  noDocs=atLeast(4096);
  distance=(1L << 60) / noDocs;
  directory=newDirectory();
  RandomIndexWriter writer=new RandomIndexWriter(random,directory,newIndexWriterConfig(TEST_VERSION_CURRENT,new MockAnalyzer(random)).setMaxBufferedDocs(_TestUtil.nextInt(random,100,1000)).setMergePolicy(newLogMergePolicy()));
  final FieldType storedLong=NumericField.getFieldType(NumericField.DataType.LONG,true);
  final FieldType storedLong8=new FieldType(storedLong);
  storedLong8.setNumericPrecisionStep(8);
  final FieldType storedLong4=new FieldType(storedLong);
  storedLong4.setNumericPrecisionStep(4);
  final FieldType storedLong6=new FieldType(storedLong);
  storedLong6.setNumericPrecisionStep(6);
  final FieldType storedLong2=new FieldType(storedLong);
  storedLong2.setNumericPrecisionStep(2);
  final FieldType storedLongNone=new FieldType(storedLong);
  storedLongNone.setNumericPrecisionStep(Integer.MAX_VALUE);
  final FieldType unstoredLong=NumericField.getFieldType(NumericField.DataType.LONG,false);
  final FieldType unstoredLong8=new FieldType(unstoredLong);
  unstoredLong8.setNumericPrecisionStep(8);
  final FieldType unstoredLong6=new FieldType(unstoredLong);
  unstoredLong6.setNumericPrecisionStep(6);
  final FieldType unstoredLong4=new FieldType(unstoredLong);
  unstoredLong4.setNumericPrecisionStep(4);
  final FieldType unstoredLong2=new FieldType(unstoredLong);
  unstoredLong2.setNumericPrecisionStep(2);
  NumericField field8=new NumericField("field8",0L,storedLong8), field6=new NumericField("field6",0L,storedLong6), field4=new NumericField("field4",0L,storedLong4), field2=new NumericField("field2",0L,storedLong2), fieldNoTrie=new NumericField("field" + Integer.MAX_VALUE,0L,storedLongNone), ascfield8=new NumericField("ascfield8",0L,unstoredLong8), ascfield6=new NumericField("ascfield6",0L,unstoredLong6), ascfield4=new NumericField("ascfield4",0L,unstoredLong4), ascfield2=new NumericField("ascfield2",0L,unstoredLong2);
  Document doc=new Document();
  doc.add(field8);
  doc.add(field6);
  doc.add(field4);
  doc.add(field2);
  doc.add(fieldNoTrie);
  doc.add(ascfield8);
  doc.add(ascfield6);
  doc.add(ascfield4);
  doc.add(ascfield2);
  for (int l=0; l < noDocs; l++) {
    long val=distance * l + startOffset;
    field8.setValue(val);
    field6.setValue(val);
    field4.setValue(val);
    field2.setValue(val);
    fieldNoTrie.setValue(val);
    val=l - (noDocs / 2);
    ascfield8.setValue(val);
    ascfield6.setValue(val);
    ascfield4.setValue(val);
    ascfield2.setValue(val);
    writer.addDocument(doc);
  }
  reader=writer.getReader();
  searcher=newSearcher(reader);
  writer.close();
}
