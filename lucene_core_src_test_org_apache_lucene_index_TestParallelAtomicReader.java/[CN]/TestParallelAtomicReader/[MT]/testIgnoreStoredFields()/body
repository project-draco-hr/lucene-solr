{
  Directory dir1=getDir1(random());
  Directory dir2=getDir2(random());
  LeafReader ir1=SlowCompositeReaderWrapper.wrap(DirectoryReader.open(dir1));
  LeafReader ir2=SlowCompositeReaderWrapper.wrap(DirectoryReader.open(dir2));
  ParallelLeafReader pr=new ParallelLeafReader(false,new LeafReader[]{ir1,ir2},new LeafReader[]{ir1});
  assertEquals("v1",pr.document(0).get("f1"));
  assertEquals("v1",pr.document(0).get("f2"));
  assertNull(pr.document(0).get("f3"));
  assertNull(pr.document(0).get("f4"));
  assertNotNull(pr.terms("f1"));
  assertNotNull(pr.terms("f2"));
  assertNotNull(pr.terms("f3"));
  assertNotNull(pr.terms("f4"));
  pr.close();
  pr=new ParallelLeafReader(false,new LeafReader[]{ir2},new LeafReader[0]);
  assertNull(pr.document(0).get("f1"));
  assertNull(pr.document(0).get("f2"));
  assertNull(pr.document(0).get("f3"));
  assertNull(pr.document(0).get("f4"));
  assertNull(pr.terms("f1"));
  assertNull(pr.terms("f2"));
  assertNotNull(pr.terms("f3"));
  assertNotNull(pr.terms("f4"));
  pr.close();
  pr=new ParallelLeafReader(true,new LeafReader[]{ir2},new LeafReader[]{ir1});
  assertEquals("v1",pr.document(0).get("f1"));
  assertEquals("v1",pr.document(0).get("f2"));
  assertNull(pr.document(0).get("f3"));
  assertNull(pr.document(0).get("f4"));
  assertNull(pr.terms("f1"));
  assertNull(pr.terms("f2"));
  assertNotNull(pr.terms("f3"));
  assertNotNull(pr.terms("f4"));
  pr.close();
  try {
    new ParallelLeafReader(true,new LeafReader[0],new LeafReader[]{ir1});
    fail("didn't get expected exception: need a non-empty main-reader array");
  }
 catch (  IllegalArgumentException iae) {
  }
  dir1.close();
  dir2.close();
}
