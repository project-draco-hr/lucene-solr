{
  Directory dir1=getDir1(random());
  Directory dir2=getDir2(random());
  AtomicReader ir1=SlowCompositeReaderWrapper.wrap(DirectoryReader.open(dir1));
  AtomicReader ir2=SlowCompositeReaderWrapper.wrap(DirectoryReader.open(dir2));
  ParallelAtomicReader pr=new ParallelAtomicReader(false,new AtomicReader[]{ir1,ir2},new AtomicReader[]{ir1});
  assertEquals("v1",pr.document(0).get("f1"));
  assertEquals("v1",pr.document(0).get("f2"));
  assertNull(pr.document(0).get("f3"));
  assertNull(pr.document(0).get("f4"));
  assertNotNull(pr.terms("f1"));
  assertNotNull(pr.terms("f2"));
  assertNotNull(pr.terms("f3"));
  assertNotNull(pr.terms("f4"));
  pr.close();
  pr=new ParallelAtomicReader(false,new AtomicReader[]{ir2},new AtomicReader[0]);
  assertNull(pr.document(0).get("f1"));
  assertNull(pr.document(0).get("f2"));
  assertNull(pr.document(0).get("f3"));
  assertNull(pr.document(0).get("f4"));
  assertNull(pr.terms("f1"));
  assertNull(pr.terms("f2"));
  assertNotNull(pr.terms("f3"));
  assertNotNull(pr.terms("f4"));
  pr.close();
  pr=new ParallelAtomicReader(true,new AtomicReader[]{ir2},new AtomicReader[]{ir1});
  assertEquals("v1",pr.document(0).get("f1"));
  assertEquals("v1",pr.document(0).get("f2"));
  assertNull(pr.document(0).get("f3"));
  assertNull(pr.document(0).get("f4"));
  assertNull(pr.terms("f1"));
  assertNull(pr.terms("f2"));
  assertNotNull(pr.terms("f3"));
  assertNotNull(pr.terms("f4"));
  pr.close();
  try {
    new ParallelAtomicReader(true,new AtomicReader[0],new AtomicReader[]{ir1});
    fail("didn't get expected exception: need a non-empty main-reader array");
  }
 catch (  IllegalArgumentException iae) {
  }
  dir1.close();
  dir2.close();
}
