{
  this.vs=groupByVS;
  this.context=vsContext;
  this.nGroups=nGroups=Math.max(1,nGroups);
  SortField[] sortFields=sort.getSort();
  this.comparators=new FieldComparator[sortFields.length];
  this.reversed=new int[sortFields.length];
  for (int i=0; i < sortFields.length; i++) {
    SortField sortField=sortFields[i];
    reversed[i]=sortField.getReverse() ? -1 : 1;
    comparators[i]=sortField.getComparator(nGroups + 1,i);
  }
  this.spareSlot=nGroups;
  this.groupMap=new HashMap<MutableValue,SearchGroup>(nGroups);
}
