{
  Comparator<SearchGroup> comparator=new Comparator<SearchGroup>(){
    public int compare(    SearchGroup o1,    SearchGroup o2){
      for (int i=0; ; i++) {
        FieldComparator fc=comparators[i];
        int c=reversed[i] * fc.compare(o1.comparatorSlot,o2.comparatorSlot);
        if (c != 0) {
          return c;
        }
 else         if (i == comparators.length - 1) {
          return o1.topDoc - o2.topDoc;
        }
      }
    }
  }
;
  orderedGroups=new TreeSet<SearchGroup>(comparator);
  orderedGroups.addAll(groupMap.values());
  if (orderedGroups.size() == 0)   return;
  for (  FieldComparator fc : comparators)   fc.setBottom(orderedGroups.last().comparatorSlot);
}
