{
  if (numGroups == 0)   return null;
  int docsToCollect=getMax(groupOffset,docsPerGroup,maxDoc);
  docsToCollect=Math.max(docsToCollect,1);
  if (false && groupBy instanceof StrFieldSource) {
    collector2=new Phase2StringGroupCollector(collector,groupBy,context,groupSort,docsToCollect,needScores,offset);
  }
 else {
    collector2=new Phase2GroupCollector(collector,groupBy,context,groupSort,docsToCollect,needScores,offset);
  }
  return collector2;
}
