{
  int docsToCollect=getMax(groupOffset,docsPerGroup,maxDoc);
  if (docsToCollect < 0 || docsToCollect > maxDoc)   docsToCollect=maxDoc;
  collector2=new Phase2GroupCollector(collector,groupBy,context,groupSort,docsToCollect,needScores,offset);
  return collector2;
}
