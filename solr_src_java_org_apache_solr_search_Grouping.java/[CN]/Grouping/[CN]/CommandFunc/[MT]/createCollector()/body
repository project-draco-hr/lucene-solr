{
  maxGroupToFind=getMax(offset,numGroups,maxDoc);
  if (numGroups == 0)   maxGroupToFind=0;
  if (compareSorts(sort,groupSort)) {
    collector=new TopGroupCollector(groupBy,context,normalizeSort(sort),maxGroupToFind);
  }
 else {
    collector=new TopGroupSortCollector(groupBy,context,normalizeSort(sort),normalizeSort(groupSort),maxGroupToFind);
  }
  return collector;
}
