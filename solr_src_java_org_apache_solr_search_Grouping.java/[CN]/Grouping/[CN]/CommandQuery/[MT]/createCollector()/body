{
  int docsToCollect=getMax(groupOffset,docsPerGroup,maxDoc);
  DocSet groupFilt=searcher.getDocSet(query);
  topCollector=newCollector(groupSort,docsToCollect,false,needScores);
  collector=new FilterCollector(groupFilt,topCollector);
  return collector;
}
