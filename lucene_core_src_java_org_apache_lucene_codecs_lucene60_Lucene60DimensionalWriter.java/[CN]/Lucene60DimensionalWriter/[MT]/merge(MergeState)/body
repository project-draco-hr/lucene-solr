{
  for (  DimensionalReader reader : mergeState.dimensionalReaders) {
    if (reader instanceof Lucene60DimensionalReader == false) {
      super.merge(mergeState);
      return;
    }
  }
  for (  FieldInfo fieldInfo : mergeState.mergeFieldInfos) {
    if (fieldInfo.getDimensionCount() != 0) {
      if (fieldInfo.getDimensionCount() == 1) {
        try (BKDWriter writer=new BKDWriter(writeState.directory,writeState.segmentInfo.name,fieldInfo.getDimensionCount(),fieldInfo.getDimensionNumBytes(),maxPointsInLeafNode,maxMBSortInHeap)){
          List<BKDReader> bkdReaders=new ArrayList<>();
          List<MergeState.DocMap> docMaps=new ArrayList<>();
          List<Integer> docIDBases=new ArrayList<>();
          for (int i=0; i < mergeState.dimensionalReaders.length; i++) {
            DimensionalReader reader=mergeState.dimensionalReaders[i];
            Lucene60DimensionalReader reader60=(Lucene60DimensionalReader)reader;
            if (reader60 != null) {
              FieldInfos readerFieldInfos=mergeState.fieldInfos[i];
              FieldInfo readerFieldInfo=readerFieldInfos.fieldInfo(fieldInfo.name);
              if (readerFieldInfo != null) {
                BKDReader bkdReader=reader60.readers.get(readerFieldInfo.number);
                if (bkdReader != null) {
                  docIDBases.add(mergeState.docBase[i]);
                  bkdReaders.add(bkdReader);
                  docMaps.add(mergeState.docMaps[i]);
                }
              }
            }
          }
          indexFPs.put(fieldInfo.name,writer.merge(dataOut,docMaps,bkdReaders,docIDBases));
        }
       }
 else {
        mergeOneField(mergeState,fieldInfo);
      }
    }
  }
}
