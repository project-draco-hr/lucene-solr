{
  try (BKDWriter writer=new BKDWriter(writeState.directory,writeState.segmentInfo.name,fieldInfo.getDimensionCount(),fieldInfo.getDimensionNumBytes(),maxPointsInLeafNode,maxMBSortInHeap)){
    values.intersect(fieldInfo.name,new IntersectVisitor(){
      @Override public void visit(      int docID){
        throw new IllegalStateException();
      }
      public void visit(      int docID,      byte[] packedValue) throws IOException {
        writer.add(packedValue,docID);
      }
      @Override public Relation compare(      byte[] minPackedValue,      byte[] maxPackedValue){
        return Relation.QUERY_CROSSES_CELL;
      }
    }
);
    indexFPs.put(fieldInfo.name,writer.finish(dataOut));
  }
 }
