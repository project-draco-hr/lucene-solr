{
  List<Fieldable> fields=doc.getFields();
  Analyzer analyzer=getRunData().getAnalyzer();
  int tokenCount=0;
  for (  final Fieldable field : fields) {
    if (!field.isTokenized())     continue;
    final TokenStream stream;
    final TokenStream streamValue=field.tokenStreamValue();
    if (streamValue != null)     stream=streamValue;
 else {
      final Reader reader;
      final Reader readerValue=field.readerValue();
      if (readerValue != null)       reader=readerValue;
 else {
        String stringValue=field.stringValue();
        if (stringValue == null)         throw new IllegalArgumentException("field must have either TokenStream, String or Reader value");
        stringReader.init(stringValue);
        reader=stringReader;
      }
      stream=analyzer.reusableTokenStream(field.name(),reader);
    }
    stream.reset();
    while (stream.incrementToken())     tokenCount++;
  }
  totalTokenCount+=tokenCount;
  return tokenCount;
}
