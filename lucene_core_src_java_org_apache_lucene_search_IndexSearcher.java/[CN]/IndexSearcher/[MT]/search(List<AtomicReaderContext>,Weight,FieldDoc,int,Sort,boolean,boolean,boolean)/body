{
  int limit=reader.maxDoc();
  if (limit == 0) {
    limit=1;
  }
  nDocs=Math.min(nDocs,limit);
  TopFieldCollector collector=TopFieldCollector.create(sort,nDocs,after,fillFields,doDocScores,doMaxScore,!weight.scoresDocsOutOfOrder());
  search(leaves,weight,collector);
  return (TopFieldDocs)collector.topDocs();
}
