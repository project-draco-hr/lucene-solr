{
  final CollectorManager<TotalHitCountCollector,Integer> collectorManager=new CollectorManager<TotalHitCountCollector,Integer>(){
    @Override public TotalHitCountCollector newCollector() throws IOException {
      return new TotalHitCountCollector();
    }
    @Override public Integer reduce(    Collection<TotalHitCountCollector> collectors) throws IOException {
      int total=0;
      for (      TotalHitCountCollector collector : collectors) {
        total+=collector.getTotalHits();
      }
      return total;
    }
  }
;
  return search(query,collectorManager);
}
