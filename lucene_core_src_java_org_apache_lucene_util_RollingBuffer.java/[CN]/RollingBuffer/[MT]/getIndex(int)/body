{
  int index=nextWrite - (nextPos - pos);
  if (index < 0) {
    index+=buffer.length;
  }
  return index;
}
