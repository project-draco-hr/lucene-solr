{
  FacetIndexingParams fip=fipPerPartitionSize.get(partSize);
  if (fip == null) {
    CategoryListParams randomOP=new CategoryListParams(){
      final OrdinalPolicy op=random().nextBoolean() ? OrdinalPolicy.ALL_BUT_DIMENSION : OrdinalPolicy.ALL_PARENTS;
      @Override public OrdinalPolicy getOrdinalPolicy(      String dimension){
        return forceAllParents ? OrdinalPolicy.ALL_PARENTS : op;
      }
    }
;
    fip=new FacetIndexingParams(randomOP){
      @Override public int getPartitionSize(){
        return partSize;
      }
    }
;
    fipPerPartitionSize.put(partSize,fip);
  }
  return fip;
}
