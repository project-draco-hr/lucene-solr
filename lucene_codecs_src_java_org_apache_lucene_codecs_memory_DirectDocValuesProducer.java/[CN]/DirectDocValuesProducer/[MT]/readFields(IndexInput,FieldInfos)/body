{
  int numEntries=0;
  int fieldNumber=meta.readVInt();
  while (fieldNumber != -1) {
    numEntries++;
    FieldInfo info=infos.fieldInfo(fieldNumber);
    int fieldType=meta.readByte();
    if (fieldType == NUMBER) {
      numerics.put(info.name,readNumericEntry(meta));
    }
 else     if (fieldType == BYTES) {
      binaries.put(info.name,readBinaryEntry(meta));
    }
 else     if (fieldType == SORTED) {
      SortedEntry entry=readSortedEntry(meta);
      sorteds.put(info.name,entry);
      binaries.put(info.name,entry.values);
    }
 else     if (fieldType == SORTED_SET) {
      SortedSetEntry entry=readSortedSetEntry(meta,false);
      sortedSets.put(info.name,entry);
      binaries.put(info.name,entry.values);
    }
 else     if (fieldType == SORTED_SET_SINGLETON) {
      SortedSetEntry entry=readSortedSetEntry(meta,true);
      sortedSets.put(info.name,entry);
      binaries.put(info.name,entry.values);
    }
 else     if (fieldType == SORTED_NUMERIC) {
      SortedNumericEntry entry=readSortedNumericEntry(meta,false);
      sortedNumerics.put(info.name,entry);
    }
 else     if (fieldType == SORTED_NUMERIC_SINGLETON) {
      SortedNumericEntry entry=readSortedNumericEntry(meta,true);
      sortedNumerics.put(info.name,entry);
    }
 else {
      throw new CorruptIndexException("invalid entry type: " + fieldType + ", field= "+ info.name+ ", input="+ meta);
    }
    fieldNumber=meta.readVInt();
  }
  return numEntries;
}
