{
  Directory d1=newDirectory();
  RandomIndexWriter w=new RandomIndexWriter(random(),d1);
  MultiReader empty=new MultiReader();
  w.addIndexes(empty);
  w.shutdown();
  DirectoryReader dr=DirectoryReader.open(d1);
  for (  AtomicReaderContext ctx : dr.leaves()) {
    assertTrue("empty segments should be dropped by addIndexes",ctx.reader().maxDoc() > 0);
  }
  dr.close();
  d1.close();
}
