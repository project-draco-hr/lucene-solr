{
  Directory src=newDirectory();
  RandomIndexWriter w1=new RandomIndexWriter(random(),src);
  w1.addDocument(new Document());
  w1.commit();
  Directory dest=newDirectory();
  IndexWriterConfig iwc=newIndexWriterConfig(TEST_VERSION_CURRENT,new MockAnalyzer(random()));
  iwc.setWriteLockTimeout(1);
  RandomIndexWriter w2=new RandomIndexWriter(random(),dest,iwc);
  try {
    w2.addIndexes(src);
    fail("did not hit expected exception");
  }
 catch (  LockObtainFailedException lofe) {
  }
  IOUtils.close(w1,w2,src,dest);
}
