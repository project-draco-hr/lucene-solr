{
  Directory dir=newDirectory();
  Directory aux=newDirectory();
  setUpDirs(dir,aux);
  IndexWriter writer=newWriter(dir,newIndexWriterConfig(new MockAnalyzer(random())).setOpenMode(OpenMode.APPEND).setMaxBufferedDocs(10).setMergePolicy(newLogMergePolicy(4)));
  addDocs(writer,10);
  writer.addIndexes(aux);
  assertEquals(1040,writer.maxDoc());
  assertEquals(1000,writer.maxDoc(0));
  writer.close();
  verifyNumDocs(dir,1040);
  dir.close();
  aux.close();
}
