{
  DuplicateFilter df=new DuplicateFilter(KEY_FIELD);
  HashSet<String> results=new HashSet<>();
  Query query=new BooleanQuery.Builder().add(tq,Occur.MUST).add(df,Occur.FILTER).build();
  ScoreDoc[] hits=searcher.search(query,1000).scoreDocs;
  for (  ScoreDoc hit : hits) {
    StoredDocument d=searcher.doc(hit.doc);
    String url=d.get(KEY_FIELD);
    assertFalse("No duplicate urls should be returned",results.contains(url));
    results.add(url);
  }
}
