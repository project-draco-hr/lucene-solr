{
  ClusterState clusterState=cloudClient.getZkStateReader().getClusterState();
  Slice slice1=clusterState.getSlice(AbstractDistribZkTestBase.DEFAULT_COLLECTION,SHARD1);
  Slice slice2=clusterState.getSlice(AbstractDistribZkTestBase.DEFAULT_COLLECTION,SHARD2);
  assertNotNull("Shard1 not found",slice1);
  assertNotNull("Shard2 not found",slice2);
  assertEquals("Shard1 is not active",Slice.ACTIVE,slice1.getState());
  assertEquals("Shard2 is not active",Slice.ACTIVE,slice2.getState());
  try {
    deleteShard(SHARD1);
    fail("Deleting an active shard should not have succeeded");
  }
 catch (  HttpSolrClient.RemoteSolrException e) {
  }
  setSliceState(SHARD1,Slice.INACTIVE);
  clusterState=cloudClient.getZkStateReader().getClusterState();
  slice1=clusterState.getSlice(AbstractDistribZkTestBase.DEFAULT_COLLECTION,SHARD1);
  assertEquals("Shard1 is not inactive yet.",Slice.INACTIVE,slice1.getState());
  deleteShard(SHARD1);
  confirmShardDeletion(SHARD1);
  setSliceState(SHARD2,Slice.CONSTRUCTION);
  deleteShard(SHARD2);
  confirmShardDeletion(SHARD2);
}
