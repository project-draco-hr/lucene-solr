{
  String field="field" + variant.TRIE_BITS;
  int count=3000;
  long upper=(count - 1) * distance + 1234L;
  TrieRangeQuery q=new TrieRangeQuery(field,null,new Long(upper),variant);
  TopDocs topDocs=searcher.search(q,null,10000,Sort.INDEXORDER);
  System.out.println("Found " + q.getLastNumberOfTerms() + " distinct terms in left open range for field '"+ field+ "'.");
  ScoreDoc[] sd=topDocs.scoreDocs;
  assertNotNull(sd);
  assertEquals("Score docs must match " + count + " docs, found "+ sd.length+ " docs",sd.length,count);
  Document doc=searcher.doc(sd[0].doc);
  assertEquals("First doc should be 0",variant.trieCodedToLong(doc.get(field)),0L);
  doc=searcher.doc(sd[sd.length - 1].doc);
  assertEquals("Last doc should be " + ((count - 1) * distance),variant.trieCodedToLong(doc.get(field)),(count - 1) * distance);
}
