{
  SolrServer server=getSolrServer();
  server.deleteByQuery("*:*");
  server.commit();
  QueryResponse rsp=server.query(new SolrQuery("*:*"));
  Assert.assertEquals(0,rsp.getResults().getNumFound());
  ContentStreamUpdateRequest up=new ContentStreamUpdateRequest("/update/csv");
  up.addFile(new File("books.csv"));
  up.setAction(AbstractUpdateRequest.ACTION.COMMIT,true,true);
  NamedList<Object> result=server.request(up);
  assertNotNull("Couldn't upload books.csv",result);
  rsp=server.query(new SolrQuery("*:*"));
  Assert.assertEquals(10,rsp.getResults().getNumFound());
  server.deleteByQuery("*:*");
  server.commit();
  rsp=server.query(new SolrQuery("*:*"));
  Assert.assertEquals(0,rsp.getResults().getNumFound());
  up=new ContentStreamUpdateRequest("/update/extract");
  up.addFile(new File("mailing_lists.pdf"));
  up.setParam("literal.id","mailing_lists.pdf");
  up.setAction(AbstractUpdateRequest.ACTION.COMMIT,true,true);
  result=server.request(up);
  assertNotNull("Couldn't upload mailing_lists.pdf",result);
  rsp=server.query(new SolrQuery("*:*"));
  Assert.assertEquals(1,rsp.getResults().getNumFound());
}
