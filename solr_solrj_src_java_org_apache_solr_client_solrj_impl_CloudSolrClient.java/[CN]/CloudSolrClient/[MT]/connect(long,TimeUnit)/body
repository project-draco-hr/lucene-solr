{
  log.info("Waiting for {} {} for cluster at {} to be ready",duration,timeUnit,zkHost);
  long timeout=System.nanoTime() + timeUnit.toNanos(duration);
  while (System.nanoTime() < timeout) {
    try {
      connect();
      log.info("Cluster at {} ready",zkHost);
      return;
    }
 catch (    RuntimeException e) {
    }
    TimeUnit.MILLISECONDS.sleep(250);
  }
  throw new TimeoutException("Timed out waiting for cluster");
}
