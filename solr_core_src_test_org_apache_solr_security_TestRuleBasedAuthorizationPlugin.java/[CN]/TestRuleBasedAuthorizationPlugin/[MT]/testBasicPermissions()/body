{
  int STATUS_OK=200;
  int FORBIDDEN=403;
  int PROMPT_FOR_CREDENTIALS=401;
  checkRules(makeMap("resource","/update/json/docs","httpMethod","POST","userPrincipal","tim","collectionRequests",singletonList(new CollectionRequest("mycoll"))),STATUS_OK);
  checkRules(makeMap("resource","/update/json/docs","httpMethod","POST","collectionRequests",singletonList(new CollectionRequest("mycoll"))),PROMPT_FOR_CREDENTIALS);
  checkRules(makeMap("resource","/schema","userPrincipal","somebody","collectionRequests",singletonList(new CollectionRequest("mycoll")),"httpMethod","POST"),FORBIDDEN);
  checkRules(makeMap("resource","/schema","userPrincipal","somebody","collectionRequests",singletonList(new CollectionRequest("mycoll")),"httpMethod","GET"),STATUS_OK);
  checkRules(makeMap("resource","/schema/fields","userPrincipal","somebody","collectionRequests",singletonList(new CollectionRequest("mycoll")),"httpMethod","GET"),STATUS_OK);
  checkRules(makeMap("resource","/schema","userPrincipal","somebody","collectionRequests",singletonList(new CollectionRequest("mycoll")),"httpMethod","POST"),FORBIDDEN);
  checkRules(makeMap("resource","/admin/collections","userPrincipal","tim","requestType",AuthorizationContext.RequestType.ADMIN,"collectionRequests",null,"httpMethod","GET","params",new MapSolrParams(singletonMap("action","LIST"))),STATUS_OK);
  checkRules(makeMap("resource","/admin/collections","userPrincipal",null,"requestType",AuthorizationContext.RequestType.ADMIN,"collectionRequests",null,"httpMethod","GET","params",new MapSolrParams(singletonMap("action","LIST"))),STATUS_OK);
  checkRules(makeMap("resource","/admin/collections","userPrincipal",null,"requestType",AuthorizationContext.RequestType.ADMIN,"collectionRequests",null,"params",new MapSolrParams(singletonMap("action","CREATE"))),PROMPT_FOR_CREDENTIALS);
  checkRules(makeMap("resource","/admin/collections","userPrincipal",null,"requestType",AuthorizationContext.RequestType.ADMIN,"collectionRequests",null,"params",new MapSolrParams(singletonMap("action","RELOAD"))),PROMPT_FOR_CREDENTIALS);
  checkRules(makeMap("resource","/admin/collections","userPrincipal","somebody","requestType",AuthorizationContext.RequestType.ADMIN,"collectionRequests",null,"params",new MapSolrParams(singletonMap("action","CREATE"))),FORBIDDEN);
  checkRules(makeMap("resource","/admin/collections","userPrincipal","tim","requestType",AuthorizationContext.RequestType.ADMIN,"collectionRequests",null,"params",new MapSolrParams(singletonMap("action","CREATE"))),STATUS_OK);
  checkRules(makeMap("resource","/select","httpMethod","GET","collectionRequests",singletonList(new CollectionRequest("mycoll")),"userPrincipal","joe"),FORBIDDEN);
}
