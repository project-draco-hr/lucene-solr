{
  final String indexStreamFN=IndexFileNames.segmentFileName(segment,"",IndexFileNames.FIELDS_INDEX_EXTENSION);
  IndexInput idxStream=dir.openInput(indexStreamFN,IOContext.DEFAULT);
  try {
    int format=idxStream.readInt();
    if (format < FieldsWriter.FORMAT_MINIMUM)     throw new IndexFormatTooOldException(indexStreamFN,format,FieldsWriter.FORMAT_MINIMUM,FieldsWriter.FORMAT_CURRENT);
    if (format > FieldsWriter.FORMAT_CURRENT)     throw new IndexFormatTooNewException(indexStreamFN,format,FieldsWriter.FORMAT_MINIMUM,FieldsWriter.FORMAT_CURRENT);
  }
  finally {
    idxStream.close();
  }
}
