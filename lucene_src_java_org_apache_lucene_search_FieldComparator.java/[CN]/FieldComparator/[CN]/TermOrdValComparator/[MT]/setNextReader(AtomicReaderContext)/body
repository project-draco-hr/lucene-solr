{
  final int docBase=context.docBase;
  termsIndex=FieldCache.DEFAULT.getTermsIndex(context.reader,field);
  final PackedInts.Reader docToOrd=termsIndex.getDocToOrd();
  FieldComparator perSegComp;
  if (docToOrd instanceof Direct8) {
    perSegComp=new ByteOrdComparator(((Direct8)docToOrd).getArray(),termsIndex,docBase);
  }
 else   if (docToOrd instanceof Direct16) {
    perSegComp=new ShortOrdComparator(((Direct16)docToOrd).getArray(),termsIndex,docBase);
  }
 else   if (docToOrd instanceof Direct32) {
    perSegComp=new IntOrdComparator(((Direct32)docToOrd).getArray(),termsIndex,docBase);
  }
 else {
    perSegComp=new AnyOrdComparator(docToOrd,termsIndex,docBase);
  }
  currentReaderGen++;
  if (bottomSlot != -1) {
    perSegComp.setBottom(bottomSlot);
  }
  return perSegComp;
}
