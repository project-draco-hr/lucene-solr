{
  boolean success=false;
  try {
    int numDefaultsToAppend=docCount - (lastDocId + 1);
    if (datOut == null) {
      initDataOut();
      for (int i=0; i <= lastDocId; i++) {
        datOut.writeLong(values[i]);
      }
    }
    fillDefault(numDefaultsToAppend);
    success=true;
  }
  finally {
    bytesUsed.addAndGet(-(RamUsageEstimator.NUM_BYTES_LONG * ((values.length))));
    values=null;
    IOUtils.closeSafely(!success,datOut);
  }
}
