{
  boolean success=false;
  try {
    int numDefaultsToAppend=docCount - (lastDocId + 1);
    if (datOut == null) {
      initDataOut();
      for (int i=0; i <= lastDocId; i++) {
        datOut.writeInt(values[i]);
      }
    }
    fillDefault(numDefaultsToAppend);
    success=true;
  }
  finally {
    bytesUsed.addAndGet(-(RamUsageEstimator.NUM_BYTES_INT * ((values.length))));
    values=null;
    if (success) {
      IOUtils.close(datOut);
    }
 else {
      IOUtils.closeWhileHandlingException(datOut);
    }
  }
}
