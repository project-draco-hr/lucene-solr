{
  Path indexDir=buildIndex();
  FSDirectory dir=new SimpleFSDirectory(indexDir);
  MockDirectoryWrapper ramDir=new MockDirectoryWrapper(random(),new RAMDirectory(dir,newIOContext(random())));
  dir.close();
  assertEquals(ramDir.sizeInBytes(),ramDir.getRecomputedSizeInBytes());
  IndexReader reader=DirectoryReader.open(ramDir);
  assertEquals(docsToAdd,reader.numDocs());
  IndexSearcher searcher=newSearcher(reader);
  for (int i=0; i < docsToAdd; i++) {
    Document doc=searcher.doc(i);
    assertTrue(doc.getField("content") != null);
  }
  reader.close();
}
