{
  SortField fields[]=sort.getSort();
  final int reverseMul[]=new int[fields.length];
  final FieldComparator<?> comparators[]=new FieldComparator[fields.length];
  for (int i=0; i < fields.length; i++) {
    reverseMul[i]=fields[i].getReverse() ? -1 : 1;
    comparators[i]=fields[i].getComparator(2,i);
    comparators[i].setNextReader(reader.getContext());
    comparators[i].setScorer(FAKESCORER);
  }
  final DocComparator comparator=new DocComparator(){
    @Override public int compare(    int docID1,    int docID2){
      try {
        for (int i=0; i < comparators.length; i++) {
          comparators[i].copy(0,docID1);
          comparators[i].copy(1,docID2);
          int comp=reverseMul[i] * comparators[i].compare(0,1);
          if (comp != 0) {
            return comp;
          }
        }
        return Integer.compare(docID1,docID2);
      }
 catch (      IOException e) {
        throw new RuntimeException(e);
      }
    }
  }
;
  return sort(reader.maxDoc(),comparator);
}
