{
  if (val instanceof SimpleOrderedMap) {
    super.writeNamedList(name,val);
    return;
  }
  final int sz=val.size();
  indent();
  writeArrayOpener(sz);
  incLevel();
  boolean first=true;
  for (int i=0; i < sz; i++) {
    if (first) {
      first=false;
    }
 else {
      writeArraySeparator();
    }
    indent();
    final String elementName=val.getName(i);
    final Object elementVal=val.getVal(i);
    writeMapOpener(-1);
    if (elementName != null) {
      writeKey("name",false);
      writeVal("name",elementName);
      writeMapSeparator();
    }
    writeTypeAsKey=true;
    writeVal(null,elementVal);
    if (writeTypeAsKey) {
      throw new RuntimeException("writeTypeAsKey should have been reset to false by writeVal('" + elementName + "','"+ elementVal+ "')");
    }
    writeMapCloser();
  }
  decLevel();
  writeArrayCloser();
}
