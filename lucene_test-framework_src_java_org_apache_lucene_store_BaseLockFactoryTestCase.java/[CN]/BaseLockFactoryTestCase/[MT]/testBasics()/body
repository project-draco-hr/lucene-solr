{
  Directory dir=getDirectory(createTempDir());
  Lock l=dir.obtainLock("commit");
  try {
    dir.obtainLock("commit");
    fail("succeeded in obtaining lock twice, didn't get exception");
  }
 catch (  LockObtainFailedException expected) {
  }
  l.close();
  l=dir.obtainLock("commit");
  l.close();
  dir.close();
}
