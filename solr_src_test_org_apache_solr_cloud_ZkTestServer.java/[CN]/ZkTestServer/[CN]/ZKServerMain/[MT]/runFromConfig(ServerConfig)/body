{
  try {
    zooKeeperServer=new ZooKeeperServer();
    FileTxnSnapLog ftxn=new FileTxnSnapLog(new File(config.getDataLogDir()),new File(config.getDataDir()));
    zooKeeperServer.setTxnLogFactory(ftxn);
    zooKeeperServer.setTickTime(config.getTickTime());
    cnxnFactory=new NIOServerCnxn.Factory(config.getClientPortAddress(),config.getMaxClientCnxns());
    cnxnFactory.startup(zooKeeperServer);
    cnxnFactory.join();
    if (zooKeeperServer.isRunning()) {
      zooKeeperServer.shutdown();
    }
  }
 catch (  InterruptedException e) {
  }
}
