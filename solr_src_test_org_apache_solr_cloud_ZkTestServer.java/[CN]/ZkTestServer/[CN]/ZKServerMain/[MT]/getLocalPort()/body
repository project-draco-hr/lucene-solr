{
  if (cnxnFactory == null) {
    throw new IllegalStateException("A port has not yet been selected");
  }
  int port=cnxnFactory.getLocalPort();
  if (port == 0) {
    throw new IllegalStateException("A port has not yet been selected");
  }
  return port;
}
