{
  super();
  final String codecIdAsString=state.codecIdAsString();
  final String docFileName=IndexFileNames.segmentFileName(state.segmentName,codecIdAsString,DOC_EXTENSION);
  docOut=factory.createOutput(state.directory,docFileName);
  docIndex=docOut.index();
  if (state.fieldInfos.hasProx()) {
    final String frqFileName=IndexFileNames.segmentFileName(state.segmentName,codecIdAsString,FREQ_EXTENSION);
    freqOut=factory.createOutput(state.directory,frqFileName);
    freqIndex=freqOut.index();
    final String posFileName=IndexFileNames.segmentFileName(state.segmentName,codecIdAsString,POS_EXTENSION);
    posOut=factory.createOutput(state.directory,posFileName);
    posIndex=posOut.index();
    final String payloadFileName=IndexFileNames.segmentFileName(state.segmentName,codecIdAsString,PAYLOAD_EXTENSION);
    payloadOut=state.directory.createOutput(payloadFileName);
  }
 else {
    freqOut=null;
    freqIndex=null;
    posOut=null;
    posIndex=null;
    payloadOut=null;
  }
  final String skipFileName=IndexFileNames.segmentFileName(state.segmentName,codecIdAsString,SKIP_EXTENSION);
  skipOut=state.directory.createOutput(skipFileName);
  totalNumDocs=state.numDocs;
  skipListWriter=new SepSkipListWriter(skipInterval,maxSkipLevels,state.numDocs,freqOut,docOut,posOut,payloadOut);
}
