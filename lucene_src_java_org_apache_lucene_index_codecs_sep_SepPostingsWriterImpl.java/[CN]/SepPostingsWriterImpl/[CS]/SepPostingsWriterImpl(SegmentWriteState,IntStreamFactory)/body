{
  super();
  final String docFileName=IndexFileNames.segmentFileName(state.segmentName,"",SepCodec.DOC_EXTENSION);
  state.flushedFiles.add(docFileName);
  docOut=factory.createOutput(state.directory,docFileName);
  docIndex=docOut.index();
  if (state.fieldInfos.hasProx()) {
    final String frqFileName=IndexFileNames.segmentFileName(state.segmentName,"",SepCodec.FREQ_EXTENSION);
    state.flushedFiles.add(frqFileName);
    freqOut=factory.createOutput(state.directory,frqFileName);
    freqIndex=freqOut.index();
    final String posFileName=IndexFileNames.segmentFileName(state.segmentName,"",SepCodec.POS_EXTENSION);
    posOut=factory.createOutput(state.directory,posFileName);
    state.flushedFiles.add(posFileName);
    posIndex=posOut.index();
    final String payloadFileName=IndexFileNames.segmentFileName(state.segmentName,"",SepCodec.PAYLOAD_EXTENSION);
    state.flushedFiles.add(payloadFileName);
    payloadOut=state.directory.createOutput(payloadFileName);
  }
 else {
    freqOut=null;
    freqIndex=null;
    posOut=null;
    posIndex=null;
    payloadOut=null;
  }
  final String skipFileName=IndexFileNames.segmentFileName(state.segmentName,"",SepCodec.SKIP_EXTENSION);
  state.flushedFiles.add(skipFileName);
  skipOut=state.directory.createOutput(skipFileName);
  totalNumDocs=state.numDocs;
  skipListWriter=new SepSkipListWriter(state.skipInterval,state.maxSkipLevels,state.numDocs,freqOut,docOut,posOut,payloadOut);
  skipInterval=state.skipInterval;
  maxSkipLevels=state.maxSkipLevels;
}
