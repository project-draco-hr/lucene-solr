{
  if (firstDoc) {
    if (!omitTF) {
      freqIndex.write(docOut,true);
      posIndex.write(docOut,true);
      docOut.writeVLong(payloadStart);
    }
    docOut.writeVLong(skipOut.getFilePointer());
    firstDoc=false;
  }
  final int delta=docID - lastDocID;
  if (docID < 0 || (df > 0 && delta <= 0)) {
    throw new CorruptIndexException("docs out of order (" + docID + " <= "+ lastDocID+ " )");
  }
  if ((++df % skipInterval) == 0) {
    skipListWriter.setSkipData(lastDocID,storePayloads,lastPayloadLength);
    skipListWriter.bufferSkip(df);
  }
  lastDocID=docID;
  docOut.write(delta);
  if (!omitTF) {
    freqOut.write(termDocFreq);
  }
}
