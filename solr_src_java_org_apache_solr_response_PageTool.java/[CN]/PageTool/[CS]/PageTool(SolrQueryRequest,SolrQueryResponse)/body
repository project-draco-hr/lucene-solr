{
  String rows=request.getParams().get("rows");
  if (rows != null) {
    results_per_page=new Integer(rows);
  }
  Object docs=response.getValues().get("response");
  if (docs != null) {
    if (docs instanceof DocSlice) {
      DocSlice doc_slice=(DocSlice)docs;
      results_found=doc_slice.matches();
      start=doc_slice.offset();
    }
 else     if (docs instanceof ResultContext) {
      DocList dl=((ResultContext)docs).docs;
      results_found=dl.matches();
      start=dl.offset();
    }
 else     if (docs instanceof SolrDocumentList) {
      SolrDocumentList doc_list=(SolrDocumentList)docs;
      results_found=doc_list.getNumFound();
      start=doc_list.getStart();
    }
 else {
      throw new SolrException(SolrException.ErrorCode.UNKNOWN,"Unknown response type " + docs + ". Expected one of DocSlice, ResultContext or SolrDocumentList");
    }
  }
  page_count=(int)Math.ceil(results_found / (double)results_per_page);
  current_page_number=(int)Math.ceil(start / (double)results_per_page) + (page_count > 0 ? 1 : 0);
}
