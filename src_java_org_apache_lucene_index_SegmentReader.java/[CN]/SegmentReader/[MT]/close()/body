{
  if (deletedDocsDirty) {
synchronized (directory) {
      deletedDocs.write(directory,segment + ".tmp");
      directory.renameFile(segment + ".tmp",segment + ".del");
    }
    deletedDocsDirty=false;
  }
  fieldsReader.close();
  tis.close();
  if (freqStream != null)   freqStream.close();
  if (proxStream != null)   proxStream.close();
  closeNorms();
  if (closeDirectory)   directory.close();
}
