{
  if (deletedDocs == null) {
    deletedDocs=new BitVector(maxDoc());
    deletedDocsRef=new Ref();
  }
  if (deletedDocsRef.refCount() > 1) {
    Ref oldRef=deletedDocsRef;
    deletedDocs=cloneDeletedDocs(deletedDocs);
    deletedDocsRef=new Ref();
    oldRef.decRef();
  }
  deletedDocsDirty=true;
  undeleteAll=false;
  if (!deletedDocs.getAndSet(docNum))   pendingDeleteCount++;
}
