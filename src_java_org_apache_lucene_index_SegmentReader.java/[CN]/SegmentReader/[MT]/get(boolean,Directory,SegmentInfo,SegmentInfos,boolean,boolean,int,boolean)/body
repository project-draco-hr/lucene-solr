{
  SegmentReader instance;
  try {
    if (readOnly)     instance=(SegmentReader)READONLY_IMPL.newInstance();
 else     instance=(SegmentReader)IMPL.newInstance();
  }
 catch (  Exception e) {
    throw new RuntimeException("cannot load SegmentReader class: " + e,e);
  }
  instance.init(dir,sis,closeDir,readOnly);
  instance.initialize(si,readBufferSize,doOpenStores);
  return instance;
}
