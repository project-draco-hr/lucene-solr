{
  long nextNormSeek=SegmentMerger.NORMS_HEADER.length;
  int maxDoc=maxDoc();
  for (int i=0; i < fieldInfos.size(); i++) {
    FieldInfo fi=fieldInfos.fieldInfo(i);
    if (fi.isIndexed && !fi.omitNorms) {
      Directory d=directory();
      String fileName=si.getNormFileName(fi.number);
      if (!si.hasSeparateNorms(fi.number)) {
        d=cfsDir;
      }
      long normSeek=(fileName.endsWith("." + IndexFileNames.NORMS_EXTENSION) ? nextNormSeek : 0);
      norms.put(fi.name,new Norm(d.openInput(fileName),fi.number,normSeek));
      nextNormSeek+=maxDoc;
    }
  }
}
