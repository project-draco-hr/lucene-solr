{
  List<String> result=new ArrayList<String>(args.size() / 2);
  final String err="init arg '" + key + "' must be a string "+ "(ie: 'str'), or an array (ie: 'arr') containing strings; found: ";
  for (Object o=args.remove(key); null != o; o=args.remove(key)) {
    if (o instanceof String) {
      result.add((String)o);
      continue;
    }
    if (o instanceof Object[]) {
      o=Arrays.asList((Object[])o);
    }
    if (o instanceof Collection) {
      for (      Object item : (Collection)o) {
        if (!(item instanceof String)) {
          throw new SolrException(SERVER_ERROR,err + item.getClass());
        }
        result.add((String)item);
      }
      continue;
    }
    throw new SolrException(SERVER_ERROR,err + o.getClass());
  }
  return result;
}
