{
  if (files == null) {
    return -1;
  }
  long max=-1;
  int prefixLen=IndexFileNames.SEGMENTS.length() + 1;
  for (int i=0; i < files.length; i++) {
    String file=files[i];
    if (file.startsWith(IndexFileNames.SEGMENTS) && !file.equals(IndexFileNames.SEGMENTS_GEN)) {
      if (file.equals(IndexFileNames.SEGMENTS)) {
        if (max == -1) {
          max=0;
        }
      }
 else {
        long v=Long.parseLong(file.substring(prefixLen),Character.MAX_RADIX);
        if (v > max) {
          max=v;
        }
      }
    }
  }
  return max;
}
