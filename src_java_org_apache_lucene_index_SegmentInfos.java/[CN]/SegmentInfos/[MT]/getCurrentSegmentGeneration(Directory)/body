{
  String[] files=directory.list();
  if (files == null)   throw new IOException("Cannot read directory " + directory);
  return getCurrentSegmentGeneration(files);
}
