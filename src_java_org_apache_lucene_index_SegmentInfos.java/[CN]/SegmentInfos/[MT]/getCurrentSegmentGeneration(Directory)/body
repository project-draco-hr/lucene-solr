{
  String[] files=directory.list();
  if (files == null)   throw new IOException("cannot read directory " + directory + ": list() returned null");
  return getCurrentSegmentGeneration(files);
}
