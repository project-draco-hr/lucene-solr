{
  IndexInput input=directory.openInput(Constants.INDEX_SEGMENTS_FILENAME);
  try {
    int format=input.readInt();
    if (format < 0) {
      if (format < FORMAT)       throw new IOException("Unknown format version: " + format);
      version=input.readLong();
      counter=input.readInt();
    }
 else {
      counter=format;
    }
    for (int i=input.readInt(); i > 0; i--) {
      SegmentInfo si=new SegmentInfo(input.readString(),input.readInt(),directory);
      addElement(si);
    }
    if (format >= 0) {
      if (input.getFilePointer() >= input.length())       version=System.currentTimeMillis();
 else       version=input.readLong();
    }
  }
  finally {
    input.close();
  }
}
