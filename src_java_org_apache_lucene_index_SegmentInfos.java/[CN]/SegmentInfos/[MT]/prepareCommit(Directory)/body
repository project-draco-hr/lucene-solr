{
  if (pendingOutput != null)   throw new IllegalStateException("prepareCommit was already called");
  write(dir);
}
