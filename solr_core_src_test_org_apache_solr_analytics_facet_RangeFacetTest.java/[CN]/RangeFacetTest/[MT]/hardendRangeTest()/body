{
  String intLongRange=getFacetXML(response,"hi","rangeFacets","long_ld");
  ArrayList<Double> intLong=(ArrayList<Double>)xmlToList(intLongRange,"double","sum");
  ArrayList<Double> intLongTest=calculateNumberStat(transformLists(intLongTestStart,5,30,5,true,true,false,false,false),"sum");
  assertEquals(intLong,intLongTest);
  String intDoubleRange=getFacetXML(response,"hi","rangeFacets","double_dd");
  ArrayList<Double> intDouble=(ArrayList<Double>)xmlToList(intDoubleRange,"double","mean");
  ArrayList<Double> intDoubleTest=calculateNumberStat(transformLists(intDoubleTestStart,3,39,7,true,false,true,false,true),"mean");
  assertEquals(intDouble,intDoubleTest);
  String intDateRange=getFacetXML(response,"hi","rangeFacets","date_dtd");
  ArrayList<Long> intDate=(ArrayList<Long>)xmlToList(intDateRange,"long","count");
  ArrayList<Long> intDateTest=(ArrayList<Long>)calculateStat(transformLists(intDateTestStart,7,44,7,true,true,false,true,true),"count");
  assertEquals(intDate,intDateTest);
  String floatLongRange=getFacetXML(response,"hf","rangeFacets","long_ld");
  ArrayList<Double> floatLong=(ArrayList<Double>)xmlToList(floatLongRange,"double","median");
  ArrayList<Double> floatLongTest=calculateNumberStat(transformLists(floatLongTestStart,0,29,4,true,true,true,true,true),"median");
  assertEquals(floatLong,floatLongTest);
  String floatDoubleRange=getFacetXML(response,"hf","rangeFacets","double_dd");
  ArrayList<Long> floatDouble=(ArrayList<Long>)xmlToList(floatDoubleRange,"long","count");
  ArrayList<Long> floatDoubleTest=(ArrayList<Long>)calculateStat(transformLists(floatDoubleTestStart,4,47,11,true,false,false,true,false),"count");
  assertEquals(floatDouble,floatDoubleTest);
  String floatDateRange=getFacetXML(response,"hf","rangeFacets","date_dtd");
  ArrayList<Double> floatDate=(ArrayList<Double>)xmlToList(floatDateRange,"double","sumOfSquares");
  ArrayList<Double> floatDateTest=calculateNumberStat(transformLists(floatDateTestStart,4,46,5,true,false,true,true,false),"sumOfSquares");
  assertEquals(floatDate,floatDateTest);
}
