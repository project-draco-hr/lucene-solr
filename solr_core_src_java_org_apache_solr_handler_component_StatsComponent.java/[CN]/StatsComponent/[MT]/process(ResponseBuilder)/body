{
  if (!rb.doStats)   return;
  boolean isShard=rb.req.getParams().getBool(ShardParams.IS_SHARD,false);
  Map<String,StatsValues> statsValues=new LinkedHashMap<>();
  for (  StatsField statsField : rb._statsInfo.getStatsFields()) {
    DocSet docs=statsField.computeBaseDocSet();
    statsValues.put(statsField.getOutputKey(),statsField.computeLocalStatsValues(docs));
  }
  rb.rsp.add("stats",convertToResponse(statsValues));
}
