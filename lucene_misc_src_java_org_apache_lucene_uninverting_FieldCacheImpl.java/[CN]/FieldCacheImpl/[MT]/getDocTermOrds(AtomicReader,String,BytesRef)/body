{
  SortedSetDocValues dv=reader.getSortedSetDocValues(field);
  if (dv != null) {
    return dv;
  }
  SortedDocValues sdv=reader.getSortedDocValues(field);
  if (sdv != null) {
    return DocValues.singleton(sdv);
  }
  final FieldInfo info=reader.getFieldInfos().fieldInfo(field);
  if (info == null) {
    return DocValues.EMPTY_SORTED_SET;
  }
 else   if (info.hasDocValues()) {
    throw new IllegalStateException("Type mismatch: " + field + " was indexed as "+ info.getDocValuesType());
  }
 else   if (!info.isIndexed()) {
    return DocValues.EMPTY_SORTED_SET;
  }
  DocTermOrds dto=(DocTermOrds)caches.get(DocTermOrds.class).get(reader,new CacheKey(field,prefix),false);
  return dto.iterator(reader);
}
