{
  super.firstInit(context);
  try {
    String serverPath=context.getResolvedEntityAttribute(SOLR_SERVER);
    if (serverPath == null) {
      throw new DataImportHandlerException(DataImportHandlerException.SEVERE,"SolrEntityProcessor: parameter 'url' is required");
    }
    HttpClient client=getHttpClient();
    URL url=new URL(serverPath);
    if ("xml".equals(context.getResolvedEntityAttribute(CommonParams.WT))) {
      solrClient=new Builder(url.toExternalForm()).withHttpClient(client).withResponseParser(new XMLResponseParser()).build();
      LOG.info("using XMLResponseParser");
    }
 else {
      solrClient=new Builder(url.toExternalForm()).withHttpClient(client).build();
      LOG.info("using BinaryResponseParser");
    }
  }
 catch (  MalformedURLException e) {
    throw new DataImportHandlerException(DataImportHandlerException.SEVERE,e);
  }
}
