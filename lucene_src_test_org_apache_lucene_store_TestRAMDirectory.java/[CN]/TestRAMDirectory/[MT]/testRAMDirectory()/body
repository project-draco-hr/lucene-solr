{
  Directory dir=newFSDirectory(indexDir);
  MockDirectoryWrapper ramDir=new MockDirectoryWrapper(random,new RAMDirectory(dir,newIOContext(random)));
  dir.close();
  assertEquals(ramDir.sizeInBytes(),ramDir.getRecomputedSizeInBytes());
  IndexReader reader=IndexReader.open(ramDir,true);
  assertEquals(docsToAdd,reader.numDocs());
  IndexSearcher searcher=newSearcher(reader);
  for (int i=0; i < docsToAdd; i++) {
    Document doc=searcher.doc(i);
    assertTrue(doc.getField("content") != null);
  }
  reader.close();
  searcher.close();
}
