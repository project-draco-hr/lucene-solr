{
  if (bytes.length == 0)   return;
  if (size == -1) {
    size=bytes.length;
  }
 else   if (bytes.length != size) {
    throw new IllegalArgumentException("expected bytes size=" + size + " but got "+ bytes.length);
  }
  if (docID >= docToEntry.length) {
    final int[] newArray=new int[ArrayUtil.oversize(1 + docID,RamUsageEstimator.NUM_BYTES_INT)];
    System.arraycopy(docToEntry,0,newArray,0,docToEntry.length);
    bytesUsed.addAndGet((newArray.length - docToEntry.length) * RamUsageEstimator.NUM_BYTES_INT);
    docToEntry=newArray;
  }
  int e=hash.add(bytes);
  docToEntry[docID]=1 + (e < 0 ? (-e) - 1 : e);
}
