{
  if (terms.isEmpty()) {
    BooleanQuery bq=new BooleanQuery();
    bq.setBoost(getBoost());
    return bq;
  }
 else   if (terms.size() == 1) {
    TermQuery tq=new TermQuery(terms.get(0));
    tq.setBoost(getBoost());
    return tq;
  }
 else   if (positions.get(0).intValue() != 0) {
    final Term[] terms=getTerms();
    final int[] positions=getPositions();
    PhraseQuery rewritten=new PhraseQuery();
    for (int i=0; i < terms.length; ++i) {
      rewritten.add(terms[i],positions[i] - positions[0]);
    }
    rewritten.setBoost(getBoost());
    rewritten.setSlop(getSlop());
    return rewritten;
  }
 else {
    return super.rewrite(reader);
  }
}
