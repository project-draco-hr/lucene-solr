{
  Directory dir=newDirectory();
  RandomIndexWriter iw=new RandomIndexWriter(random(),dir);
  Document doc=new Document();
  doc.add(new BinaryDocValuesField("binary",new BytesRef("binary value")));
  doc.add(new SortedDocValuesField("sorted",new BytesRef("sorted value")));
  doc.add(new NumericDocValuesField("numeric",42));
  iw.addDocument(doc);
  DirectoryReader ir=iw.getReader();
  iw.close();
  AtomicReader ar=getOnlySegmentReader(ir);
  BytesRef scratch=new BytesRef();
  try {
    FieldCache.DEFAULT.getInts(ar,"binary",false);
    fail();
  }
 catch (  IllegalStateException expected) {
  }
  BinaryDocValues binary=FieldCache.DEFAULT.getTerms(ar,"binary");
  binary.get(0,scratch);
  assertEquals("binary value",scratch.utf8ToString());
  try {
    FieldCache.DEFAULT.getTermsIndex(ar,"binary");
    fail();
  }
 catch (  IllegalStateException expected) {
  }
  Bits bits=FieldCache.DEFAULT.getDocsWithField(ar,"binary");
  assertTrue(bits instanceof Bits.MatchAllBits);
  try {
    FieldCache.DEFAULT.getInts(ar,"sorted",false);
    fail();
  }
 catch (  IllegalStateException expected) {
  }
  binary=FieldCache.DEFAULT.getTerms(ar,"sorted");
  binary.get(0,scratch);
  assertEquals("sorted value",scratch.utf8ToString());
  SortedDocValues sorted=FieldCache.DEFAULT.getTermsIndex(ar,"sorted");
  assertEquals(0,sorted.getOrd(0));
  assertEquals(1,sorted.getValueCount());
  sorted.get(0,scratch);
  assertEquals("sorted value",scratch.utf8ToString());
  bits=FieldCache.DEFAULT.getDocsWithField(ar,"sorted");
  assertTrue(bits instanceof Bits.MatchAllBits);
  Ints numeric=FieldCache.DEFAULT.getInts(ar,"numeric",false);
  assertEquals(42,numeric.get(0));
  try {
    FieldCache.DEFAULT.getTerms(ar,"numeric");
    fail();
  }
 catch (  IllegalStateException expected) {
  }
  try {
    FieldCache.DEFAULT.getTermsIndex(ar,"numeric");
    fail();
  }
 catch (  IllegalStateException expected) {
  }
  bits=FieldCache.DEFAULT.getDocsWithField(ar,"numeric");
  assertTrue(bits instanceof Bits.MatchAllBits);
  ir.close();
  dir.close();
}
