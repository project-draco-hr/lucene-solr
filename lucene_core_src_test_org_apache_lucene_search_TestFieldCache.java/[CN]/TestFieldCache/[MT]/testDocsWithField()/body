{
  FieldCache cache=FieldCache.DEFAULT;
  cache.purgeAllCaches();
  assertEquals(0,cache.getCacheEntries().length);
  cache.getDoubles(reader,"theDouble",true);
  assertEquals(3,cache.getCacheEntries().length);
  Bits bits=cache.getDocsWithField(reader,"theDouble");
  assertEquals(3,cache.getCacheEntries().length);
  assertTrue(bits instanceof Bits.MatchAllBits);
  FieldCache.Ints ints=cache.getInts(reader,"sparse",true);
  assertEquals(6,cache.getCacheEntries().length);
  Bits docsWithField=cache.getDocsWithField(reader,"sparse");
  assertEquals(6,cache.getCacheEntries().length);
  for (int i=0; i < docsWithField.length(); i++) {
    if (i % 2 == 0) {
      assertTrue(docsWithField.get(i));
      assertEquals(i,ints.get(i));
    }
 else {
      assertFalse(docsWithField.get(i));
    }
  }
  FieldCache.Ints numInts=cache.getInts(reader,"numInt",random().nextBoolean());
  docsWithField=cache.getDocsWithField(reader,"numInt");
  for (int i=0; i < docsWithField.length(); i++) {
    if (i % 2 == 0) {
      assertTrue(docsWithField.get(i));
      assertEquals(i,numInts.get(i));
    }
 else {
      assertFalse(docsWithField.get(i));
    }
  }
}
