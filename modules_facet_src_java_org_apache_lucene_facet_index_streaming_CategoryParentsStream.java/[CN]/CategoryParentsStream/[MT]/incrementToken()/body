{
  if (this.categoryAttribute.getCategoryPath() != null) {
    clearCategoryProperties();
    boolean added=false;
    int ordinal=this.ordinalProperty.getOrdinal();
    if (ordinal != -1) {
      ordinal=this.taxonomyWriter.getParent(ordinal);
      if (this.ordinalPolicy.shouldAdd(ordinal)) {
        this.ordinalProperty.setOrdinal(ordinal);
        try {
          this.categoryAttribute.addProperty(ordinalProperty);
        }
 catch (        UnsupportedOperationException e) {
          throw new IOException(e.getLocalizedMessage());
        }
        added=true;
      }
 else {
        this.ordinalProperty.setOrdinal(-1);
      }
    }
    CategoryPath cp=this.categoryAttribute.getCategoryPath();
    if (cp != null) {
      cp.trim(1);
      if (added || this.pathPolicy.shouldAdd(cp)) {
        this.categoryAttribute.setCategoryPath(cp);
        added=true;
      }
 else {
        this.categoryAttribute.clear();
      }
    }
    if (added) {
      return true;
    }
  }
  if (input.incrementToken()) {
    int ordinal=taxonomyWriter.addCategory(this.categoryAttribute.getCategoryPath());
    this.ordinalProperty.setOrdinal(ordinal);
    try {
      this.categoryAttribute.addProperty(this.ordinalProperty);
    }
 catch (    UnsupportedOperationException e) {
      throw new IOException(e.getLocalizedMessage());
    }
    return true;
  }
  return false;
}
