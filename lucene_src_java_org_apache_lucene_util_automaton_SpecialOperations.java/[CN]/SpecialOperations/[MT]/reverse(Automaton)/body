{
  a.expandSingleton();
  HashMap<State,HashSet<Transition>> m=new HashMap<State,HashSet<Transition>>();
  Set<State> states=a.getStates();
  Set<State> accept=a.getAcceptStates();
  for (  State r : states) {
    m.put(r,new HashSet<Transition>());
    r.accept=false;
  }
  for (  State r : states)   for (  Transition t : r.getTransitions())   m.get(t.to).add(new Transition(t.min,t.max,r));
  for (  State r : states)   r.transitions=m.get(r);
  a.initial.accept=true;
  a.initial=new State();
  for (  State r : accept)   a.initial.addEpsilon(r);
  a.deterministic=false;
  return accept;
}
