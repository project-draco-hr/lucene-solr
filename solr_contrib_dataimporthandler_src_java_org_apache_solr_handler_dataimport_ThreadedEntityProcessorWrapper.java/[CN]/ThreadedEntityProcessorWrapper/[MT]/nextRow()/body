{
  if (rowcache != null) {
    return getFromRowCache();
  }
  while (true) {
    Map<String,Object> arow=null;
synchronized (delegate) {
      if (entityRunner.entityEnded.get())       return null;
      try {
        arow=delegate.nextRow();
      }
 catch (      Exception e) {
        if (ABORT.equals(onError)) {
          wrapAndThrow(SEVERE,e);
        }
 else {
          LOG.error("Exception in entity : " + entityName,e);
          return null;
        }
      }
      if (LOG.isDebugEnabled()) {
        LOG.debug("arow : " + arow);
      }
      if (arow == null)       entityRunner.entityEnded.set(true);
    }
    if (arow == null) {
      return null;
    }
 else {
      arow=applyTransformer(arow);
      if (arow != null) {
        delegate.postTransform(arow);
        return arow;
      }
    }
  }
}
