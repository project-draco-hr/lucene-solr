{
  IndexReader reader=signedIndexReader;
  IndexSearcher search=newSearcher(reader);
  Collator c=Collator.getInstance(Locale.ENGLISH);
  int medId=((maxId - minId) / 2);
  String minIP=pad(minId);
  String maxIP=pad(maxId);
  String medIP=pad(medId);
  int numDocs=reader.numDocs();
  assertEquals("num of docs",numDocs,1 + maxId - minId);
  Query q=new TermQuery(new Term("body","body"));
  int numHits=search.search(q,new TermRangeFilter("id",minIP,maxIP,T,T,c),1000).totalHits;
  assertEquals("find all",numDocs,numHits);
  numHits=search.search(q,new TermRangeFilter("id",minIP,maxIP,T,F,c),1000).totalHits;
  assertEquals("all but last",numDocs - 1,numHits);
  numHits=search.search(q,new TermRangeFilter("id",minIP,maxIP,F,T,c),1000).totalHits;
  assertEquals("all but first",numDocs - 1,numHits);
  numHits=search.search(q,new TermRangeFilter("id",minIP,maxIP,F,F,c),1000).totalHits;
  assertEquals("all but ends",numDocs - 2,numHits);
  numHits=search.search(q,new TermRangeFilter("id",medIP,maxIP,T,T,c),1000).totalHits;
  assertEquals("med and up",1 + maxId - medId,numHits);
  numHits=search.search(q,new TermRangeFilter("id",minIP,medIP,T,T,c),1000).totalHits;
  assertEquals("up to med",1 + medId - minId,numHits);
  numHits=search.search(q,new TermRangeFilter("id",minIP,null,T,F,c),1000).totalHits;
  assertEquals("min and up",numDocs,numHits);
  numHits=search.search(q,new TermRangeFilter("id",null,maxIP,F,T,c),1000).totalHits;
  assertEquals("max and down",numDocs,numHits);
  numHits=search.search(q,new TermRangeFilter("id",minIP,null,F,F,c),1000).totalHits;
  assertEquals("not min, but up",numDocs - 1,numHits);
  numHits=search.search(q,new TermRangeFilter("id",null,maxIP,F,F,c),1000).totalHits;
  assertEquals("not max, but down",numDocs - 1,numHits);
  numHits=search.search(q,new TermRangeFilter("id",medIP,maxIP,T,F,c),1000).totalHits;
  assertEquals("med and up, not max",maxId - medId,numHits);
  numHits=search.search(q,new TermRangeFilter("id",minIP,medIP,F,T,c),1000).totalHits;
  assertEquals("not min, up to med",medId - minId,numHits);
  numHits=search.search(q,new TermRangeFilter("id",minIP,minIP,F,F,c),1000).totalHits;
  assertEquals("min,min,F,F",0,numHits);
  numHits=search.search(q,new TermRangeFilter("id",medIP,medIP,F,F,c),1000).totalHits;
  assertEquals("med,med,F,F",0,numHits);
  numHits=search.search(q,new TermRangeFilter("id",maxIP,maxIP,F,F,c),1000).totalHits;
  assertEquals("max,max,F,F",0,numHits);
  numHits=search.search(q,new TermRangeFilter("id",minIP,minIP,T,T,c),1000).totalHits;
  assertEquals("min,min,T,T",1,numHits);
  numHits=search.search(q,new TermRangeFilter("id",null,minIP,F,T,c),1000).totalHits;
  assertEquals("nul,min,F,T",1,numHits);
  numHits=search.search(q,new TermRangeFilter("id",maxIP,maxIP,T,T,c),1000).totalHits;
  assertEquals("max,max,T,T",1,numHits);
  numHits=search.search(q,new TermRangeFilter("id",maxIP,null,T,F,c),1000).totalHits;
  assertEquals("max,nul,T,T",1,numHits);
  numHits=search.search(q,new TermRangeFilter("id",medIP,medIP,T,T,c),1000).totalHits;
  assertEquals("med,med,T,T",1,numHits);
  search.close();
}
