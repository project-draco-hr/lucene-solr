{
  SolrCore core=h.getCore();
  UpdateRequestProcessorChain pc=core.getUpdateProcessingChain(chain);
  assertNotNull("No Chain named: " + chain,pc);
  SolrQueryResponse rsp=new SolrQueryResponse();
  rsp.add("responseHeader",new SimpleOrderedMap<Object>());
  if (requestParams == null) {
    requestParams=new ModifiableSolrParams();
  }
  SolrQueryRequest req=new LocalSolrQueryRequest(core,requestParams);
  try {
    UpdateRequestProcessor processor=pc.createProcessor(req,rsp);
    for (    SolrInputDocument doc : docs) {
      AddUpdateCommand cmd=new AddUpdateCommand(req);
      cmd.solrDoc=doc;
      processor.processAdd(cmd);
    }
    processor.finish();
  }
  finally {
    req.close();
  }
  return rsp;
}
