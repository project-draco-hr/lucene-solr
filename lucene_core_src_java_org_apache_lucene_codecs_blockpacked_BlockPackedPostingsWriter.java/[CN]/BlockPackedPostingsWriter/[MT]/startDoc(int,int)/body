{
  if (DEBUG) {
    System.out.println("FPW.startDoc docID[" + docBufferUpto + "]="+ docID);
  }
  final int docDelta=docID - lastDocID;
  if (docID < 0 || (docCount > 0 && docDelta <= 0)) {
    throw new CorruptIndexException("docs out of order (" + docID + " <= "+ lastDocID+ " ) (docOut: "+ docOut+ ")");
  }
  docDeltaBuffer[docBufferUpto]=docDelta;
  if (fieldHasFreqs) {
    freqBuffer[docBufferUpto]=termDocFreq;
  }
  docBufferUpto++;
  docCount++;
  if (docBufferUpto == BLOCK_SIZE) {
    if (DEBUG) {
      System.out.println("  write docDelta block @ fp=" + docOut.getFilePointer());
    }
    forUtil.writeBlock(docDeltaBuffer,encoded,docOut);
    if (fieldHasFreqs) {
      if (DEBUG) {
        System.out.println("  write freq block @ fp=" + docOut.getFilePointer());
      }
      forUtil.writeBlock(freqBuffer,encoded,docOut);
    }
  }
  lastDocID=docID;
  lastPosition=0;
  lastStartOffset=0;
}
