{
  lowerVal=lowerVal == null ? null : toTerm(lowerVal);
  upperVal=upperVal == null ? null : toTerm(upperVal);
  final BytesRef spare=new BytesRef();
  int lower=Integer.MIN_VALUE;
  if (lowerVal != null) {
    lower=termsIndex.binarySearchLookup(new BytesRef(lowerVal),spare);
    if (lower < 0) {
      lower=-lower - 1;
    }
 else     if (!includeLower) {
      lower++;
    }
  }
  int upper=Integer.MAX_VALUE;
  if (upperVal != null) {
    upper=termsIndex.binarySearchLookup(new BytesRef(upperVal),spare);
    if (upper < 0) {
      upper=-upper - 2;
    }
 else     if (!includeUpper) {
      upper--;
    }
  }
  final int ll=lower;
  final int uu=upper;
  return new ValueSourceScorer(reader,this){
    @Override public boolean matchesValue(    int doc){
      int ord=termsIndex.getOrd(doc);
      return ord >= ll && ord <= uu;
    }
  }
;
}
