{
  if (len < INSERTION_SORT_THRESHOLD) {
    insertionSort(array,off,len);
    return;
  }
  buffer=ArrayUtil.grow(buffer,len);
  int[] arr=array;
  int arrOff=off;
  int[] buf=buffer;
  int bufOff=0;
  for (int shift=0; shift <= 24; shift+=8) {
    if (sort(arr,arrOff,len,histogram,shift,buf,bufOff)) {
      int[] tmp=arr;
      int tmpOff=arrOff;
      arr=buf;
      arrOff=bufOff;
      buf=tmp;
      bufOff=tmpOff;
    }
  }
  if (array == buf) {
    System.arraycopy(arr,arrOff,array,off,len);
  }
}
