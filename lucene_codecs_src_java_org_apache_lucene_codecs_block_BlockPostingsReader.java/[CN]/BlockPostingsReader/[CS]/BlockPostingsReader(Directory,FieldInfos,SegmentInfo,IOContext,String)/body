{
  boolean success=false;
  IndexInput docIn=null;
  IndexInput posIn=null;
  IndexInput payIn=null;
  try {
    docIn=dir.openInput(IndexFileNames.segmentFileName(segmentInfo.name,segmentSuffix,BlockPostingsFormat.DOC_EXTENSION),ioContext);
    CodecUtil.checkHeader(docIn,BlockPostingsWriter.DOC_CODEC,BlockPostingsWriter.VERSION_CURRENT,BlockPostingsWriter.VERSION_CURRENT);
    forUtil=new ForUtil(docIn);
    if (fieldInfos.hasProx()) {
      posIn=dir.openInput(IndexFileNames.segmentFileName(segmentInfo.name,segmentSuffix,BlockPostingsFormat.POS_EXTENSION),ioContext);
      CodecUtil.checkHeader(posIn,BlockPostingsWriter.POS_CODEC,BlockPostingsWriter.VERSION_CURRENT,BlockPostingsWriter.VERSION_CURRENT);
      if (fieldInfos.hasPayloads() || fieldInfos.hasOffsets()) {
        payIn=dir.openInput(IndexFileNames.segmentFileName(segmentInfo.name,segmentSuffix,BlockPostingsFormat.PAY_EXTENSION),ioContext);
        CodecUtil.checkHeader(payIn,BlockPostingsWriter.PAY_CODEC,BlockPostingsWriter.VERSION_CURRENT,BlockPostingsWriter.VERSION_CURRENT);
      }
    }
    this.docIn=docIn;
    this.posIn=posIn;
    this.payIn=payIn;
    success=true;
  }
  finally {
    if (!success) {
      IOUtils.closeWhileHandlingException(docIn,posIn,payIn);
    }
  }
}
