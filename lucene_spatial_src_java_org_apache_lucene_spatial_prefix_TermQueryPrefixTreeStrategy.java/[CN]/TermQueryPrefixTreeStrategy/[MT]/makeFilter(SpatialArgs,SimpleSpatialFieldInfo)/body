{
  final SpatialOperation op=args.getOperation();
  if (!SpatialOperation.is(op,SpatialOperation.IsWithin,SpatialOperation.Intersects,SpatialOperation.BBoxWithin,SpatialOperation.BBoxIntersects))   throw new UnsupportedSpatialOperation(op);
  Shape shape=args.getShape();
  int detailLevel=grid.getMaxLevelForPrecision(shape,args.getDistPrecision());
  List<Node> cells=grid.getNodes(shape,detailLevel,false);
  TermsFilter filter=new TermsFilter();
  for (  Node cell : cells) {
    filter.addTerm(new Term(fieldInfo.getFieldName(),cell.getTokenString()));
  }
  return filter;
}
