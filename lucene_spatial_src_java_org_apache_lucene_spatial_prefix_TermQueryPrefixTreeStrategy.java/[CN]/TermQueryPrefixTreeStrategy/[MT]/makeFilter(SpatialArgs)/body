{
  final SpatialOperation op=args.getOperation();
  if (op != SpatialOperation.Intersects)   throw new UnsupportedSpatialOperation(op);
  Shape shape=args.getShape();
  int detailLevel=grid.getLevelForDistance(args.resolveDistErr(ctx,distErrPct));
  List<Node> cells=grid.getNodes(shape,detailLevel,false,true);
  BytesRef[] terms=new BytesRef[cells.size()];
  int i=0;
  for (  Node cell : cells) {
    terms[i++]=new BytesRef(cell.getTokenString());
  }
  return new TermsFilter(getFieldName(),terms);
}
