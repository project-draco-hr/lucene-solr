{
  if (fixedSize) {
    if (mode == Mode.STRAIGHT) {
      return new FixedStraightBytesImpl.Reader(dir,id,maxDoc,context);
    }
 else     if (mode == Mode.DEREF) {
      return new FixedDerefBytesImpl.Reader(dir,id,maxDoc,context);
    }
 else     if (mode == Mode.SORTED) {
      return new FixedSortedBytesImpl.Reader(dir,id,maxDoc,context);
    }
  }
 else {
    if (mode == Mode.STRAIGHT) {
      return new VarStraightBytesImpl.Reader(dir,id,maxDoc,context);
    }
 else     if (mode == Mode.DEREF) {
      return new VarDerefBytesImpl.Reader(dir,id,maxDoc,context);
    }
 else     if (mode == Mode.SORTED) {
      return new VarSortedBytesImpl.Reader(dir,id,maxDoc,context);
    }
  }
  throw new IllegalArgumentException("Illegal Mode: " + mode);
}
