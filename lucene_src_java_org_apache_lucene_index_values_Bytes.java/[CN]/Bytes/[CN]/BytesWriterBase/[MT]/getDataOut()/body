{
  if (datOut == null) {
    boolean success=false;
    try {
      datOut=dir.createOutput(IndexFileNames.segmentFileName(id,"",DATA_EXTENSION));
      CodecUtil.writeHeader(datOut,codecName,version);
      success=true;
    }
  finally {
      if (!success) {
        IOUtils.closeSafely(true,datOut);
      }
    }
  }
  return datOut;
}
