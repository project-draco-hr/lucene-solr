{
  meta.writeVInt(field.number);
  meta.writeByte(DiskDocValuesFormat.BINARY);
  int minLength=Integer.MAX_VALUE;
  int maxLength=Integer.MIN_VALUE;
  final long startFP=data.getFilePointer();
  long count=0;
  for (  BytesRef v : values) {
    minLength=Math.min(minLength,v.length);
    maxLength=Math.max(maxLength,v.length);
    data.writeBytes(v.bytes,v.offset,v.length);
    count++;
  }
  meta.writeVInt(minLength == maxLength ? BINARY_FIXED_UNCOMPRESSED : BINARY_VARIABLE_UNCOMPRESSED);
  meta.writeVInt(minLength);
  meta.writeVInt(maxLength);
  meta.writeVLong(count);
  meta.writeLong(startFP);
  if (minLength != maxLength) {
    meta.writeLong(data.getFilePointer());
    meta.writeVInt(PackedInts.VERSION_CURRENT);
    meta.writeVInt(BLOCK_SIZE);
    final MonotonicBlockPackedWriter writer=new MonotonicBlockPackedWriter(data,BLOCK_SIZE);
    long addr=0;
    for (    BytesRef v : values) {
      addr+=v.length;
      writer.add(addr);
    }
    writer.finish();
  }
}
