{
  String dataName=IndexFileNames.segmentFileName(state.segmentInfo.name,state.segmentSuffix,"ddvd");
  data=state.directory.createOutput(dataName,state.context);
  CodecUtil.writeHeader(data,DiskDocValuesFormat.DATA_CODEC,DiskDocValuesFormat.VERSION_CURRENT);
  String metaName=IndexFileNames.segmentFileName(state.segmentInfo.name,state.segmentSuffix,"ddvm");
  meta=state.directory.createOutput(metaName,state.context);
  CodecUtil.writeHeader(meta,DiskDocValuesFormat.METADATA_CODEC,DiskDocValuesFormat.VERSION_CURRENT);
  maxDoc=state.segmentInfo.getDocCount();
}
