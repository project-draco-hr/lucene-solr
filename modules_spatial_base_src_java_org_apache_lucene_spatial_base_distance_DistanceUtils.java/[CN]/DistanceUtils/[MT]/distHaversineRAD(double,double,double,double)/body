{
  if (lat1 == lat2 && lon1 == lon2)   return 0.0;
  double hsinX=Math.sin((lon1 - lon2) * 0.5);
  double hsinY=Math.sin((lat1 - lat2) * 0.5);
  double h=hsinY * hsinY + (Math.cos(lat1) * Math.cos(lat2) * hsinX* hsinX);
  return 2 * Math.atan2(Math.sqrt(h),Math.sqrt(1 - h));
}
