{
  Sort sort=new Sort(new SortField(NUMERIC_DV_FIELD,SortField.Type.INT));
  final Sorter.DocMap docMap=new Sorter(sort).sort(unsortedReader);
  NumericDocValues dv=unsortedReader.getNumericDocValues(NUMERIC_DV_FIELD);
  sortedValues=new Integer[unsortedReader.maxDoc()];
  for (int i=0; i < unsortedReader.maxDoc(); ++i) {
    sortedValues[docMap.oldToNew(i)]=(int)dv.get(i);
  }
  if (VERBOSE) {
    System.out.println("docMap: " + docMap);
    System.out.println("sortedValues: " + Arrays.toString(sortedValues));
  }
  sortedReader=SortingLeafReader.wrap(unsortedReader,sort);
  if (VERBOSE) {
    System.out.print("mapped-deleted-docs: ");
    Bits mappedLiveDocs=sortedReader.getLiveDocs();
    for (int i=0; i < mappedLiveDocs.length(); i++) {
      if (!mappedLiveDocs.get(i)) {
        System.out.print(i + " ");
      }
    }
    System.out.println();
  }
  TestUtil.checkReader(sortedReader);
}
