{
  int upTo=min;
  int exclDoc=excl.docID();
  while (upTo < max) {
    if (exclDoc < upTo) {
      exclDoc=excl.advance(upTo);
    }
    if (exclDoc == upTo) {
      upTo+=1;
      exclDoc=excl.nextDoc();
    }
 else {
      upTo=req.score(collector,acceptDocs,upTo,Math.min(exclDoc,max));
    }
  }
  if (upTo == max) {
    upTo=req.score(collector,acceptDocs,upTo,upTo);
  }
  return upTo;
}
