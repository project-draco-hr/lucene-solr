{
  try {
    SolrQueryParser parser=schema.getSolrQueryParser(defaultField);
    parser.setDefaultOperator(getQueryParserDefaultOperator(schema,params.get(QueryParsing.OP)));
    Query query=parser.parse(qs);
    if (SolrCore.log.isTraceEnabled()) {
      SolrCore.log.trace("After QueryParser:" + query);
    }
    return query;
  }
 catch (  ParseException e) {
    SolrCore.log(e);
    throw new SolrException(SolrException.ErrorCode.BAD_REQUEST,"Query parsing error: " + e.getMessage(),e);
  }
}
