{
  Fields fields=MultiFields.getFields(ir);
  FieldsEnum fieldEnum=fields.iterator();
  String f=null;
  while ((f=fieldEnum.next()) != null) {
    Terms terms=fields.terms(f);
    long sumDocFreq=terms.getSumDocFreq();
    if (sumDocFreq == -1) {
      if (VERBOSE) {
        System.out.println("skipping field: " + f + ", codec does not support sumDocFreq");
      }
      continue;
    }
    long computedSumDocFreq=0;
    TermsEnum termsEnum=terms.iterator(null);
    while (termsEnum.next() != null) {
      computedSumDocFreq+=termsEnum.docFreq();
    }
    assertEquals(computedSumDocFreq,sumDocFreq);
  }
}
