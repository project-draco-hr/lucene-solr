{
  if (!shouldSample(docids)) {
    return new SampleResult(docids,1d);
  }
  int actualSize=docids.size();
  int sampleSetSize=(int)(actualSize * samplingParams.getSampleRatio());
  sampleSetSize=Math.max(sampleSetSize,samplingParams.getMinSampleSize());
  sampleSetSize=Math.min(sampleSetSize,samplingParams.getMaxSampleSize());
  int[] sampleSet=null;
  try {
    sampleSet=RandomSample.repeatableSample(docids,actualSize,sampleSetSize);
  }
 catch (  IOException e) {
    if (logger.isLoggable(Level.WARNING)) {
      logger.log(Level.WARNING,"sampling failed: " + e.getMessage() + " - falling back to no sampling!",e);
    }
    return new SampleResult(docids,1d);
  }
  ScoredDocIDs sampled=ScoredDocIdsUtils.createScoredDocIDsSubset(docids,sampleSet);
  if (logger.isLoggable(Level.FINEST)) {
    logger.finest("******************** " + sampled.size());
  }
  return new SampleResult(sampled,sampled.size() / (double)docids.size());
}
