{
  final Path configDir=Paths.get(TEST_HOME(),"collection1","conf");
  String configName="solrCloudCollectionConfig";
  int nodeCount=6;
  configureCluster(nodeCount).addConfig(configName,configDir).configure();
  Map<String,String> collectionProperties=new HashMap<>();
  collectionProperties.put("config","solrconfig-blockjoinfacetcomponent.xml");
  collectionProperties.put("schema","schema-blockjoinfacetcomponent.xml");
  int shards=3;
  int replicas=2;
  assertNotNull(cluster.createCollection(collection,shards,replicas,configName,collectionProperties));
  AbstractDistribZkTestBase.waitForRecoveriesToFinish(collection,cluster.getSolrClient().getZkStateReader(),false,true,30);
}
