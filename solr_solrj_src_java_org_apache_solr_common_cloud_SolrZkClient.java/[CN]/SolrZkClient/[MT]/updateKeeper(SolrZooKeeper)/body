{
  if (isClosed)   throw new RuntimeException("client is closed");
  SolrZooKeeper oldKeeper=this.keeper;
  this.keeper=keeper;
  if (oldKeeper != null) {
    oldKeeper.close();
  }
  if (isClosed)   this.keeper.close();
}
