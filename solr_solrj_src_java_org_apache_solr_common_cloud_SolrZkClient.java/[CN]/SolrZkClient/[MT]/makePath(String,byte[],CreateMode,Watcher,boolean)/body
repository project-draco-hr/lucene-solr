{
  if (log.isInfoEnabled()) {
    log.info("makePath: " + path);
  }
  if (path.startsWith("/")) {
    path=path.substring(1,path.length());
  }
  String[] paths=path.split("/");
  StringBuilder sbPath=new StringBuilder();
  for (int i=0; i < paths.length; i++) {
    byte[] bytes=null;
    String pathPiece=paths[i];
    sbPath.append("/" + pathPiece);
    String currentPath=sbPath.toString();
    Object exists=exists(currentPath,watcher);
    if (exists == null || ((i == paths.length - 1) && failOnExists)) {
      CreateMode mode=CreateMode.PERSISTENT;
      if (i == paths.length - 1) {
        mode=createMode;
        bytes=data;
      }
      keeper.create(currentPath,bytes,ZooDefs.Ids.OPEN_ACL_UNSAFE,mode);
      if (i == paths.length - 1) {
        exists(currentPath,watcher);
      }
    }
 else     if (i == paths.length - 1) {
      setData(currentPath,data,-1);
      exists(currentPath,watcher);
    }
  }
}
