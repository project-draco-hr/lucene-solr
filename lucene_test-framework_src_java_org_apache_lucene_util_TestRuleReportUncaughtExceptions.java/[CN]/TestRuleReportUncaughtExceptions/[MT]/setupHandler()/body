{
  savedUncaughtExceptionHandler=Thread.getDefaultUncaughtExceptionHandler();
  Thread.setDefaultUncaughtExceptionHandler(new Thread.UncaughtExceptionHandler(){
    public void uncaughtException(    Thread t,    Throwable e){
      if (e.getClass().getName().endsWith("AssumptionViolatedException")) {
        String where="<unknown>";
        for (        StackTraceElement elem : e.getStackTrace()) {
          if (!elem.getClassName().startsWith("org.junit")) {
            where=elem.toString();
            break;
          }
        }
        System.err.print("NOTE: Uncaught exception handler caught a failed assumption at " + where + " (ignored):");
      }
 else {
synchronized (uncaughtExceptions) {
          uncaughtExceptions.add(new UncaughtExceptionEntry(t,e));
        }
        StringWriter sw=new StringWriter();
        sw.write("\n===>\nUncaught exception by thread: " + t + "\n");
        PrintWriter pw=new PrintWriter(sw);
        e.printStackTrace(pw);
        pw.flush();
        sw.write("<===\n");
        System.err.println(sw.toString());
      }
    }
  }
);
}
