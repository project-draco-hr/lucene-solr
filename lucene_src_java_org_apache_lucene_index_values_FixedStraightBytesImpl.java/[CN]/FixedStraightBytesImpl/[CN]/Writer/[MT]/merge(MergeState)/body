{
  if (state.bits == null && state.reader instanceof Reader) {
    Reader reader=(Reader)state.reader;
    final int maxDocs=reader.maxDoc;
    if (maxDocs == 0) {
      return;
    }
    if (size == -1) {
      size=reader.size;
      datOut.writeInt(size);
      oneRecord=new byte[size];
    }
    fill(state.docBase);
    final IndexInput cloneData=reader.cloneData();
    try {
      datOut.copyBytes(cloneData,size * maxDocs);
    }
  finally {
      cloneData.close();
    }
    lastDocID+=maxDocs - 1;
  }
 else   super.merge(state);
}
