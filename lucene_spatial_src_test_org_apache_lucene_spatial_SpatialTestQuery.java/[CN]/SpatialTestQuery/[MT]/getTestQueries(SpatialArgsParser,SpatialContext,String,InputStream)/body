{
  List<SpatialTestQuery> results=new ArrayList<SpatialTestQuery>();
  BufferedReader bufInput=new BufferedReader(new InputStreamReader(in,"UTF-8"));
  try {
    String line;
    for (int lineNumber=1; (line=bufInput.readLine()) != null; lineNumber++) {
      SpatialTestQuery test=new SpatialTestQuery();
      test.line=line;
      test.lineNumber=lineNumber;
      try {
        if (line.startsWith("[")) {
          int idx=line.indexOf(']');
          if (idx > 0) {
            line=line.substring(idx + 1);
          }
        }
        int idx=line.indexOf('@');
        StringTokenizer st=new StringTokenizer(line.substring(0,idx));
        while (st.hasMoreTokens()) {
          test.ids.add(st.nextToken().trim());
        }
        test.args=parser.parse(line.substring(idx + 1).trim(),ctx);
        results.add(test);
      }
 catch (      Exception ex) {
        throw new RuntimeException("invalid query line: " + test.line,ex);
      }
    }
  }
  finally {
    bufInput.close();
  }
  return results.iterator();
}
