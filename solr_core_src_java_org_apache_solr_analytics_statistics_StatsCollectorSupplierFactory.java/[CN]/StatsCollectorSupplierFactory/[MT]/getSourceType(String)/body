{
  int paren=expression.indexOf('(');
  if (paren < 0) {
    return FIELD_TYPE;
  }
  String operation=expression.substring(0,paren).trim();
  if (AnalyticsParams.NUMERIC_OPERATION_SET.contains(operation)) {
    return NUMBER_TYPE;
  }
 else   if (AnalyticsParams.DATE_OPERATION_SET.contains(operation)) {
    return DATE_TYPE;
  }
 else   if (AnalyticsParams.STRING_OPERATION_SET.contains(operation)) {
    return STRING_TYPE;
  }
 else   if (operation.equals(AnalyticsParams.FILTER)) {
    return FILTER_TYPE;
  }
  throw new SolrException(ErrorCode.BAD_REQUEST,"The operation \"" + operation + "\" in ["+ expression+ "] is not supported.");
}
