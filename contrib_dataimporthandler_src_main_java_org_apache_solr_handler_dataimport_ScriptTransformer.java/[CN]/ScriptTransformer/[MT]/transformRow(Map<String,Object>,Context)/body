{
  try {
    if (engine == null)     initEngine(context);
    if (engine == null)     return row;
    return invokeFunctionMethod.invoke(engine,functionName,new Object[]{row,context});
  }
 catch (  DataImportHandlerException e) {
    throw e;
  }
catch (  InvocationTargetException e) {
    throw new DataImportHandlerException(DataImportHandlerException.SEVERE,"Could not invoke method :" + functionName + "\n <script>\n"+ context.getVariableResolver().resolve(DataConfig.IMPORTER_NS + "." + DataConfig.SCRIPT)+ "</script>",e);
  }
catch (  Exception e) {
    throw new DataImportHandlerException(DataImportHandlerException.SEVERE,"Error invoking script for entity " + context.getEntityAttribute("name"),e);
  }
}
