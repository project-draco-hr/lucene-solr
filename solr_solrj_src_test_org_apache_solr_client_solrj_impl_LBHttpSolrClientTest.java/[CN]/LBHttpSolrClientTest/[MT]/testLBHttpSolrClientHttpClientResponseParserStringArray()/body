{
  CloseableHttpClient httpClient=HttpClientUtil.createClient(new ModifiableSolrParams());
  LBHttpSolrClient testClient=new LBHttpSolrClient(httpClient,(ResponseParser)null);
  HttpSolrClient httpSolrClient=testClient.makeSolrClient("http://127.0.0.1:8080");
  try {
    assertNull("Generated server should have null parser.",httpSolrClient.getParser());
  }
  finally {
    httpSolrClient.shutdown();
    testClient.shutdown();
    httpClient.close();
  }
  try {
    ResponseParser parser=new BinaryResponseParser();
    httpClient=HttpClientUtil.createClient(new ModifiableSolrParams());
    testClient=new LBHttpSolrClient(httpClient,parser);
    httpSolrClient=testClient.makeSolrClient("http://127.0.0.1:8080");
    assertEquals("Invalid parser passed to generated server.",parser,httpSolrClient.getParser());
  }
  finally {
    httpSolrClient.shutdown();
    testClient.shutdown();
    httpClient.close();
  }
}
