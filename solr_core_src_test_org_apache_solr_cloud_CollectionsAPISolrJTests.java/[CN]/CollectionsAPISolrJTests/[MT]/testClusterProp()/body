{
  CollectionAdminRequest.ClusterProp clusterPropRequest=new CollectionAdminRequest.ClusterProp().setPropertyName(ZkStateReader.LEGACY_CLOUD).setPropertyValue("false");
  CollectionAdminResponse response=clusterPropRequest.process(cloudClient);
  assertEquals(0,response.getStatus());
  TimeOut timeout=new TimeOut(3,TimeUnit.SECONDS);
  boolean changed=false;
  while (!timeout.hasTimedOut()) {
    Thread.sleep(10);
    changed=Objects.equals("false",cloudClient.getZkStateReader().getClusterProps().get(ZkStateReader.LEGACY_CLOUD));
    if (changed)     break;
  }
  assertTrue("The Cluster property wasn't set",changed);
  clusterPropRequest=new CollectionAdminRequest.ClusterProp().setPropertyName(ZkStateReader.LEGACY_CLOUD).setPropertyValue(null);
  clusterPropRequest.process(cloudClient);
  timeout=new TimeOut(3,TimeUnit.SECONDS);
  changed=false;
  while (!timeout.hasTimedOut()) {
    Thread.sleep(10);
    changed=(cloudClient.getZkStateReader().getClusterProps().get(ZkStateReader.LEGACY_CLOUD) == null);
    if (changed)     break;
  }
  assertTrue("The Cluster property wasn't unset",changed);
}
