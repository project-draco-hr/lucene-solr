{
  CollectionAdminRequest.ClusterProp clusterPropRequest=new CollectionAdminRequest.ClusterProp().setPropertyName(ZkStateReader.LEGACY_CLOUD).setPropertyValue("false");
  CollectionAdminResponse response=clusterPropRequest.process(cloudClient);
  assertEquals(0,response.getStatus());
  long timeOut=System.currentTimeMillis() + 3000;
  boolean changed=false;
  while (System.currentTimeMillis() < timeOut) {
    Thread.sleep(10);
    changed=Objects.equals("false",cloudClient.getZkStateReader().getClusterProps().get(ZkStateReader.LEGACY_CLOUD));
    if (changed)     break;
  }
  assertTrue("The Cluster property wasn't set",changed);
  clusterPropRequest=new CollectionAdminRequest.ClusterProp().setPropertyName(ZkStateReader.LEGACY_CLOUD).setPropertyValue(null);
  clusterPropRequest.process(cloudClient);
  timeOut=System.currentTimeMillis() + 3000;
  changed=false;
  while (System.currentTimeMillis() < timeOut) {
    Thread.sleep(10);
    changed=(cloudClient.getZkStateReader().getClusterProps().get(ZkStateReader.LEGACY_CLOUD) == null);
    if (changed)     break;
  }
  assertTrue("The Cluster property wasn't unset",changed);
}
