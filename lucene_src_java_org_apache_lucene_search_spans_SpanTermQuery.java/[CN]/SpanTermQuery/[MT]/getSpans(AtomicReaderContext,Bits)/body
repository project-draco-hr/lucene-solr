{
  final IndexReader reader=context.reader;
  final DocsAndPositionsEnum postings=reader.termPositionsEnum(acceptDocs,term.field(),term.bytes());
  if (postings != null) {
    return new TermSpans(postings,term);
  }
 else {
    if (reader.termDocsEnum(reader.getLiveDocs(),term.field(),term.bytes()) != null) {
      throw new IllegalStateException("field \"" + term.field() + "\" was indexed without position data; cannot run SpanTermQuery (term="+ term.text()+ ")");
    }
 else {
      return TermSpans.EMPTY_TERM_SPANS;
    }
  }
}
