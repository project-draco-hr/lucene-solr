{
  long indexHeapRamBytesUsed=0;
  for (  AtomicReaderContext atomicReaderContext : reader.leaves()) {
    AtomicReader atomicReader=atomicReaderContext.reader();
    if (atomicReader instanceof SegmentReader) {
      indexHeapRamBytesUsed+=((SegmentReader)atomicReader).ramBytesUsed();
    }
 else {
      return -1;
    }
  }
  return indexHeapRamBytesUsed;
}
