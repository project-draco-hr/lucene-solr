{
  final String INPUT="G&uuml;nther G&uuml;nther is here";
  List<String> mappingRules=new ArrayList<String>();
  mappingRules.add("\"&uuml;\" => \"??\"");
  NormalizeCharMap.Builder builder=new NormalizeCharMap.Builder();
  builder.add("&uuml;","??");
  NormalizeCharMap normMap=builder.build();
  CharStream charStream=new MappingCharFilter(normMap,CharReader.get(new StringReader(INPUT)));
  TokenStream stream=new PatternTokenizer(charStream,Pattern.compile("[,;/\\s]+"),-1);
  assertTokenStreamContents(stream,new String[]{"G??nther","G??nther","is","here"},new int[]{0,13,26,29},new int[]{12,25,28,33},INPUT.length());
  charStream=new MappingCharFilter(normMap,CharReader.get(new StringReader(INPUT)));
  stream=new PatternTokenizer(charStream,Pattern.compile("G??nther"),0);
  assertTokenStreamContents(stream,new String[]{"G??nther","G??nther"},new int[]{0,13},new int[]{12,25},INPUT.length());
}
