{
  BKDTreeWriter.verifyParams(maxPointsInLeafNode,maxPointsSortInHeap);
  this.delegate=delegate;
  this.maxPointsInLeafNode=maxPointsInLeafNode;
  this.maxPointsSortInHeap=maxPointsSortInHeap;
  this.state=state;
  String datFileName=IndexFileNames.segmentFileName(state.segmentInfo.name,state.segmentSuffix,BKDTreeDocValuesFormat.DATA_EXTENSION);
  out=state.directory.createOutput(datFileName,state.context);
  CodecUtil.writeIndexHeader(out,BKDTreeDocValuesFormat.DATA_CODEC_NAME,BKDTreeDocValuesFormat.DATA_VERSION_CURRENT,state.segmentInfo.getId(),state.segmentSuffix);
}
