{
  dir=newDirectory();
  taxoDir=newDirectory();
  TaxonomyWriter taxoWriter=new DirectoryTaxonomyWriter(taxoDir);
  config=new FacetsConfig();
  config.setIndexFieldName("int","$facets.int");
  config.setMultiValued("int",true);
  config.setIndexFieldName("float","$facets.float");
  config.setMultiValued("float",true);
  RandomIndexWriter writer=new RandomIndexWriter(random(),dir);
  for (int i=0; i < 110; i++) {
    Document doc=new Document();
    if (i % 11 != 0) {
      doc.add(new IntAssociationFacetField(2,"int","a"));
      doc.add(new FloatAssociationFacetField(0.5f,"float","a"));
      if (i % 2 == 0) {
        doc.add(new IntAssociationFacetField(3,"int","b"));
        doc.add(new FloatAssociationFacetField(0.2f,"float","b"));
      }
    }
    writer.addDocument(config.build(taxoWriter,doc));
  }
  taxoWriter.close();
  reader=writer.getReader();
  writer.shutdown();
  taxoReader=new DirectoryTaxonomyReader(taxoDir);
}
