{
  List<Range> ranges;
  RangeInfo rangeInfo;
  rangeInfo=new RangeInfo();
  Map<String,Slice> slices=getSlices(collection);
  if (slices == null) {
    throw new SolrException(ErrorCode.BAD_REQUEST,"Can not find collection " + collection + " in "+ this);
  }
  Set<String> shards=slices.keySet();
  ArrayList<String> shardList=new ArrayList<String>(shards.size());
  shardList.addAll(shards);
  Collections.sort(shardList);
  ranges=hp.partitionRange(shards.size());
  rangeInfo.ranges=ranges;
  rangeInfo.shardList=shardList;
  rangeInfos.put(collection,rangeInfo);
  return rangeInfo;
}
