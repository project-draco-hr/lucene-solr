{
  Directory dir=newDirectory();
  IndexWriter iw=new IndexWriter(dir,newIndexWriterConfig(TEST_VERSION_CURRENT,new MockAnalyzer(random())));
  iw.addDocument(new Document());
  iw.close();
  try {
    IndexOutput out=dir.createOutput("myrandomfile",newIOContext(random()));
    out.writeByte((byte)42);
    out.close();
    new IndexWriter(dir,newIndexWriterConfig(TEST_VERSION_CURRENT,new MockAnalyzer(random()))).close();
    assertTrue(dir.fileExists("myrandomfile"));
  }
  finally {
    dir.close();
  }
}
