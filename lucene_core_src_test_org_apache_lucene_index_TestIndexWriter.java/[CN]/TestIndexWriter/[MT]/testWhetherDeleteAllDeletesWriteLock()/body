{
  Directory d=newFSDirectory(createTempDir("TestIndexWriter.testWhetherDeleteAllDeletesWriteLock"),SimpleFSLockFactory.INSTANCE);
  RandomIndexWriter w1=new RandomIndexWriter(random(),d);
  w1.deleteAll();
  try {
    new RandomIndexWriter(random(),d,newIndexWriterConfig(null).setWriteLockTimeout(100));
    fail("should not be able to create another writer");
  }
 catch (  LockObtainFailedException lofe) {
  }
  w1.close();
  d.close();
}
