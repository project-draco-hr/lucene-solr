{
  Directory d=newFSDirectory(createTempDir("TestIndexWriter.testWhetherDeleteAllDeletesWriteLock"));
  d.setLockFactory(new SimpleFSLockFactory());
  RandomIndexWriter w1=new RandomIndexWriter(random(),d);
  w1.deleteAll();
  try {
    new RandomIndexWriter(random(),d,newIndexWriterConfig(TEST_VERSION_CURRENT,null).setWriteLockTimeout(100));
    fail("should not be able to create another writer");
  }
 catch (  LockObtainFailedException lofe) {
  }
  w1.shutdown();
  d.close();
}
