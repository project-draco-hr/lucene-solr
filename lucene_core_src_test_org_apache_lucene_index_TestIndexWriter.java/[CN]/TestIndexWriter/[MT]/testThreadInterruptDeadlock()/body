{
  IndexerThreadInterrupt t=new IndexerThreadInterrupt(1);
  t.setDaemon(true);
  t.start();
  assertTrue(new ThreadInterruptedException(new InterruptedException()).getCause() instanceof InterruptedException);
  final int numInterrupts=atLeast(300);
  int i=0;
  while (i < numInterrupts) {
    Thread.sleep(10);
    if (t.allowInterrupt) {
      i++;
      t.interrupt();
    }
    if (!t.isAlive()) {
      break;
    }
  }
  t.finish=true;
  t.join();
  if (t.failed) {
    fail(new String(t.bytesLog.toString("UTF-8")));
  }
}
