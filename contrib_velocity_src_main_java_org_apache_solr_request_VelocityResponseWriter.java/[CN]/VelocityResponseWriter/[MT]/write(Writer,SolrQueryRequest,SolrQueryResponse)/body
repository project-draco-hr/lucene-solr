{
  VelocityEngine engine=getEngine(request);
  Template template=getTemplate(engine,request);
  VelocityContext context=new VelocityContext();
  context.put("request",request);
  context.put("response",response);
  context.put("page",new PageTool(request,response));
  context.put("esc",new EscapeTool());
  template.merge(context,writer);
}
