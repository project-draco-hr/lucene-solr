{
  Template template;
  String template_name=request.getParams().get("v.template");
  String qt=request.getParams().get("qt");
  String path=(String)request.getContext().get("path");
  if (template_name == null && path != null) {
    template_name=path;
  }
  if (template_name == null && qt != null) {
    template_name=qt;
  }
  if (template_name == null)   template_name="index";
  try {
    template=engine.getTemplate(template_name + ".vm");
  }
 catch (  Exception e) {
    throw new IOException(e.getMessage());
  }
  return template;
}
