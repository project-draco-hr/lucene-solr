{
  try {
    for (    DocumentsWriterPerThread dwpt : flushQueue) {
      doAfterFlush(dwpt);
      dwpt.abort();
    }
    for (    BlockedFlush blockedFlush : blockedFlushes) {
      flushingWriters.put(blockedFlush.dwpt,Long.valueOf(blockedFlush.bytes));
      doAfterFlush(blockedFlush.dwpt);
      blockedFlush.dwpt.abort();
    }
  }
  finally {
    fullFlush=false;
    flushQueue.clear();
    blockedFlushes.clear();
    updateStallState();
  }
}
