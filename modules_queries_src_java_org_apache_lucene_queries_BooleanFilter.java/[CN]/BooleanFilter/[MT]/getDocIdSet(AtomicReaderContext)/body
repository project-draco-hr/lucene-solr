{
  FixedBitSet res=null;
  final IndexReader reader=context.reader;
  if (shouldFilters != null) {
    for (int i=0; i < shouldFilters.size(); i++) {
      final DocIdSetIterator disi=getDISI(shouldFilters,i,context);
      if (disi == null)       continue;
      if (res == null) {
        res=new FixedBitSet(reader.maxDoc());
      }
      res.or(disi);
    }
  }
  if (notFilters != null) {
    for (int i=0; i < notFilters.size(); i++) {
      if (res == null) {
        res=new FixedBitSet(reader.maxDoc());
        res.set(0,reader.maxDoc());
      }
      final DocIdSetIterator disi=getDISI(notFilters,i,context);
      if (disi != null) {
        res.andNot(disi);
      }
    }
  }
  if (mustFilters != null) {
    for (int i=0; i < mustFilters.size(); i++) {
      final DocIdSetIterator disi=getDISI(mustFilters,i,context);
      if (disi == null) {
        return DocIdSet.EMPTY_DOCIDSET;
      }
      if (res == null) {
        res=new FixedBitSet(reader.maxDoc());
        res.or(disi);
      }
 else {
        res.and(disi);
      }
    }
  }
  return res != null ? res : DocIdSet.EMPTY_DOCIDSET;
}
