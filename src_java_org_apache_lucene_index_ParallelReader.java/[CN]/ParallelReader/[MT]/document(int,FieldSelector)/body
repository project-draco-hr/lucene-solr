{
  Document result=new Document();
  for (int i=0; i < storedFieldReaders.size(); i++) {
    IndexReader reader=(IndexReader)storedFieldReaders.get(i);
    boolean include=(fieldSelector == null);
    if (!include) {
      Iterator it=((Collection)readerToFields.get(reader)).iterator();
      while (it.hasNext())       if (fieldSelector.accept((String)it.next()) != FieldSelectorResult.NO_LOAD) {
        include=true;
        break;
      }
    }
    if (include) {
      Iterator fieldIterator=reader.document(n,fieldSelector).getFields().iterator();
      while (fieldIterator.hasNext()) {
        result.add((Fieldable)fieldIterator.next());
      }
    }
  }
  return result;
}
