{
  if (readers.size() == 0) {
    this.maxDoc=reader.maxDoc();
    this.numDocs=reader.numDocs();
    this.hasDeletions=reader.hasDeletions();
  }
  if (reader.maxDoc() != maxDoc)   throw new IllegalArgumentException("All readers must have same maxDoc: " + maxDoc + "!="+ reader.maxDoc());
  if (reader.numDocs() != numDocs)   throw new IllegalArgumentException("All readers must have same numDocs: " + numDocs + "!="+ reader.numDocs());
  Collection fields=reader.getFieldNames(IndexReader.FieldOption.ALL);
  readerToFields.put(reader,fields);
  Iterator i=fields.iterator();
  while (i.hasNext()) {
    String field=(String)i.next();
    if (fieldToReader.get(field) == null)     fieldToReader.put(field,reader);
  }
  if (!ignoreStoredFields)   storedFieldReaders.add(reader);
  readers.add(reader);
}
