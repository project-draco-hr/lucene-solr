{
  JavaBinCodec codec=new JavaBinCodec();
  NamedList nl=new NamedList();
  NamedList params=solrParamsToNamedList(updateRequest.getParams());
  if (updateRequest.getCommitWithin() != -1) {
    params.add("commitWithin",updateRequest.getCommitWithin());
  }
  List<List<NamedList>> doclist=new ArrayList<List<NamedList>>();
  if (updateRequest.getDocuments() != null) {
    for (    SolrInputDocument doc : updateRequest.getDocuments()) {
      doclist.add(solrInputDocumentToList(doc));
    }
  }
  nl.add("params",params);
  nl.add("delById",updateRequest.getDeleteById());
  nl.add("delByQ",updateRequest.getDeleteQuery());
  nl.add("docs",doclist.iterator());
  codec.marshal(nl,os);
}
