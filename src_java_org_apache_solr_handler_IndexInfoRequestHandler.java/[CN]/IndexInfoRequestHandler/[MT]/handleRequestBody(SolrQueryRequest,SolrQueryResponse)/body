{
  try {
    SolrIndexSearcher searcher=req.getSearcher();
    IndexReader reader=searcher.getReader();
    Collection<String> fieldNames=reader.getFieldNames(IndexReader.FieldOption.ALL);
    Map<String,Object> fields=new HashMap<String,Object>();
    IndexSchema schema=req.getSchema();
    for (    String fieldName : fieldNames) {
      Map<String,String> fieldInfo=new HashMap<String,String>();
      FieldType fieldType=schema.getFieldTypeNoEx(fieldName);
      if (fieldType != null) {
        fieldInfo.put("type",fieldType.getTypeName());
      }
 else {
        fieldInfo.put("type",null);
      }
      fields.put(fieldName,fieldInfo);
    }
    rsp.add("fields",fields);
    Map<String,Object> indexInfo=new HashMap<String,Object>();
    indexInfo.put("numDocs",reader.numDocs());
    indexInfo.put("maxDoc",reader.maxDoc());
    indexInfo.put("version",Long.toString(reader.getVersion()));
    rsp.add("index",indexInfo);
  }
 catch (  SolrException e) {
    rsp.setException(e);
    return;
  }
catch (  Exception e) {
    SolrException.log(SolrCore.log,e);
    rsp.setException(e);
    return;
  }
}
