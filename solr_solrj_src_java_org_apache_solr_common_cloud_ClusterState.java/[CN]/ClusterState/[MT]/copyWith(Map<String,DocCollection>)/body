{
  ClusterState result=new ClusterState(liveNodes,new LinkedHashMap<>(collectionStates),znodeVersion);
  for (  Entry<String,DocCollection> e : modified.entrySet()) {
    DocCollection c=e.getValue();
    if (c == null) {
      result.collectionStates.remove(e.getKey());
      continue;
    }
    result.collectionStates.put(c.getName(),new CollectionRef(c));
  }
  return result;
}
