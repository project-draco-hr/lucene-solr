{
  if (bytes == null || bytes.length == 0) {
    return new ClusterState(liveNodes,Collections.<String,Map<String,Slice>>emptyMap());
  }
  LinkedHashMap<String,Object> stateMap=(LinkedHashMap<String,Object>)ZkStateReader.fromJSON(bytes);
  HashMap<String,Map<String,Slice>> state=new HashMap<String,Map<String,Slice>>();
  for (  String collectionName : stateMap.keySet()) {
    Map<String,Object> collection=(Map<String,Object>)stateMap.get(collectionName);
    Map<String,Slice> slices=new LinkedHashMap<String,Slice>();
    for (    String sliceName : collection.keySet()) {
      Map<String,Map<String,String>> sliceMap=(Map<String,Map<String,String>>)collection.get(sliceName);
      Map<String,ZkNodeProps> shards=new LinkedHashMap<String,ZkNodeProps>();
      for (      String shardName : sliceMap.keySet()) {
        shards.put(shardName,new ZkNodeProps(sliceMap.get(shardName)));
      }
      Slice slice=new Slice(sliceName,shards);
      slices.put(sliceName,slice);
    }
    state.put(collectionName,slices);
  }
  return new ClusterState(liveNodes,state);
}
