{
  ClusterState result=new ClusterState(liveNodes,new LinkedHashMap<>(collectionStates),znodeVersion);
  if (collection == null) {
    result.collectionStates.remove(collectionName);
  }
 else {
    result.collectionStates.put(collectionName,new CollectionRef(collection));
  }
  return result;
}
