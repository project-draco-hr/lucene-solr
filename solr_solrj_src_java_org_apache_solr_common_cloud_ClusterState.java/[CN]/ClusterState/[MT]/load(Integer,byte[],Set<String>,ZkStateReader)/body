{
  if (bytes == null || bytes.length == 0) {
    return new ClusterState(version,liveNodes,Collections.<String,DocCollection>emptyMap(),stateReader);
  }
  Map<String,Object> stateMap=(Map<String,Object>)ZkStateReader.fromJSON(bytes);
  Map<String,DocCollection> collections=new LinkedHashMap<>(stateMap.size());
  for (  Entry<String,Object> entry : stateMap.entrySet()) {
    String collectionName=entry.getKey();
    DocCollection coll=collectionFromObjects(collectionName,(Map<String,Object>)entry.getValue(),version);
    collections.put(collectionName,coll);
  }
  return new ClusterState(version,liveNodes,collections,stateReader);
}
