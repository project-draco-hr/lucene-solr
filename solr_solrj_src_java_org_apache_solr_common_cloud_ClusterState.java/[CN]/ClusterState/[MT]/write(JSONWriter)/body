{
  if (collectionStates.size() == 1) {
    CollectionRef ref=collectionStates.values().iterator().next();
    DocCollection docCollection=ref.get();
    if (docCollection.getStateFormat() > 1) {
      jsonWriter.write(Collections.singletonMap(docCollection.getName(),docCollection));
      return;
    }
  }
  LinkedHashMap<String,DocCollection> map=new LinkedHashMap<>();
  for (  Entry<String,CollectionRef> e : collectionStates.entrySet()) {
    if (e.getValue().getClass() == CollectionRef.class) {
      DocCollection coll=e.getValue().get();
      if (coll.getStateFormat() == 1) {
        map.put(coll.getName(),coll);
      }
    }
  }
  jsonWriter.write(map);
}
