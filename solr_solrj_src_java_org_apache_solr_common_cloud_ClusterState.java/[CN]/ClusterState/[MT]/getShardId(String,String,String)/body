{
  Collection<CollectionRef> states=collectionStates.values();
  if (collectionName != null) {
    CollectionRef c=collectionStates.get(collectionName);
    if (c != null)     states=Collections.singletonList(c);
  }
  for (  CollectionRef ref : states) {
    DocCollection coll=ref.get();
    if (coll == null)     continue;
    for (    Slice slice : coll.getSlices()) {
      for (      Replica replica : slice.getReplicas()) {
        String rnodeName=replica.getStr(ZkStateReader.NODE_NAME_PROP);
        String rcore=replica.getStr(ZkStateReader.CORE_NAME_PROP);
        if (nodeName.equals(rnodeName) && coreName.equals(rcore)) {
          return slice.getName();
        }
      }
    }
  }
  return null;
}
