{
synchronized (modifyCurrentIndexLock) {
    ensureOpen();
    final Directory dir=this.spellIndex;
    final IndexWriter writer=new IndexWriter(dir,new IndexWriterConfig(Version.LUCENE_CURRENT,new WhitespaceAnalyzer(Version.LUCENE_CURRENT)).setRAMBufferSizeMB(ramMB));
    ((LogMergePolicy)writer.getMergePolicy()).setMergeFactor(mergeFactor);
    Iterator<String> iter=dict.getWordsIterator();
    while (iter.hasNext()) {
      String word=iter.next();
      int len=word.length();
      if (len < 3) {
        continue;
      }
      if (this.exist(word)) {
        continue;
      }
      Document doc=createDocument(word,getMin(len),getMax(len));
      writer.addDocument(doc);
    }
    writer.optimize();
    writer.close();
    swapSearcher(dir);
  }
}
