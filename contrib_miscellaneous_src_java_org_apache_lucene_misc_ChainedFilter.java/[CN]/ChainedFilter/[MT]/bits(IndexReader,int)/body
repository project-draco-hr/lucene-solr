{
  BitSet result;
  int i=0;
  if (logic == AND) {
    result=(BitSet)chain[i].bits(reader).clone();
    ++i;
  }
 else   if (logic == ANDNOT) {
    result=(BitSet)chain[i].bits(reader).clone();
    result.flip(0,reader.maxDoc());
    ++i;
  }
 else {
    result=new BitSet(reader.maxDoc());
  }
  for (; i < chain.length; i++) {
    doChain(result,reader,logic,chain[i]);
  }
  return result;
}
