{
  if (logic.length != chain.length)   throw new IllegalArgumentException("Invalid number of elements in logic array");
  BitSet result;
  int i=0;
  if (logic[0] == AND) {
    result=(BitSet)chain[i].bits(reader).clone();
    ++i;
  }
 else   if (logic[0] == ANDNOT) {
    result=(BitSet)chain[i].bits(reader).clone();
    result.flip(0,reader.maxDoc());
    ++i;
  }
 else {
    result=new BitSet(reader.maxDoc());
  }
  for (; i < chain.length; i++) {
    doChain(result,reader,logic[i],chain[i]);
  }
  return result;
}
