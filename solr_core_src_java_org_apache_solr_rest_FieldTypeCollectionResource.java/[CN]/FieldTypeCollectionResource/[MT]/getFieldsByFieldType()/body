{
  Map<String,List<String>> fieldsByFieldType=new HashMap<String,List<String>>();
  for (  SchemaField schemaField : getSchema().getFields().values()) {
    final String fieldType=schemaField.getType().getTypeName();
    List<String> fields=fieldsByFieldType.get(fieldType);
    if (null == fields) {
      fields=new ArrayList<String>();
      fieldsByFieldType.put(fieldType,fields);
    }
    fields.add(schemaField.getName());
  }
  for (  List<String> fields : fieldsByFieldType.values()) {
    Collections.sort(fields);
  }
  return fieldsByFieldType;
}
