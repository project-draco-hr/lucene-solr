{
  for (  Map<String,String> fld : context.getAllEntityFields()) {
    String style=fld.get(FORMAT_STYLE);
    if (style != null) {
      String column=fld.get(DataImporter.COLUMN);
      String srcCol=fld.get(RegexTransformer.SRC_COL_NAME);
      if (srcCol == null)       srcCol=column;
      Object val=row.get(srcCol);
      String styleSmall=style.toLowerCase();
      if (val instanceof List) {
        List<String> inputs=(List)val;
        List results=new ArrayList();
        for (        String input : inputs) {
          try {
            results.add(process(input,styleSmall));
          }
 catch (          ParseException e) {
            throw new DataImportHandlerException(DataImportHandlerException.SEVERE,"Failed to apply NumberFormat on column: " + column,e);
          }
        }
        row.put(column,results);
      }
 else {
        if (val == null || val.toString().trim().equals(""))         continue;
        try {
          row.put(column,process(val.toString(),styleSmall));
        }
 catch (        ParseException e) {
          throw new DataImportHandlerException(DataImportHandlerException.SEVERE,"Failed to apply NumberFormat on column: " + column,e);
        }
      }
    }
  }
  return row;
}
