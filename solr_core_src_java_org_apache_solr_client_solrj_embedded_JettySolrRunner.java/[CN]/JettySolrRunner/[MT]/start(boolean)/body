{
  Map<String,String> prevContext=MDC.getCopyOfContextMap();
  MDC.clear();
  try {
    if (startedBefore) {
      waitOnSolr=false;
      int port=reusePort ? lastPort : this.config.port;
      init(port);
    }
 else {
      startedBefore=true;
    }
    if (!server.isRunning()) {
      server.start();
    }
synchronized (JettySolrRunner.this) {
      int cnt=0;
      while (!waitOnSolr) {
        this.wait(100);
        if (cnt++ == 5) {
          throw new RuntimeException("Jetty/Solr unresponsive");
        }
      }
    }
    if (config.waitForLoadingCoresToFinishMs != null && config.waitForLoadingCoresToFinishMs > 0L)     waitForLoadingCoresToFinish(config.waitForLoadingCoresToFinishMs);
  }
  finally {
    if (prevContext != null) {
      MDC.setContextMap(prevContext);
    }
 else {
      MDC.clear();
    }
  }
}
