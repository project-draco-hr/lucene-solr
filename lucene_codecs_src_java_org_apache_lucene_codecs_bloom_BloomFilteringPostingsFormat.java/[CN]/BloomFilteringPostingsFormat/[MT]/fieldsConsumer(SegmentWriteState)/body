{
  if (delegatePostingsFormat == null) {
    throw new UnsupportedOperationException("Error - " + getClass().getName() + " has been constructed without a choice of PostingsFormat");
  }
  FieldsConsumer fieldsConsumer=delegatePostingsFormat.fieldsConsumer(state);
  if (!(fieldsConsumer instanceof PushFieldsConsumer)) {
    throw new UnsupportedOperationException("Wrapped PostingsFormat must return a PushFieldsConsumer");
  }
  return new BloomFilteredFieldsConsumer((PushFieldsConsumer)fieldsConsumer,state);
}
