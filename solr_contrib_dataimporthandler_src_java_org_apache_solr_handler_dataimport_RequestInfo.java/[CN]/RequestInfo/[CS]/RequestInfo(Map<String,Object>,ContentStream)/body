{
  this.contentStream=stream;
  if (requestParams.containsKey("command")) {
    command=(String)requestParams.get("command");
  }
 else {
    command=null;
  }
  boolean debugMode=StrUtils.parseBool((String)requestParams.get("debug"),false);
  if (debugMode) {
    debug=true;
    debugInfo=new DebugInfo(requestParams);
  }
 else {
    debug=false;
    debugInfo=null;
  }
  if (requestParams.containsKey("clean")) {
    clean=StrUtils.parseBool((String)requestParams.get("clean"),true);
  }
 else   if (DataImporter.DELTA_IMPORT_CMD.equals(command) || DataImporter.IMPORT_CMD.equals(command)) {
    clean=false;
  }
 else {
    clean=debug ? false : true;
  }
  optimize=StrUtils.parseBool((String)requestParams.get("optimize"),false);
  if (optimize) {
    commit=true;
  }
 else {
    commit=StrUtils.parseBool((String)requestParams.get("commit"),(debug ? false : true));
  }
  if (requestParams.containsKey("rows")) {
    rows=Integer.parseInt((String)requestParams.get("rows"));
  }
 else {
    rows=debug ? 10 : Long.MAX_VALUE;
  }
  if (requestParams.containsKey("start")) {
    start=Integer.parseInt((String)requestParams.get("start"));
  }
 else {
    start=0;
  }
  syncMode=StrUtils.parseBool((String)requestParams.get("synchronous"),false);
  Object o=requestParams.get("entity");
  List<String> modifiableEntities=null;
  if (o != null) {
    if (o instanceof String) {
      modifiableEntities=new ArrayList<String>();
      modifiableEntities.add((String)o);
    }
 else     if (o instanceof List<?>) {
      @SuppressWarnings("unchecked") List<String> modifiableEntities1=new ArrayList<String>((List<String>)o);
      modifiableEntities=modifiableEntities1;
    }
    entitiesToRun=Collections.unmodifiableList(modifiableEntities);
  }
 else {
    entitiesToRun=null;
  }
  String dataConfigParam=(String)requestParams.get("dataConfig");
  if (dataConfigParam != null && dataConfigParam.trim().length() == 0) {
    dataConfigParam=null;
  }
  dataConfig=dataConfigParam;
  this.rawParams=Collections.unmodifiableMap(new HashMap<String,Object>(requestParams));
}
