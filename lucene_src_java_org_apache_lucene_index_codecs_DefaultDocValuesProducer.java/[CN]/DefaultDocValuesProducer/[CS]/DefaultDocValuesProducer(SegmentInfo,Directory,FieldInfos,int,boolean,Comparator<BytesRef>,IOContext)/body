{
  this.useCompoundFile=useCompoundFile;
  this.sortComparator=sortComparator;
  final Directory directory;
  if (useCompoundFile) {
    cfs=directory=new CompoundFileDirectory(dir,IndexFileNames.segmentFileName(si.name,codecId,IndexFileNames.COMPOUND_FILE_EXTENSION),context,false);
  }
 else {
    cfs=null;
    directory=dir;
  }
  docValues=load(fieldInfo,si.name,si.docCount,directory,codecId,context);
}
