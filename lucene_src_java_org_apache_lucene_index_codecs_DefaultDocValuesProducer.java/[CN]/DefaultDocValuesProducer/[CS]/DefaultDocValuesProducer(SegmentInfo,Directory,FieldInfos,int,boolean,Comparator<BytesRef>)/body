{
  this.useCompoundFile=useCompoundFile;
  this.sortComparator=sortComparator;
  final Directory directory;
  if (useCompoundFile) {
    cfs=directory=dir.openCompoundInput(IndexFileNames.segmentFileName(si.name,codecId,IndexFileNames.COMPOUND_FILE_EXTENSION),1024);
  }
 else {
    cfs=null;
    directory=dir;
  }
  docValues=load(fieldInfo,si.name,si.docCount,directory,codecId);
}
