{
  TreeMap<String,IndexDocValues> values=new TreeMap<String,IndexDocValues>();
  boolean success=false;
  try {
    for (    FieldInfo fieldInfo : fieldInfos) {
      if (codecId == fieldInfo.getCodecId() && fieldInfo.hasDocValues()) {
        final String field=fieldInfo.name;
        final String id=DefaultDocValuesConsumer.docValuesId(segment,codecId,fieldInfo.number);
        values.put(field,loadDocValues(docCount,dir,id,fieldInfo.getDocValues(),sortComparator));
      }
    }
    success=true;
  }
  finally {
    if (!success) {
      closeInternal(values.values());
    }
  }
  return values;
}
