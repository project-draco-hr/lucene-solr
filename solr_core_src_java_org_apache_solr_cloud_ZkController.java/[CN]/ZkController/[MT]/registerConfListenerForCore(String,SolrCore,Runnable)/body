{
  if (listener == null)   throw new NullPointerException("listener cannot be null");
synchronized (confDirectoryWatchers) {
    if (confDirectoryWatchers.containsKey(confDir)) {
      confDirectoryWatchers.get(confDir).add(listener);
      core.addCloseHook(new CloseHook(){
        @Override public void preClose(        SolrCore core){
          unRegisterConfListener(listener);
        }
        @Override public void postClose(        SolrCore core){
        }
      }
);
    }
 else {
      throw new SolrException(ErrorCode.SERVER_ERROR,"This conf directory is not valid");
    }
  }
}
