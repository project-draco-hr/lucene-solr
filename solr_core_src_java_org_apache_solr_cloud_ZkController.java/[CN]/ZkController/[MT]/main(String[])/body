{
  String zkServerAddress=args[0];
  String solrHome=args[1];
  String solrPort=null;
  if (args.length > 2) {
    solrPort=args[2];
  }
  SolrZkServer zkServer=null;
  if (solrPort != null) {
    zkServer=new SolrZkServer("true",null,solrHome + "/zoo_data",solrHome,solrPort);
    zkServer.parseConfig();
    zkServer.start();
  }
  SolrZkClient zkClient=new SolrZkClient(zkServerAddress,15000,5000,new OnReconnect(){
    @Override public void command(){
    }
  }
);
  SolrResourceLoader loader=new SolrResourceLoader(solrHome);
  solrHome=loader.getInstanceDir();
  InputSource cfgis=new InputSource(new File(solrHome,"solr.xml").toURI().toASCIIString());
  Config cfg=new Config(loader,null,cfgis,null,false);
  bootstrapConf(zkClient,cfg,solrHome);
  if (solrPort != null) {
    zkServer.stop();
  }
}
