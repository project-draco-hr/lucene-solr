{
  final String coreNodeName=getCoreNodeName(descriptor);
  int retryCount=320;
  while (retryCount-- > 0) {
    final String shardId=zkStateReader.getClusterState().getShardId(coreNodeName);
    if (shardId != null) {
      return shardId;
    }
    try {
      Thread.sleep(1000);
    }
 catch (    InterruptedException e) {
      Thread.currentThread().interrupt();
    }
  }
  throw new SolrException(ErrorCode.SERVER_ERROR,"Could not get shard_id for core: " + coreName + " coreNodeName:"+ coreNodeName);
}
