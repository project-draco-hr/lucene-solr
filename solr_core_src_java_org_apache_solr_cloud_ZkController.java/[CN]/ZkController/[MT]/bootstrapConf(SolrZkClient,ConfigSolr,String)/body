{
  List<String> allCoreNames=cfg.getAllCoreNames();
  log.info("bootstraping config for " + allCoreNames.size() + " cores into ZooKeeper using solr.xml from "+ solrHome);
  for (  String coreName : allCoreNames) {
    String rawName=PropertiesUtil.substituteProperty(cfg.getProperty(coreName,"name",null),new Properties());
    String instanceDir=cfg.getProperty(coreName,"instanceDir",null);
    File idir=new File(instanceDir);
    System.out.println("idir:" + idir);
    if (!idir.isAbsolute()) {
      idir=new File(solrHome,instanceDir);
    }
    String confName=PropertiesUtil.substituteProperty(cfg.getProperty(coreName,"collection",null),new Properties());
    if (confName == null) {
      confName=rawName;
    }
    File udir=new File(idir,"conf");
    log.info("Uploading directory " + udir + " with name "+ confName+ " for SolrCore "+ rawName);
    ZkController.uploadConfigDir(zkClient,udir,confName);
  }
}
