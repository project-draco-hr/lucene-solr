{
  int retryCount=320;
  log.info("look for our core node name");
  while (retryCount-- > 0) {
    Map<String,Slice> slicesMap=zkStateReader.getClusterState().getSlicesMap(descriptor.getCloudDescriptor().getCollectionName());
    if (slicesMap != null) {
      for (      Slice slice : slicesMap.values()) {
        for (        Replica replica : slice.getReplicas()) {
          String nodeName=replica.getStr(ZkStateReader.NODE_NAME_PROP);
          String core=replica.getStr(ZkStateReader.CORE_NAME_PROP);
          String msgNodeName=getNodeName();
          String msgCore=descriptor.getName();
          if (msgNodeName.equals(nodeName) && core.equals(msgCore)) {
            descriptor.getCloudDescriptor().setCoreNodeName(replica.getName());
            return;
          }
        }
      }
    }
    try {
      Thread.sleep(1000);
    }
 catch (    InterruptedException e) {
      Thread.currentThread().interrupt();
    }
  }
}
