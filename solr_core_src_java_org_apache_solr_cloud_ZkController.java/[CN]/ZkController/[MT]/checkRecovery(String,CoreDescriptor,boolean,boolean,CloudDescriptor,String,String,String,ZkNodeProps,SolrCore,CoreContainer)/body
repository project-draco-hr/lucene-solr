{
  boolean doRecovery=true;
  if (isLeader) {
    doRecovery=false;
    UpdateLog ulog=core.getUpdateHandler().getUpdateLog();
    if (!core.isReloaded() && ulog != null) {
      Future<UpdateLog.RecoveryInfo> recoveryFuture=core.getUpdateHandler().getUpdateLog().recoverFromLog();
      if (recoveryFuture != null) {
        recoveryFuture.get();
      }
    }
    return false;
  }
 else {
    if (core.isReloaded() && !recoverReloadedCores) {
      doRecovery=false;
    }
  }
  if (doRecovery && !SKIP_AUTO_RECOVERY) {
    log.info("Core needs to recover:" + core.getName());
    core.getUpdateHandler().getSolrCoreState().doRecovery(core);
    return true;
  }
  return false;
}
