{
  log.info("Looking for collection configName");
  int retry=1;
  for (; retry < 6; retry++) {
    if (zkClient.exists(collectionPath,true)) {
      ZkNodeProps cProps=ZkNodeProps.load(zkClient.getData(collectionPath,null,null,true));
      if (cProps.containsKey(CONFIGNAME_PROP)) {
        break;
      }
    }
    List<String> configNames=null;
    try {
      configNames=zkClient.getChildren(CONFIGS_ZKNODE,null,true);
    }
 catch (    NoNodeException e) {
    }
    if (configNames != null && configNames.size() == 1) {
      log.info("Only one config set found in zk - using it:" + configNames.get(0));
      collectionProps.put(CONFIGNAME_PROP,configNames.get(0));
      break;
    }
    log.info("Could not find collection configName - pausing for 2 seconds and trying again - try: " + retry);
    Thread.sleep(2000);
  }
  if (retry == 6) {
    log.error("Could not find configName for collection " + collection);
    throw new ZooKeeperException(SolrException.ErrorCode.SERVER_ERROR,"Could not find configName for collection " + collection);
  }
}
