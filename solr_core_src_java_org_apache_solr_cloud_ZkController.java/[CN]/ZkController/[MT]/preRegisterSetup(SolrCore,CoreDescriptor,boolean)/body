{
  publish(cd,ZkStateReader.DOWN);
  String shardId=cd.getCloudDescriptor().getShardId();
  Map<String,String> props=new HashMap<String,String>();
  props.put(ZkStateReader.BASE_URL_PROP,getBaseUrl());
  props.put(ZkStateReader.CORE_NAME_PROP,cd.getName());
  props.put(ZkStateReader.NODE_NAME_PROP,getNodeName());
  final String coreZkNodeName=getNodeName() + "_" + cd.getName();
  ZkNodeProps ourProps=new ZkNodeProps(props);
  String collection=cd.getCloudDescriptor().getCollectionName();
  try {
    joinElection(collection,coreZkNodeName,shardId,ourProps,core);
  }
 catch (  InterruptedException e) {
    Thread.currentThread().interrupt();
    throw new ZooKeeperException(SolrException.ErrorCode.SERVER_ERROR,"",e);
  }
catch (  KeeperException e) {
    throw new ZooKeeperException(SolrException.ErrorCode.SERVER_ERROR,"",e);
  }
catch (  IOException e) {
    throw new ZooKeeperException(SolrException.ErrorCode.SERVER_ERROR,"",e);
  }
  waitForLeaderToSeeDownState(cd,coreZkNodeName,waitForNotLive);
}
