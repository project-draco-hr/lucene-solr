{
  NodeList nodes=(NodeList)cfg.evaluate("solr/cores/core",XPathConstants.NODESET);
  for (int i=0; i < nodes.getLength(); i++) {
    Node node=nodes.item(i);
    String rawName=DOMUtil.getAttr(node,"name",null);
    String instanceDir=DOMUtil.getAttr(node,"instanceDir",null);
    File idir=new File(instanceDir);
    if (!idir.isAbsolute()) {
      idir=new File(solrHome,instanceDir);
    }
    String confName=DOMUtil.getAttr(node,"collection",null);
    if (confName == null) {
      confName=rawName;
    }
    ZkController.uploadConfigDir(zkClient,new File(idir,"conf"),confName);
  }
}
