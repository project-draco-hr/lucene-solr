{
  final int numIndexedShapes=1 + atMost(9);
  List<Shape> indexedShapes=new ArrayList<>(numIndexedShapes);
  for (int i=0; i < numIndexedShapes; i++) {
    indexedShapes.add(randomIndexedShape());
  }
  for (int i=0; i < indexedShapes.size(); i++) {
    Shape shape=indexedShapes.get(i);
    adoc("" + i,shape);
    if (random().nextInt(10) == 0)     commit();
  }
  for (int id=0; id < indexedShapes.size(); id++) {
    if (random().nextInt(10) == 0) {
      deleteDoc("" + id);
      indexedShapes.set(id,null);
    }
  }
  commit();
  final Rectangle rect=randomRectangle();
  queryHeatmapRecursive(usually() ? ctx.getWorldBounds() : rect,1);
  if (rect.getWidth() > 0) {
    double shift=random().nextDouble() % rect.getWidth();
    queryHeatmapRecursive(ctx.makeRectangle(DistanceUtils.normLonDEG(rect.getMinX() - shift),DistanceUtils.normLonDEG(rect.getMaxX() - shift),rect.getMinY(),rect.getMaxY()),1);
  }
}
