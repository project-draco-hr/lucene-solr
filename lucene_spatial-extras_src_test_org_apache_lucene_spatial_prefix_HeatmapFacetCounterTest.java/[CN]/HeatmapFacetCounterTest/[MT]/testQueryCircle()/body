{
  final SpatialContextFactory spatialContextFactory=new SpatialContextFactory();
  spatialContextFactory.geo=false;
  spatialContextFactory.worldBounds=new RectangleImpl(-90,90,-90,90,null);
  ctx=spatialContextFactory.newSpatialContext();
  final int LEVEL=4;
  grid=new QuadPrefixTree(ctx,LEVEL);
  strategy=new RecursivePrefixTreeStrategy(grid,getTestClass().getSimpleName());
  Circle circle=ctx.makeCircle(0,0,89);
  adoc("0",ctx.makePoint(88,88));
  adoc("1",ctx.makePoint(0,0));
  commit();
  final HeatmapFacetCounter.Heatmap heatmap=HeatmapFacetCounter.calcFacets((PrefixTreeStrategy)strategy,indexSearcher.getTopReaderContext(),null,circle,LEVEL,1000);
  boolean foundOne=false;
  for (  int count : heatmap.counts) {
switch (count) {
case 0:
      break;
case 1:
    assertFalse(foundOne);
  foundOne=true;
break;
default :
fail("counts should be 0 or 1: " + count);
}
}
assertTrue(foundOne);
}
