{
  IndexCommitPoint cp=dp.snapshot();
  try {
    Collection files=cp.getFileNames();
    Iterator it=files.iterator();
    while (it.hasNext()) {
      final String fileName=(String)it.next();
      readFile(dir,fileName);
    }
  }
  finally {
    dp.release();
  }
}
