{
  for (  String dim : expectedCounts.keySet()) {
    FacetLabel drillDownCP=new FacetLabel(dim);
    FacetSearchParams fsp=new FacetSearchParams(fip,new CountFacetRequest(drillDownCP,10));
    DrillDownQuery drillDown=new DrillDownQuery(fip,new MatchAllDocsQuery());
    drillDown.add(drillDownCP);
    TotalHitCountCollector total=new TotalHitCountCollector();
    FacetsCollector fc=FacetsCollector.create(fsp,indexReader,taxoReader);
    searcher.search(drillDown,MultiCollector.wrap(fc,total));
    assertTrue("no results for drill-down query " + drillDown,total.getTotalHits() > 0);
    List<FacetResult> facetResults=fc.getFacetResults();
    assertEquals(1,facetResults.size());
    FacetResultNode rootNode=facetResults.get(0).getFacetResultNode();
    assertEquals("wrong count for " + dim,expectedCounts.get(dim).intValue(),(int)rootNode.value);
  }
}
