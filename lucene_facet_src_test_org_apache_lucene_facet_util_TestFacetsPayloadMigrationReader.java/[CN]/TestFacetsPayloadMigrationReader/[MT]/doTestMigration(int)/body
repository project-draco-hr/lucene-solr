{
  Directory indexDir=newDirectory();
  Directory taxoDir=newDirectory();
  HashMap<FacetLabel,CategoryListParams> params=new HashMap<FacetLabel,CategoryListParams>();
  params.put(new FacetLabel(DIMENSIONS[0]),new CategoryListParams(DIMENSIONS[0]){
    @Override public OrdinalPolicy getOrdinalPolicy(    String dimension){
      return OrdinalPolicy.ALL_PARENTS;
    }
  }
);
  params.put(new FacetLabel(DIMENSIONS[1]),new CategoryListParams(DIMENSIONS[1]){
    @Override public OrdinalPolicy getOrdinalPolicy(    String dimension){
      return OrdinalPolicy.ALL_PARENTS;
    }
  }
);
  HashMap<String,OrdinalPolicy> policies=new HashMap<String,CategoryListParams.OrdinalPolicy>();
  policies.put(DIMENSIONS[2],OrdinalPolicy.ALL_PARENTS);
  policies.put(DIMENSIONS[3],OrdinalPolicy.ALL_PARENTS);
  FacetIndexingParams fip=new PerDimensionIndexingParams(params,new PerDimensionOrdinalPolicy(policies)){
    @Override public int getPartitionSize(){
      return partitionSize;
    }
  }
;
  HashMap<String,Integer> expectedCounts=createIndex(indexDir,taxoDir,fip);
  migrateIndex(indexDir,fip);
  verifyMigratedIndex(indexDir,taxoDir,expectedCounts,fip);
  IOUtils.close(indexDir,taxoDir);
}
