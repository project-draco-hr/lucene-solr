{
  out.close();
  if (count != countWritten) {
    throw new IllegalStateException("wrote " + countWritten + " values, but expected "+ count);
  }
}
