{
  closed=true;
  tempFile.close();
  if (count != countWritten) {
    throw new IllegalStateException("wrote " + countWritten + " values, but expected "+ count);
  }
}
