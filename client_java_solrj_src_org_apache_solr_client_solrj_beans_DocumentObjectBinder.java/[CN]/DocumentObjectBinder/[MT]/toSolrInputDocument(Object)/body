{
  List<DocField> fields=getDocFields(obj.getClass());
  if (fields.isEmpty()) {
    throw new RuntimeException("class: " + obj.getClass() + " does not define any fields.");
  }
  SolrInputDocument doc=new SolrInputDocument();
  for (  DocField field : fields) {
    doc.setField(field.name,field.get(obj),1.0f);
  }
  return doc;
}
