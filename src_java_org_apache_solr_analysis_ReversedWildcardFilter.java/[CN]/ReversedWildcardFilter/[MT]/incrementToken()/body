{
  if (save != null) {
    restoreState(save);
    save=null;
    return true;
  }
  if (!input.incrementToken())   return false;
  int oldLen=termAtt.termLength();
  if (oldLen == 0)   return true;
  int origOffset=posAtt.getPositionIncrement();
  if (withOriginal == true) {
    posAtt.setPositionIncrement(0);
    save=captureState();
  }
  char[] buffer=termAtt.resizeTermBuffer(oldLen + 1);
  buffer[oldLen]=markerChar;
  ReverseStringFilter.reverse(buffer,oldLen + 1);
  posAtt.setPositionIncrement(origOffset);
  termAtt.setTermBuffer(buffer,0,oldLen + 1);
  return true;
}
