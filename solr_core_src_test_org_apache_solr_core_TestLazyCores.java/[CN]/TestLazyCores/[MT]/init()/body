{
  if (_solrHomeDirectory.exists()) {
    FileUtils.deleteDirectory(_solrHomeDirectory);
  }
  assertTrue("Failed to mkdirs workDir",_solrHomeDirectory.mkdirs());
  for (int idx=1; idx < 10; ++idx) {
    copyConfFiles(_solrHomeDirectory,"collection" + idx);
  }
  File solrXml=new File(_solrHomeDirectory,"solr.xml");
  FileUtils.write(solrXml,LOTS_SOLR_XML,IOUtils.CHARSET_UTF_8.toString());
  final CoreContainer cores=new CoreContainer(_solrHomeDirectory.getAbsolutePath());
  cores.load(_solrHomeDirectory.getAbsolutePath(),solrXml);
  cores.setPersistent(false);
  return cores;
}
