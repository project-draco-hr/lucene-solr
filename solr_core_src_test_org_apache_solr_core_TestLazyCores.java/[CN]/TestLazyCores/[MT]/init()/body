{
  solrHomeDirectory=createTempDir().toFile();
  for (int idx=1; idx < 10; ++idx) {
    copyMinConf(new File(solrHomeDirectory,"collection" + idx));
  }
  SolrResourceLoader loader=new SolrResourceLoader(solrHomeDirectory.getAbsolutePath());
  File solrXml=new File(solrHomeDirectory,"solr.xml");
  FileUtils.write(solrXml,LOTS_SOLR_XML,Charsets.UTF_8.toString());
  ConfigSolrXmlOld config=(ConfigSolrXmlOld)ConfigSolr.fromFile(loader,solrXml);
  CoresLocator locator=new SolrXMLCoresLocator.NonPersistingLocator(LOTS_SOLR_XML,config);
  final CoreContainer cores=new CoreContainer(loader,config,locator);
  cores.load();
  return cores;
}
