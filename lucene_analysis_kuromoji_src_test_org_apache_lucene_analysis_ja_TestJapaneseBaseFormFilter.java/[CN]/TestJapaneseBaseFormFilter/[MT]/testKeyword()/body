{
  final CharArraySet exclusionSet=new CharArraySet(asSet("??????"),false);
  Analyzer a=new Analyzer(){
    @Override protected TokenStreamComponents createComponents(    String fieldName){
      Tokenizer source=new JapaneseTokenizer(newAttributeFactory(),null,true,JapaneseTokenizer.DEFAULT_MODE);
      TokenStream sink=new SetKeywordMarkerFilter(source,exclusionSet);
      return new TokenStreamComponents(source,new JapaneseBaseFormFilter(sink));
    }
  }
;
  assertAnalyzesTo(a,"??????????????????????????????????????????",new String[]{"??????","???","??????","??????","??????","???","??????","??????"});
  a.close();
}
