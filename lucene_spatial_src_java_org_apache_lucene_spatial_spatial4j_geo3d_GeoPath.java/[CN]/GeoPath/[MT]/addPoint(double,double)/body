{
  if (lat < -Math.PI * 0.5 || lat > Math.PI * 0.5)   throw new IllegalArgumentException("Latitude out of range");
  if (lon < -Math.PI || lon > Math.PI)   throw new IllegalArgumentException("Longitude out of range");
  GeoPoint end=new GeoPoint(lat,lon);
  if (points.size() > 0) {
    GeoPoint start=points.get(points.size() - 1).point;
    PathSegment ps=new PathSegment(start,end,cutoffOffset,cutoffAngle,chordDistance);
    if (ps.isDegenerate())     return;
    segments.add(ps);
  }
  SegmentEndpoint se=new SegmentEndpoint(end,originDistance,cutoffOffset,cutoffAngle,chordDistance);
  points.add(se);
}
