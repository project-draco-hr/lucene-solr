{
  assertQ("/schema/fields?indent=on&wt=xml","count(/response/arr[@name='fields']/lst/str[@name]) > 0","count(/response/arr[@name='fields']/lst/str[starts-with(@name,'newfield')]) = 0");
  assertJPost("/schema/fields",json("[{'name':'newfield','type':'text_en','stored':true,'indexed':false}]"),"/responseHeader/status==0");
  File managedSchemaFile=new File(tmpConfDir,"managed-schema");
  assertTrue(managedSchemaFile.exists());
  String managedSchemaContents=FileUtils.readFileToString(managedSchemaFile,"UTF-8");
  Pattern newfieldStoredTrueIndexedFalsePattern=Pattern.compile("<field name=\"newfield\" type=\"text_en\" " + "(?=.*stored=\"true\")(?=.*indexed=\"false\").*/>");
  assertTrue(newfieldStoredTrueIndexedFalsePattern.matcher(managedSchemaContents).find());
  assertQ("/schema/fields?indent=on&wt=xml","/response/arr[@name='fields']/lst" + "[str[@name='name']='newfield' and str[@name='type']='text_en'" + " and bool[@name='stored']='true' and bool[@name='indexed']='false']");
  assertU(adoc("newfield","value1 value2","id","789"));
  assertU(commit());
  assertJPost("/schema/fields",json("[{'name':'newfield2','type':'text_en','stored':true,'indexed':true,'multiValued':true}]"),"/responseHeader/status==0");
  managedSchemaContents=FileUtils.readFileToString(managedSchemaFile,"UTF-8");
  Pattern newfield2StoredTrueIndexedTrueMultiValuedTruePattern=Pattern.compile("<field name=\"newfield2\" type=\"text_en\" " + "(?=.*stored=\"true\")(?=.*indexed=\"true\")(?=multiValued=\"true\").*/>");
  assertTrue(newfield2StoredTrueIndexedTrueMultiValuedTruePattern.matcher(managedSchemaContents).find());
  assertQ("/schema/fields?indent=on&wt=xml","/response/arr[@name='fields']/lst" + "[str[@name='name']='newfield2' and str[@name='type']='text_en'" + " and bool[@name='stored']='true' and bool[@name='indexed']='true' and bool[@name='multiValued']='true']");
  assertU(adoc("newfield2","value1 value2","newfield2","value3 value4","id","790"));
  assertU(commit());
  assertQ("/select?q=newfield2:value3","/response/lst[@name='responseHeader']/int[@name='status'] = '0'","/response/result[@name='response'][@numFound='1']","count(/response/result[@name='response']/doc) = 1","/response/result[@name='response']/doc/str[@name='id'][.='790']");
}
