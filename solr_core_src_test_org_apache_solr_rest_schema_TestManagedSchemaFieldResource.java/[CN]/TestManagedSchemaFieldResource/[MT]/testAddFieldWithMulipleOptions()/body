{
  assertQ("/schema/fields/newfield?indent=on&wt=xml","count(/response/lst[@name='field']) = 0","/response/lst[@name='responseHeader']/int[@name='status'] = '404'","/response/lst[@name='error']/int[@name='code'] = '404'");
  assertJPut("/schema/fields/newfield",json("{'type':'text_en','stored':true,'indexed':false}"),"/responseHeader/status==0");
  File managedSchemaFile=new File(tmpConfDir,"managed-schema");
  assertTrue(managedSchemaFile.exists());
  String managedSchemaContents=FileUtils.readFileToString(managedSchemaFile,"UTF-8");
  Pattern newfieldStoredTrueIndexedFalsePattern=Pattern.compile("<field name=\"newfield\" type=\"text_en\" " + "(?=.*stored=\"true\")(?=.*indexed=\"false\").*/>");
  assertTrue(newfieldStoredTrueIndexedFalsePattern.matcher(managedSchemaContents).find());
  assertQ("/schema/fields/newfield?indent=on&wt=xml","count(/response/lst[@name='field']) = 1","/response/lst[@name='responseHeader']/int[@name='status'] = '0'","/response/lst[@name='field']/str[@name='name'] = 'newfield'","/response/lst[@name='field']/str[@name='type'] = 'text_en'","/response/lst[@name='field']/bool[@name='indexed'] = 'false'","/response/lst[@name='field']/bool[@name='stored'] = 'true'");
  assertU(adoc("newfield","value1 value2","id","1234"));
  assertU(commit());
  assertQ("/schema/fields/newfield2?indent=on&wt=xml","count(/response/lst[@name='field']) = 0","/response/lst[@name='responseHeader']/int[@name='status'] = '404'","/response/lst[@name='error']/int[@name='code'] = '404'");
  assertJPut("/schema/fields/newfield2",json("{'type':'text_en','stored':true,'indexed':true,'multiValued':true}"),"/responseHeader/status==0");
  managedSchemaContents=FileUtils.readFileToString(managedSchemaFile,"UTF-8");
  Pattern newfield2StoredTrueIndexedTrueMultiValuedTruePattern=Pattern.compile("<field name=\"newfield2\" type=\"text_en\" " + "(?=.*stored=\"true\")(?=.*indexed=\"true\")(?=.*multiValued=\"true\").*/>");
  assertTrue(newfield2StoredTrueIndexedTrueMultiValuedTruePattern.matcher(managedSchemaContents).find());
  assertQ("/schema/fields/newfield2?indent=on&wt=xml","count(/response/lst[@name='field']) = 1","/response/lst[@name='responseHeader']/int[@name='status'] = '0'","/response/lst[@name='field']/str[@name='name'] = 'newfield2'","/response/lst[@name='field']/str[@name='type'] = 'text_en'","/response/lst[@name='field']/bool[@name='indexed'] = 'true'","/response/lst[@name='field']/bool[@name='stored'] = 'true'","/response/lst[@name='field']/bool[@name='multiValued'] = 'true'");
  assertU(adoc("newfield2","value1 value2","newfield2","value3 value4","id","5678"));
  assertU(commit());
  assertQ("/select?q=newfield2:value3","/response/lst[@name='responseHeader']/int[@name='status'] = '0'","/response/result[@name='response'][@numFound='1']","count(/response/result[@name='response']/doc) = 1","/response/result[@name='response']/doc/str[@name='id'][.='5678']");
}
