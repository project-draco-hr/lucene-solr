{
  for (  LeafReaderContext ctx : sortedReader.leaves()) {
    LeafReader reader=ctx.reader();
    BinaryDocValues dv=reader.getBinaryDocValues(BINARY_DV_FIELD);
    boolean isSorted=reader.getIndexSort() != null;
    int lastID=Integer.MIN_VALUE;
    for (int docID=0; docID < reader.maxDoc(); docID++) {
      BytesRef bytes=dv.get(docID);
      String idString=reader.document(docID).get(ID_FIELD);
      assertEquals("incorrect binary DocValues for doc " + docID,idString,bytes.utf8ToString());
      if (isSorted) {
        int id=Integer.parseInt(idString);
        assertTrue("lastID=" + lastID + " vs id="+ id,lastID < id);
        lastID=id;
      }
    }
  }
}
