{
  for (  LeafReaderContext ctx : sortedReader.leaves()) {
    LeafReader reader=ctx.reader();
    SortedDocValues dv=reader.getSortedDocValues(SORTED_DV_FIELD);
    int maxDoc=reader.maxDoc();
    for (int doc=0; doc < maxDoc; doc++) {
      final BytesRef bytes=dv.get(doc);
      String id=reader.document(doc).get(ID_FIELD);
      assertEquals("incorrect sorted DocValues for doc " + doc,id,bytes.utf8ToString());
    }
  }
}
