{
  Directory dir=newDirectory();
  IndexWriterConfig iwc=new IndexWriterConfig(new MockAnalyzer(random()));
  Sort indexSort=new Sort(new SortField("foo",SortField.Type.FLOAT));
  iwc.setIndexSort(indexSort);
  IndexWriter w=new IndexWriter(dir,iwc);
  Document doc=new Document();
  doc.add(new FloatDocValuesField("foo",18.0f));
  w.addDocument(doc);
  w.commit();
  doc=new Document();
  doc.add(new FloatDocValuesField("foo",-1.0f));
  w.addDocument(doc);
  w.commit();
  doc=new Document();
  doc.add(new FloatDocValuesField("foo",7.0f));
  w.addDocument(doc);
  w.forceMerge(1);
  DirectoryReader r=DirectoryReader.open(w);
  LeafReader leaf=getOnlyLeafReader(r);
  assertEquals(3,leaf.maxDoc());
  NumericDocValues values=leaf.getNumericDocValues("foo");
  assertEquals(0,values.nextDoc());
  assertEquals(-1.0f,Float.intBitsToFloat((int)values.longValue()),0.0f);
  assertEquals(1,values.nextDoc());
  assertEquals(7.0f,Float.intBitsToFloat((int)values.longValue()),0.0f);
  assertEquals(2,values.nextDoc());
  assertEquals(18.0f,Float.intBitsToFloat((int)values.longValue()),0.0f);
  r.close();
  w.close();
  dir.close();
}
