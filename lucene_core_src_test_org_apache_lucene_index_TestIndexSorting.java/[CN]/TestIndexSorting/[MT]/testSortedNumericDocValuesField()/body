{
  for (  LeafReaderContext ctx : sortedReader.leaves()) {
    LeafReader reader=ctx.reader();
    SortedNumericDocValues dv=reader.getSortedNumericDocValues(SORTED_NUMERIC_DV_FIELD);
    int maxDoc=reader.maxDoc();
    for (int doc=0; doc < maxDoc; doc++) {
      dv.setDocument(doc);
      assertEquals(2,dv.count());
      int id=Integer.parseInt(reader.document(doc).get(ID_FIELD));
      assertEquals("incorrect sorted-numeric DocValues for doc " + doc,id,dv.valueAt(0));
      assertEquals("incorrect sorted-numeric DocValues for doc " + doc,id + 1,dv.valueAt(1));
    }
  }
}
