{
  for (  LeafReaderContext ctx : sortedReader.leaves()) {
    LeafReader reader=ctx.reader();
    SortedSetDocValues dv=reader.getSortedSetDocValues(SORTED_SET_DV_FIELD);
    int maxDoc=reader.maxDoc();
    for (int doc=0; doc < maxDoc; doc++) {
      dv.setDocument(doc);
      BytesRef bytes=dv.lookupOrd(dv.nextOrd());
      String id=reader.document(doc).get(ID_FIELD);
      assertEquals("incorrect sorted-set DocValues for doc " + doc,id,bytes.utf8ToString());
      bytes=dv.lookupOrd(dv.nextOrd());
      assertEquals("incorrect sorted-set DocValues for doc " + doc,Integer.valueOf(Integer.parseInt(id) + 1).toString(),bytes.utf8ToString());
      assertEquals(SortedSetDocValues.NO_MORE_ORDS,dv.nextOrd());
    }
  }
}
