{
  Row now=getRow(root);
  int w;
  CharSequence last=null;
  StrEnum e=new StrEnum(key,forward);
  for (int i=0; i < key.length() - 1; i++) {
    Character ch=new Character(e.next());
    w=now.getCmd(ch);
    if (w >= 0) {
      last=cmds.get(w);
    }
    w=now.getRef(ch);
    if (w >= 0) {
      now=getRow(w);
    }
 else {
      return last;
    }
  }
  w=now.getCmd(new Character(e.next()));
  return (w >= 0) ? cmds.get(w) : last;
}
