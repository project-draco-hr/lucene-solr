{
  dfsCluster=HdfsTestUtil.setupClass(createTempDir().getAbsolutePath());
  System.setProperty("solr.hdfs.home",dfsCluster.getURI().toString() + "/solr");
  hdfsUri=dfsCluster.getFileSystem().getUri().toString();
  try {
    URI uri=new URI(hdfsUri);
    fs=FileSystem.newInstance(uri,new Configuration());
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
catch (  URISyntaxException e) {
    throw new RuntimeException(e);
  }
  System.setProperty("solr.ulog.dir",hdfsUri + "/solr/shard1");
  initCore("solrconfig-tlog.xml","schema15.xml");
}
