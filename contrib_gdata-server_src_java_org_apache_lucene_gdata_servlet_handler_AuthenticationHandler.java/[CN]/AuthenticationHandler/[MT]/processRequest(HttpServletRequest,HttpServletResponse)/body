{
  try {
    String serviceName=request.getParameter(AuthenticationController.SERVICE_PARAMETER);
    if (LOG.isInfoEnabled()) {
      String application=request.getParameter(AuthenticationController.APPLICATION_PARAMETER);
      LOG.info("Authentication request for service: " + serviceName + "; Application name: "+ application);
    }
    if (!this.registry.isServiceRegistered(serviceName))     throw new AuthenticationException("requested Service " + serviceName + "is not registered");
    String password=request.getParameter(AuthenticationController.PASSWORD_PARAMETER);
    String accountName=request.getParameter(AuthenticationController.ACCOUNT_PARAMETER);
    String clientIp=request.getRemoteHost();
    GDataAccount account=getAccount(accountName);
    if (account == null || !account.getPassword().equals(password))     throw new AuthenticationException("Account is null or password does not match");
    String token=this.controller.authenticatAccount(account,clientIp);
    sendToken(response,token);
    if (LOG.isInfoEnabled()) {
      LOG.info("Account authenticated -- " + account);
    }
  }
 catch (  AuthenticationException e) {
    LOG.error("BadAuthentication -- " + e.getMessage(),e);
    sendError(response,GDataResponse.FORBIDDEN,"BadAuthentication");
  }
catch (  Exception e) {
    LOG.error("Unexpected Exception -- SERVERERROR -- " + e.getMessage(),e);
    sendError(response,GDataResponse.SERVER_ERROR,"Service not available");
  }
}
