{
  final String field=fieldname.intern();
  final FieldCache.StringIndex index=FieldCache.DEFAULT.getStringIndex(reader,field);
  return new ScoreDocComparator(){
    public final int compare(    final ScoreDoc i,    final ScoreDoc j){
      final int fi=index.order[i.doc];
      final int fj=index.order[j.doc];
      if (fi == fj)       return 0;
      if (fi == 0)       return 1;
      if (fj == 0)       return -1;
      return fi < fj ? -1 : 1;
    }
    public Comparable sortValue(    final ScoreDoc i){
      int f=index.order[i.doc];
      return (0 == f) ? missingValueProxy : index.lookup[f];
    }
    public int sortType(){
      return SortField.CUSTOM;
    }
  }
;
}
