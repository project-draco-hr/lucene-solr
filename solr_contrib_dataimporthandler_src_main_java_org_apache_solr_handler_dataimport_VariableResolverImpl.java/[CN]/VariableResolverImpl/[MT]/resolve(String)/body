{
  if (name == null)   return container;
  if ("".equals(name))   return null;
  String[] parts=DOT_SPLIT.split(name,0);
  CURRENT_VARIABLE_RESOLVER.set(this);
  try {
    Map<String,Object> namespace=container;
    for (int i=0; i < parts.length; i++) {
      String thePart=parts[i];
      if (i == parts.length - 1) {
        Object val=namespace.get(thePart);
        return val == null ? getDefault(name) : val;
      }
      Object temp=namespace.get(thePart);
      if (temp == null) {
        Object val=namespace.get(mergeAll(parts,i));
        return val == null ? getDefault(name) : val;
      }
 else {
        if (temp instanceof Map) {
          namespace=(Map)temp;
        }
 else {
          return getDefault(name);
        }
      }
    }
  }
  finally {
    CURRENT_VARIABLE_RESOLVER.remove();
  }
  return getDefault(name);
}
