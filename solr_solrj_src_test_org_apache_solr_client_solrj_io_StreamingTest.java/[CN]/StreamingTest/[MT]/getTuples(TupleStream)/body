{
  tupleStream.open();
  List<Tuple> tuples=new ArrayList();
  for (; ; ) {
    Tuple t=tupleStream.read();
    if (t.EOF) {
      if (tupleStream instanceof ParallelStream) {
        ParallelStream p=(ParallelStream)tupleStream;
        assert(t.getMetrics() == p.getEofTuples());
      }
      break;
    }
 else {
      tuples.add(t);
    }
  }
  tupleStream.close();
  return tuples;
}
