{
  if (isCommit) {
    String fileName=((IndexCommitPoint)commits.get(commits.size() - 1)).getSegmentsFileName();
    if (seen.contains(fileName)) {
      throw new RuntimeException("onCommit was called twice on the same commit point: " + fileName);
    }
    seen.add(fileName);
    numOnCommit++;
  }
  int size=commits.size();
  for (int i=0; i < size - numToKeep; i++) {
    ((IndexCommitPoint)commits.get(i)).delete();
    numDelete++;
  }
}
