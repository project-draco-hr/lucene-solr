{
  for (int i=counts.length - 1; i > 1; i--) {
    int count=counts[i];
    if (count > 0) {
      int parent=parents[i];
      if (parent != 0) {
        counts[parent]+=count;
      }
    }
  }
}
