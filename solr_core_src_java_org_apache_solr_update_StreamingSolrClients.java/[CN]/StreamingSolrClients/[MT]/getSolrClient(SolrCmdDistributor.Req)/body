{
  String url=getFullUrl(req.node.getUrl());
  ConcurrentUpdateSolrClient client=solrClients.get(url);
  if (client == null) {
    client=new ErrorReportingConcurrentUpdateSolrClient(url,httpClient,100,runnerCount,updateExecutor,true,req);
    client.setParser(new BinaryResponseParser());
    client.setRequestWriter(new BinaryRequestWriter());
    client.setPollQueueTime(req.pollQueueTime);
    Set<String> queryParams=new HashSet<>(2);
    queryParams.add(DistributedUpdateProcessor.DISTRIB_FROM);
    queryParams.add(DistributingUpdateProcessorFactory.DISTRIB_UPDATE_PARAM);
    client.setQueryParams(queryParams);
    solrClients.put(url,client);
  }
  return client;
}
