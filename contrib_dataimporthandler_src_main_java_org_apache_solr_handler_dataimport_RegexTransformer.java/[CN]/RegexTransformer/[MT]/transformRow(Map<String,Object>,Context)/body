{
  VariableResolver vr=context.getVariableResolver();
  List<Map<String,String>> fields=context.getAllEntityFields();
  for (  Map<String,String> field : fields) {
    String col=field.get(DataImporter.COLUMN);
    String reStr=field.get(REGEX);
    reStr=vr.replaceTokens(reStr);
    String splitBy=field.get(SPLIT_BY);
    splitBy=vr.replaceTokens(splitBy);
    String replaceWith=field.get(REPLACE_WITH);
    replaceWith=vr.replaceTokens(replaceWith);
    if (reStr != null || splitBy != null) {
      String srcColName=field.get(SRC_COL_NAME);
      if (srcColName == null) {
        srcColName=col;
      }
      Object tmpVal=row.get(srcColName);
      if (tmpVal == null)       continue;
      if (tmpVal instanceof List) {
        List<String> inputs=(List<String>)tmpVal;
        List results=new ArrayList();
        for (        String input : inputs) {
          Object o=process(col,reStr,splitBy,replaceWith,input);
          if (o != null)           results.add(o);
        }
        row.put(col,results);
      }
 else {
        String value=tmpVal.toString();
        Object o=process(col,reStr,splitBy,replaceWith,value);
        if (o != null)         row.put(col,o);
      }
    }
  }
  return row;
}
