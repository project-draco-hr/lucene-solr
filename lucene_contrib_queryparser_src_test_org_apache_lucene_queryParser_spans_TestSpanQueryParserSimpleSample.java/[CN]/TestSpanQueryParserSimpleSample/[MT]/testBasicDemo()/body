{
  SyntaxParser queryParser=new StandardSyntaxParser();
  QueryNode queryTree=queryParser.parse("body:text",null);
  QueryConfigHandler spanQueryConfigHandler=new SpansQueryConfigHandler();
  UniqueFieldAttribute uniqueFieldAtt=spanQueryConfigHandler.getAttribute(UniqueFieldAttribute.class);
  uniqueFieldAtt.setUniqueField("index");
  QueryNodeProcessorPipeline spanProcessorPipeline=new QueryNodeProcessorPipeline(spanQueryConfigHandler);
  spanProcessorPipeline.add(new SpansValidatorQueryNodeProcessor());
  spanProcessorPipeline.add(new UniqueFieldQueryNodeProcessor());
  if (VERBOSE)   System.out.println(queryTree);
  queryTree=spanProcessorPipeline.process(queryTree);
  if (VERBOSE)   System.out.println(queryTree);
  SpansQueryTreeBuilder spansQueryTreeBuilder=new SpansQueryTreeBuilder();
  SpanQuery spanquery=spansQueryTreeBuilder.build(queryTree);
  assertTrue(spanquery instanceof SpanTermQuery);
  assertEquals(spanquery.toString(),"index:text");
}
