{
  HashSet<String> files=new HashSet<String>();
  if (includeSegmentsFile) {
    final String segmentFileName=getCurrentSegmentFileName();
    if (segmentFileName != null) {
      files.add(segmentFileName);
    }
    if (lastGlobalFieldMapVersion > 0) {
      files.add(getGlobalFieldNumberName(lastGlobalFieldMapVersion));
    }
  }
  final int size=size();
  for (int i=0; i < size; i++) {
    final SegmentInfo info=info(i);
    if (info.dir == dir) {
      files.addAll(info(i).files());
    }
  }
  return files;
}
