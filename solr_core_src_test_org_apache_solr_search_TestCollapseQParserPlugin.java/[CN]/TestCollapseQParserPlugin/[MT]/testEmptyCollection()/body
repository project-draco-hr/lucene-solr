{
  String group=(random().nextBoolean() ? "group_s" : "group_s_dv");
  String optional_min_or_max=(random().nextBoolean() ? "" : (random().nextBoolean() ? "min=field(test_ti)" : "max=field(test_ti)"));
  ModifiableSolrParams params=new ModifiableSolrParams();
  params.add("q","*:*");
  params.add("fq","{!collapse field=" + group + " "+ optional_min_or_max+ "}");
  assertQ(req(params),"*[count(//doc)=0]");
}
