{
  DirectoryReader ir=DirectoryReader.open(dir);
  for (  AtomicReaderContext leaf : ir.leaves()) {
    AtomicReader leafReader=leaf.reader();
    assertTerms(leafReader.terms("field1bare"),leafReader.terms("field2offsets"),true);
    assertTerms(leafReader.terms("field2offsets"),leafReader.terms("field3payloadsFixed"),true);
    assertTerms(leafReader.terms("field3payloadsFixed"),leafReader.terms("field4payloadsVariable"),true);
    assertTerms(leafReader.terms("field4payloadsVariable"),leafReader.terms("field5payloadsFixedOffsets"),true);
    assertTerms(leafReader.terms("field5payloadsFixedOffsets"),leafReader.terms("field6payloadsVariableOffsets"),true);
  }
  ir.close();
}
