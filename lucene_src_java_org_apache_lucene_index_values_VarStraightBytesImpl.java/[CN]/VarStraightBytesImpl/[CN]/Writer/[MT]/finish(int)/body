{
  if (datOut == null) {
    return;
  }
  initIndexOut();
  fill(docCount);
  idxOut.writeVLong(address);
  final PackedInts.Writer w=PackedInts.getWriter(idxOut,docCount,PackedInts.bitsRequired(address));
  for (int i=0; i < docCount; i++) {
    w.add(docToAddress[i]);
  }
  w.finish();
  bytesUsed.addAndGet(-(docToAddress.length) * RamUsageEstimator.NUM_BYTES_INT);
  docToAddress=null;
  super.finish(docCount);
}
