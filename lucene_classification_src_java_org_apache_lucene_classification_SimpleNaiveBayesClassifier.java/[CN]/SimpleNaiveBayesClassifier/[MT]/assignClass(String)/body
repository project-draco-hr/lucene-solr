{
  if (atomicReader == null) {
    throw new RuntimeException("need to train the classifier first");
  }
  double max=0d;
  String foundClass=null;
  Terms terms=MultiFields.getTerms(atomicReader,classFieldName);
  TermsEnum termsEnum=terms.iterator(null);
  BytesRef next;
  while ((next=termsEnum.next()) != null) {
    double clVal=calculatePrior(next) * calculateLikelihood(inputDocument,next);
    if (clVal > max) {
      max=clVal;
      foundClass=next.utf8ToString();
    }
  }
  return foundClass;
}
