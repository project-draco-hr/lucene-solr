{
  if (atomicReader == null) {
    throw new IOException("You must first call Classifier#train");
  }
  double max=-Double.MAX_VALUE;
  BytesRef foundClass=new BytesRef();
  Terms terms=MultiFields.getTerms(atomicReader,classFieldName);
  TermsEnum termsEnum=terms.iterator(null);
  BytesRef next;
  String[] tokenizedDoc=tokenizeDoc(inputDocument);
  while ((next=termsEnum.next()) != null) {
    double clVal=calculateLogPrior(next) + calculateLogLikelihood(tokenizedDoc,next);
    if (clVal > max) {
      max=clVal;
      foundClass=BytesRef.deepCopyOf(next);
    }
  }
  double score=10 / Math.abs(max);
  return new ClassificationResult<>(foundClass,score);
}
