{
  if (atomicReader == null) {
    throw new IOException("You must first call Classifier#train");
  }
  double max=0d;
  BytesRef foundClass=new BytesRef();
  Terms terms=MultiFields.getTerms(atomicReader,classFieldName);
  TermsEnum termsEnum=terms.iterator(null);
  BytesRef next;
  String[] tokenizedDoc=tokenizeDoc(inputDocument);
  while ((next=termsEnum.next()) != null) {
    double clVal=calculatePrior(next) * calculateLikelihood(tokenizedDoc,next);
    if (clVal > max) {
      max=clVal;
      foundClass=BytesRef.deepCopyOf(next);
    }
  }
  return new ClassificationResult<BytesRef>(foundClass,max);
}
