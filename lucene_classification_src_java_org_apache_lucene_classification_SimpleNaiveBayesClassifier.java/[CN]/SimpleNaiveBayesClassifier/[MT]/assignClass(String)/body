{
  if (atomicReader == null) {
    throw new RuntimeException("need to train the classifier first");
  }
  Double max=0d;
  String foundClass=null;
  Terms terms=MultiFields.getTerms(atomicReader,classFieldName);
  TermsEnum termsEnum=terms.iterator(null);
  BytesRef t=termsEnum.next();
  while (t != null) {
    String classValue=t.utf8ToString();
    Double clVal=calculatePrior(classValue) * calculateLikelihood(inputDocument,classValue);
    if (clVal > max) {
      max=clVal;
      foundClass=classValue;
    }
    t=termsEnum.next();
  }
  return foundClass;
}
