{
  stream.close();
  executorService.shutdown();
  try {
    executorService.awaitTermination(Long.MAX_VALUE,TimeUnit.SECONDS);
  }
 catch (  InterruptedException e) {
    logger.error("Interrupted while waiting for termination",e);
  }
}
