{
  if (a1.isSingleton() && a2.isSingleton())   return BasicAutomata.makeString(a1.singleton + a2.singleton);
  boolean deterministic=a1.isSingleton() && a2.isDeterministic();
  if (a1 == a2) {
    a1=a1.cloneExpanded();
    a2=a2.cloneExpanded();
  }
 else {
    a1=a1.cloneExpandedIfRequired();
    a2=a2.cloneExpandedIfRequired();
  }
  for (  State s : a1.getAcceptStates()) {
    s.accept=false;
    s.addEpsilon(a2.initial);
  }
  a1.deterministic=deterministic;
  a1.clearNumberedStates();
  a1.checkMinimizeAlways();
  return a1;
}
