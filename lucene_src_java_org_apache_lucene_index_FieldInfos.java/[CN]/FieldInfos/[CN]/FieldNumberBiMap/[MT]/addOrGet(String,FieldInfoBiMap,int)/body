{
  Integer fieldNumber=nameToNumber.get(fieldName);
  if (fieldNumber == null) {
    if (!numberToName.containsKey(preferredFieldNumber)) {
      fieldNumber=preferredFieldNumber;
    }
 else {
      fieldNumber=findNextAvailableFieldNumber(preferredFieldNumber + 1,numberToName.keySet());
    }
    numberToName.put(fieldNumber,fieldName);
    nameToNumber.put(fieldName,fieldNumber);
  }
  return fieldNumber;
}
