{
  output.writeVInt(FORMAT_CURRENT);
  output.writeVInt(size());
  for (  FieldInfo fi : this) {
    byte bits=0x0;
    if (fi.isIndexed)     bits|=IS_INDEXED;
    if (fi.storeTermVector)     bits|=STORE_TERMVECTOR;
    if (fi.storePositionWithTermVector)     bits|=STORE_POSITIONS_WITH_TERMVECTOR;
    if (fi.storeOffsetWithTermVector)     bits|=STORE_OFFSET_WITH_TERMVECTOR;
    if (fi.omitNorms)     bits|=OMIT_NORMS;
    if (fi.storePayloads)     bits|=STORE_PAYLOADS;
    if (fi.omitTermFreqAndPositions)     bits|=OMIT_TERM_FREQ_AND_POSITIONS;
    output.writeString(fi.name);
    output.writeInt(fi.number);
    output.writeInt(fi.getCodecId());
    output.writeByte(bits);
  }
}
