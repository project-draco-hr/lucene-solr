{
  final AtomicBoolean wasCalled=new AtomicBoolean();
  Directory dir=newDirectory();
  IndexWriterConfig iwc=newIndexWriterConfig(new MockAnalyzer(random()));
  iwc.setMergeScheduler(new ConcurrentMergeScheduler(){
    @Override protected boolean maybeStall(    IndexWriter writer){
      wasCalled.set(true);
      return true;
    }
  }
);
  IndexWriter w=new IndexWriter(dir,iwc);
  w.addDocument(new Document());
  w.forceMerge(1);
  assertTrue(wasCalled.get());
  w.close();
  dir.close();
}
