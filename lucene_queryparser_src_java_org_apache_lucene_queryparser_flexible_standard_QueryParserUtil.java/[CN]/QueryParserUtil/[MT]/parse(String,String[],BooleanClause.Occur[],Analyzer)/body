{
  if (fields.length != flags.length)   throw new IllegalArgumentException("fields.length != flags.length");
  BooleanQuery.Builder bQuery=new BooleanQuery.Builder();
  StandardQueryParser qp=new StandardQueryParser();
  qp.setAnalyzer(analyzer);
  for (int i=0; i < fields.length; i++) {
    Query q=qp.parse(query,fields[i]);
    if (q != null) {
      bQuery.add(q,flags[i]);
    }
  }
  return bQuery.build();
}
