{
  if (ndv.docID() != -1) {
    throw new RuntimeException("dv iterator for field: " + fieldName + " should start at docID=-1, but got "+ ndv.docID());
  }
  while (true) {
    int docID=ndv.nextDoc();
    if (docID == NO_MORE_DOCS) {
      break;
    }
    int count=ndv.docValueCount();
    if (count == 0) {
      throw new RuntimeException("sorted numeric dv for field: " + fieldName + " returned docValueCount=0 for docID="+ docID);
    }
    long previous=Long.MIN_VALUE;
    for (int j=0; j < count; j++) {
      long value=ndv.nextValue();
      if (value < previous) {
        throw new RuntimeException("values out of order: " + value + " < "+ previous+ " for doc: "+ docID);
      }
      previous=value;
    }
  }
}
