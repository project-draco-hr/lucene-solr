{
  for (int i=0; i < maxDoc; i++) {
    ndv.setDocument(i);
    int count=ndv.count();
    if (docsWithField.get(i)) {
      if (count == 0) {
        throw new RuntimeException("dv for field: " + fieldName + " is not marked missing but has zero count for doc: "+ i);
      }
      long previous=Long.MIN_VALUE;
      for (int j=0; j < count; j++) {
        long value=ndv.valueAt(j);
        if (value < previous) {
          throw new RuntimeException("values out of order: " + value + " < "+ previous+ " for doc: "+ i);
        }
        previous=value;
      }
    }
 else {
      if (count != 0) {
        throw new RuntimeException("dv for field: " + fieldName + " is marked missing but has count="+ count+ " for doc: "+ i);
      }
    }
  }
}
