{
  Bits docsWithField=dvReader.getDocsWithField(fi);
  if (docsWithField == null) {
    throw new RuntimeException(fi.name + " docsWithField does not exist");
  }
 else   if (docsWithField.length() != maxDoc) {
    throw new RuntimeException(fi.name + " docsWithField has incorrect length: " + docsWithField.length()+ ",expected: "+ maxDoc);
  }
switch (fi.getDocValuesType()) {
case SORTED:
    status.totalSortedFields++;
  checkSortedDocValues(fi.name,maxDoc,dvReader.getSorted(fi),docsWithField);
break;
case SORTED_NUMERIC:
status.totalSortedNumericFields++;
checkSortedNumericDocValues(fi.name,maxDoc,dvReader.getSortedNumeric(fi),docsWithField);
break;
case SORTED_SET:
status.totalSortedSetFields++;
checkSortedSetDocValues(fi.name,maxDoc,dvReader.getSortedSet(fi),docsWithField);
break;
case BINARY:
status.totalBinaryFields++;
checkBinaryDocValues(fi.name,maxDoc,dvReader.getBinary(fi),docsWithField);
break;
case NUMERIC:
status.totalNumericFields++;
checkNumericDocValues(fi.name,maxDoc,dvReader.getNumeric(fi),docsWithField);
break;
default :
throw new AssertionError();
}
}
