{
  IndexInput indexInput=(IndexInput)datIn.clone();
  boolean success=false;
  try {
    indexInput.seek(CodecUtil.headerLength(CODEC_NAME));
    indexInput.readByte();
    datOut.copyBytes(indexInput,bytesPerValue(type) * numDocs);
    success=true;
  }
  finally {
    IOUtils.closeSafely(!success,indexInput);
  }
  return numDocs;
}
