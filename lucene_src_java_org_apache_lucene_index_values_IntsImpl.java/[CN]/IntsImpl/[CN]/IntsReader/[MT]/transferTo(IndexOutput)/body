{
  IndexInput indexInput=(IndexInput)datIn.clone();
  boolean success=false;
  try {
    indexInput.seek(CodecUtil.headerLength(CODEC_NAME));
    indexInput.readByte();
    datOut.copyBytes(indexInput,bytesPerValue(type) * numDocs);
    success=true;
  }
  finally {
    if (success) {
      IOUtils.close(indexInput);
    }
 else {
      IOUtils.closeWhileHandlingException(indexInput);
    }
  }
  return numDocs;
}
