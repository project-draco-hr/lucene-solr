{
  if (datOut == null) {
    boolean success=false;
    try {
      datOut=dir.createOutput(IndexFileNames.segmentFileName(id,"",DATA_EXTENSION),context);
      CodecUtil.writeHeader(datOut,CODEC_NAME,VERSION_CURRENT);
      datOut.writeByte(typeOrd);
      success=true;
    }
  finally {
      if (!success) {
        IOUtils.closeSafely(true,datOut);
      }
    }
  }
}
