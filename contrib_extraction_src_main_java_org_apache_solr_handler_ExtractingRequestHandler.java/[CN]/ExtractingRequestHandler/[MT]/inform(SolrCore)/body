{
  if (initArgs != null) {
    String tikaConfigLoc=(String)initArgs.get(CONFIG_LOCATION);
    if (tikaConfigLoc != null) {
      File configFile=new File(tikaConfigLoc);
      if (configFile.isAbsolute() == false) {
        configFile=new File(core.getResourceLoader().getConfigDir(),configFile.getPath());
      }
      try {
        config=new TikaConfig(configFile);
      }
 catch (      Exception e) {
        throw new SolrException(ErrorCode.SERVER_ERROR,e);
      }
    }
 else {
      try {
        config=TikaConfig.getDefaultConfig();
      }
 catch (      TikaException e) {
        throw new SolrException(ErrorCode.SERVER_ERROR,e);
      }
    }
    NamedList configDateFormats=(NamedList)initArgs.get(DATE_FORMATS);
    if (configDateFormats != null && configDateFormats.size() > 0) {
      dateFormats=new HashSet<String>();
      while (configDateFormats.iterator().hasNext()) {
        String format=(String)configDateFormats.iterator().next();
        log.info("Adding Date Format: " + format);
        dateFormats.add(format);
      }
    }
  }
 else {
    try {
      config=TikaConfig.getDefaultConfig();
    }
 catch (    TikaException e) {
      throw new SolrException(ErrorCode.SERVER_ERROR,e);
    }
  }
  factory=createFactory();
}
