{
  SolrQueryResponse rsp=new SolrQueryResponse();
  BufferingRequestProcessor p=new BufferingRequestProcessor(null);
  JsonLoader loader=new JsonLoader();
  String invalidJsonString="}{";
  try (SolrQueryRequest req=req()){
    try {
      loader.load(req,rsp,new ContentStreamBase.StringStream(invalidJsonString),p);
      fail("Expected invalid JSON to produce a SolrException.");
    }
 catch (    SolrException expectedException) {
      assertEquals(SolrException.ErrorCode.BAD_REQUEST.code,expectedException.code());
      assertTrue(expectedException.getMessage().contains("Cannot parse"));
      assertTrue(expectedException.getMessage().contains("JSON"));
    }
  }
 }
