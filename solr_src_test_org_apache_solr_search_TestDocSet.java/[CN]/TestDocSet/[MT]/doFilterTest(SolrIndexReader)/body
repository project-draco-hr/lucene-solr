{
  OpenBitSet bs=getRandomSet(reader.maxDoc(),rand.nextInt(reader.maxDoc() + 1));
  DocSet a=new BitDocSet(bs);
  DocSet b=getIntDocSet(bs);
  Filter fa=a.getTopFilter();
  Filter fb=b.getTopFilter();
  DocIdSet da=fa.getDocIdSet(reader);
  DocIdSet db=fb.getDocIdSet(reader);
  doTestIteratorEqual(da,db);
  for (  SolrIndexReader sir : reader.getLeafReaders()) {
    da=fa.getDocIdSet(sir);
    db=fb.getDocIdSet(sir);
    doTestIteratorEqual(da,db);
  }
  int nReaders=reader.getLeafReaders().length;
  for (int i=0; i < nReaders; i++) {
    SolrIndexReader sir=reader.getLeafReaders()[rand.nextInt(nReaders)];
    da=fa.getDocIdSet(sir);
    db=fb.getDocIdSet(sir);
    doTestIteratorEqual(da,db);
  }
}
