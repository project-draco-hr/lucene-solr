{
  last=first=null;
  int orderedIndex=0;
  while (queue.top() != null) {
    SpansCell cell=(SpansCell)queue.pop();
    addToList(cell);
    if (cell.index == orderedIndex) {
      orderedIndex++;
    }
 else {
      return cell.next();
    }
  }
  throw new AssertionError("Unexpected: ordered");
}
