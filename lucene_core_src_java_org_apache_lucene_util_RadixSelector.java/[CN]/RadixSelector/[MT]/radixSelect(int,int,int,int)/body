{
  final int[] histogram=this.histogram;
  Arrays.fill(histogram,0);
  buildHistogram(from,to,d,histogram);
  int bucketFrom=from;
  for (int bucket=0; bucket < HISTOGRAM_SIZE; ++bucket) {
    final int bucketTo=bucketFrom + histogram[bucket];
    if (bucketTo > k) {
      partition(from,to,bucket,bucketFrom,bucketTo,d);
      if (bucket != 0 && d + 1 < maxLength) {
        select(bucketFrom,bucketTo,k,d + 1);
      }
      return;
    }
    bucketFrom=bucketTo;
  }
  throw new AssertionError("Unreachable code");
}
