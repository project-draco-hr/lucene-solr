{
  if (termStr == null) {
    throw new ParseException("Passed null value as term to getWildcardQuery");
  }
  if (!getAllowLeadingWildcard() && (termStr.startsWith("*") || termStr.startsWith("?"))) {
    throw new ParseException("'*' or '?' not allowed as first character in WildcardQuery" + " unless getAllowLeadingWildcard() returns true");
  }
  Matcher wildcardMatcher=wildcardPattern.matcher(termStr);
  StringBuilder sb=new StringBuilder();
  int last=0;
  while (wildcardMatcher.find()) {
    if (wildcardMatcher.group(1) != null) {
      continue;
    }
    if (wildcardMatcher.start() > 0) {
      String chunk=termStr.substring(last,wildcardMatcher.start());
      String analyzed=analyzeSingleChunk(field,termStr,chunk);
      sb.append(analyzed);
    }
    sb.append(wildcardMatcher.group(2));
    last=wildcardMatcher.end();
  }
  if (last < termStr.length()) {
    sb.append(analyzeSingleChunk(field,termStr,termStr.substring(last)));
  }
  return super.getWildcardQuery(field,sb.toString());
}
