{
  System.setProperty("collection","control_collection");
  controlJetty=createJetty(testDir,testDir + "/control/data","control_shard");
  System.clearProperty("collection");
  controlClient=createNewSolrServer(controlJetty.getLocalPort());
  StringBuilder sb=new StringBuilder();
  for (int i=1; i <= numShards; i++) {
    if (sb.length() > 0)     sb.append(',');
    JettySolrRunner j=createJetty(testDir,testDir + "/jetty" + i,"shard" + (i + 2));
    jettys.add(j);
    clients.add(createNewSolrServer(j.getLocalPort()));
    sb.append("localhost:").append(j.getLocalPort()).append(context);
  }
  shards=sb.toString();
  for (int i=1; i <= numShards; i++) {
    ZkStateReader zkStateReader=((SolrDispatchFilter)jettys.get(0).getDispatchFilter().getFilter()).getCores().getZkController().getZkStateReader();
    zkStateReader.getLeaderProps("collection1","shard" + (i + 2),15000);
  }
}
