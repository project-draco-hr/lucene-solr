{
  clearIndex();
  int numDocsExpected=1;
  for (int i=1; i < 4; i++) {
    if (random().nextBoolean()) {
      assertU(adoc(sdoc("id",i)));
      numDocsExpected++;
    }
  }
  assertU(adoc(sdoc("id","0",fieldname,negative,fieldname,positive)));
  for (int i=1; i < 4; i++) {
    if (random().nextBoolean()) {
      assertU(adoc(sdoc("id",-i)));
      numDocsExpected++;
    }
  }
  assertU(commit());
  assertDocWithValsIsFirst(numDocsExpected,"def(field(" + fieldname + ",min),0) asc");
  assertDocWithValsIsLast(numDocsExpected,"def(field(" + fieldname + ",min),0) desc");
  assertDocWithValsIsFirst(numDocsExpected,"def(field(" + fieldname + ",max),0) desc");
  assertDocWithValsIsLast(numDocsExpected,"def(field(" + fieldname + ",max),0) asc");
  assertDocWithValsIsFirst(numDocsExpected,"sum(32,field(" + fieldname + ",max)) desc");
  assertDocWithValsIsLast(numDocsExpected,"sum(32,field(" + fieldname + ",max)) asc");
  assertDocWithValsIsFirst(numDocsExpected,"sum(32,field(" + fieldname + ",min)) asc");
  assertDocWithValsIsLast(numDocsExpected,"sum(32,field(" + fieldname + ",min)) desc");
}
