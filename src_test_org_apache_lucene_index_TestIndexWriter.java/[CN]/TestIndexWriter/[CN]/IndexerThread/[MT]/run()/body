{
  final Document doc=new Document();
  doc.add(new Field("field","aaa bbb ccc ddd eee fff ggg hhh iii jjj",Field.Store.YES,Field.Index.TOKENIZED,Field.TermVector.WITH_POSITIONS_OFFSETS));
  int idUpto=0;
  int fullCount=0;
  while (true) {
    try {
      writer.updateDocument(new Term("id","" + (idUpto++)),doc);
    }
 catch (    IOException ioe) {
      if (ioe.getMessage().startsWith("fake disk full at") || ioe.getMessage().equals("now failing on purpose")) {
        diskFull=true;
        try {
          Thread.sleep(1);
        }
 catch (        InterruptedException ie) {
          Thread.currentThread().interrupt();
        }
        if (fullCount++ >= 5)         break;
      }
 else {
        if (noErrors) {
          System.out.println(Thread.currentThread().getName() + ": ERROR: unexpected IOException:");
          ioe.printStackTrace(System.out);
          error=ioe;
        }
        break;
      }
    }
catch (    Throwable t) {
      if (noErrors) {
        System.out.println(Thread.currentThread().getName() + ": ERROR: unexpected Throwable:");
        t.printStackTrace(System.out);
        error=t;
      }
      break;
    }
  }
}
