{
  final int NUM_COPY=50;
  CommitAndAddIndexes3 c=new CommitAndAddIndexes3(NUM_COPY);
  c.launchThreads(-1);
  try {
    Thread.sleep(500);
  }
 catch (  InterruptedException ie) {
    Thread.currentThread().interrupt();
  }
  c.didClose=true;
  c.writer2.rollback();
  c.joinThreads();
  _TestUtil.checkIndex(c.dir2);
  c.closeDir();
  assertTrue(c.failures.size() == 0);
}
