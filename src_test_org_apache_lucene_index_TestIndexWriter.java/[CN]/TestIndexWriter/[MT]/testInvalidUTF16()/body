{
  MockRAMDirectory dir=new MockRAMDirectory();
  IndexWriter w=new IndexWriter(dir,new WhitespaceAnalyzer(Version.LUCENE_CURRENT),true,IndexWriter.MaxFieldLength.UNLIMITED);
  Document doc=new Document();
  final int count=utf8Data.length / 2;
  for (int i=0; i < count; i++)   doc.add(new Field("f" + i,utf8Data[2 * i],Field.Store.YES,Field.Index.ANALYZED));
  w.addDocument(doc);
  w.close();
  IndexReader ir=IndexReader.open(dir,true);
  Document doc2=ir.document(0);
  for (int i=0; i < count; i++) {
    assertEquals("field " + i + " was not indexed correctly",1,ir.docFreq(new Term("f" + i,utf8Data[2 * i + 1])));
    assertEquals("field " + i + " is incorrect",utf8Data[2 * i + 1],doc2.getField("f" + i).stringValue());
  }
  ir.close();
  dir.close();
}
