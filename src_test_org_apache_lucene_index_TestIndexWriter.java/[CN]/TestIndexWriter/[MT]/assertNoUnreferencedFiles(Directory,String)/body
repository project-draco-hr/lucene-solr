{
  String[] startFiles=dir.list();
  SegmentInfos infos=new SegmentInfos();
  infos.read(dir);
  IndexFileDeleter d=new IndexFileDeleter(dir,new KeepOnlyLastCommitDeletionPolicy(),infos,null);
  String[] endFiles=dir.list();
  Arrays.sort(startFiles);
  Arrays.sort(endFiles);
  if (!Arrays.equals(startFiles,endFiles)) {
    fail(message + ": before delete:\n    " + arrayToString(startFiles)+ "\n  after delete:\n    "+ arrayToString(endFiles));
  }
}
