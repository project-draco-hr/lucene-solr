{
  int pri=Thread.currentThread().getPriority();
  try {
    MockRAMDirectory dir=new MockRAMDirectory();
    IndexWriter iw=new IndexWriter(dir,new StandardAnalyzer(),true,IndexWriter.MaxFieldLength.LIMITED);
    Document document=new Document();
    document.add(new Field("tvtest","a b c",Field.Store.NO,Field.Index.ANALYZED,Field.TermVector.YES));
    iw.setMaxBufferedDocs(2);
    iw.setMergeFactor(2);
    Thread.currentThread().setPriority(Thread.MAX_PRIORITY);
    for (int i=0; i < 4; i++)     iw.addDocument(document);
    iw.close();
  }
  finally {
    Thread.currentThread().setPriority(pri);
  }
}
