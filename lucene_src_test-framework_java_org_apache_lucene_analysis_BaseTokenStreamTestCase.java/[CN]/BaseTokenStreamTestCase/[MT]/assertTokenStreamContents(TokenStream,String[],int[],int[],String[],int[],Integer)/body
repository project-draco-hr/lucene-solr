{
  assertNotNull(output);
  CheckClearAttributesAttribute checkClearAtt=ts.addAttribute(CheckClearAttributesAttribute.class);
  assertTrue("has no CharTermAttribute",ts.hasAttribute(CharTermAttribute.class));
  CharTermAttribute termAtt=ts.getAttribute(CharTermAttribute.class);
  OffsetAttribute offsetAtt=null;
  if (startOffsets != null || endOffsets != null || finalOffset != null) {
    assertTrue("has no OffsetAttribute",ts.hasAttribute(OffsetAttribute.class));
    offsetAtt=ts.getAttribute(OffsetAttribute.class);
  }
  TypeAttribute typeAtt=null;
  if (types != null) {
    assertTrue("has no TypeAttribute",ts.hasAttribute(TypeAttribute.class));
    typeAtt=ts.getAttribute(TypeAttribute.class);
  }
  PositionIncrementAttribute posIncrAtt=null;
  if (posIncrements != null) {
    assertTrue("has no PositionIncrementAttribute",ts.hasAttribute(PositionIncrementAttribute.class));
    posIncrAtt=ts.getAttribute(PositionIncrementAttribute.class);
  }
  ts.reset();
  for (int i=0; i < output.length; i++) {
    ts.clearAttributes();
    termAtt.setEmpty().append("bogusTerm");
    if (offsetAtt != null)     offsetAtt.setOffset(14584724,24683243);
    if (typeAtt != null)     typeAtt.setType("bogusType");
    if (posIncrAtt != null)     posIncrAtt.setPositionIncrement(45987657);
    checkClearAtt.getAndResetClearCalled();
    assertTrue("token " + i + " does not exist",ts.incrementToken());
    assertTrue("clearAttributes() was not called correctly in TokenStream chain",checkClearAtt.getAndResetClearCalled());
    assertEquals("term " + i,output[i],termAtt.toString());
    if (startOffsets != null)     assertEquals("startOffset " + i,startOffsets[i],offsetAtt.startOffset());
    if (endOffsets != null)     assertEquals("endOffset " + i,endOffsets[i],offsetAtt.endOffset());
    if (types != null)     assertEquals("type " + i,types[i],typeAtt.type());
    if (posIncrements != null)     assertEquals("posIncrement " + i,posIncrements[i],posIncrAtt.getPositionIncrement());
    if (offsetAtt != null) {
      assertTrue("startOffset must be >= 0",offsetAtt.startOffset() >= 0);
      assertTrue("endOffset must be >= 0",offsetAtt.endOffset() >= 0);
      assertTrue("endOffset must be >= startOffset",offsetAtt.endOffset() >= offsetAtt.startOffset());
    }
    if (posIncrAtt != null) {
      assertTrue("posIncrement must be >= 0",posIncrAtt.getPositionIncrement() >= 0);
    }
  }
  assertFalse("end of stream",ts.incrementToken());
  ts.end();
  if (finalOffset != null)   assertEquals("finalOffset ",finalOffset.intValue(),offsetAtt.endOffset());
  if (offsetAtt != null) {
    assertTrue("finalOffset must be >= 0",offsetAtt.endOffset() >= 0);
  }
  ts.close();
}
