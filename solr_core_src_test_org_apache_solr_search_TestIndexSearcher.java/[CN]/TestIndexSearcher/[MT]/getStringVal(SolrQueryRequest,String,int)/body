{
  SchemaField sf=sqr.getSchema().getField(field);
  ValueSource vs=sf.getType().getValueSource(sf,null);
  Map context=ValueSource.newContext(sqr.getSearcher());
  vs.createWeight(context,sqr.getSearcher());
  IndexReaderContext topReaderContext=sqr.getSearcher().getTopReaderContext();
  List<AtomicReaderContext> leaves=topReaderContext.leaves();
  int idx=ReaderUtil.subIndex(doc,leaves);
  AtomicReaderContext leaf=leaves.get(idx);
  FunctionValues vals=vs.getValues(context,leaf);
  return vals.strVal(doc - leaf.docBase);
}
