{
  StringBuilder sb=new StringBuilder(queryString);
  if (SELECT_WHERE_PATTERN.matcher(queryString).find()) {
    sb.append(" and ");
  }
 else {
    sb.append(" where ");
  }
  boolean first=true;
  String[] primaryKeys=context.getEntityAttribute("pk").split(",");
  for (  String primaryKey : primaryKeys) {
    if (!first) {
      sb.append(" and ");
    }
    first=false;
    Object val=resolver.resolve("dataimporter.delta." + primaryKey);
    if (val == null) {
      Matcher m=DOT_PATTERN.matcher(primaryKey);
      if (m.find()) {
        val=resolver.resolve("dataimporter.delta." + m.group(1));
      }
    }
    sb.append(primaryKey).append(" = ");
    if (val instanceof Number) {
      sb.append(val.toString());
    }
 else {
      sb.append("'").append(val.toString()).append("'");
    }
  }
  return sb.toString();
}
