{
  TopOrdCountQueue q=new TopOrdCountQueue(topN);
  int bottomValue=0;
  int ord=children[dimOrd];
  long sumValue=0;
  TopOrdCountQueue.OrdAndCount reuse=null;
  while (ord != TaxonomyReader.INVALID_ORDINAL) {
    if (values[ord] > 0) {
      sumValue+=values[ord];
      if (values[ord] > bottomValue) {
        if (reuse == null) {
          reuse=new TopOrdCountQueue.OrdAndCount();
        }
        reuse.ord=ord;
        reuse.count=values[ord];
        reuse=q.insertWithOverflow(reuse);
        if (q.size() == topN) {
          bottomValue=q.top().count;
        }
      }
    }
    ord=siblings[ord];
  }
  if (sumValue == 0) {
    return null;
  }
  LabelAndValue[] labelValues=new LabelAndValue[q.size()];
  for (int i=labelValues.length - 1; i >= 0; i--) {
    TopOrdCountQueue.OrdAndCount ordAndCount=q.pop();
    FacetLabel child=taxoReader.getPath(ordAndCount.ord);
    labelValues[i]=new LabelAndValue(child.components[path.length],ordAndCount.count);
  }
  return new SimpleFacetResult(path,sumValue,labelValues);
}
