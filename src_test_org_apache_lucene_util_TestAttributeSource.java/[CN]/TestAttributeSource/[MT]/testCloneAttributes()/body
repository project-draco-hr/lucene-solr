{
  final AttributeSource src=new AttributeSource();
  final TermAttribute termAtt=src.addAttribute(TermAttribute.class);
  final TypeAttribute typeAtt=src.addAttribute(TypeAttribute.class);
  termAtt.setTermBuffer("TestTerm");
  typeAtt.setType("TestType");
  final AttributeSource clone=src.cloneAttributes();
  final Iterator<Class<? extends Attribute>> it=clone.getAttributeClassesIterator();
  assertEquals("TermAttribute must be the first attribute",TermAttribute.class,it.next());
  assertEquals("TypeAttribute must be the second attribute",TypeAttribute.class,it.next());
  assertFalse("No more attributes",it.hasNext());
  final TermAttribute termAtt2=clone.getAttribute(TermAttribute.class);
  final TypeAttribute typeAtt2=clone.getAttribute(TypeAttribute.class);
  assertNotSame("TermAttribute of original and clone must be different instances",termAtt2,termAtt);
  assertNotSame("TypeAttribute of original and clone must be different instances",typeAtt2,typeAtt);
  assertEquals("TermAttribute of original and clone must be equal",termAtt2,termAtt);
  assertEquals("TypeAttribute of original and clone must be equal",typeAtt2,typeAtt);
  termAtt2.setTermBuffer("OtherTerm");
  typeAtt2.setType("OtherType");
  clone.copyTo(src);
  assertEquals("TermAttribute of original must now contain updated term","OtherTerm",termAtt.term());
  assertEquals("TypeAttribute of original must now contain updated type","OtherType",typeAtt.type());
  assertNotSame("TermAttribute of original and clone must be different instances",termAtt2,termAtt);
  assertNotSame("TypeAttribute of original and clone must be different instances",typeAtt2,typeAtt);
  assertEquals("TermAttribute of original and clone must be equal",termAtt2,termAtt);
  assertEquals("TypeAttribute of original and clone must be equal",typeAtt2,typeAtt);
}
