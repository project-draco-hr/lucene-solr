{
  if (endState == null) {
    super.end();
  }
 else {
    restoreState(endState);
  }
}
