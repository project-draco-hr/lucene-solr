{
  File dataDir=new File(dataDirPath);
  if (!dataDir.isDirectory()) {
    log.debug("{} does not point to a valid data directory; skipping clean-up of old index directories.",dataDirPath);
    return;
  }
  final File currentIndexDir=new File(currentIndexDirPath);
  File[] oldIndexDirs=dataDir.listFiles(new FileFilter(){
    @Override public boolean accept(    File file){
      String fileName=file.getName();
      return file.isDirectory() && !file.equals(currentIndexDir) && (fileName.equals("index") || fileName.matches(INDEX_W_TIMESTAMP_REGEX));
    }
  }
);
  if (oldIndexDirs == null || oldIndexDirs.length == 0)   return;
  log.info("Found {} old index directories to clean-up under {}",oldIndexDirs.length,dataDirPath);
  for (  File dir : oldIndexDirs) {
    String dirToRmPath=dir.getAbsolutePath();
    try {
      if (deleteOldIndexDirectory(dirToRmPath)) {
        log.info("Deleted old index directory: {}",dirToRmPath);
      }
 else {
        log.warn("Delete old index directory {} failed.",dirToRmPath);
      }
    }
 catch (    IOException ioExc) {
      log.error("Failed to delete old directory {} due to: {}",dir.getAbsolutePath(),ioExc.toString());
    }
  }
}
