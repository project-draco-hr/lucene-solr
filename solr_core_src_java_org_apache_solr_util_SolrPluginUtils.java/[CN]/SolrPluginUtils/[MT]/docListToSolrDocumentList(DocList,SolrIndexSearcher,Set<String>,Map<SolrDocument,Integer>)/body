{
  IndexSchema schema=searcher.getSchema();
  SolrDocumentList list=new SolrDocumentList();
  list.setNumFound(docs.matches());
  list.setMaxScore(docs.maxScore());
  list.setStart(docs.offset());
  DocIterator dit=docs.iterator();
  while (dit.hasNext()) {
    int docid=dit.nextDoc();
    Document luceneDoc=searcher.doc(docid,fields);
    SolrDocument doc=new SolrDocument();
    for (    IndexableField field : luceneDoc) {
      if (null == fields || fields.contains(field.name())) {
        SchemaField sf=schema.getField(field.name());
        doc.addField(field.name(),sf.getType().toObject(field));
      }
    }
    if (docs.hasScores() && (null == fields || fields.contains("score"))) {
      doc.addField("score",dit.score());
    }
    list.add(doc);
    if (ids != null) {
      ids.put(doc,new Integer(docid));
    }
  }
  return list;
}
