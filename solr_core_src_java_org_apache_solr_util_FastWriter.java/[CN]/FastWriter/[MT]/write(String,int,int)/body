{
  int space=buf.length - pos;
  if (len < space) {
    str.getChars(off,off + len,buf,pos);
    pos+=len;
  }
 else   if (len < BUFSIZE) {
    str.getChars(off,off + space,buf,pos);
    flush(buf,0,buf.length);
    str.getChars(off + space,off + len,buf,0);
    pos=len - space;
  }
 else {
    flush(buf,0,pos);
    pos=0;
    flush(str,off,len);
  }
}
