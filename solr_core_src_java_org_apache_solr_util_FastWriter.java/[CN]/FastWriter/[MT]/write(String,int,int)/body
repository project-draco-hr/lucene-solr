{
  for (; ; ) {
    int space=buf.length - pos;
    if (len <= space) {
      str.getChars(off,off + len,buf,pos);
      pos+=len;
      return;
    }
 else     if (len > buf.length) {
      if (pos > 0) {
        flush(buf,0,pos);
        pos=0;
      }
      flush(str,off,len);
      return;
    }
    str.getChars(off,off + space,buf,pos);
    flush(buf,0,buf.length);
    pos=0;
    off+=space;
    len-=space;
  }
}
