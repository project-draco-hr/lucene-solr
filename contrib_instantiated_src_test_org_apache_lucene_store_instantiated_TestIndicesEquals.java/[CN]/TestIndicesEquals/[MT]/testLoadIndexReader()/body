{
  RAMDirectory dir=new RAMDirectory();
  IndexWriter indexWriter=new IndexWriter(dir,new StandardAnalyzer(org.apache.lucene.util.Version.LUCENE_CURRENT),true,IndexWriter.MaxFieldLength.UNLIMITED);
  for (int i=0; i < 20; i++) {
    Document document=new Document();
    assembleDocument(document,i);
    indexWriter.addDocument(document);
  }
  indexWriter.close();
  IndexReader ir=IndexReader.open(dir,false);
  InstantiatedIndex ii=new InstantiatedIndex(ir);
  ir.close();
  testEqualBehaviour(dir,ii);
}
