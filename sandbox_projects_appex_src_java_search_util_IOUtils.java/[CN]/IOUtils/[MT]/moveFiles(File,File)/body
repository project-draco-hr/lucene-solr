{
  InputStream in=null;
  OutputStream out=null;
  if (!source.isDirectory())   throw new IOException("Expected a directory but " + source.toString() + " is a file!");
  if (!destination.isDirectory())   throw new IOException("Expected a directory but " + destination.toString() + " is a file!");
  File[] farray=source.listFiles();
  try {
    for (int i=0; i < farray.length; i++) {
      if (farray[i].isFile()) {
        File target=new File(destination,farray[i].getName());
        if (!target.exists() || target.canWrite()) {
          in=new FileInputStream(farray[i]);
          out=new FileOutputStream(target);
          transferData(in,out);
          in.close();
          out.close();
          if (target.exists())           farray[i].delete();
        }
      }
    }
    in=null;
    out=null;
  }
  finally {
    if (in != null)     in.close();
    if (out != null)     out.close();
  }
}
