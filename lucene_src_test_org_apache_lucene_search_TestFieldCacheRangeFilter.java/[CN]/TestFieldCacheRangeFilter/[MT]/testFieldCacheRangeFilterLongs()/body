{
  IndexReader reader=signedIndexReader;
  IndexSearcher search=newSearcher(reader);
  int numDocs=reader.numDocs();
  int medId=((maxId - minId) / 2);
  Long minIdO=Long.valueOf(minId);
  Long maxIdO=Long.valueOf(maxId);
  Long medIdO=Long.valueOf(medId);
  assertEquals("num of docs",numDocs,1 + maxId - minId);
  ScoreDoc[] result;
  Query q=new TermQuery(new Term("body","body"));
  result=search.search(q,FieldCacheRangeFilter.newLongRange("id",minIdO,maxIdO,T,T),numDocs).scoreDocs;
  assertEquals("find all",numDocs,result.length);
  result=search.search(q,FieldCacheRangeFilter.newLongRange("id",minIdO,maxIdO,T,F),numDocs).scoreDocs;
  assertEquals("all but last",numDocs - 1,result.length);
  result=search.search(q,FieldCacheRangeFilter.newLongRange("id",minIdO,maxIdO,F,T),numDocs).scoreDocs;
  assertEquals("all but first",numDocs - 1,result.length);
  result=search.search(q,FieldCacheRangeFilter.newLongRange("id",minIdO,maxIdO,F,F),numDocs).scoreDocs;
  assertEquals("all but ends",numDocs - 2,result.length);
  result=search.search(q,FieldCacheRangeFilter.newLongRange("id",medIdO,maxIdO,T,T),numDocs).scoreDocs;
  assertEquals("med and up",1 + maxId - medId,result.length);
  result=search.search(q,FieldCacheRangeFilter.newLongRange("id",minIdO,medIdO,T,T),numDocs).scoreDocs;
  assertEquals("up to med",1 + medId - minId,result.length);
  result=search.search(q,FieldCacheRangeFilter.newLongRange("id",null,null,T,T),numDocs).scoreDocs;
  assertEquals("find all",numDocs,result.length);
  result=search.search(q,FieldCacheRangeFilter.newLongRange("id",minIdO,null,T,F),numDocs).scoreDocs;
  assertEquals("min and up",numDocs,result.length);
  result=search.search(q,FieldCacheRangeFilter.newLongRange("id",null,maxIdO,F,T),numDocs).scoreDocs;
  assertEquals("max and down",numDocs,result.length);
  result=search.search(q,FieldCacheRangeFilter.newLongRange("id",minIdO,null,F,F),numDocs).scoreDocs;
  assertEquals("not min, but up",numDocs - 1,result.length);
  result=search.search(q,FieldCacheRangeFilter.newLongRange("id",null,maxIdO,F,F),numDocs).scoreDocs;
  assertEquals("not max, but down",numDocs - 1,result.length);
  result=search.search(q,FieldCacheRangeFilter.newLongRange("id",medIdO,maxIdO,T,F),numDocs).scoreDocs;
  assertEquals("med and up, not max",maxId - medId,result.length);
  result=search.search(q,FieldCacheRangeFilter.newLongRange("id",minIdO,medIdO,F,T),numDocs).scoreDocs;
  assertEquals("not min, up to med",medId - minId,result.length);
  result=search.search(q,FieldCacheRangeFilter.newLongRange("id",minIdO,minIdO,F,F),numDocs).scoreDocs;
  assertEquals("min,min,F,F",0,result.length);
  result=search.search(q,FieldCacheRangeFilter.newLongRange("id",medIdO,medIdO,F,F),numDocs).scoreDocs;
  assertEquals("med,med,F,F",0,result.length);
  result=search.search(q,FieldCacheRangeFilter.newLongRange("id",maxIdO,maxIdO,F,F),numDocs).scoreDocs;
  assertEquals("max,max,F,F",0,result.length);
  result=search.search(q,FieldCacheRangeFilter.newLongRange("id",minIdO,minIdO,T,T),numDocs).scoreDocs;
  assertEquals("min,min,T,T",1,result.length);
  result=search.search(q,FieldCacheRangeFilter.newLongRange("id",null,minIdO,F,T),numDocs).scoreDocs;
  assertEquals("nul,min,F,T",1,result.length);
  result=search.search(q,FieldCacheRangeFilter.newLongRange("id",maxIdO,maxIdO,T,T),numDocs).scoreDocs;
  assertEquals("max,max,T,T",1,result.length);
  result=search.search(q,FieldCacheRangeFilter.newLongRange("id",maxIdO,null,T,F),numDocs).scoreDocs;
  assertEquals("max,nul,T,T",1,result.length);
  result=search.search(q,FieldCacheRangeFilter.newLongRange("id",medIdO,medIdO,T,T),numDocs).scoreDocs;
  assertEquals("med,med,T,T",1,result.length);
  result=search.search(q,FieldCacheRangeFilter.newLongRange("id",Long.valueOf(Long.MAX_VALUE),null,F,F),numDocs).scoreDocs;
  assertEquals("overflow special case",0,result.length);
  result=search.search(q,FieldCacheRangeFilter.newLongRange("id",null,Long.valueOf(Long.MIN_VALUE),F,F),numDocs).scoreDocs;
  assertEquals("overflow special case",0,result.length);
  result=search.search(q,FieldCacheRangeFilter.newLongRange("id",maxIdO,minIdO,T,T),numDocs).scoreDocs;
  assertEquals("inverse range",0,result.length);
  search.close();
}
