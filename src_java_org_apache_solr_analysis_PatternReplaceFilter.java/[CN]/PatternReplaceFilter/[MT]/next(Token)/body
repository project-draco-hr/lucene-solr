{
  Token t=input.next(in);
  if (t == null)   return null;
  CharSequence text=CharBuffer.wrap(t.termBuffer(),0,t.termLength());
  Matcher m=p.matcher(text);
  if (all) {
    t.setTermText(m.replaceAll(replacement));
  }
 else {
    t.setTermText(m.replaceFirst(replacement));
  }
  return t;
}
