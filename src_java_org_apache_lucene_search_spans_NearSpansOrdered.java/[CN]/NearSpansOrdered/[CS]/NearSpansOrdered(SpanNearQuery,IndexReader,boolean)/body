{
  if (spanNearQuery.getClauses().length < 2) {
    throw new IllegalArgumentException("Less than 2 clauses: " + spanNearQuery);
  }
  this.collectPayloads=collectPayloads;
  allowedSlop=spanNearQuery.getSlop();
  SpanQuery[] clauses=spanNearQuery.getClauses();
  subSpans=new PayloadSpans[clauses.length];
  matchPayload=new LinkedList();
  subSpansByDoc=new PayloadSpans[clauses.length];
  for (int i=0; i < clauses.length; i++) {
    subSpans[i]=clauses[i].getPayloadSpans(reader);
    subSpansByDoc[i]=subSpans[i];
  }
  query=spanNearQuery;
}
