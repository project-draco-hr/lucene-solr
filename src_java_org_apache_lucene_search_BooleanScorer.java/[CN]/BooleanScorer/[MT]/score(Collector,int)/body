{
  if (coordFactors == null) {
    computeCoordFactors();
  }
  boolean more;
  Bucket tmp;
  BucketScorer bs=new BucketScorer();
  collector.setScorer(bs);
  do {
    bucketTable.first=null;
    while (current != null) {
      if ((current.bits & prohibitedMask) == 0 && (current.bits & requiredMask) == requiredMask) {
        if (current.doc >= max) {
          tmp=current;
          current=current.next;
          tmp.next=bucketTable.first;
          bucketTable.first=tmp;
          continue;
        }
        if (current.coord >= minNrShouldMatch) {
          bs.score=current.score * coordFactors[current.coord];
          bs.doc=current.doc;
          collector.collect(current.doc);
        }
      }
      current=current.next;
    }
    if (bucketTable.first != null) {
      current=bucketTable.first;
      bucketTable.first=current.next;
      return true;
    }
    more=false;
    end+=BucketTable.SIZE;
    for (SubScorer sub=scorers; sub != null; sub=sub.next) {
      if (!sub.done) {
        sub.done=!sub.scorer.score(sub.collector,end);
        if (!sub.done)         more=true;
      }
    }
    current=bucketTable.first;
  }
 while (current != null || more);
  return false;
}
