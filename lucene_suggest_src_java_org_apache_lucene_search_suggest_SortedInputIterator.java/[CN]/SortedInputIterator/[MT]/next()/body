{
  boolean success=false;
  if (done) {
    return null;
  }
  try {
    ByteArrayDataInput input=new ByteArrayDataInput();
    if (reader.read(scratch)) {
      final BytesRef bytes=scratch.get();
      weight=decode(bytes,input);
      if (hasPayloads) {
        payload=decodePayload(bytes,input);
      }
      if (hasContexts) {
        contexts=decodeContexts(bytes,input);
      }
      success=true;
      return bytes;
    }
    close();
    success=done=true;
    return null;
  }
  finally {
    if (!success) {
      done=true;
      close();
    }
  }
}
