{
  System.setProperty("shareSchema","true");
  final CoreContainer cores=init("_shareSchema");
  try {
    CoreDescriptor descriptor1=new CoreDescriptor(cores,"core1","./collection1");
    SolrCore core1=cores.create(descriptor1);
    CoreDescriptor descriptor2=new CoreDescriptor(cores,"core2","./collection1");
    SolrCore core2=cores.create(descriptor2);
    assertSame(core1.getLatestSchema(),core2.getLatestSchema());
    core1.close();
    core2.close();
  }
  finally {
    cores.shutdown();
    System.clearProperty("shareSchema");
  }
}
