{
  File solrHomeDirectory=new File(TEMP_DIR,this.getClass().getName() + "_noCores");
  SetUpHome(solrHomeDirectory,EMPTY_SOLR_XML);
  CoreContainer.Initializer init=new CoreContainer.Initializer();
  CoreContainer cores=null;
  try {
    cores=init.initialize();
  }
 catch (  Exception e) {
    fail("CoreContainer not created" + e.getMessage());
  }
  try {
    assertEquals("There should not be cores",0,cores.getCores().size());
    FileUtils.copyDirectory(new File(SolrTestCaseJ4.TEST_HOME(),"collection1"),solrHomeDirectory);
    CoreDescriptor coreDescriptor=new CoreDescriptor(cores,"core1",solrHomeDirectory.getAbsolutePath());
    SolrCore newCore=cores.create(coreDescriptor);
    cores.register(newCore,false);
    assertEquals("There core registered",1,cores.getCores().size());
    assertXmlFile(new File(solrHomeDirectory,"solr.xml"),"/solr/cores[@transientCacheSize='32']");
    newCore.close();
    cores.remove("core1");
    assertEquals("There should not be cores",0,cores.getCores().size());
  }
  finally {
    cores.shutdown();
    FileUtils.deleteDirectory(solrHomeDirectory);
  }
}
