{
  final String indexStreamFN=IndexFileNames.segmentFileName(segment,"",DefaultStoredFieldsWriter.FIELDS_INDEX_EXTENSION);
  IndexInput idxStream=dir.openInput(indexStreamFN,IOContext.DEFAULT);
  try {
    int format=idxStream.readInt();
    if (format < DefaultStoredFieldsWriter.FORMAT_MINIMUM)     throw new IndexFormatTooOldException(idxStream,format,DefaultStoredFieldsWriter.FORMAT_MINIMUM,DefaultStoredFieldsWriter.FORMAT_CURRENT);
    if (format > DefaultStoredFieldsWriter.FORMAT_CURRENT)     throw new IndexFormatTooNewException(idxStream,format,DefaultStoredFieldsWriter.FORMAT_MINIMUM,DefaultStoredFieldsWriter.FORMAT_CURRENT);
  }
  finally {
    idxStream.close();
  }
}
