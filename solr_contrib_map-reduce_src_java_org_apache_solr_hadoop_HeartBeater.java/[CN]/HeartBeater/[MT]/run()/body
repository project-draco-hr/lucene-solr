{
  LOG.info("HeartBeat thread running");
  while (true) {
    try {
synchronized (this) {
        if (threadsNeedingHeartBeat > 0) {
          progress.progress();
          if (LOG.isInfoEnabled()) {
            LOG.info(String.format(Locale.ENGLISH,"Issuing heart beat for %d threads",threadsNeedingHeartBeat));
          }
        }
 else {
          if (LOG.isInfoEnabled()) {
            LOG.info(String.format(Locale.ENGLISH,"heartbeat skipped count %d",threadsNeedingHeartBeat));
          }
        }
      }
      if (isClosing.await(waitTimeMs,TimeUnit.MILLISECONDS)) {
        return;
      }
    }
 catch (    Throwable e) {
      LOG.error("HeartBeat throwable",e);
    }
  }
}
