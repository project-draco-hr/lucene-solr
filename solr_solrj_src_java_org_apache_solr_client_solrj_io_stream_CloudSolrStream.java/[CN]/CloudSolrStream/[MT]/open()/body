{
  this.tuples=new TreeSet();
  this.solrStreams=new ArrayList();
  this.eofTuples=Collections.synchronizedMap(new HashMap());
  if (this.streamContext != null && this.streamContext.getSolrClientCache() != null) {
    this.cloudSolrClient=this.streamContext.getSolrClientCache().getCloudSolrClient(zkHost);
  }
 else {
    this.cloudSolrClient=new Builder().withZkHost(zkHost).build();
    this.cloudSolrClient.connect();
  }
  constructStreams();
  openStreams();
}
