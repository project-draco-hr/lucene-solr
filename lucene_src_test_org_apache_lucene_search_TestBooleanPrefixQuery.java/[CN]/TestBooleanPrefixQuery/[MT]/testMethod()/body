{
  MockRAMDirectory directory=new MockRAMDirectory();
  String[] categories=new String[]{"food","foodanddrink","foodanddrinkandgoodtimes","food and drink"};
  Query rw1=null;
  Query rw2=null;
  IndexReader reader=null;
  RandomIndexWriter writer=new RandomIndexWriter(newRandom(),directory);
  for (int i=0; i < categories.length; i++) {
    Document doc=new Document();
    doc.add(new Field("category",categories[i],Field.Store.YES,Field.Index.NOT_ANALYZED));
    writer.addDocument(doc);
  }
  reader=writer.getReader();
  writer.close();
  PrefixQuery query=new PrefixQuery(new Term("category","foo"));
  rw1=query.rewrite(reader);
  BooleanQuery bq=new BooleanQuery();
  bq.add(query,BooleanClause.Occur.MUST);
  rw2=bq.rewrite(reader);
  assertEquals("Number of Clauses Mismatch",getCount(reader,rw1),getCount(reader,rw2));
  reader.close();
  directory.close();
}
