{
  meta.writeVInt(field.number);
  meta.writeByte(Lucene50DocValuesFormat.SORTED_NUMERIC);
  if (isSingleValued(docToValueCount)) {
    meta.writeVInt(SORTED_SINGLE_VALUED);
    addNumericField(field,singletonView(docToValueCount,values,null));
  }
 else {
    final SortedSet<LongsRef> uniqueValueSets=uniqueValueSets(docToValueCount,values);
    if (uniqueValueSets != null) {
      meta.writeVInt(SORTED_SET_TABLE);
      writeDictionary(uniqueValueSets);
      addNumericField(field,docToSetId(uniqueValueSets,docToValueCount,values),false);
    }
 else {
      meta.writeVInt(SORTED_WITH_ADDRESSES);
      addNumericField(field,values,true);
      addAddresses(field,docToValueCount);
    }
  }
}
