{
  long now=System.nanoTime();
  long maxTimeout=now + timeoutInNanos;
  long timeout=now + TimeUnit.NANOSECONDS.convert(60,TimeUnit.SECONDS);
  boolean firstTime=true;
  int stableCheckTimeout=2000;
  String oldleader=null;
  while (System.nanoTime() < timeout && System.nanoTime() < maxTimeout) {
    String newLeader=OverseerCollectionProcessor.getLeaderNode(testZkClient);
    if (newLeader != null && !newLeader.equals(oldleader)) {
      timeout=System.nanoTime() + TimeUnit.NANOSECONDS.convert(60,TimeUnit.SECONDS);
      log.info("oldLeader={} newLeader={} - Advancing timeout to: {}",oldleader,newLeader,timeout);
      oldleader=newLeader;
    }
    if (!overseerDesignates.contains(newLeader)) {
      Thread.sleep(500);
    }
 else {
      if (firstTime) {
        firstTime=false;
        Thread.sleep(stableCheckTimeout);
      }
 else {
        return true;
      }
    }
  }
  if (System.nanoTime() < maxTimeout) {
    log.error("Max wait time exceeded");
  }
  return false;
}
