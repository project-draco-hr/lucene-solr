{
  try {
    if (resultMode == ResultMode.PER_NODE_IN_TREE) {
      return new TopKInEachNodeHandler(taxonomyReader,(FacetRequest)clone());
    }
    return new TopKFacetResultsHandler(taxonomyReader,(FacetRequest)clone());
  }
 catch (  CloneNotSupportedException e) {
    throw new RuntimeException(e);
  }
}
