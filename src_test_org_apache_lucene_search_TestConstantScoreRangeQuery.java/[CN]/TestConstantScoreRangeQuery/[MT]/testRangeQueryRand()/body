{
  IndexReader reader=IndexReader.open(index);
  IndexSearcher search=new IndexSearcher(reader);
  String minRP=pad(minR);
  String maxRP=pad(maxR);
  int numDocs=reader.numDocs();
  assertEquals("num of docs",numDocs,1 + maxId - minId);
  Hits result;
  Query q=new TermQuery(new Term("body","body"));
  result=search.search(csrq("rand",minRP,maxRP,T,T));
  assertEquals("find all",numDocs,result.length());
  result=search.search(csrq("rand",minRP,maxRP,T,F));
  assertEquals("all but biggest",numDocs - 1,result.length());
  result=search.search(csrq("rand",minRP,maxRP,F,T));
  assertEquals("all but smallest",numDocs - 1,result.length());
  result=search.search(csrq("rand",minRP,maxRP,F,F));
  assertEquals("all but extremes",numDocs - 2,result.length());
  result=search.search(csrq("rand",minRP,null,T,F));
  assertEquals("smallest and up",numDocs,result.length());
  result=search.search(csrq("rand",null,maxRP,F,T));
  assertEquals("biggest and down",numDocs,result.length());
  result=search.search(csrq("rand",minRP,null,F,F));
  assertEquals("not smallest, but up",numDocs - 1,result.length());
  result=search.search(csrq("rand",null,maxRP,F,F));
  assertEquals("not biggest, but down",numDocs - 1,result.length());
  result=search.search(csrq("rand",minRP,minRP,F,F));
  assertEquals("min,min,F,F",0,result.length());
  result=search.search(csrq("rand",maxRP,maxRP,F,F));
  assertEquals("max,max,F,F",0,result.length());
  result=search.search(csrq("rand",minRP,minRP,T,T));
  assertEquals("min,min,T,T",1,result.length());
  result=search.search(csrq("rand",null,minRP,F,T));
  assertEquals("nul,min,F,T",1,result.length());
  result=search.search(csrq("rand",maxRP,maxRP,T,T));
  assertEquals("max,max,T,T",1,result.length());
  result=search.search(csrq("rand",maxRP,null,T,F));
  assertEquals("max,nul,T,T",1,result.length());
}
