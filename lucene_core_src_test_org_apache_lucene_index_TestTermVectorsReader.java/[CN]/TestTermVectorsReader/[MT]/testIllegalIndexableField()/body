{
  Directory dir=newDirectory();
  MockAnalyzer a=new MockAnalyzer(random());
  a.setEnableChecks(false);
  RandomIndexWriter w=new RandomIndexWriter(random(),dir,a);
  FieldType ft=new FieldType(TextField.TYPE_NOT_STORED);
  ft.setStoreTermVectors(true);
  ft.setStoreTermVectorPayloads(true);
  Document doc=new Document();
  doc.add(new Field("field","value",ft));
  try {
    w.addDocument(doc);
    fail("did not hit exception");
  }
 catch (  IllegalArgumentException iae) {
    assertEquals("cannot index term vector payloads without term vector positions (field=\"field\")",iae.getMessage());
  }
  ft=new FieldType(TextField.TYPE_NOT_STORED);
  ft.setStoreTermVectors(false);
  ft.setStoreTermVectorOffsets(true);
  doc=new Document();
  doc.add(new Field("field","value",ft));
  try {
    w.addDocument(doc);
    fail("did not hit exception");
  }
 catch (  IllegalArgumentException iae) {
    assertEquals("cannot index term vector offsets when term vectors are not indexed (field=\"field\")",iae.getMessage());
  }
  ft=new FieldType(TextField.TYPE_NOT_STORED);
  ft.setStoreTermVectors(false);
  ft.setStoreTermVectorPositions(true);
  doc=new Document();
  doc.add(new Field("field","value",ft));
  try {
    w.addDocument(doc);
    fail("did not hit exception");
  }
 catch (  IllegalArgumentException iae) {
    assertEquals("cannot index term vector positions when term vectors are not indexed (field=\"field\")",iae.getMessage());
  }
  ft=new FieldType(TextField.TYPE_NOT_STORED);
  ft.setStoreTermVectors(false);
  ft.setStoreTermVectorPayloads(true);
  doc=new Document();
  doc.add(new Field("field","value",ft));
  try {
    w.addDocument(doc);
    fail("did not hit exception");
  }
 catch (  IllegalArgumentException iae) {
    assertEquals("cannot index term vector payloads when term vectors are not indexed (field=\"field\")",iae.getMessage());
  }
  ft=new FieldType(TextField.TYPE_NOT_STORED);
  ft.setStoreTermVectors(true);
  ft.setStoreTermVectorPayloads(true);
  doc=new Document();
  doc.add(new Field("field","value",ft));
  try {
    w.addDocument(doc);
    fail("did not hit exception");
  }
 catch (  IllegalArgumentException iae) {
    assertEquals("cannot index term vector payloads without term vector positions (field=\"field\")",iae.getMessage());
  }
  ft=new FieldType(StoredField.TYPE);
  ft.setStoreTermVectors(true);
  doc=new Document();
  doc.add(new Field("field","value",ft));
  try {
    w.addDocument(doc);
    fail("did not hit exception");
  }
 catch (  IllegalArgumentException iae) {
    assertEquals("cannot store term vectors for a field that is not indexed (field=\"field\")",iae.getMessage());
  }
  ft=new FieldType(StoredField.TYPE);
  ft.setStoreTermVectorPositions(true);
  doc=new Document();
  doc.add(new Field("field","value",ft));
  try {
    w.addDocument(doc);
    fail("did not hit exception");
  }
 catch (  IllegalArgumentException iae) {
    assertEquals("cannot store term vector positions for a field that is not indexed (field=\"field\")",iae.getMessage());
  }
  ft=new FieldType(StoredField.TYPE);
  ft.setStoreTermVectorOffsets(true);
  doc=new Document();
  doc.add(new Field("field","value",ft));
  try {
    w.addDocument(doc);
    fail("did not hit exception");
  }
 catch (  IllegalArgumentException iae) {
    assertEquals("cannot store term vector offsets for a field that is not indexed (field=\"field\")",iae.getMessage());
  }
  ft=new FieldType(StoredField.TYPE);
  ft.setStoreTermVectorPayloads(true);
  doc=new Document();
  doc.add(new Field("field","value",ft));
  try {
    w.addDocument(doc);
    fail("did not hit exception");
  }
 catch (  IllegalArgumentException iae) {
    assertEquals("cannot store term vector payloads for a field that is not indexed (field=\"field\")",iae.getMessage());
  }
  w.close();
  dir.close();
}
