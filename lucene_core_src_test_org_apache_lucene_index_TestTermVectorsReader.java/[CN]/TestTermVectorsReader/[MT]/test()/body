{
  DirectoryReader reader=IndexReader.open(dir);
  for (  IndexReader r : reader.getSequentialSubReaders()) {
    SegmentInfo s=((SegmentReader)r).getSegmentInfo();
    assertTrue(((SegmentReader)r).getFieldInfos().hasVectors());
    Set<String> files=new HashSet<String>();
    s.getCodec().termVectorsFormat().files(s,files);
    assertFalse(files.isEmpty());
    for (    String file : files) {
      assertTrue(dir.fileExists(file));
    }
  }
  reader.close();
}
