{
  ByteArrayOutputStream bos=new ByteArrayOutputStream(1024);
  CheckIndex checker=new CheckIndex(dir);
  checker.setCrossCheckTermVectors(crossCheckTermVectors);
  checker.setInfoStream(new PrintStream(bos,false,"UTF-8"),false);
  CheckIndex.Status indexStatus=checker.checkIndex(null);
  if (indexStatus == null || indexStatus.clean == false) {
    System.out.println("CheckIndex failed");
    System.out.println(bos.toString("UTF-8"));
    throw new RuntimeException("CheckIndex failed");
  }
 else {
    if (LuceneTestCase.INFOSTREAM) {
      System.out.println(bos.toString("UTF-8"));
    }
    return indexStatus;
  }
}
