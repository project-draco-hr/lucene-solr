{
  ByteArrayOutputStream bos=new ByteArrayOutputStream(1024);
  PrintStream infoStream=new PrintStream(bos,false,IOUtils.UTF_8);
  reader.checkIntegrity();
  FieldNormStatus fieldNormStatus=CheckIndex.testFieldNorms(reader,infoStream);
  TermIndexStatus termIndexStatus=CheckIndex.testPostings(reader,infoStream);
  StoredFieldStatus storedFieldStatus=CheckIndex.testStoredFields(reader,infoStream);
  TermVectorStatus termVectorStatus=CheckIndex.testTermVectors(reader,infoStream,false,crossCheckTermVectors);
  DocValuesStatus docValuesStatus=CheckIndex.testDocValues(reader,infoStream);
  if (fieldNormStatus.error != null || termIndexStatus.error != null || storedFieldStatus.error != null || termVectorStatus.error != null || docValuesStatus.error != null) {
    System.out.println("CheckReader failed");
    System.out.println(bos.toString(IOUtils.UTF_8));
    throw new RuntimeException("CheckReader failed");
  }
 else {
    if (LuceneTestCase.INFOSTREAM) {
      System.out.println(bos.toString(IOUtils.UTF_8));
    }
  }
}
