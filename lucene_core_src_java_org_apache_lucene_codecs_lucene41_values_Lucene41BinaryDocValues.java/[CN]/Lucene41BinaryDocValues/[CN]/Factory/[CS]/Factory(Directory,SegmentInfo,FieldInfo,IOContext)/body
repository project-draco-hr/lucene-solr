{
  boolean success=false;
  this.valueCount=segmentInfo.getDocCount();
  IndexInput datIn=null;
  IndexInput indexIn=null;
  try {
    datIn=dir.openInput(Lucene41DocValuesConsumer.getDocValuesFileName(segmentInfo,field,Lucene41DocValuesConsumer.DATA_EXTENSION),context);
    CodecUtil.checkHeader(datIn,CODEC_NAME,VERSION_START,VERSION_START);
    this.size=datIn.readInt();
    this.maxLength=datIn.readInt();
    this.baseOffset=datIn.getFilePointer();
    if (size == VALUE_SIZE_VAR) {
      indexIn=dir.openInput(Lucene41DocValuesConsumer.getDocValuesFileName(segmentInfo,field,Lucene41DocValuesConsumer.INDEX_EXTENSION),context);
      CodecUtil.checkHeader(indexIn,CODEC_NAME,VERSION_START,VERSION_START);
      indexHeader=PackedInts.readHeader(indexIn);
    }
 else {
      indexIn=null;
      indexHeader=null;
    }
    this.indexIn=indexIn;
    this.datIn=datIn;
    success=true;
  }
  finally {
    if (!success) {
      IOUtils.closeWhileHandlingException(datIn,indexIn);
    }
  }
}
