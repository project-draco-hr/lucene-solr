{
  if (0 == segments.size()) {
    throw new RuntimeException("segments must include at least one segment");
  }
  this.segments=new ArrayList<>(segments);
  int count=0;
  for (  SegmentCommitInfo info : segments) {
    count+=info.info.getDocCount();
  }
  totalDocCount=count;
  rateLimiter=new MergeRateLimiter(this);
}
