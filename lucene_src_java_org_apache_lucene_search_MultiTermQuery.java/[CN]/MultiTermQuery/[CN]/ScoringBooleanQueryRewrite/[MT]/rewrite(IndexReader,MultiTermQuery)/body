{
  final BooleanQuery result=new BooleanQuery(true);
  final Term placeholderTerm=new Term(query.field);
  query.incTotalNumberOfTerms(collectTerms(reader,query,new TermCollector(){
    @Override public boolean collect(    TermsEnum termsEnum,    BytesRef bytes,    float boost){
      TermQuery tq=new TermQuery(placeholderTerm.createTerm(new BytesRef(bytes)),termsEnum.docFreq());
      tq.setBoost(query.getBoost() * boost);
      result.add(tq,BooleanClause.Occur.SHOULD);
      return true;
    }
  }
));
  return result;
}
