{
  MockInitialContextFactory.bind("java:comp/env/jdbc/JndiDB",dataSource);
  props.put(JdbcDataSource.JNDI_NAME,"java:comp/env/jdbc/JndiDB");
  SQLException sqlException=new SQLException("fake");
  EasyMock.expect(dataSource.getConnection()).andThrow(sqlException);
  mockControl.replay();
  try {
    jdbcDataSource.createConnectionFactory(context,props).call();
  }
 catch (  SQLException ex) {
    assertSame(sqlException,ex);
  }
  mockControl.verify();
}
