{
  MockInitialContextFactory.bind("java:comp/env/jdbc/JndiDB",dataSource);
  props.put(JdbcDataSource.JNDI_NAME,"java:comp/env/jdbc/JndiDB");
  props.put("user","Fred");
  props.put("encryptKeyFile","${foo.bar}");
  props.put("password","U2FsdGVkX18QMjY0yfCqlfBMvAB4d3XkwY96L7gfO2o=");
  EasyMock.expect(dataSource.getConnection("Fred","MyPassword")).andReturn(connection);
  Map<String,Object> values=new HashMap<>();
  values.put("bar",createEncryptionKeyFile());
  context.getVariableResolver().addNamespace("foo",values);
  jdbcDataSource.init(context,props);
  connection.setAutoCommit(false);
  mockControl.replay();
  jdbcDataSource.getConnection();
  mockControl.verify();
}
