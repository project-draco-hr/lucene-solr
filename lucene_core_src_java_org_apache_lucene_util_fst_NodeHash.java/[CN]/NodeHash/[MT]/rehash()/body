{
  final GrowableWriter oldTable=table;
  if (oldTable.size() >= Integer.MAX_VALUE / 2) {
    throw new IllegalStateException("FST too large (> 2.1 GB)");
  }
  table=new GrowableWriter(oldTable.getBitsPerValue(),2 * oldTable.size(),PackedInts.COMPACT);
  mask=table.size() - 1;
  for (int idx=0; idx < oldTable.size(); idx++) {
    final long address=oldTable.get(idx);
    if (address != 0) {
      addNew(address);
    }
  }
}
