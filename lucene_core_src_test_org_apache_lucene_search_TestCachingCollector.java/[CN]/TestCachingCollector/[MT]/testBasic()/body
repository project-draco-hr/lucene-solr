{
  for (  boolean cacheScores : new boolean[]{false,true}) {
    CachingCollector cc=CachingCollector.create(new NoOpCollector(false),cacheScores,1.0);
    cc.setScorer(new MockScorer());
    for (int i=0; i < 1000; i++) {
      cc.collect(i);
    }
    cc.replay(new Collector(){
      int prevDocID=-1;
      @Override public void setScorer(      Scorer scorer){
      }
      @Override public void setNextReader(      AtomicReaderContext context){
      }
      @Override public void collect(      int doc){
        assertEquals(prevDocID + 1,doc);
        prevDocID=doc;
      }
      @Override public boolean acceptsDocsOutOfOrder(){
        return false;
      }
    }
);
  }
}
