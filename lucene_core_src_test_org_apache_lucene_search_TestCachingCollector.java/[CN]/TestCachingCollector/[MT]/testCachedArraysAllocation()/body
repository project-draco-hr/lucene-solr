{
  int numDocs=random().nextInt(10000) + 150;
  for (  boolean cacheScores : new boolean[]{false,true}) {
    int bytesPerDoc=cacheScores ? 8 : 4;
    CachingCollector cc=CachingCollector.create(new NoOpCollector(false),cacheScores,bytesPerDoc * ONE_BYTE * numDocs);
    cc.setScorer(new MockScorer());
    for (int i=0; i < numDocs; i++)     cc.collect(i);
    assertTrue(cc.isCached());
    cc.collect(numDocs);
    assertFalse(cc.isCached());
  }
}
