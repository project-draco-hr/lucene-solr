{
  CachingCollector cc=CachingCollector.create(new NoOpCollector(),true,50 * ONE_BYTE);
  LeafCollector acc=cc.getLeafCollector(null);
  acc.setScorer(new MockScorer());
  for (int i=0; i < 130; i++) {
    acc.collect(i);
  }
  assertFalse("CachingCollector should not be cached due to low memory limit",cc.isCached());
  try {
    cc.replay(new NoOpCollector());
    fail("replay should fail if CachingCollector is not cached");
  }
 catch (  IllegalStateException e) {
  }
}
