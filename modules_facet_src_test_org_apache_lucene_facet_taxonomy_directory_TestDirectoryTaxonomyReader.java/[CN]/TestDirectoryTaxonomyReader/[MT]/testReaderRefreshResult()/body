{
  Directory dir=null;
  DirectoryTaxonomyWriter ltw=null;
  DirectoryTaxonomyReader ltr=null;
  try {
    dir=newDirectory();
    ltw=new DirectoryTaxonomyWriter(dir);
    ltw.addCategory(new CategoryPath("a"));
    ltw.commit();
    ltr=new DirectoryTaxonomyReader(dir);
    assertFalse("Nothing has changed",ltr.refresh());
    ltw.addCategory(new CategoryPath("b"));
    ltw.commit();
    assertTrue("changes were committed",ltr.refresh());
    assertFalse("Nothing has changed",ltr.refresh());
  }
  finally {
    IOUtils.close(ltw,ltr,dir);
  }
}
