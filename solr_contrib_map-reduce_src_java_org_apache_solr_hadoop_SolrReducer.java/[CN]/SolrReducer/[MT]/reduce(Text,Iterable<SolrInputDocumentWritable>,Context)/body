{
  heartBeater.needHeartBeat();
  try {
    values=resolve(key,values,context);
    super.reduce(key,values,context);
  }
 catch (  Exception e) {
    LOG.error("Unable to process key " + key,e);
    context.getCounter(getClass().getName() + ".errors",e.getClass().getName()).increment(1);
    exceptionHandler.handleException(e,null);
  }
 finally {
    heartBeater.cancelHeartBeat();
  }
}
