{
  Parser parser=detectParser(record);
  if (parser == null) {
    return false;
  }
  ParseContext parseContext=new ParseContext();
  parseContext.set(Locale.class,locale);
  Metadata metadata=new Metadata();
  for (  Entry<String,Object> entry : record.getFields().entries()) {
    metadata.add(entry.getKey(),entry.getValue().toString());
  }
  SolrContentHandler handler=solrContentHandlerFactory.createSolrContentHandler(metadata,solrParams,schema);
  try {
    inputStream=TikaInputStream.get(inputStream);
    ContentHandler parsingHandler=handler;
    if (xpathExpr != null) {
      Matcher matcher=PARSER.parse(xpathExpr);
      parsingHandler=new MatchingContentHandler(parsingHandler,matcher);
    }
    try {
      parser.parse(inputStream,parsingHandler,metadata,parseContext);
    }
 catch (    IOException|TikaException|SAXException e) {
      throw new MorphlineRuntimeException("Cannot parse",e);
    }
  }
  finally {
    if (inputStream != null) {
      Closeables.closeQuietly(inputStream);
    }
  }
  SolrInputDocument doc=handler.newDocument();
  LOG.debug("solr doc: {}",doc);
  Record outputRecord=toRecord(doc);
  return getChild().process(outputRecord);
}
