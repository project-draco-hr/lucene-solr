{
  Iterable<TermFreq> keys=shuffle(new TermFreq("foo bar baz blah",50),new TermFreq("boo foo bar foo bee",20));
  Analyzer a=new MockAnalyzer(random());
  FreeTextSuggester sug=new FreeTextSuggester(a,a,2,(byte)0x20);
  sug.build(new TermFreqArrayIterator(keys));
  for (int i=0; i < 2; i++) {
    assertEquals("foo bar/0.67 foo bee/0.33 baz/0.04 blah/0.04 boo/0.04",toString(sug.lookup("foo b",10)));
    assertEquals("foo bar/0.67 foo bee/0.33",toString(sug.lookup("foo ",10)));
    assertEquals("foo/0.33",toString(sug.lookup("foo",10)));
    assertEquals("bar/0.22 baz/0.11 bee/0.11 blah/0.11 boo/0.11",toString(sug.lookup("b",10)));
    File tmpDir=_TestUtil.getTempDir("FreeTextSuggesterTest");
    tmpDir.mkdir();
    File path=new File(tmpDir,"suggester");
    OutputStream os=new FileOutputStream(path);
    sug.store(os);
    os.close();
    InputStream is=new FileInputStream(path);
    sug=new FreeTextSuggester(a,a,2,(byte)0x20);
    sug.load(is);
    is.close();
  }
}
