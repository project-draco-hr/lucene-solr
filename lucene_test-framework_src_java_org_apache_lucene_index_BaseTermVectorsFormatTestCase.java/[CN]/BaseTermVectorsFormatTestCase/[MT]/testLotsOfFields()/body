{
  final RandomDocumentFactory docFactory=new RandomDocumentFactory(5000,10);
  for (  Options options : validOptions()) {
    final Directory dir=newDirectory();
    final RandomIndexWriter writer=new RandomIndexWriter(random(),dir);
    final RandomDocument doc=docFactory.newDocument(atLeast(100),5,options);
    writer.addDocument(doc.toDocument());
    final IndexReader reader=writer.getReader();
    assertEquals(doc,reader.getTermVectors(0));
    reader.close();
    writer.shutdown();
    dir.close();
  }
}
