{
  Directory dir=newDirectory();
  IndexWriterConfig conf=newIndexWriterConfig(TEST_VERSION_CURRENT,new MockAnalyzer(random)).setMergeScheduler(new MyMergeScheduler()).setMaxBufferedDocs(2).setMergePolicy(newLogMergePolicy());
  LogMergePolicy lmp=(LogMergePolicy)conf.getMergePolicy();
  lmp.setMaxMergeDocs(20);
  lmp.setMergeFactor(2);
  IndexWriter iw=new IndexWriter(dir,conf);
  Document document=new Document();
  FieldType customType=new FieldType(TextField.TYPE_UNSTORED);
  customType.setStoreTermVectors(true);
  document.add(newField("tvtest","a b c",customType));
  for (int i=0; i < 177; i++)   iw.addDocument(document);
  iw.close();
  dir.close();
}
