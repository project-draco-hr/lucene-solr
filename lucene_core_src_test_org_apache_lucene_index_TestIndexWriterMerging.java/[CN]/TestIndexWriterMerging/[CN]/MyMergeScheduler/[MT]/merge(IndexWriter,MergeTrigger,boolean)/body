{
  while (true) {
    MergePolicy.OneMerge merge=writer.getNextMerge();
    if (merge == null) {
      break;
    }
    int numDocs=0;
    for (int i=0; i < merge.segments.size(); i++) {
      int maxDoc=merge.segments.get(i).info.maxDoc();
      numDocs+=maxDoc;
      assertTrue(maxDoc < 20);
    }
    writer.merge(merge);
    assertEquals(numDocs,merge.getMergeInfo().info.maxDoc());
  }
}
