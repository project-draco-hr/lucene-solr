{
  closed=true;
  if (nextWrite != values.length) {
    throw new IllegalStateException("only wrote " + nextWrite + " values, but expected "+ values.length);
  }
}
