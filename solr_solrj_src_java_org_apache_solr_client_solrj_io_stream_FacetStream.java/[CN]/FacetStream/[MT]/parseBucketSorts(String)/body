{
  String[] sorts=bucketSortString.split(",");
  FieldComparator[] comps=new FieldComparator[sorts.length];
  for (int i=0; i < sorts.length; i++) {
    String s=sorts[i];
    String[] spec=s.trim().split("\\s+");
    if (2 != spec.length) {
      throw new IOException(String.format(Locale.ROOT,"invalid expression - bad bucketSort '%s'. Expected form 'field order'",bucketSortString));
    }
    String fieldName=spec[0].trim();
    String order=spec[1].trim();
    comps[i]=new FieldComparator(fieldName,order.equalsIgnoreCase("asc") ? ComparatorOrder.ASCENDING : ComparatorOrder.DESCENDING);
  }
  return comps;
}
