{
  if (useMergePolicyInfo()) {
    return buildMergePolicyFromInfo(schema);
  }
  final MergePolicyFactory mpf;
  if (mergePolicyFactoryInfo == null) {
    mpf=defaultMergePolicyFactory;
  }
 else {
    final String mpfClassName=mergePolicyFactoryInfo.className;
    final MergePolicyFactoryArgs mpfArgs=new MergePolicyFactoryArgs(mergePolicyFactoryInfo.initArgs);
    final SolrResourceLoader resourceLoader=schema.getResourceLoader();
    mpf=resourceLoader.newInstance(mpfClassName,MergePolicyFactory.class,NO_SUB_PACKAGES,new Class[]{SolrResourceLoader.class,MergePolicyFactoryArgs.class},new Object[]{resourceLoader,mpfArgs});
  }
  return mpf.getMergePolicy();
}
