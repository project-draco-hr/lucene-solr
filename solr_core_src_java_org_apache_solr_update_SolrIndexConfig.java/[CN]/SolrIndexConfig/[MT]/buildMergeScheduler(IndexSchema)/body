{
  String msClassName=mergeSchedulerInfo == null ? SolrIndexConfig.DEFAULT_MERGE_SCHEDULER_CLASSNAME : mergeSchedulerInfo.className;
  MergeScheduler scheduler=schema.getResourceLoader().newInstance(msClassName,MergeScheduler.class);
  if (mergeSchedulerInfo != null) {
    if (scheduler instanceof ConcurrentMergeScheduler) {
      NamedList args=mergeSchedulerInfo.initArgs.clone();
      Integer maxMergeCount=(Integer)args.remove("maxMergeCount");
      if (maxMergeCount == null) {
        maxMergeCount=((ConcurrentMergeScheduler)scheduler).getMaxMergeCount();
      }
      Integer maxThreadCount=(Integer)args.remove("maxThreadCount");
      if (maxThreadCount == null) {
        maxThreadCount=((ConcurrentMergeScheduler)scheduler).getMaxThreadCount();
      }
      ((ConcurrentMergeScheduler)scheduler).setMaxMergesAndThreads(maxMergeCount,maxThreadCount);
      SolrPluginUtils.invokeSetters(scheduler,args);
    }
 else {
      SolrPluginUtils.invokeSetters(scheduler,mergeSchedulerInfo.initArgs);
    }
  }
  return scheduler;
}
