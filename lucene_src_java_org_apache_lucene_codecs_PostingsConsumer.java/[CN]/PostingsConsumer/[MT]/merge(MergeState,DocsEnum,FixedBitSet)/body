{
  int df=0;
  long totTF=0;
  if (mergeState.fieldInfo.indexOptions == IndexOptions.DOCS_ONLY) {
    while (true) {
      final int doc=postings.nextDoc();
      if (doc == DocIdSetIterator.NO_MORE_DOCS) {
        break;
      }
      visitedDocs.set(doc);
      this.startDoc(doc,0);
      this.finishDoc();
      df++;
    }
    totTF=-1;
  }
 else   if (mergeState.fieldInfo.indexOptions == IndexOptions.DOCS_AND_FREQS) {
    while (true) {
      final int doc=postings.nextDoc();
      if (doc == DocIdSetIterator.NO_MORE_DOCS) {
        break;
      }
      visitedDocs.set(doc);
      final int freq=postings.freq();
      this.startDoc(doc,freq);
      this.finishDoc();
      df++;
      totTF+=freq;
    }
  }
 else {
    final DocsAndPositionsEnum postingsEnum=(DocsAndPositionsEnum)postings;
    while (true) {
      final int doc=postingsEnum.nextDoc();
      if (doc == DocIdSetIterator.NO_MORE_DOCS) {
        break;
      }
      visitedDocs.set(doc);
      final int freq=postingsEnum.freq();
      this.startDoc(doc,freq);
      totTF+=freq;
      for (int i=0; i < freq; i++) {
        final int position=postingsEnum.nextPosition();
        final BytesRef payload;
        if (postingsEnum.hasPayload()) {
          payload=postingsEnum.getPayload();
        }
 else {
          payload=null;
        }
        this.addPosition(position,payload);
      }
      this.finishDoc();
      df++;
    }
  }
  return new TermStats(df,totTF);
}
