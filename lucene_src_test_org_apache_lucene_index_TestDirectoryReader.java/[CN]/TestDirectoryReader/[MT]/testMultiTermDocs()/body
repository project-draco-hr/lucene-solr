{
  MockRAMDirectory ramDir1=newDirectory(random);
  addDoc(random,ramDir1,"test foo",true);
  MockRAMDirectory ramDir2=newDirectory(random);
  addDoc(random,ramDir2,"test blah",true);
  MockRAMDirectory ramDir3=newDirectory(random);
  addDoc(random,ramDir3,"test wow",true);
  IndexReader[] readers1=new IndexReader[]{IndexReader.open(ramDir1,false),IndexReader.open(ramDir3,false)};
  IndexReader[] readers2=new IndexReader[]{IndexReader.open(ramDir1,false),IndexReader.open(ramDir2,false),IndexReader.open(ramDir3,false)};
  MultiReader mr2=new MultiReader(readers1);
  MultiReader mr3=new MultiReader(readers2);
  TermsEnum te2=MultiFields.getTerms(mr2,"body").iterator();
  te2.seek(new BytesRef("wow"));
  DocsEnum td=MultiFields.getTermDocsEnum(mr2,MultiFields.getDeletedDocs(mr2),"body",te2.term());
  TermsEnum te3=MultiFields.getTerms(mr3,"body").iterator();
  te3.seek(new BytesRef("wow"));
  td=te3.docs(MultiFields.getDeletedDocs(mr3),td);
  int ret=0;
  while (td.nextDoc() != td.NO_MORE_DOCS)   ret+=td.docID();
  assertTrue(ret > 0);
  readers1[0].close();
  readers1[1].close();
  readers2[0].close();
  readers2[1].close();
  readers2[2].close();
  ramDir1.close();
  ramDir2.close();
  ramDir3.close();
}
