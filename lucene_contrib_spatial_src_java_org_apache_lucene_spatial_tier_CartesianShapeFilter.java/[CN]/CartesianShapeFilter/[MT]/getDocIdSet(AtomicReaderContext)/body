{
  final Bits liveDocs=context.reader.getLiveDocs();
  final List<Double> area=shape.getArea();
  final int sz=area.size();
  final BytesRef bytesRef=new BytesRef(NumericUtils.BUF_SIZE_LONG);
  if (sz == 1) {
    double boxId=area.get(0).doubleValue();
    NumericUtils.longToPrefixCoded(NumericUtils.doubleToSortableLong(boxId),0,bytesRef);
    return new DocIdSet(){
      @Override public DocIdSetIterator iterator() throws IOException {
        return context.reader.termDocsEnum(liveDocs,fieldName,bytesRef);
      }
      @Override public boolean isCacheable(){
        return false;
      }
    }
;
  }
 else {
    final FixedBitSet bits=new FixedBitSet(context.reader.maxDoc());
    for (int i=0; i < sz; i++) {
      double boxId=area.get(i).doubleValue();
      NumericUtils.longToPrefixCoded(NumericUtils.doubleToSortableLong(boxId),0,bytesRef);
      final DocsEnum docsEnum=context.reader.termDocsEnum(liveDocs,fieldName,bytesRef);
      if (docsEnum == null)       continue;
      int doc;
      while ((doc=docsEnum.nextDoc()) != DocIdSetIterator.NO_MORE_DOCS) {
        bits.set(doc);
      }
    }
    return bits;
  }
}
