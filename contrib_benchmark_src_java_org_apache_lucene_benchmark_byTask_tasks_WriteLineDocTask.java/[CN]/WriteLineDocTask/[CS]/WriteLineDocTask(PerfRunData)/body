{
  super(runData);
  Config config=runData.getConfig();
  String fileName=config.get("line.file.out",null);
  if (fileName == null) {
    throw new IllegalArgumentException("line.file.out must be set");
  }
  OutputStream out=new FileOutputStream(fileName);
  boolean doBzipCompression=false;
  String doBZCompress=config.get("bzip.compression",null);
  if (doBZCompress != null) {
    doBzipCompression=Boolean.valueOf(doBZCompress).booleanValue();
  }
 else {
    doBzipCompression=fileName.endsWith("bz2");
  }
  if (doBzipCompression) {
    out=new BufferedOutputStream(out,1 << 16);
    out=new CompressorStreamFactory().createCompressorOutputStream("bzip2",out);
  }
  lineFileOut=new BufferedWriter(new OutputStreamWriter(out,"UTF-8"),1 << 16);
  docMaker=runData.getDocMaker();
  logStep=config.get("doc.writeline.log.step",DEFAULT_WRITELINE_DOC_LOG_STEP);
  if (logStep <= 0) {
    logStep=Integer.MAX_VALUE;
  }
}
