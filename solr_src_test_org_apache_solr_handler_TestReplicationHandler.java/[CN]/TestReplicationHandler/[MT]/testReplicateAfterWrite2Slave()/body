{
  int nDocs=50;
  for (int i=0; i < nDocs; i++) {
    index(masterClient,"id",i,"name","name = " + i);
  }
  String masterUrl="http://localhost:" + masterJetty.getLocalPort() + "/solr/replication?command=disableReplication";
  URL url=new URL(masterUrl);
  InputStream stream=url.openStream();
  try {
    stream.close();
  }
 catch (  IOException e) {
  }
  masterClient.commit();
  NamedList masterQueryRsp=rQuery(50,"*:*",masterClient);
  SolrDocumentList masterQueryResult=(SolrDocumentList)masterQueryRsp.get("response");
  assertEquals(nDocs,masterQueryResult.getNumFound());
  index(slaveClient,"id",551,"name","name = " + 551);
  slaveClient.commit(true,true);
  index(slaveClient,"id",552,"name","name = " + 552);
  slaveClient.commit(true,true);
  index(slaveClient,"id",553,"name","name = " + 553);
  slaveClient.commit(true,true);
  index(slaveClient,"id",554,"name","name = " + 554);
  slaveClient.commit(true,true);
  index(slaveClient,"id",555,"name","name = " + 555);
  slaveClient.commit(true,true);
  NamedList slaveQueryRsp=rQuery(1,"id:555",slaveClient);
  SolrDocumentList slaveQueryResult=(SolrDocumentList)slaveQueryRsp.get("response");
  assertEquals(1,slaveQueryResult.getNumFound());
  masterUrl="http://localhost:" + masterJetty.getLocalPort() + "/solr/replication?command=enableReplication";
  url=new URL(masterUrl);
  stream=url.openStream();
  try {
    stream.close();
  }
 catch (  IOException e) {
  }
  slaveQueryRsp=rQuery(0,"id:555",slaveClient);
  slaveQueryResult=(SolrDocumentList)slaveQueryRsp.get("response");
  assertEquals(0,slaveQueryResult.getNumFound());
}
