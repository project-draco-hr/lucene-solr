{
  slaveJetty.stop();
  nDocs--;
  masterClient.deleteByQuery("*:*");
  for (int i=0; i < nDocs; i++)   index(masterClient,"id",i,"name","name = " + i);
  masterClient.commit();
  NamedList masterQueryRsp=rQuery(nDocs,"*:*",masterClient);
  SolrDocumentList masterQueryResult=(SolrDocumentList)masterQueryRsp.get("response");
  assertEquals(nDocs,masterQueryResult.getNumFound());
  copyFile(getFile(CONF_DIR + "solrconfig-master2.xml"),new File(master.getConfDir(),"solrconfig.xml"));
  masterJetty.stop();
  masterJetty=createJetty(master);
  masterClient=createNewSolrServer(masterJetty.getLocalPort());
  copyFile(getFile(SLAVE_CONFIG),new File(slave.getConfDir(),"solrconfig.xml"),masterJetty.getLocalPort());
  slaveJetty=createJetty(slave);
  slaveClient=createNewSolrServer(slaveJetty.getLocalPort());
  NamedList slaveQueryRsp=rQuery(nDocs,"*:*",slaveClient);
  SolrDocumentList slaveQueryResult=(SolrDocumentList)slaveQueryRsp.get("response");
  assertEquals(nDocs,slaveQueryResult.getNumFound());
  String cmp=TestDistributedSearch.compare(masterQueryResult,slaveQueryResult,0,null);
  assertEquals(null,cmp);
  copyFile(getFile(CONF_DIR + "solrconfig-master.xml"),new File(master.getConfDir(),"solrconfig.xml"));
  masterJetty.stop();
  masterJetty=createJetty(master);
  masterClient=createNewSolrServer(masterJetty.getLocalPort());
  copyFile(getFile(SLAVE_CONFIG),new File(slave.getConfDir(),"solrconfig.xml"),masterJetty.getLocalPort());
  slaveJetty.stop();
  slaveJetty=createJetty(slave);
  slaveClient=createNewSolrServer(slaveJetty.getLocalPort());
}
