{
  StreamExpression expression=new StreamExpression(factory.getFunctionName(this.getClass()));
  expression.addParameter(tupleStream.toExpression(factory));
  StringBuilder overBuilder=new StringBuilder();
  for (  Bucket bucket : buckets) {
    if (overBuilder.length() > 0) {
      overBuilder.append(",");
    }
    overBuilder.append(bucket.toString());
  }
  expression.addParameter(new StreamExpressionNamedParameter("over",overBuilder.toString()));
  for (  Metric metric : metrics) {
    expression.addParameter(metric.toExpression(factory));
  }
  return expression;
}
