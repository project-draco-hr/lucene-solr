{
  if (queryAnalyzer == null)   return null;
  if (!(queryAnalyzer instanceof TokenizerChain)) {
    return new KeywordAnalyzer();
  }
  TokenizerChain tc=(TokenizerChain)queryAnalyzer;
  MultiTermChainBuilder builder=new MultiTermChainBuilder();
  CharFilterFactory[] charFactories=tc.getCharFilterFactories();
  for (  CharFilterFactory fact : charFactories) {
    builder.add(fact);
  }
  builder.add(tc.getTokenizerFactory());
  for (  TokenFilterFactory fact : tc.getTokenFilterFactories()) {
    builder.add(fact);
  }
  return builder.build();
}
