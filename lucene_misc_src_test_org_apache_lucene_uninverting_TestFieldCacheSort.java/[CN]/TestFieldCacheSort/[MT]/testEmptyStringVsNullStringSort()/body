{
  Directory dir=newDirectory();
  IndexWriter w=new IndexWriter(dir,newIndexWriterConfig(TEST_VERSION_CURRENT,new MockAnalyzer(random())));
  Document doc=new Document();
  doc.add(newStringField("f","",Field.Store.NO));
  doc.add(newStringField("t","1",Field.Store.NO));
  w.addDocument(doc);
  w.commit();
  doc=new Document();
  doc.add(newStringField("t","1",Field.Store.NO));
  w.addDocument(doc);
  IndexReader r=UninvertingReader.wrap(DirectoryReader.open(w,true),Collections.singletonMap("f",Type.SORTED));
  w.shutdown();
  IndexSearcher s=newSearcher(r);
  TopDocs hits=s.search(new TermQuery(new Term("t","1")),null,10,new Sort(new SortField("f",SortField.Type.STRING)));
  assertEquals(2,hits.totalHits);
  assertEquals(1,hits.scoreDocs[0].doc);
  assertEquals(0,hits.scoreDocs[1].doc);
  TestUtil.checkReader(r);
  r.close();
  dir.close();
}
