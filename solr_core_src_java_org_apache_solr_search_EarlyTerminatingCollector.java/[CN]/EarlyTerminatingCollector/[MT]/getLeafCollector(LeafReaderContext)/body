{
  prevReaderCumulativeSize+=currentReaderSize;
  currentReaderSize=context.reader().maxDoc() - 1;
  return new FilterLeafCollector(super.getLeafCollector(context)){
    /** 
 * This collector requires that docs be collected in order, otherwise
 * the computed number of scanned docs in the resulting{@link EarlyTerminatingCollectorException} will be meaningless.
 */
    @Override public boolean acceptsDocsOutOfOrder(){
      return false;
    }
    @Override public void collect(    int doc) throws IOException {
      super.collect(doc);
      numCollected++;
      if (maxDocsToCollect <= numCollected) {
        throw new EarlyTerminatingCollectorException(numCollected,prevReaderCumulativeSize + (doc + 1));
      }
    }
  }
;
}
