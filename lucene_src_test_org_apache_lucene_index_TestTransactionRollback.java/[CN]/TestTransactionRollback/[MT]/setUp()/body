{
  super.setUp();
  dir=newDirectory();
  IndexDeletionPolicy sdp=new KeepAllDeletionPolicy();
  IndexWriter w=new IndexWriter(dir,newIndexWriterConfig(TEST_VERSION_CURRENT,new MockAnalyzer()).setIndexDeletionPolicy(sdp));
  for (int currentRecordId=1; currentRecordId <= 100; currentRecordId++) {
    Document doc=new Document();
    doc.add(newField(FIELD_RECORD_ID,"" + currentRecordId,Field.Store.YES,Field.Index.ANALYZED));
    w.addDocument(doc);
    if (currentRecordId % 10 == 0) {
      Map<String,String> data=new HashMap<String,String>();
      data.put("index","records 1-" + currentRecordId);
      w.commit(data);
    }
  }
  w.close();
}
