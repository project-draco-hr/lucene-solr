{
  if (result == null || result.getDocIdSet() == null) {
    return SpanFilterResult.EMPTY_SPAN_FILTER_RESULT;
  }
 else   if (result.getDocIdSet().isCacheable()) {
    return result;
  }
 else {
    final DocIdSetIterator it=result.getDocIdSet().iterator();
    if (it == null) {
      return SpanFilterResult.EMPTY_SPAN_FILTER_RESULT;
    }
 else {
      final FixedBitSet bits=new FixedBitSet(reader.maxDoc());
      bits.or(it);
      return new SpanFilterResult(bits,result.getPositions());
    }
  }
}
