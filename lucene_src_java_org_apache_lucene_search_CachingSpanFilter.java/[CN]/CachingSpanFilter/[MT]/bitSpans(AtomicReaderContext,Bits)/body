{
  final SpanFilterResult result=getCachedResult(context);
  if (acceptDocs == null) {
    return result;
  }
 else {
    List<SpanFilterResult.PositionInfo> allPositions=result.getPositions();
    List<SpanFilterResult.PositionInfo> positions=new ArrayList<SpanFilterResult.PositionInfo>(allPositions.size() / 2 + 1);
    for (    SpanFilterResult.PositionInfo p : allPositions) {
      if (acceptDocs.get(p.getDoc())) {
        positions.add(p);
      }
    }
    return new SpanFilterResult(BitsFilteredDocIdSet.wrap(result.getDocIdSet(),acceptDocs),positions);
  }
}
