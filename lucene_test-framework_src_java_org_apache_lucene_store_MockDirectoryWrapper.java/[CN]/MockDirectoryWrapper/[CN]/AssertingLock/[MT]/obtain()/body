{
  if (delegateLock.obtain()) {
    final RuntimeException exception=openLocks.putIfAbsent(name,new RuntimeException("lock \"" + name + "\" was not released: "+ delegateLock));
    if (exception != null && delegateLock != NoLockFactory.SINGLETON_LOCK) {
      throw exception;
    }
    obtained=true;
  }
 else {
    obtained=false;
  }
  return obtained;
}
