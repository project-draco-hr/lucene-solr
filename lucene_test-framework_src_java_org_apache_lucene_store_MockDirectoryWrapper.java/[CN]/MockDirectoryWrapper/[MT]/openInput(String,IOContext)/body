{
  maybeYield();
  if (failOnOpenInput) {
    maybeThrowDeterministicException();
  }
  if (!delegate.fileExists(name)) {
    throw new FileNotFoundException(name + " in dir=" + delegate);
  }
  if (openFilesForWrite.contains(name) && !name.startsWith("segments")) {
    throw fillOpenTrace(new IOException("MockDirectoryWrapper: file \"" + name + "\" is still open for writing"),name,false);
  }
  IndexInput ii=new MockIndexInputWrapper(this,name,delegate.openInput(name,LuceneTestCase.newIOContext(randomState,context)));
  addFileHandle(ii,name,Handle.Input);
  return ii;
}
