{
  super(delegate);
  this.randomState=new Random(random.nextInt());
  this.throttledOutput=new ThrottledIndexOutput(ThrottledIndexOutput.mBitsToBytes(40 + randomState.nextInt(10)),5 + randomState.nextInt(5),null);
  this.lockFactory=new MockLockFactoryWrapper(this,delegate.getLockFactory());
  if (randomState.nextInt(50) == 17) {
    double maxMBPerSec=10 + 5 * (randomState.nextDouble() - 0.5);
    if (LuceneTestCase.VERBOSE) {
      System.out.println("MockDirectoryWrapper: will rate limit output IO to " + maxMBPerSec + " MB/sec");
    }
    rateLimiter=new RateLimiter(maxMBPerSec);
  }
 else {
    rateLimiter=null;
  }
  init();
}
