{
  for (  NormsProducer normsProducer : mergeState.normsProducers) {
    if (normsProducer != null) {
      normsProducer.checkIntegrity();
    }
  }
  for (  FieldInfo mergeFieldInfo : mergeState.mergeFieldInfos) {
    if (mergeFieldInfo.hasNorms()) {
      List<NumericDocValues> toMerge=new ArrayList<>();
      for (int i=0; i < mergeState.normsProducers.length; i++) {
        NormsProducer normsProducer=mergeState.normsProducers[i];
        NumericDocValues norms=null;
        if (normsProducer != null) {
          FieldInfo fieldInfo=mergeState.fieldInfos[i].fieldInfo(mergeFieldInfo.name);
          if (fieldInfo != null && fieldInfo.hasNorms()) {
            norms=normsProducer.getNorms(fieldInfo);
          }
        }
        if (norms == null) {
          norms=DocValues.emptyNumeric();
        }
        toMerge.add(norms);
      }
      mergeNormsField(mergeFieldInfo,mergeState,toMerge);
    }
  }
}
