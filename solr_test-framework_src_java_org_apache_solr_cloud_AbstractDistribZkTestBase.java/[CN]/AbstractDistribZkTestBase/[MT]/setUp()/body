{
  super.setUp();
  createTempDir();
  String zkDir=testDir.getAbsolutePath() + File.separator + "zookeeper/server1/data";
  zkServer=new ZkTestServer(zkDir);
  zkServer.run();
  System.setProperty(ZK_HOST,zkServer.getZkAddress());
  System.setProperty(ENABLE_UPDATE_LOG,"true");
  System.setProperty(REMOVE_VERSION_FIELD,"true");
  System.setProperty(ZOOKEEPER_FORCE_SYNC,"false");
  System.setProperty(MockDirectoryFactory.SOLR_TESTS_ALLOW_READING_FILES_STILL_OPEN_FOR_WRITE,"true");
  String schema=getSchemaFile();
  if (schema == null)   schema="schema.xml";
  AbstractZkTestCase.buildZooKeeper(zkServer.getZkHost(),zkServer.getZkAddress(),getCloudSolrConfig(),schema);
  System.setProperty("solr.test.sys.prop1","propone");
  System.setProperty("solr.test.sys.prop2","proptwo");
}
