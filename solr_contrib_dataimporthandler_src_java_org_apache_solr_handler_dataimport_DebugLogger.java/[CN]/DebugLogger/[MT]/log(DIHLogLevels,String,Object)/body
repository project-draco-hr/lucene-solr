{
  if (event == DIHLogLevels.DISABLE_LOGGING) {
    enabled=false;
    return;
  }
 else   if (event == DIHLogLevels.ENABLE_LOGGING) {
    enabled=true;
    return;
  }
  if (!enabled && event != DIHLogLevels.START_ENTITY && event != DIHLogLevels.END_ENTITY) {
    return;
  }
  if (event == DIHLogLevels.START_DOC) {
    debugStack.push(new DebugInfo(null,DIHLogLevels.START_DOC,peekStack()));
  }
 else   if (DIHLogLevels.START_ENTITY == event) {
    debugStack.push(new DebugInfo(name,DIHLogLevels.START_ENTITY,peekStack()));
  }
 else   if (DIHLogLevels.ENTITY_OUT == event || DIHLogLevels.PRE_TRANSFORMER_ROW == event) {
    if (debugStack.peek().type == DIHLogLevels.START_ENTITY || debugStack.peek().type == DIHLogLevels.START_DOC) {
      debugStack.peek().lst.add(null,fmt.format(new Object[]{++debugStack.peek().rowCount}));
      addToNamedList(debugStack.peek().lst,row);
      debugStack.peek().lst.add(null,LINE);
    }
  }
 else   if (event == DIHLogLevels.ROW_END) {
    popAllTransformers();
  }
 else   if (DIHLogLevels.END_ENTITY == event) {
    while (debugStack.pop().type != DIHLogLevels.START_ENTITY)     ;
  }
 else   if (DIHLogLevels.END_DOC == event) {
    while (debugStack.pop().type != DIHLogLevels.START_DOC)     ;
  }
 else   if (event == DIHLogLevels.TRANSFORMER_EXCEPTION) {
    debugStack.push(new DebugInfo(name,event,peekStack()));
    debugStack.peek().lst.add("EXCEPTION",getStacktraceString((Exception)row));
  }
 else   if (DIHLogLevels.TRANSFORMED_ROW == event) {
    debugStack.push(new DebugInfo(name,event,peekStack()));
    debugStack.peek().lst.add(null,LINE);
    addToNamedList(debugStack.peek().lst,row);
    debugStack.peek().lst.add(null,LINE);
    if (row instanceof DataImportHandlerException) {
      DataImportHandlerException dataImportHandlerException=(DataImportHandlerException)row;
      dataImportHandlerException.debugged=true;
    }
  }
 else   if (DIHLogLevels.ENTITY_META == event) {
    popAllTransformers();
    debugStack.peek().lst.add(name,row);
  }
 else   if (DIHLogLevels.ENTITY_EXCEPTION == event) {
    if (row instanceof DataImportHandlerException) {
      DataImportHandlerException dihe=(DataImportHandlerException)row;
      if (dihe.debugged)       return;
      dihe.debugged=true;
    }
    popAllTransformers();
    debugStack.peek().lst.add("EXCEPTION",getStacktraceString((Exception)row));
  }
}
