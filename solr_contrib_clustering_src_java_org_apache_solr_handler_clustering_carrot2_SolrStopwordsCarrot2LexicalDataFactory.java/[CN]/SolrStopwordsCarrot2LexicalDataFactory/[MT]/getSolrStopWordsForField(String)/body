{
  if (!solrStopWords.containsKey(fieldName)) {
    final Analyzer fieldAnalyzer=schema.getFieldType(fieldName).getAnalyzer();
    if (fieldAnalyzer instanceof TokenizerChain) {
      final TokenFilterFactory[] filterFactories=((TokenizerChain)fieldAnalyzer).getTokenFilterFactories();
      for (      TokenFilterFactory factory : filterFactories) {
        if (factory instanceof StopFilterFactory) {
          solrStopWords.put(fieldName,((StopFilterFactory)factory).getStopWords());
        }
        if (factory instanceof CommonGramsFilterFactory) {
          solrStopWords.put(fieldName,((CommonGramsFilterFactory)factory).getCommonWords());
        }
      }
    }
  }
  return solrStopWords.get(fieldName);
}
