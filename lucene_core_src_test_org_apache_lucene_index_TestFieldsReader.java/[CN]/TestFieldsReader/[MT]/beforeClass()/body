{
  testDoc=new Document();
  fieldInfos=new FieldInfos.Builder();
  DocHelper.setupDoc(testDoc);
  for (  IndexableField field : testDoc.getFields()) {
    fieldInfos.addOrUpdate(field.name(),field.fieldType());
  }
  dir=newDirectory();
  IndexWriterConfig conf=newIndexWriterConfig(TEST_VERSION_CURRENT,new MockAnalyzer(random())).setMergePolicy(newLogMergePolicy());
  conf.getMergePolicy().setNoCFSRatio(0.0);
  IndexWriter writer=new IndexWriter(dir,conf);
  writer.addDocument(testDoc);
  writer.close();
  FaultyIndexInput.doFail=false;
}
