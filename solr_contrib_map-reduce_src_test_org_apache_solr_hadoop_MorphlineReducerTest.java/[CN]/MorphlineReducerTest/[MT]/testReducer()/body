{
  MySolrReducer myReducer=new MySolrReducer();
  ReduceDriver<Text,SolrInputDocumentWritable,Text,SolrInputDocumentWritable> reduceDriver=ReduceDriver.newReduceDriver(myReducer);
  Configuration config=reduceDriver.getConfiguration();
  setupHadoopConfig(config);
  List<SolrInputDocumentWritable> values=new ArrayList<SolrInputDocumentWritable>();
  SolrInputDocument sid=new SolrInputDocument();
  String id="myid1";
  sid.addField("id",id);
  sid.addField("text","some unique text");
  SolrInputDocumentWritable sidw=new SolrInputDocumentWritable(sid);
  values.add(sidw);
  reduceDriver.withInput(new Text(id),values);
  reduceDriver.withCacheArchive(solrHomeZip.getAbsolutePath());
  reduceDriver.withOutputFormat(SolrOutputFormat.class,NullInputFormat.class);
  reduceDriver.run();
  assertEquals("Expected 1 counter increment",1,reduceDriver.getCounters().findCounter(SolrCounters.class.getName(),SolrCounters.DOCUMENTS_WRITTEN.toString()).getValue());
}
