{
  IndexInput in=(IndexInput)SimpleTextFieldsReader.this.in.clone();
  in.seek(termsStart);
  final BytesRef lastTerm=new BytesRef(10);
  long lastDocsStart=-1;
  int docFreq=0;
  while (true) {
    readLine(in,scratch);
    if (scratch.equals(END) || scratch.startsWith(FIELD)) {
      if (lastDocsStart != -1) {
        allTerms.put(new BytesRef(lastTerm),new TermData(lastDocsStart,docFreq));
      }
      break;
    }
 else     if (scratch.startsWith(DOC)) {
      docFreq++;
    }
 else     if (scratch.startsWith(TERM)) {
      if (lastDocsStart != -1) {
        allTerms.put(new BytesRef(lastTerm),new TermData(lastDocsStart,docFreq));
      }
      lastDocsStart=in.getFilePointer();
      final int len=scratch.length - TERM.length;
      if (len > lastTerm.length) {
        lastTerm.grow(len);
      }
      System.arraycopy(scratch.bytes,TERM.length,lastTerm.bytes,0,len);
      lastTerm.length=len;
      docFreq=0;
    }
  }
}
