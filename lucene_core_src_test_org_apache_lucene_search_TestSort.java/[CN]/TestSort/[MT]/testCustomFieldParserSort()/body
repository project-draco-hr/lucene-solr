{
  FieldCache fc=FieldCache.DEFAULT;
  sort.setSort(new SortField("parser",new FieldCache.IntParser(){
    public final int parseInt(    final BytesRef term){
      return (term.bytes[term.offset] - 'A') * 123456;
    }
  }
),SortField.FIELD_DOC);
  assertMatches(full,queryA,sort,"JIHGFEDCBA");
  assertSaneFieldCaches(getTestName() + " IntParser");
  fc.purgeAllCaches();
  sort.setSort(new SortField("parser",new FieldCache.FloatParser(){
    public final float parseFloat(    final BytesRef term){
      return (float)Math.sqrt(term.bytes[term.offset]);
    }
  }
),SortField.FIELD_DOC);
  assertMatches(full,queryA,sort,"JIHGFEDCBA");
  assertSaneFieldCaches(getTestName() + " FloatParser");
  fc.purgeAllCaches();
  sort.setSort(new SortField("parser",new FieldCache.LongParser(){
    public final long parseLong(    final BytesRef term){
      return (term.bytes[term.offset] - 'A') * 1234567890L;
    }
  }
),SortField.FIELD_DOC);
  assertMatches(full,queryA,sort,"JIHGFEDCBA");
  assertSaneFieldCaches(getTestName() + " LongParser");
  fc.purgeAllCaches();
  sort.setSort(new SortField("parser",new FieldCache.DoubleParser(){
    public final double parseDouble(    final BytesRef term){
      return Math.pow(term.bytes[term.offset],(term.bytes[term.offset] - 'A'));
    }
  }
),SortField.FIELD_DOC);
  assertMatches(full,queryA,sort,"JIHGFEDCBA");
  assertSaneFieldCaches(getTestName() + " DoubleParser");
  fc.purgeAllCaches();
  sort.setSort(new SortField("parser",new FieldCache.ByteParser(){
    public final byte parseByte(    final BytesRef term){
      return (byte)(term.bytes[term.offset] - 'A');
    }
  }
),SortField.FIELD_DOC);
  assertMatches(full,queryA,sort,"JIHGFEDCBA");
  assertSaneFieldCaches(getTestName() + " ByteParser");
  fc.purgeAllCaches();
  sort.setSort(new SortField("parser",new FieldCache.ShortParser(){
    public final short parseShort(    final BytesRef term){
      return (short)(term.bytes[term.offset] - 'A');
    }
  }
),SortField.FIELD_DOC);
  assertMatches(full,queryA,sort,"JIHGFEDCBA");
  assertSaneFieldCaches(getTestName() + " ShortParser");
  fc.purgeAllCaches();
}
