{
  FieldCache fc=FieldCache.DEFAULT;
  sort.setSort(new SortField("parser",new FieldCache.IntParser(){
    @Override public final int parseInt(    final BytesRef term){
      return (term.bytes[term.offset] - 'A') * 123456;
    }
    @Override public TermsEnum termsEnum(    Terms terms) throws IOException {
      return terms.iterator(null);
    }
  }
),SortField.FIELD_DOC);
  assertMatches(full,queryA,sort,"JIHGFEDCBA");
  assertSaneFieldCaches(getTestName() + " IntParser");
  fc.purgeAllCaches();
  sort.setSort(new SortField("parser",new FieldCache.FloatParser(){
    @Override public final float parseFloat(    final BytesRef term){
      return (float)Math.sqrt(term.bytes[term.offset]);
    }
    @Override public TermsEnum termsEnum(    Terms terms) throws IOException {
      return terms.iterator(null);
    }
  }
),SortField.FIELD_DOC);
  assertMatches(full,queryA,sort,"JIHGFEDCBA");
  assertSaneFieldCaches(getTestName() + " FloatParser");
  fc.purgeAllCaches();
  sort.setSort(new SortField("parser",new FieldCache.LongParser(){
    @Override public final long parseLong(    final BytesRef term){
      return (term.bytes[term.offset] - 'A') * 1234567890L;
    }
    @Override public TermsEnum termsEnum(    Terms terms) throws IOException {
      return terms.iterator(null);
    }
  }
),SortField.FIELD_DOC);
  assertMatches(full,queryA,sort,"JIHGFEDCBA");
  assertSaneFieldCaches(getTestName() + " LongParser");
  fc.purgeAllCaches();
  sort.setSort(new SortField("parser",new FieldCache.DoubleParser(){
    @Override public final double parseDouble(    final BytesRef term){
      return Math.pow(term.bytes[term.offset],(term.bytes[term.offset] - 'A'));
    }
    @Override public TermsEnum termsEnum(    Terms terms) throws IOException {
      return terms.iterator(null);
    }
  }
),SortField.FIELD_DOC);
  assertMatches(full,queryA,sort,"JIHGFEDCBA");
  assertSaneFieldCaches(getTestName() + " DoubleParser");
  fc.purgeAllCaches();
  sort.setSort(new SortField("parser",new FieldCache.ByteParser(){
    @Override public final byte parseByte(    final BytesRef term){
      return (byte)(term.bytes[term.offset] - 'A');
    }
    @Override public TermsEnum termsEnum(    Terms terms) throws IOException {
      return terms.iterator(null);
    }
  }
),SortField.FIELD_DOC);
  assertMatches(full,queryA,sort,"JIHGFEDCBA");
  assertSaneFieldCaches(getTestName() + " ByteParser");
  fc.purgeAllCaches();
  sort.setSort(new SortField("parser",new FieldCache.ShortParser(){
    @Override public final short parseShort(    final BytesRef term){
      return (short)(term.bytes[term.offset] - 'A');
    }
    @Override public TermsEnum termsEnum(    Terms terms) throws IOException {
      return terms.iterator(null);
    }
  }
),SortField.FIELD_DOC);
  assertMatches(full,queryA,sort,"JIHGFEDCBA");
  assertSaneFieldCaches(getTestName() + " ShortParser");
  fc.purgeAllCaches();
}
