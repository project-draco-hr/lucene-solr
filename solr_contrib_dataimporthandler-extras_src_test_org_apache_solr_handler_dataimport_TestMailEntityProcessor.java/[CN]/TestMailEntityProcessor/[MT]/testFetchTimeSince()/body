{
  Map<String,String> paramMap=new HashMap<>();
  paramMap.put("folders","top1" + sep + "child11");
  paramMap.put("recurse","true");
  paramMap.put("processAttachments","false");
  paramMap.put("fetchMailsSince","2008-12-26 00:00:00");
  DataImporter di=new DataImporter();
  di.loadAndInit(getConfigFromMap(paramMap));
  RequestInfo rp=new RequestInfo(null,createMap("command","full-import"),null);
  SolrWriterImpl swi=new SolrWriterImpl();
  di.runCmd(rp,swi);
  assertEquals("top1" + sep + "child11 and its direct children did not return 6 messages",6,swi.docs.size());
}
