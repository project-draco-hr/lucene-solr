{
  List rows=new ArrayList();
  rows.add(createMap("id","1","desc","one"));
  rows.add(createMap("id","2","desc","two"));
  rows.add(createMap("id","3","desc","break"));
  rows.add(createMap("id","4","desc","four"));
  MockDataSource.setIterator("select * from x",rows.iterator());
  Map extraParams=createMap("writerImpl",TestSolrWriter.class.getName(),"commit","true");
  runFullImport(loadDataConfig("data-config-with-datasource.xml"),extraParams);
  assertQ(req("id:1"),"//*[@numFound='1']");
  assertQ(req("id:2"),"//*[@numFound='1']");
  assertQ(req("id:3"),"//*[@numFound='0']");
  assertQ(req("id:4"),"//*[@numFound='1']");
}
