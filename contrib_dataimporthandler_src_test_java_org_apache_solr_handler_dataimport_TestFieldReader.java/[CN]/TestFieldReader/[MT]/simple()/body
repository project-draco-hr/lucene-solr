{
  DataImporter di=new DataImporter();
  di.loadAndInit(config);
  TestDocBuilder.SolrWriterImpl sw=new TestDocBuilder.SolrWriterImpl();
  DataImporter.RequestParams rp=new DataImporter.RequestParams(createMap("command","full-import"));
  List<Map<String,Object>> l=new ArrayList<Map<String,Object>>();
  l.add(createMap("xml",xml));
  MockDataSource.setIterator("select * from a",l.iterator());
  di.runCmd(rp,sw,new HashMap<String,String>());
  Assert.assertEquals(sw.docs.get(0).getFieldValue("y"),"Hello");
  MockDataSource.clearCache();
}
