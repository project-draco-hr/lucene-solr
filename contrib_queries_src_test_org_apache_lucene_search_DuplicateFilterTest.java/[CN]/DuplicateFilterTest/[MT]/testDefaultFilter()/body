{
  DuplicateFilter df=new DuplicateFilter(KEY_FIELD);
  HashSet results=new HashSet();
  Hits h=searcher.search(tq,df);
  for (int i=0; i < h.length(); i++) {
    Document d=h.doc(i);
    String url=d.get(KEY_FIELD);
    assertFalse("No duplicate urls should be returned",results.contains(url));
    results.add(url);
  }
}
