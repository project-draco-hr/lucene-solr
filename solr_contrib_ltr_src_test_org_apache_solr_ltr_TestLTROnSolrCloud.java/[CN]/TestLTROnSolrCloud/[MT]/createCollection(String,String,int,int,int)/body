{
  CollectionAdminResponse response;
  CollectionAdminRequest.Create create=CollectionAdminRequest.createCollection(name,config,numShards,numReplicas);
  create.setMaxShardsPerNode(maxShardsPerNode);
  response=create.process(solrCluster.getSolrClient());
  if (response.getStatus() != 0 || response.getErrorMessages() != null) {
    fail("Could not create collection. Response" + response.toString());
  }
  ZkStateReader zkStateReader=solrCluster.getSolrClient().getZkStateReader();
  AbstractDistribZkTestBase.waitForRecoveriesToFinish(name,zkStateReader,false,true,100);
}
