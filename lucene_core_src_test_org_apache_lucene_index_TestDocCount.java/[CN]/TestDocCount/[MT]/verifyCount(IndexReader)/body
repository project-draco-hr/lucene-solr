{
  Fields fields=MultiFields.getFields(ir);
  if (fields == null) {
    return;
  }
  for (  String field : fields) {
    Terms terms=fields.terms(field);
    if (terms == null) {
      continue;
    }
    int docCount=terms.getDocCount();
    FixedBitSet visited=new FixedBitSet(ir.maxDoc());
    TermsEnum te=terms.iterator(null);
    while (te.next() != null) {
      DocsEnum de=TestUtil.docs(random(),te,null,null,DocsEnum.FLAG_NONE);
      while (de.nextDoc() != DocIdSetIterator.NO_MORE_DOCS) {
        visited.set(de.docID());
      }
    }
    assertEquals(visited.cardinality(),docCount);
  }
}
