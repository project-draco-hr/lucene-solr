{
  return new VisitorTemplate(context){
    private DocIdSetBuilder results;
    @Override protected void start() throws IOException {
      results=new DocIdSetBuilder(maxDoc,terms);
    }
    @Override protected DocIdSet finish(){
      return results.build();
    }
    @Override protected boolean visitPrefix(    Cell cell) throws IOException {
      if (cell.getShapeRel() == SpatialRelation.WITHIN || cell.getLevel() == detailLevel) {
        collectDocs(results);
        return false;
      }
      return true;
    }
    @Override protected void visitLeaf(    Cell cell) throws IOException {
      collectDocs(results);
    }
  }
.getDocIdSet();
}
