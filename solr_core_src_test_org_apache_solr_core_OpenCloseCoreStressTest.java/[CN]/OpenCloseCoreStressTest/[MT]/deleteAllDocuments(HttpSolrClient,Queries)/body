{
  log.info("Deleting data from last cycle, this may take a few minutes.");
  for (  String core : coreNames) {
    try {
      client.setBaseURL(url + core);
      client.deleteByQuery("*:*");
      client.optimize(true,true);
    }
 catch (    Exception e) {
      e.printStackTrace();
    }
  }
  log.info("Insuring all cores empty");
  long foundDocs=0;
  for (  String core : coreNames) {
    try {
      long found=queries.getCount(client,core);
      assertEquals("Cores should be empty",found,0L);
      foundDocs+=found;
    }
 catch (    Exception e) {
      e.printStackTrace();
    }
  }
  if (foundDocs > 0) {
    log.warn("Found docs after purging done, this is bad.");
  }
  coreCounts.clear();
  for (  String core : coreNames) {
    coreCounts.put(core,0L);
  }
}
