{
  meta.writeVLong(numDocsWithValue);
  meta.writeVInt(DIRECT_MONOTONIC_BLOCK_SHIFT);
  final DirectMonotonicWriter docIdsWriter=DirectMonotonicWriter.getInstance(meta,data,numDocsWithValue,DIRECT_MONOTONIC_BLOCK_SHIFT);
  long docID=0;
  for (  Number nv : values) {
switch (numberType) {
case VALUE:
      if (nv != null) {
        docIdsWriter.add(docID);
      }
    break;
case ORDINAL:
  if (nv.longValue() != -1L) {
    docIdsWriter.add(docID);
  }
break;
default :
throw new AssertionError();
}
docID++;
}
docIdsWriter.finish();
return docID;
}
