{
  String debug=req.getParams().get(CommonParams.DEBUG_QUERY);
  NamedList dbg=null;
  if (debug != null) {
    dbg=new SimpleOrderedMap();
    SolrIndexSearcher searcher=req.getSearcher();
    IndexSchema schema=req.getSchema();
    boolean legacyExplainStyle=req.getParams().getBool(CommonParams.EXPLAIN_AS_STRING,false);
    dbg.add("rawquerystring",req.getParams().get(CommonParams.Q));
    dbg.add("querystring",userQuery);
    dbg.add("parsedquery",QueryParsing.toString(query,schema));
    dbg.add("parsedquery_toString",query.toString());
    dbg.add("explain",legacyExplainStyle ? getExplainList(query,results,searcher,schema) : explanationsToNamedLists(getExplanations(query,results,searcher,schema)));
    String otherQueryS=req.getParams().get(CommonParams.EXPLAIN_OTHER);
    if (otherQueryS != null && otherQueryS.length() > 0) {
      DocList otherResults=doSimpleQuery(otherQueryS,req.getSearcher(),req.getSchema(),0,10);
      dbg.add("otherQuery",otherQueryS);
      dbg.add("explainOther",legacyExplainStyle ? getExplainList(query,otherResults,searcher,schema) : explanationsToNamedLists(getExplanations(query,otherResults,searcher,schema)));
    }
  }
  return dbg;
}
