{
  for (int i=0; i < 5; i++) {
    try {
      ServerSocket server=new ServerSocket(0);
      port=server.getLocalPort();
      server.close();
      System.out.println("Using port: " + port);
      try {
        LocateRegistry.createRegistry(port);
      }
 catch (      RemoteException e) {
      }
      String url="service:jmx:rmi:///jndi/rmi://:" + port + "/solrjmx";
      JmxConfiguration config=new JmxConfiguration(true,null,url);
      monitoredMap=new JmxMonitoredMap<String,SolrInfoMBean>(null,config);
      JMXServiceURL u=new JMXServiceURL(url);
      connector=JMXConnectorFactory.connect(u);
      mbeanServer=connector.getMBeanServerConnection();
      break;
    }
 catch (    Exception e) {
    }
  }
}
