{
  return new AnalyzerWrapper(Analyzer.PER_FIELD_REUSE_STRATEGY){
    @Override protected Analyzer getWrappedAnalyzer(    String fieldName){
      return indexAnalyzer;
    }
    @Override protected TokenStreamComponents wrapComponents(    String fieldName,    TokenStreamComponents components){
      if (fieldName.equals("textgrams") && minPrefixChars > 0) {
        TokenFilter filter;
        if (matchVersion.onOrAfter(Version.LUCENE_4_4_0)) {
          filter=new EdgeNGramTokenFilter(components.getTokenStream(),1,minPrefixChars);
        }
 else {
          filter=new Lucene43EdgeNGramTokenFilter(components.getTokenStream(),1,minPrefixChars);
        }
        return new TokenStreamComponents(components.getTokenizer(),filter);
      }
 else {
        return components;
      }
    }
  }
;
}
