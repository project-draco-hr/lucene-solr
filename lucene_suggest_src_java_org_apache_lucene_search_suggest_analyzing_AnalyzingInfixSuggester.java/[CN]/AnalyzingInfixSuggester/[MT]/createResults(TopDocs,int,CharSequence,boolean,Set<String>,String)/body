{
  List<LookupResult> results=new ArrayList<LookupResult>();
  BytesRef scratch=new BytesRef();
  for (int i=0; i < hits.scoreDocs.length; i++) {
    ScoreDoc sd=hits.scoreDocs[i];
    textDV.get(sd.doc,scratch);
    String text=scratch.utf8ToString();
    long score=weightsDV.get(sd.doc);
    BytesRef payload;
    if (payloadsDV != null) {
      payload=new BytesRef();
      payloadsDV.get(sd.doc,payload);
    }
 else {
      payload=null;
    }
    LookupResult result;
    if (doHighlight) {
      Object highlightKey=highlight(text,matchedTokens,prefixToken);
      result=new LookupResult(highlightKey.toString(),highlightKey,score,payload);
    }
 else {
      result=new LookupResult(text,score,payload);
    }
    results.add(result);
  }
  return results;
}
