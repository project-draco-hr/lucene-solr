{
  if (numBufferedDocs == this.numStoredFields.length) {
    final int newLength=ArrayUtil.oversize(numBufferedDocs + 1,4);
    this.numStoredFields=Arrays.copyOf(this.numStoredFields,newLength);
    endOffsets=Arrays.copyOf(endOffsets,newLength);
  }
  this.numStoredFields[numBufferedDocs]=numStoredFieldsInDoc;
  numStoredFieldsInDoc=0;
  endOffsets[numBufferedDocs]=bufferedDocs.length;
  ++numBufferedDocs;
  if (triggerFlush()) {
    flush();
  }
}
