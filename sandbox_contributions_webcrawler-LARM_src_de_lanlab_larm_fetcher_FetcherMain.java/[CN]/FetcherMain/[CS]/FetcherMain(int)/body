{
  messageHandler=new MessageHandler();
  SimpleLogger storeLog=new SimpleLogger("store",false);
  SimpleLogger linksLog=new SimpleLogger("links",false);
  StoragePipeline storage=new StoragePipeline();
  storage.addLinkStorage(new LinkLogStorage(linksLog));
  storage.addLinkStorage(messageHandler);
  LuceneStorage luceneStorage=new LuceneStorage();
  luceneStorage.setAnalyzer(new org.apache.lucene.analysis.de.GermanAnalyzer());
  luceneStorage.setCreate(true);
  luceneStorage.setIndexName("luceneIndex");
  luceneStorage.setFieldInfo("url",LuceneStorage.INDEX | LuceneStorage.STORE);
  luceneStorage.setFieldInfo("content",LuceneStorage.INDEX | LuceneStorage.STORE | LuceneStorage.TOKEN);
  storage.addDocStorage(luceneStorage);
  storage.open();
  hostManager=new HostManager(1000);
  reFilter=new RobotExclusionFilter(hostManager);
  urlScopeFilter=new URLScopeFilter();
  urlVisitedFilter=new URLVisitedFilter(100000);
  knownPathsFilter=new KnownPathsFilter();
  urlLengthFilter=new URLLengthFilter(255);
  fetcher=new Fetcher(nrThreads,storage,storage,hostManager);
  HTTPConnection.setDefaultAllowUserInteraction(false);
  HTTPConnection.removeDefaultModule(HTTPClient.ContentEncodingModule.class);
  fetcher.init();
  monitor=new ThreadMonitor(urlLengthFilter,urlVisitedFilter,urlScopeFilter,reFilter,messageHandler,fetcher.getThreadPool(),hostManager,5000);
  messageHandler.addListener(urlLengthFilter);
  messageHandler.addListener(urlScopeFilter);
  messageHandler.addListener(reFilter);
  messageHandler.addListener(urlVisitedFilter);
  messageHandler.addListener(knownPathsFilter);
  messageHandler.addListener(fetcher);
}
