{
  messageHandler=new MessageHandler();
  SimpleLogger storeLog=new SimpleLogger("store",false);
  SimpleLogger linksLog=new SimpleLogger("links",false);
  StoragePipeline storage=new StoragePipeline();
  storage.addDocStorage(new LogStorage(storeLog,false,"logs/pagefile"));
  storage.addLinkStorage(new LinkLogStorage(linksLog));
  storage.addLinkStorage(messageHandler);
  urlScopeFilter=new URLScopeFilter();
  urlVisitedFilter=new URLVisitedFilter(100000);
  hostManager=new HostManager(1000);
  reFilter=new RobotExclusionFilter(hostManager);
  fetcher=new Fetcher(nrThreads,storage,storage,hostManager);
  knownPathsFilter=new KnownPathsFilter();
  urlLengthFilter=new URLLengthFilter(255);
  HTTPConnection.setDefaultAllowUserInteraction(false);
  HTTPConnection.removeDefaultModule(HTTPClient.ContentEncodingModule.class);
  fetcher.init();
  monitor=new ThreadMonitor(urlLengthFilter,urlVisitedFilter,urlScopeFilter,reFilter,messageHandler,fetcher.getThreadPool(),hostManager,5000);
  messageHandler.addListener(urlLengthFilter);
  messageHandler.addListener(urlScopeFilter);
  messageHandler.addListener(reFilter);
  messageHandler.addListener(urlVisitedFilter);
  messageHandler.addListener(knownPathsFilter);
  messageHandler.addListener(fetcher);
}
