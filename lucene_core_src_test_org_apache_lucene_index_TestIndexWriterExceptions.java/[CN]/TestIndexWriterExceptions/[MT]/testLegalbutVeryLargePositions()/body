{
  Directory dir=newDirectory();
  IndexWriter iw=new IndexWriter(dir,newIndexWriterConfig(null));
  Document doc=new Document();
  Token t1=new Token("foo",0,3);
  t1.setPositionIncrement(Integer.MAX_VALUE - 500);
  if (random().nextBoolean()) {
    t1.setPayload(new BytesRef(new byte[]{0x1}));
  }
  TokenStream overflowingTokenStream=new CannedTokenStream(new Token[]{t1});
  Field field=new TextField("foo",overflowingTokenStream);
  doc.add(field);
  iw.addDocument(doc);
  iw.close();
  dir.close();
}
