{
  boolean optimized=reader.isOptimized();
  PerDocValues perDoc=optimized ? reader.getSequentialSubReaders()[0].perDocValues() : MultiPerDocValues.getPerDocs(reader);
switch (random.nextInt(optimized ? 3 : 2)) {
case 0:
    return perDoc.docValues(field);
case 1:
  IndexDocValues docValues=perDoc.docValues(field);
if (docValues != null) {
  return docValues;
}
throw new RuntimeException("no such field " + field);
case 2:
return reader.getSequentialSubReaders()[0].docValues(field);
}
throw new RuntimeException();
}
