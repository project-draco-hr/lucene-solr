{
  final Collection<SearchGroup<BytesRef>> topGroups;
  if (topNGroups > 0) {
    if (field.getType().getNumericType() != null) {
      topGroups=GroupConverter.fromMutable(field,firstPassGroupingCollector.getTopGroups(0,true));
    }
 else {
      topGroups=firstPassGroupingCollector.getTopGroups(0,true);
    }
  }
 else {
    topGroups=Collections.emptyList();
  }
  final Integer groupCount;
  if (includeGroupCount) {
    groupCount=allGroupsCollector.getGroupCount();
  }
 else {
    groupCount=null;
  }
  return new SearchGroupsFieldCommandResult(groupCount,topGroups);
}
