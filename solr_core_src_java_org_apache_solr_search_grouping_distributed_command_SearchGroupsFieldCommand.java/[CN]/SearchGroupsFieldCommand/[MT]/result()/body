{
  final Collection<SearchGroup<BytesRef>> topGroups;
  if (topNGroups > 0) {
    topGroups=firstPassGroupingCollector.getTopGroups(0,true);
  }
 else {
    topGroups=Collections.emptyList();
  }
  final Integer groupCount;
  if (includeGroupCount) {
    groupCount=allGroupsCollector.getGroupCount();
  }
 else {
    groupCount=null;
  }
  return new Pair<Integer,Collection<SearchGroup<BytesRef>>>(groupCount,topGroups);
}
