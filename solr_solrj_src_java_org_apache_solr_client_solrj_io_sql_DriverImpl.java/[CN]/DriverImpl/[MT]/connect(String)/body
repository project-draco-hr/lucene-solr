{
  if (!acceptsURL(url)) {
    return null;
  }
  String[] parts=url.split("://",0);
  if (parts.length < 2) {
    throw new SQLException("The zkHost must start with ://");
  }
  String zkUrl=parts[1];
  String[] zkUrlParts=zkUrl.split("\\?");
  if (zkUrlParts.length < 2) {
    throw new SQLException("The connection url has no connection properties. At a mininum the collection must be specified.");
  }
  String connectionProps=zkUrlParts[1];
  String zkHost=zkUrlParts[0];
  Properties props=new Properties();
  loadParams(connectionProps,props);
  String collection=(String)props.remove("collection");
  if (!props.containsKey("aggregationMode")) {
    props.setProperty("aggregationMode","facet");
  }
  return new ConnectionImpl(zkHost,collection,props);
}
