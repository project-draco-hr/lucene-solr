{
  if (field instanceof DocValuesField)   return field;
  final DocValuesField valField=new DocValuesField();
switch (type) {
case BYTES_FIXED_DEREF:
case BYTES_FIXED_SORTED:
case BYTES_FIXED_STRAIGHT:
case BYTES_VAR_DEREF:
case BYTES_VAR_SORTED:
case BYTES_VAR_STRAIGHT:
    BytesRef ref=field.isBinary() ? new BytesRef(field.getBinaryValue(),field.getBinaryOffset(),field.getBinaryLength()) : new BytesRef(field.stringValue());
  valField.setBytes(ref,type);
break;
case INTS:
valField.setInt(Long.parseLong(field.stringValue()));
break;
case FLOAT_32:
valField.setFloat(Float.parseFloat(field.stringValue()));
break;
case FLOAT_64:
valField.setFloat(Double.parseDouble(field.stringValue()));
break;
default :
throw new IllegalArgumentException("unknown type: " + type);
}
return valField.set(field);
}
