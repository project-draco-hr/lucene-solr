{
  IndexReader reader=null;
  FSDirectory dir=null;
  String field=null;
  if (args.length == 1) {
    dir=FSDirectory.open(new File(args[0]));
    reader=IndexReader.open(dir,true);
  }
 else   if (args.length == 2) {
    dir=FSDirectory.open(new File(args[0]));
    reader=IndexReader.open(dir,true);
    field=args[1];
  }
 else {
    usage();
    System.exit(1);
  }
  TermInfoQueue tiq=new TermInfoQueue(numTerms);
  if (field != null) {
    Terms terms=reader.fields().terms(field);
    if (terms != null) {
      TermsEnum termsEnum=terms.iterator();
      while (true) {
        BytesRef term=termsEnum.next();
        if (term != null) {
          tiq.insertWithOverflow(new TermInfo(new Term(field,term.utf8ToString()),termsEnum.docFreq()));
        }
 else {
          break;
        }
      }
    }
  }
 else {
    FieldsEnum fields=reader.fields().iterator();
    while (true) {
      field=fields.next();
      if (field != null) {
        TermsEnum terms=fields.terms();
        while (true) {
          BytesRef term=terms.next();
          if (term != null) {
            tiq.insertWithOverflow(new TermInfo(new Term(field,term.toString()),terms.docFreq()));
          }
 else {
            break;
          }
        }
      }
 else {
        break;
      }
    }
  }
  while (tiq.size() != 0) {
    TermInfo termInfo=tiq.pop();
    System.out.println(termInfo.term + " " + termInfo.docFreq);
  }
  reader.close();
}
