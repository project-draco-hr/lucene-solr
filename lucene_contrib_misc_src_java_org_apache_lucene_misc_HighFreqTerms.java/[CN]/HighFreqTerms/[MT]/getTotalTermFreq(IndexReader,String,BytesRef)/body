{
  long totalTF=0;
  Terms terms=MultiFields.getTerms(reader,field);
  if (terms == null) {
    return 0;
  }
  TermsEnum termsEnum=terms.iterator(null);
  if (termsEnum.seekCeil(termText) != TermsEnum.SeekStatus.FOUND) {
    return 0;
  }
  Bits liveDocs=MultiFields.getLiveDocs(reader);
  if (liveDocs == null) {
    final long totTF=termsEnum.totalTermFreq();
    if (totTF != -1) {
      return totTF;
    }
  }
  DocsEnum de=termsEnum.docs(liveDocs,null);
  final DocsEnum.BulkReadResult bulkresult=de.getBulkResult();
  int count;
  while ((count=de.read()) != 0) {
    final int[] freqs=bulkresult.freqs.ints;
    final int limit=bulkresult.freqs.offset + count;
    for (int i=bulkresult.freqs.offset; i < limit; i++) {
      totalTF+=freqs[i];
    }
  }
  return totalTF;
}
