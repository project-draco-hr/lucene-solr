{
  final long totalTF[]=new long[1];
  new ReaderUtil.Gather(reader){
    @Override protected void add(    int base,    IndexReader r) throws IOException {
      Bits liveDocs=r.getLiveDocs();
      if (liveDocs == null) {
        final long totTF=r.totalTermFreq(field,termText);
        if (totTF != -1) {
          totalTF[0]+=totTF;
          return;
        }
      }
      DocsEnum de=r.termDocsEnum(liveDocs,field,termText);
      if (de != null) {
        while (de.nextDoc() != DocIdSetIterator.NO_MORE_DOCS)         totalTF[0]+=de.freq();
      }
    }
  }
.run();
  return totalTF[0];
}
