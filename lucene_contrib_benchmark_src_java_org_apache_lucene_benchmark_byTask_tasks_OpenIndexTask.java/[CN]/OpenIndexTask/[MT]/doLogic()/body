{
  PerfRunData runData=getRunData();
  Config config=runData.getConfig();
  final IndexCommit ic;
  if (commitUserData != null) {
    ic=OpenReaderTask.findIndexCommit(runData.getDirectory(),commitUserData);
  }
 else {
    ic=null;
  }
  IndexWriter writer=new IndexWriter(runData.getDirectory(),new IndexWriterConfig(Version.LUCENE_CURRENT,runData.getAnalyzer()).setIndexDeletionPolicy(CreateIndexTask.getIndexDeletionPolicy(config)).setIndexCommit(ic));
  CreateIndexTask.setIndexWriterConfig(writer,config);
  runData.setIndexWriter(writer);
  return 1;
}
