{
  final StringBuilder sb=new StringBuilder(Math.min(sourceText.length() / 2,MAX_CLASS_NAME_LENGTH));
  boolean wasIdentifierPart=true;
  for (int i=0, c=sourceText.length(); i < c && sb.length() < MAX_CLASS_NAME_LENGTH; i++) {
    final char ch=sourceText.charAt(i);
    if (Character.isJavaIdentifierPart(ch)) {
      sb.append(ch);
      wasIdentifierPart=true;
    }
 else     if (wasIdentifierPart) {
      sb.append('_');
      wasIdentifierPart=false;
    }
  }
  for (int i=sb.length() - 1; i >= 0; i--) {
    if (sb.charAt(i) == '_') {
      sb.setLength(i);
    }
 else {
      break;
    }
  }
  return sb.toString();
}
