{
  return new LineReader<SpatialTestQuery>(new InputStreamReader(in,"UTF-8")){
    @Override public SpatialTestQuery parseLine(    String line){
      SpatialTestQuery test=new SpatialTestQuery();
      test.line=line;
      test.lineNumber=getLineNumber();
      try {
        if (line.startsWith("[")) {
          int idx=line.indexOf(']');
          if (idx > 0) {
            line=line.substring(idx + 1);
          }
        }
        int idx=line.indexOf('@');
        StringTokenizer st=new StringTokenizer(line.substring(0,idx));
        while (st.hasMoreTokens()) {
          test.ids.add(st.nextToken().trim());
        }
        test.args=parser.parse(line.substring(idx + 1).trim(),ctx);
        return test;
      }
 catch (      Exception ex) {
        throw new RuntimeException("invalid query line: " + test.line,ex);
      }
    }
  }
;
}
