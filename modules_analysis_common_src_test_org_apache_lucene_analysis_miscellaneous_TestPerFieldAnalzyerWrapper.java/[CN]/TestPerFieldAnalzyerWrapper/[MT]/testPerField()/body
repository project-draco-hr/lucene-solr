{
  String text="Qwerty";
  Map<String,Analyzer> analyzerPerField=new HashMap<String,Analyzer>();
  analyzerPerField.put("special",new SimpleAnalyzer(TEST_VERSION_CURRENT));
  PerFieldAnalyzerWrapper analyzer=new PerFieldAnalyzerWrapper(new WhitespaceAnalyzer(TEST_VERSION_CURRENT),analyzerPerField);
  TokenStream tokenStream=analyzer.reusableTokenStream("field",new StringReader(text));
  CharTermAttribute termAtt=tokenStream.getAttribute(CharTermAttribute.class);
  tokenStream.reset();
  assertTrue(tokenStream.incrementToken());
  assertEquals("WhitespaceAnalyzer does not lowercase","Qwerty",termAtt.toString());
  tokenStream=analyzer.reusableTokenStream("special",new StringReader(text));
  termAtt=tokenStream.getAttribute(CharTermAttribute.class);
  tokenStream.reset();
  assertTrue(tokenStream.incrementToken());
  assertEquals("SimpleAnalyzer lowercases","qwerty",termAtt.toString());
}
