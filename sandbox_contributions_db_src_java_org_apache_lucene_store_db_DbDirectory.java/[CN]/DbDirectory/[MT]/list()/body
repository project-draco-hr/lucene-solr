{
  Dbc cursor=null;
  List list=new ArrayList();
  try {
    try {
      Dbt key=new Dbt(new byte[0]);
      Dbt data=new Dbt(null);
      data.setPartialLength(0);
      data.setFlags(Db.DB_DBT_PARTIAL);
      cursor=files.cursor(txn,flags);
      if (cursor.get(key,data,Db.DB_SET_RANGE | flags) != Db.DB_NOTFOUND) {
        ByteArrayInputStream buffer=new ByteArrayInputStream(key.getData());
        DataInputStream in=new DataInputStream(buffer);
        String name=in.readUTF();
        in.close();
        list.add(name);
        while (cursor.get(key,data,Db.DB_NEXT | flags) != Db.DB_NOTFOUND) {
          buffer=new ByteArrayInputStream(key.getData());
          in=new DataInputStream(buffer);
          name=in.readUTF();
          in.close();
          list.add(name);
        }
      }
    }
  finally {
      if (cursor != null)       cursor.close();
    }
  }
 catch (  DbException e) {
    throw new IOException(e.getMessage());
  }
  return (String[])list.toArray(new String[list.size()]);
}
