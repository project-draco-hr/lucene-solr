{
  SolrParams params=req.getParams();
  if (params == null) {
    params=new MapSolrParams(new HashMap<String,String>());
  }
  boolean optimize=params.getBool(UpdateParams.OPTIMIZE,false);
  boolean commit=params.getBool(UpdateParams.COMMIT,false);
  if (optimize || commit || force) {
    CommitUpdateCommand cmd=new CommitUpdateCommand(optimize);
    cmd.waitFlush=params.getBool(UpdateParams.WAIT_FLUSH,cmd.waitFlush);
    cmd.waitSearcher=params.getBool(UpdateParams.WAIT_SEARCHER,cmd.waitSearcher);
    req.getCore().getUpdateHandler().commit(cmd);
    if (optimize) {
      rsp.add("optimize",true);
    }
 else {
      rsp.add("commit",true);
    }
    return true;
  }
  return false;
}
