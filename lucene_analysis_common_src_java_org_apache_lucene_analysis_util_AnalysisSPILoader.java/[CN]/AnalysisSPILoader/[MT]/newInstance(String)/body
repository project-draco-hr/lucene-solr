{
  final Class<S> service=services.get(name.toLowerCase(Locale.ROOT));
  if (service != null) {
    try {
      return service.newInstance();
    }
 catch (    Exception e) {
      throw new IllegalArgumentException("SPI class of type " + clazz.getName() + " with name '"+ name+ "' cannot be instantiated. "+ "This is likely due to a misconfiguration of the java class '"+ service.getName()+ "': ",e);
    }
  }
 else {
    throw new IllegalArgumentException("A SPI class of type " + clazz.getName() + " with name '"+ name+ "' does not exist. "+ "You need to add the corresponding JAR file supporting this SPI to your classpath."+ "The current classpath supports the following names: "+ availableServices());
  }
}
