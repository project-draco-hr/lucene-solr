{
  final CodecProvider codecProvider=codecs == null ? CodecProvider.getDefault() : codecs;
  return (IndexReader)new SegmentInfos.FindSegmentsFile(directory){
    @Override protected Object doBody(    String segmentFileName) throws CorruptIndexException, IOException {
      SegmentInfos infos=new SegmentInfos(codecProvider);
      infos.read(directory,segmentFileName,codecProvider);
      return new DirectoryReader(directory,infos,deletionPolicy,readOnly,termInfosIndexDivisor,codecProvider);
    }
  }
.run(commit);
}
