{
  final String codecIdAsString="" + codecId;
  boolean success=false;
  try {
    final String docFileName=IndexFileNames.segmentFileName(segmentInfo.name,codecIdAsString,SepPostingsWriterImpl.DOC_EXTENSION);
    docIn=intFactory.openInput(dir,docFileName);
    skipIn=dir.openInput(IndexFileNames.segmentFileName(segmentInfo.name,codecIdAsString,SepPostingsWriterImpl.SKIP_EXTENSION),readBufferSize);
    if (segmentInfo.getHasProx()) {
      freqIn=intFactory.openInput(dir,IndexFileNames.segmentFileName(segmentInfo.name,codecIdAsString,SepPostingsWriterImpl.FREQ_EXTENSION));
      posIn=intFactory.openInput(dir,IndexFileNames.segmentFileName(segmentInfo.name,codecIdAsString,SepPostingsWriterImpl.POS_EXTENSION),readBufferSize);
      payloadIn=dir.openInput(IndexFileNames.segmentFileName(segmentInfo.name,codecIdAsString,SepPostingsWriterImpl.PAYLOAD_EXTENSION),readBufferSize);
    }
 else {
      posIn=null;
      payloadIn=null;
      freqIn=null;
    }
    success=true;
  }
  finally {
    if (!success) {
      close();
    }
  }
}
