{
  if (docFreq >= skipInterval) {
    if (skipper == null) {
      skipper=new SepSkipListReader((IndexInput)skipIn.clone(),freqIn,docIn,posIn,maxSkipLevels,skipInterval);
    }
    if (!skipped) {
      skipper.init(skipFP,docIndex,freqIndex,posIndex,0,docFreq,storePayloads);
      skipper.setOmitTF(omitTF);
      skipped=true;
    }
    final int newCount=skipper.skipTo(target);
    if (newCount > count) {
      if (!omitTF) {
        skipper.getFreqIndex().seek(freqReader);
      }
      skipper.getDocIndex().seek(docReader);
      count=newCount;
      doc=skipper.getDoc();
    }
  }
  do {
    if (nextDoc() == NO_MORE_DOCS) {
      return NO_MORE_DOCS;
    }
  }
 while (target > doc);
  return doc;
}
