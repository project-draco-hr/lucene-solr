{
  Random random=random();
  int blockSize=BlockCache._32K;
  int slabSize=blockSize * 1024;
  long totalMemory=2 * slabSize;
  BlockCache blockCache=new BlockCache(new Metrics(),true,totalMemory,slabSize);
  BlockCacheKey blockCacheKey=new BlockCacheKey();
  blockCacheKey.setBlock(0);
  blockCacheKey.setFile(0);
  blockCacheKey.setPath("/");
  byte[] newData=new byte[blockSize * 3];
  byte[] testData=testData(random,blockSize,newData);
  assertTrue(blockCache.store(blockCacheKey,0,testData,0,blockSize));
  assertTrue(blockCache.store(blockCacheKey,0,testData,blockSize,blockSize));
  assertTrue(blockCache.store(blockCacheKey,0,testData,blockSize * 2,blockSize));
  assertTrue(blockCache.store(blockCacheKey,1,testData,0,blockSize - 1));
  assertTrue(blockCache.store(blockCacheKey,1,testData,blockSize,blockSize - 1));
  assertTrue(blockCache.store(blockCacheKey,1,testData,blockSize * 2,blockSize - 1));
}
