{
  try {
    File index=new File("index");
    boolean create=false;
    File root=null;
    String usage="IndexHTML [-create] [-index <index>] <root_directory>";
    if (argv.length == 0) {
      System.err.println("Usage: " + usage);
      return;
    }
    for (int i=0; i < argv.length; i++) {
      if (argv[i].equals("-index")) {
        index=new File(argv[++i]);
      }
 else       if (argv[i].equals("-create")) {
        create=true;
      }
 else       if (i != argv.length - 1) {
        System.err.println("Usage: " + usage);
        return;
      }
 else       root=new File(argv[i]);
    }
    if (root == null) {
      System.err.println("Specify directory to index");
      System.err.println("Usage: " + usage);
      return;
    }
    Date start=new Date();
    if (!create) {
      deleting=true;
      indexDocs(root,index,create);
    }
    writer=new IndexWriter(FSDirectory.open(index),new StandardAnalyzer(Version.LUCENE_CURRENT),create,new IndexWriter.MaxFieldLength(1000000));
    indexDocs(root,index,create);
    System.out.println("Optimizing index...");
    writer.optimize();
    writer.close();
    Date end=new Date();
    System.out.print(end.getTime() - start.getTime());
    System.out.println(" total milliseconds");
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
}
