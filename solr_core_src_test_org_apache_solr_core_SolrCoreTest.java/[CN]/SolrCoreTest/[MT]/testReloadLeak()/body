{
  final ExecutorService executor=ExecutorUtil.newMDCAwareFixedThreadPool(1,new DefaultSolrThreadFactory("testReloadLeak"));
  SolrCore core=h.getCore();
  assertTrue("Refcount != 1",core.getOpenCount() == 1);
  executor.execute(new NewSearcherRunnable(core));
  h.reload();
  executor.shutdown();
  executor.awaitTermination(1,TimeUnit.MINUTES);
  assertTrue("SolrCore " + core + " is not closed",core.isClosed());
  assertTrue(core.areAllSearcherReferencesEmpty());
}
