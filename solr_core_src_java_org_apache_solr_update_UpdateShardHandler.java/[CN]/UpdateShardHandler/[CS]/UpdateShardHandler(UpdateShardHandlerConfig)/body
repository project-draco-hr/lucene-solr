{
  this.cfg=cfg;
  clientConnectionManager=new PoolingClientConnectionManager(SchemeRegistryFactory.createSystemDefault());
  if (cfg != null) {
    clientConnectionManager.setMaxTotal(cfg.getMaxUpdateConnections());
    clientConnectionManager.setDefaultMaxPerRoute(cfg.getMaxUpdateConnectionsPerHost());
  }
  ModifiableSolrParams clientParams=getClientParams();
  log.info("Creating UpdateShardHandler HTTP client with params: {}",clientParams);
  client=HttpClientUtil.createClient(clientParams,clientConnectionManager);
}
