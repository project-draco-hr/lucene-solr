{
  this.traversal=(Traversal)context.get("traversal");
  if (traversal == null) {
    StreamContext localContext=new StreamContext();
    localContext.numWorkers=context.numWorkers;
    localContext.workerID=context.workerID;
    localContext.setSolrClientCache(context.getSolrClientCache());
    localContext.setStreamFactory(context.getStreamFactory());
    for (    Object key : context.getEntries().keySet()) {
      localContext.put(key,context.get(key));
    }
    traversal=new Traversal();
    localContext.put("traversal",traversal);
    this.tupleStream.setStreamContext(localContext);
    this.streamContext=localContext;
  }
 else {
    this.tupleStream.setStreamContext(context);
    this.streamContext=context;
  }
}
