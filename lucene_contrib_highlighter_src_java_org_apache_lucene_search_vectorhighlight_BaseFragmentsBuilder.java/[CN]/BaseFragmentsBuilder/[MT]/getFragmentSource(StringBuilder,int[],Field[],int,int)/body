{
  while (buffer.length() < endOffset && index[0] < values.length) {
    if (index[0] > 0 && values[index[0]].isTokenized() && values[index[0]].stringValue().length() > 0)     buffer.append(multiValuedSeparator);
    buffer.append(values[index[0]++].stringValue());
  }
  int eo=buffer.length() < endOffset ? buffer.length() : endOffset;
  return buffer.substring(startOffset,eo);
}
