{
  writer.deleteAll();
  Document d=new Document();
  FieldType ft=new FieldType();
  ft.setStored(true);
  d.add(new Field(SNAPSHOTS_ID,"",ft));
  for (  Entry<String,String> e : super.getSnapshots().entrySet()) {
    d.add(new Field(e.getKey(),e.getValue(),ft));
  }
  if (id != null) {
    d.add(new Field(id,segment,ft));
  }
  writer.addDocument(d);
  writer.commit();
}
