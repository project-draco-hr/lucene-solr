{
  this.readerContext=context;
  groupIndex=FieldCache.DEFAULT.getTermsIndex(context.reader,groupField);
  for (int i=0; i < fields.length; i++) {
    sortsIndex[i]=FieldCache.DEFAULT.getTermsIndex(context.reader,fields[i].getField());
  }
  ordSet.clear();
  segmentGroupHeads=new GroupHead[groupIndex.numOrd()];
  for (  GroupHead collectedGroup : collectedGroups) {
    int groupOrd=groupIndex.binarySearchLookup(collectedGroup.groupValue,scratchBytesRef);
    if (groupOrd >= 0) {
      ordSet.put(groupOrd);
      segmentGroupHeads[groupOrd]=collectedGroup;
      for (int i=0; i < sortsIndex.length; i++) {
        collectedGroup.sortOrds[i]=sortsIndex[i].binarySearchLookup(collectedGroup.sortValues[i],scratchBytesRef);
      }
    }
  }
}
