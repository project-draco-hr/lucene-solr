{
  Fieldable binaryFldCompressed=new Field("binaryCompressed",CompressionTools.compress(binaryValCompressed.getBytes()));
  Fieldable stringFldCompressed=new Field("stringCompressed",CompressionTools.compressString(binaryValCompressed));
  Document doc=new Document();
  doc.add(binaryFldCompressed);
  doc.add(stringFldCompressed);
  MockRAMDirectory dir=new MockRAMDirectory();
  IndexWriter writer=new IndexWriter(dir,new IndexWriterConfig(TEST_VERSION_CURRENT));
  writer.addDocument(doc);
  writer.close();
  IndexReader reader=IndexReader.open(dir,false);
  Document docFromReader=reader.document(0);
  assertTrue(docFromReader != null);
  String binaryFldCompressedTest=new String(CompressionTools.decompress(docFromReader.getBinaryValue("binaryCompressed")));
  assertTrue(binaryFldCompressedTest.equals(binaryValCompressed));
  assertTrue(CompressionTools.decompressString(docFromReader.getBinaryValue("stringCompressed")).equals(binaryValCompressed));
  reader.close();
  dir.close();
}
