{
  File files[]=srcDir.listFiles(new FilenameFilter(){
    public boolean accept(    File dir,    String name){
      return name.endsWith("rbbi");
    }
  }
);
  if (files == null)   throw new IOException("Path does not exist: " + srcDir);
  for (int i=0; i < files.length; i++) {
    File file=files[i];
    File outputFile=new File(destDir,file.getName().replaceAll("rbbi$","brk"));
    String rules=getRules(file);
    System.err.print("Compiling " + file.getName() + " to "+ outputFile.getName()+ ": ");
    try {
      new RuleBasedBreakIterator(rules);
    }
 catch (    IllegalArgumentException e) {
      System.err.println(e.getMessage());
      System.exit(1);
    }
    FileOutputStream os=new FileOutputStream(outputFile);
    Class<?> builderClass=Class.forName("com.ibm.icu.text.RBBIRuleBuilder");
    Method method=builderClass.getDeclaredMethod("compileRules",String.class,OutputStream.class);
    method.setAccessible(true);
    method.invoke(null,rules,os);
    os.close();
    System.err.println(outputFile.length() + " bytes.");
  }
}
