{
  if (o instanceof String) {
    return parseStringFacetOrStat(key,(String)o);
  }
  if (!(o instanceof Map)) {
    throw err("expected Map but got " + o);
  }
  Map<String,Object> m=(Map<String,Object>)o;
  String type;
  Object args;
  if (m.size() == 1) {
    Map.Entry<String,Object> entry=m.entrySet().iterator().next();
    type=entry.getKey();
    args=entry.getValue();
  }
 else {
    Object typeObj=m.get("type");
    if (!(typeObj instanceof String)) {
      throw err("expected facet/stat type name, like {type:range, field:price, ...} but got " + typeObj);
    }
    type=(String)typeObj;
    args=m;
  }
  return parseFacetOrStat(key,type,args);
}
