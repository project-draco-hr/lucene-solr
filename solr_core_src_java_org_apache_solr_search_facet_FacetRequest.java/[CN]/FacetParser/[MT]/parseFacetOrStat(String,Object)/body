{
  if (o instanceof String) {
    return parseStringFacetOrStat(key,(String)o);
  }
  if (!(o instanceof Map)) {
    throw err("expected Map but got " + o);
  }
  Map<String,Object> m=(Map<String,Object>)o;
  if (m.size() != 1) {
    throw err("expected facet/stat type name, like {range:{... but got " + m);
  }
  Map.Entry<String,Object> entry=m.entrySet().iterator().next();
  String type=entry.getKey();
  Object args=entry.getValue();
  return parseFacetOrStat(key,type,args);
}
