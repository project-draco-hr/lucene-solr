{
  if (sort == null) {
    facet.sortVariable="count";
    facet.sortDirection=FacetRequest.SortDirection.desc;
  }
 else   if (sort instanceof String) {
    String sortStr=(String)sort;
    if (sortStr.endsWith(" asc")) {
      facet.sortVariable=sortStr.substring(0,sortStr.length() - " asc".length());
      facet.sortDirection=FacetRequest.SortDirection.asc;
    }
 else     if (sortStr.endsWith(" desc")) {
      facet.sortVariable=sortStr.substring(0,sortStr.length() - " desc".length());
      facet.sortDirection=FacetRequest.SortDirection.desc;
    }
 else {
      facet.sortVariable=sortStr;
      facet.sortDirection="index".equals(facet.sortVariable) ? FacetRequest.SortDirection.asc : FacetRequest.SortDirection.desc;
    }
  }
 else {
    Map<String,Object> map=(Map<String,Object>)sort;
    Map.Entry<String,Object> entry=map.entrySet().iterator().next();
    String k=entry.getKey();
    Object v=entry.getValue();
    facet.sortVariable=k;
    facet.sortDirection=FacetRequest.SortDirection.valueOf(v.toString());
  }
}
