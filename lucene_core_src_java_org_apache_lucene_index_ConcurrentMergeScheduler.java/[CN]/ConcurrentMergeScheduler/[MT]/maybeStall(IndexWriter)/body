{
  long startStallTime=0;
  while (writer.hasPendingMerges() && mergeThreadCount() >= maxMergeCount) {
    if (mergeThreads.contains(Thread.currentThread())) {
      return false;
    }
    if (verbose() && startStallTime == 0) {
      message("    too many merges; stalling...");
    }
    startStallTime=System.currentTimeMillis();
    doStall();
  }
  if (verbose() && startStallTime != 0) {
    message("  stalled for " + (System.currentTimeMillis() - startStallTime) + " msec");
  }
  return true;
}
