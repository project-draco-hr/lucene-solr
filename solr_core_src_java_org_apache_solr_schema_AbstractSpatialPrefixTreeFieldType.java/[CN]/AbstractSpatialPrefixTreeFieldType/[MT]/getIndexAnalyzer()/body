{
  return new Analyzer(){
    @Override protected TokenStreamComponents createComponents(    final String fieldName){
      return new TokenStreamComponents(new KeywordTokenizer()){
        private Shape shape=null;
        protected void setReader(        final Reader reader){
          source.setReader(reader);
          try {
            shape=parseShape(IOUtils.toString(reader));
          }
 catch (          IOException e) {
            throw new RuntimeException(e);
          }
        }
        public TokenStream getTokenStream(){
          PrefixTreeStrategy s=newSpatialStrategy(fieldName == null ? getTypeName() : fieldName);
          return s.createIndexableFields(shape)[0].tokenStreamValue();
        }
      }
;
    }
  }
;
}
