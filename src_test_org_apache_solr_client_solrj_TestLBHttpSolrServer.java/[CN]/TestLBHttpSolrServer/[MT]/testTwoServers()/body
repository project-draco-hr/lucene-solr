{
  LBHttpSolrServer lbHttpSolrServer=new LBHttpSolrServer(httpClient,solr[0].getUrl(),solr[1].getUrl());
  lbHttpSolrServer.setAliveCheckInterval(1000);
  SolrQuery solrQuery=new SolrQuery("*:*");
  Set<String> names=new HashSet<String>();
  QueryResponse resp=null;
  solr[0].jetty.stop();
  solr[0].jetty=null;
  resp=lbHttpSolrServer.query(solrQuery);
  String name=resp.getResults().get(0).getFieldValue("name").toString();
  Assert.assertEquals("solr1",name);
  resp=lbHttpSolrServer.query(solrQuery);
  name=resp.getResults().get(0).getFieldValue("name").toString();
  Assert.assertEquals("solr1",name);
  solr[1].jetty.stop();
  solr[1].jetty=null;
  solr[0].startJetty();
  Thread.sleep(1200);
  try {
    resp=lbHttpSolrServer.query(solrQuery);
  }
 catch (  SolrServerException e) {
    Thread.sleep(3000);
    resp=lbHttpSolrServer.query(solrQuery);
  }
  name=resp.getResults().get(0).getFieldValue("name").toString();
  Assert.assertEquals("solr0",name);
}
