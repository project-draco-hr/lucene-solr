{
  CodecUtil.checkHeader(data,Lucene40DocValuesFormat.BYTES_FIXED_SORTED_CODEC_NAME_DAT,Lucene40DocValuesFormat.BYTES_FIXED_SORTED_VERSION_START,Lucene40DocValuesFormat.BYTES_FIXED_SORTED_VERSION_CURRENT);
  CodecUtil.checkHeader(index,Lucene40DocValuesFormat.BYTES_FIXED_SORTED_CODEC_NAME_IDX,Lucene40DocValuesFormat.BYTES_FIXED_SORTED_VERSION_START,Lucene40DocValuesFormat.BYTES_FIXED_SORTED_VERSION_CURRENT);
  final int fixedLength=data.readInt();
  final int valueCount=index.readInt();
  PagedBytes bytes=new PagedBytes(16);
  bytes.copy(data,fixedLength * (long)valueCount);
  final PagedBytes.Reader bytesReader=bytes.freeze(true);
  final PackedInts.Reader reader=PackedInts.getReader(index);
  ramBytesUsed.addAndGet(bytes.ramBytesUsed() + reader.ramBytesUsed());
  return correctBuggyOrds(new SortedDocValues(){
    @Override public int getOrd(    int docID){
      return (int)reader.get(docID);
    }
    @Override public BytesRef lookupOrd(    int ord){
      final BytesRef term=new BytesRef();
      bytesReader.fillSlice(term,fixedLength * (long)ord,fixedLength);
      return term;
    }
    @Override public int getValueCount(){
      return valueCount;
    }
  }
);
}
