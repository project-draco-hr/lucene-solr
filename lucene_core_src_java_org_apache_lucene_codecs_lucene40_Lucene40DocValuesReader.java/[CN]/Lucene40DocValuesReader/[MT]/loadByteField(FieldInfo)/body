{
  String fileName=IndexFileNames.segmentFileName(state.segmentInfo.name,Integer.toString(field.number),"dat");
  IndexInput input=dir.openInput(fileName,state.context);
  boolean success=false;
  try {
    CodecUtil.checkHeader(input,Lucene40DocValuesFormat.INTS_CODEC_NAME,Lucene40DocValuesFormat.INTS_VERSION_START,Lucene40DocValuesFormat.INTS_VERSION_CURRENT);
    input.readInt();
    int maxDoc=state.segmentInfo.getDocCount();
    final byte values[]=new byte[maxDoc];
    input.readBytes(values,0,values.length);
    return new NumericDocValues(){
      @Override public long get(      int docID){
        return values[docID];
      }
    }
;
  }
  finally {
    if (success) {
      IOUtils.close(input);
    }
 else {
      IOUtils.closeWhileHandlingException(input);
    }
  }
}
