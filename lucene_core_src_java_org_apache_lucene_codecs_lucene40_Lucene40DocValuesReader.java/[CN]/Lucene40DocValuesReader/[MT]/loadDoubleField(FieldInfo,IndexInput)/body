{
  CodecUtil.checkHeader(input,Lucene40DocValuesFormat.FLOATS_CODEC_NAME,Lucene40DocValuesFormat.FLOATS_VERSION_START,Lucene40DocValuesFormat.FLOATS_VERSION_CURRENT);
  int valueSize=input.readInt();
  if (valueSize != 8) {
    throw new CorruptIndexException("invalid valueSize: " + valueSize);
  }
  int maxDoc=state.segmentInfo.getDocCount();
  final long values[]=new long[maxDoc];
  for (int i=0; i < values.length; i++) {
    values[i]=input.readLong();
  }
  ramBytesUsed.addAndGet(RamUsageEstimator.sizeOf(values));
  return new NumericDocValues(){
    @Override public long get(    int docID){
      return values[docID];
    }
  }
;
}
