{
  String fileName=IndexFileNames.segmentFileName(state.segmentInfo.name,Integer.toString(field.number),"dat");
  IndexInput input=dir.openInput(fileName,state.context);
  boolean success=false;
  try {
    CodecUtil.checkHeader(input,Lucene40DocValuesFormat.FLOATS_CODEC_NAME,Lucene40DocValuesFormat.FLOATS_VERSION_START,Lucene40DocValuesFormat.FLOATS_VERSION_CURRENT);
    input.readInt();
    int maxDoc=state.segmentInfo.getDocCount();
    final int values[]=new int[maxDoc];
    for (int i=0; i < values.length; i++) {
      values[i]=input.readInt();
    }
    return new NumericDocValues(){
      @Override public long get(      int docID){
        return values[docID];
      }
    }
;
  }
  finally {
    if (success) {
      IOUtils.close(input);
    }
 else {
      IOUtils.closeWhileHandlingException(input);
    }
  }
}
