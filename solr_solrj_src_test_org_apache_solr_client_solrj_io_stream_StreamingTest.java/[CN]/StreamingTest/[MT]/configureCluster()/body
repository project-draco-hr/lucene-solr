{
  numShards=random().nextInt(2) + 1;
  numWorkers=numShards > 2 ? random().nextInt(numShards - 1) + 1 : numShards;
  configureCluster(numShards).addConfig("conf",getFile("solrj").toPath().resolve("solr").resolve("configsets").resolve("streaming").resolve("conf")).configure();
  CollectionAdminRequest.createCollection(COLLECTION,"conf",numShards,1).process(cluster.getSolrClient());
  AbstractDistribZkTestBase.waitForRecoveriesToFinish(COLLECTION,cluster.getSolrClient().getZkStateReader(),false,true,TIMEOUT);
  zkHost=cluster.getZkServer().getZkAddress();
  streamFactory.withCollectionZkHost(COLLECTION,zkHost);
}
