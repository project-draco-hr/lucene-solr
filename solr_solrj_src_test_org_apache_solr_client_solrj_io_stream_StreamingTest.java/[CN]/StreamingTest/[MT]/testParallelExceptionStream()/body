{
  indexr(id,"0","a_s","hello0","a_i","0","a_f","1");
  indexr(id,"2","a_s","hello0","a_i","2","a_f","2");
  indexr(id,"3","a_s","hello3","a_i","3","a_f","3");
  indexr(id,"4","a_s","hello4","a_i","4","a_f","4");
  indexr(id,"1","a_s","hello0","a_i","1","a_f","5");
  indexr(id,"5","a_s","hello3","a_i","10","a_f","6");
  indexr(id,"6","a_s","hello4","a_i","11","a_f","7");
  indexr(id,"7","a_s","hello3","a_i","12","a_f","8");
  indexr(id,"8","a_s","hello3","a_i","13","a_f","9");
  indexr(id,"9","a_s","hello0","a_i","14","a_f","10");
  commit();
  String zkHost=zkServer.getZkAddress();
  Map paramsA=mapParams("q","*:*","fl","a_s,a_i,a_f,blah","sort","blah asc");
  CloudSolrStream stream=new CloudSolrStream(zkHost,"collection1",paramsA);
  ParallelStream pstream=new ParallelStream(zkHost,"collection1",stream,2,new FieldComparator("blah",ComparatorOrder.ASCENDING));
  ExceptionStream estream=new ExceptionStream(pstream);
  Tuple t=getTuple(estream);
  assert(t.EOF);
  assert(t.EXCEPTION);
  assert(t.getException().contains("When numWorkers > 1 partitionKeys must be set."));
  paramsA=mapParams("q","*:*","fl","a_s,a_i,a_f,score","sort","a_s asc","qt","/export","partitionKeys","a_s");
  stream=new CloudSolrStream(zkHost,"collection1",paramsA);
  pstream=new ParallelStream(zkHost,"collection1",stream,2,new FieldComparator("a_s",ComparatorOrder.ASCENDING));
  estream=new ExceptionStream(pstream);
  t=getTuple(estream);
  assert(t.EOF);
  assert(t.EXCEPTION);
  assert(t.getException().contains("undefined field:"));
}
