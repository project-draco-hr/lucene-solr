{
  final String field=fieldname.intern();
  Object lookupArray=FieldCache.DEFAULT.getAuto(reader,field);
  if (lookupArray instanceof FieldCache.StringIndex) {
    return comparatorString(reader,field);
  }
 else   if (lookupArray instanceof int[]) {
    return comparatorInt(reader,field,null);
  }
 else   if (lookupArray instanceof long[]) {
    return comparatorLong(reader,field,null);
  }
 else   if (lookupArray instanceof float[]) {
    return comparatorFloat(reader,field,null);
  }
 else   if (lookupArray instanceof String[]) {
    return comparatorString(reader,field);
  }
 else {
    throw new RuntimeException("unknown data type in field '" + field + "'");
  }
}
