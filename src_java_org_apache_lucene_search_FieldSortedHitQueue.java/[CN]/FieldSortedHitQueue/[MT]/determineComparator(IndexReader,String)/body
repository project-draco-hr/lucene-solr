{
  field=field.intern();
  TermEnum enumerator=reader.terms(new Term(field,""));
  try {
    Term term=enumerator.term();
    if (term == null) {
      throw new RuntimeException("no terms in field " + field);
    }
    if (term.field() == field) {
      String termtext=term.text().trim();
      try {
        Integer.parseInt(termtext);
        return IntegerSortedHitQueue.comparator(reader,enumerator,field);
      }
 catch (      NumberFormatException nfe) {
      }
      try {
        Float.parseFloat(termtext);
        return FloatSortedHitQueue.comparator(reader,enumerator,field);
      }
 catch (      NumberFormatException nfe) {
      }
      return StringSortedHitQueue.comparator(reader,enumerator,field);
    }
 else {
      throw new RuntimeException("field \"" + field + "\" does not appear to be indexed");
    }
  }
  finally {
    enumerator.close();
  }
}
