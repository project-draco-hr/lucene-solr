{
  TermEnum enumerator=reader.terms(new Term(field,""));
  try {
    Term term=enumerator.term();
    if (term == null) {
      throw new RuntimeException("no terms in field " + field);
    }
    if (term.field() == field) {
      String termtext=term.text().trim();
      if (pIntegers.matcher(termtext).matches())       return IntegerSortedHitQueue.comparator(reader,enumerator,field);
 else       if (pFloats.matcher(termtext).matches())       return FloatSortedHitQueue.comparator(reader,enumerator,field);
      return StringSortedHitQueue.comparator(reader,enumerator,field);
    }
 else {
      throw new RuntimeException("field \"" + field + "\" does not appear to be indexed");
    }
  }
  finally {
    enumerator.close();
  }
}
