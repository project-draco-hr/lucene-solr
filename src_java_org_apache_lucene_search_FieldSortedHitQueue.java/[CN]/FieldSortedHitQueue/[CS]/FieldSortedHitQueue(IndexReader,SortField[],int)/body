{
  final int n=fields.length;
  comparators=new ScoreDocComparator[n];
  this.fields=new SortField[n];
  for (int i=0; i < n; ++i) {
    String fieldname=fields[i].getField();
    comparators[i]=getCachedComparator(reader,fieldname,fields[i].getType(),fields[i].getLocale(),fields[i].getFactory());
    if (comparators[i].sortType() == SortField.STRING) {
      this.fields[i]=new SortField(fieldname,fields[i].getLocale(),fields[i].getReverse());
    }
 else {
      this.fields[i]=new SortField(fieldname,comparators[i].sortType(),fields[i].getReverse());
    }
  }
  initialize(size);
}
