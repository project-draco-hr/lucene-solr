{
  checkVersion(version);
switch (format) {
case PACKED:
    return new DirectPackedReader(bitsPerValue,valueCount,in);
case PACKED_SINGLE_BLOCK:
  return new DirectPacked64SingleBlockReader(bitsPerValue,valueCount,in);
default :
throw new AssertionError("Unknwown format: " + format);
}
}
