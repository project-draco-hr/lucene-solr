{
  String field=((String)fieldKey).intern();
  TermEnum enumerator=reader.terms(new Term(field));
  try {
    Term term=enumerator.term();
    if (term == null) {
      throw new RuntimeException("no terms in field " + field + " - cannot determine sort type");
    }
    int ret=0;
    if (term.field() == field) {
      String termtext=term.text().trim();
      try {
        Integer.parseInt(termtext);
        ret=SortField.INT;
      }
 catch (      NumberFormatException nfe1) {
        try {
          Long.parseLong(termtext);
          ret=SortField.LONG;
        }
 catch (        NumberFormatException nfe2) {
          try {
            Float.parseFloat(termtext);
            ret=SortField.FLOAT;
          }
 catch (          NumberFormatException nfe3) {
            ret=SortField.STRING;
          }
        }
      }
    }
 else {
      throw new RuntimeException("field \"" + field + "\" does not appear to be indexed");
    }
    return ret;
  }
  finally {
    enumerator.close();
  }
}
