{
  if (newState == null) {
    log.info("Deleting data for {}",coll);
    watchedCollectionStates.remove(coll);
    return;
  }
  while (true) {
    if (!interestingCollections.contains(coll)) {
      break;
    }
    DocCollection oldState=watchedCollectionStates.get(coll);
    if (oldState == null) {
      if (watchedCollectionStates.putIfAbsent(coll,newState) == null) {
        log.info("Add data for {} ver {} ",coll,newState.getZNodeVersion());
        break;
      }
    }
 else {
      if (oldState.getZNodeVersion() >= newState.getZNodeVersion()) {
        break;
      }
      if (watchedCollectionStates.replace(coll,oldState,newState)) {
        log.info("Updating data for {} from {} to {} ",coll,oldState.getZNodeVersion(),newState.getZNodeVersion());
        break;
      }
    }
  }
  if (!interestingCollections.contains(coll)) {
    watchedCollectionStates.remove(coll);
    log.info("Removing uninteresting collection {}",coll);
  }
}
