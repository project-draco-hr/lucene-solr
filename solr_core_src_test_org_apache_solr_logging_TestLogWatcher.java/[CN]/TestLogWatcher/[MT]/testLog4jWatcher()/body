{
  LogWatcher watcher=LogWatcher.newRegisteredLogWatcher(config,null);
  assertEquals(watcher.getLastEvent(),-1);
  log.warn("This is a test message");
  assertTrue(watcher.getLastEvent() > -1);
  SolrDocumentList events=watcher.getHistory(-1,new AtomicBoolean());
  assertEquals(events.size(),1);
  SolrDocument event=events.get(0);
  assertEquals(event.get("logger"),"org.apache.solr.logging.TestLogWatcher");
  assertEquals(event.get("message"),"This is a test message");
}
