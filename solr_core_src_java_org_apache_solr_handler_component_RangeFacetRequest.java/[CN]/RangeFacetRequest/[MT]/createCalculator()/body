{
  RangeEndpointCalculator<?> calc;
  FieldType ft=schemaField.getType();
  if (ft instanceof TrieField) {
    final TrieField trie=(TrieField)ft;
switch (trie.getType()) {
case FLOAT:
      calc=new FloatRangeEndpointCalculator(this);
    break;
case DOUBLE:
  calc=new DoubleRangeEndpointCalculator(this);
break;
case INTEGER:
calc=new IntegerRangeEndpointCalculator(this);
break;
case LONG:
calc=new LongRangeEndpointCalculator(this);
break;
case DATE:
calc=new DateRangeEndpointCalculator(this,null);
break;
default :
throw new SolrException(SolrException.ErrorCode.BAD_REQUEST,"Unable to range facet on tried field of unexpected type:" + this.facetOn);
}
}
 else if (ft instanceof DateRangeField) {
calc=new DateRangeFieldEndpointCalculator(this,null);
}
 else {
throw new SolrException(SolrException.ErrorCode.BAD_REQUEST,"Unable to range facet on field:" + schemaField);
}
return calc;
}
