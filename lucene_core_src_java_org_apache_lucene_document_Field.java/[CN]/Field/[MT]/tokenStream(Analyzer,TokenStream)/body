{
  if (fieldType().indexOptions() == null) {
    return null;
  }
  final NumericType numericType=fieldType().numericType();
  if (numericType != null) {
    if (!(reuse instanceof NumericTokenStream && ((NumericTokenStream)reuse).getPrecisionStep() == type.numericPrecisionStep())) {
      reuse=new NumericTokenStream(type.numericPrecisionStep());
    }
    final NumericTokenStream nts=(NumericTokenStream)reuse;
    final Number val=(Number)fieldsData;
switch (numericType) {
case INT:
      nts.setIntValue(val.intValue());
    break;
case LONG:
  nts.setLongValue(val.longValue());
break;
case FLOAT:
nts.setFloatValue(val.floatValue());
break;
case DOUBLE:
nts.setDoubleValue(val.doubleValue());
break;
default :
throw new AssertionError("Should never get here");
}
return reuse;
}
if (!fieldType().tokenized()) {
if (stringValue() == null) {
throw new IllegalArgumentException("Non-Tokenized Fields must have a String value");
}
if (!(reuse instanceof StringTokenStream)) {
reuse=new StringTokenStream();
}
((StringTokenStream)reuse).setValue(stringValue());
return reuse;
}
if (tokenStream != null) {
return tokenStream;
}
 else if (readerValue() != null) {
return analyzer.tokenStream(name(),readerValue());
}
 else if (stringValue() != null) {
return analyzer.tokenStream(name(),stringValue());
}
throw new IllegalArgumentException("Field must have either TokenStream, String, Reader or Number value; got " + this);
}
