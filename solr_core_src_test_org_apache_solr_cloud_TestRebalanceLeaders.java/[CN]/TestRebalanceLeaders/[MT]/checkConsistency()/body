{
  TimeOut timeout=new TimeOut(timeoutMs,TimeUnit.MILLISECONDS);
  boolean checkAppearOnce=false;
  boolean checkElectionZero=false;
  boolean checkZkLeadersAgree=false;
  while (!timeout.hasTimedOut()) {
    checkAppearOnce=checkAppearOnce();
    checkElectionZero=checkElectionZero();
    checkZkLeadersAgree=checkZkLeadersAgree();
    if (checkAppearOnce && checkElectionZero && checkZkLeadersAgree) {
      return;
    }
    Thread.sleep(1000);
  }
  fail("Checking the rebalance leader command failed, checkAppearOnce=" + checkAppearOnce + " checkElectionZero="+ checkElectionZero+ " checkZkLeadersAgree="+ checkZkLeadersAgree);
}
