{
  expected.clear();
  for (  Map.Entry<String,List<Replica>> ent : initial.entrySet()) {
    List<Replica> replicas=ent.getValue();
    Replica rep=replicas.get(Math.abs(random().nextInt()) % replicas.size());
    expected.put(ent.getKey(),rep);
    issuePreferred(ent.getKey(),rep);
  }
  if (waitForAllPreferreds() == false) {
    fail("Waited for timeout for preferredLeader assignments to be made and they werent.");
  }
  if (random().nextBoolean())   rebalanceLeaderUsingSolrJAPI();
 else   rebalanceLeaderUsingDirectCall();
}
