{
  super.init(context);
  fileName=context.getEntityAttribute(FILE_NAME);
  if (fileName != null) {
    fileName=context.replaceTokens(fileName);
    fileNamePattern=Pattern.compile(fileName);
  }
  baseDir=context.getEntityAttribute(BASE_DIR);
  if (baseDir == null)   throw new DataImportHandlerException(DataImportHandlerException.SEVERE,"'baseDir' is a required attribute");
  baseDir=context.replaceTokens(baseDir);
  File dir=new File(baseDir);
  if (!dir.isDirectory())   throw new DataImportHandlerException(DataImportHandlerException.SEVERE,"'baseDir' value: " + baseDir + " is not a directory");
  String r=context.getEntityAttribute(RECURSIVE);
  if (r != null)   recursive=Boolean.parseBoolean(r);
  excludes=context.getEntityAttribute(EXCLUDES);
  if (excludes != null) {
    excludes=context.replaceTokens(excludes);
    excludesPattern=Pattern.compile(excludes);
  }
}
