{
  if (lastElement >= offsets.length) {
    int oldLen=offsets.length;
    offsets=ArrayUtil.grow(offsets,offsets.length + 1);
    bytesUsed.addAndGet((offsets.length - oldLen) * RamUsageEstimator.NUM_BYTES_INT);
  }
  pool.copy(bytes);
  offsets[lastElement++]=currentOffset;
  currentOffset+=bytes.length;
  return lastElement;
}
