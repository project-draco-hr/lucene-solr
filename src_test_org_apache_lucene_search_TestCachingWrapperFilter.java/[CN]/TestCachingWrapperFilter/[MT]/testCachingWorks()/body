{
  Directory dir=new RAMDirectory();
  IndexWriter writer=new IndexWriter(dir,new StandardAnalyzer(TEST_VERSION_CURRENT),true,IndexWriter.MaxFieldLength.LIMITED);
  writer.close();
  IndexReader reader=IndexReader.open(dir,true);
  MockFilter filter=new MockFilter();
  CachingWrapperFilter cacher=new CachingWrapperFilter(filter);
  cacher.getDocIdSet(reader);
  assertTrue("first time",filter.wasCalled());
  cacher.getDocIdSet(reader);
  filter.clear();
  cacher.getDocIdSet(reader);
  assertFalse("second time",filter.wasCalled());
  reader.close();
}
