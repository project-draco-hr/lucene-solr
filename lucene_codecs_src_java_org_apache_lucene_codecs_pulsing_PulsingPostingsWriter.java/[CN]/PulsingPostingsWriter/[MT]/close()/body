{
  wrappedPostingsWriter.close();
  if (wrappedPostingsWriter instanceof PulsingPostingsWriter || VERSION_CURRENT < VERSION_META_ARRAY) {
    return;
  }
  String summaryFileName=IndexFileNames.segmentFileName(segmentState.segmentInfo.name,segmentState.segmentSuffix,SUMMARY_EXTENSION);
  IndexOutput out=null;
  try {
    out=segmentState.directory.createOutput(summaryFileName,segmentState.context);
    CodecUtil.writeHeader(out,CODEC,VERSION_CURRENT);
    out.writeVInt(fields.size());
    for (    FieldMetaData field : fields) {
      out.writeVInt(field.fieldNumber);
      out.writeVInt(field.longsSize);
    }
    out.close();
  }
  finally {
    IOUtils.closeWhileHandlingException(out);
  }
}
