{
  try {
    if (query instanceof BoostQuery) {
      BoostQuery boostQuery=(BoostQuery)query;
      getTerms(boostQuery.getQuery(),boost * boostQuery.getBoost(),terms,prohibited,fieldName);
    }
 else     if (query instanceof BooleanQuery)     getTermsFromBooleanQuery((BooleanQuery)query,boost,terms,prohibited,fieldName);
 else {
      HashSet<Term> nonWeightedTerms=new HashSet<>();
      try {
        EMPTY_INDEXSEARCHER.createNormalizedWeight(query,false).extractTerms(nonWeightedTerms);
      }
 catch (      IOException bogus) {
        throw new RuntimeException("Should not happen on an empty index",bogus);
      }
      for (Iterator<Term> iter=nonWeightedTerms.iterator(); iter.hasNext(); ) {
        Term term=iter.next();
        if ((fieldName == null) || (term.field().equals(fieldName))) {
          terms.add(new WeightedTerm(boost,term.text()));
        }
      }
    }
  }
 catch (  UnsupportedOperationException ignore) {
  }
}
