{
  for (int port=0; port < 65535; port++) {
    Socket s=new Socket();
    try {
      s.bind(null);
      int availablePort=s.getLocalPort();
      s.close();
      return availablePort;
    }
 catch (    IOException e) {
      e.printStackTrace();
    }
  }
  throw new RuntimeException("Could not find unused TCP port.");
}
