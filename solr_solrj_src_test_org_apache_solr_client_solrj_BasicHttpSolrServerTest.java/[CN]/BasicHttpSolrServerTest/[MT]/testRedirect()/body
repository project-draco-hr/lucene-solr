{
  HttpSolrServer server=new HttpSolrServer("http://127.0.0.1:" + jetty.getLocalPort() + "/solr/redirect/foo");
  SolrQuery q=new SolrQuery("*:*");
  try {
    QueryResponse response=server.query(q);
    fail("Should have thrown an exception.");
  }
 catch (  SolrServerException e) {
    assertTrue(e.getMessage().contains("redirect"));
  }
  server.setFollowRedirects(true);
  try {
    QueryResponse response=server.query(q);
  }
 catch (  Throwable t) {
    fail("Exception was thrown:" + t);
  }
}
