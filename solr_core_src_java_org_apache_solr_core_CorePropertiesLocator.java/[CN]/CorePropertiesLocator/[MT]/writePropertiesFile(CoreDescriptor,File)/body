{
  Properties p=buildCoreProperties(cd);
  OutputStream os=null;
  try {
    os=new FileOutputStream(propfile);
    Writer writer=new OutputStreamWriter(os,Charsets.UTF_8);
    p.store(writer,"Written by CorePropertiesLocator on " + new Date());
    writer.close();
  }
 catch (  IOException e) {
    logger.error("Couldn't persist core properties to {}: {}",propfile.getAbsolutePath(),e);
  }
 finally {
    if (os != null)     IOUtils.closeQuietly(os);
  }
}
