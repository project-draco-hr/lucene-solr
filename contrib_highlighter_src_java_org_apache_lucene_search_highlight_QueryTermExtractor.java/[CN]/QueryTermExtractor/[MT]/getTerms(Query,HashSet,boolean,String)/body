{
  try {
    if (query instanceof BooleanQuery)     getTermsFromBooleanQuery((BooleanQuery)query,terms,prohibited,fieldName);
 else     if (query instanceof FilteredQuery)     getTermsFromFilteredQuery((FilteredQuery)query,terms,prohibited,fieldName);
 else {
      HashSet nonWeightedTerms=new HashSet();
      query.extractTerms(nonWeightedTerms);
      for (Iterator iter=nonWeightedTerms.iterator(); iter.hasNext(); ) {
        Term term=(Term)iter.next();
        if ((fieldName == null) || (term.field() == fieldName)) {
          terms.add(new WeightedTerm(query.getBoost(),term.text()));
        }
      }
    }
  }
 catch (  UnsupportedOperationException ignore) {
  }
}
