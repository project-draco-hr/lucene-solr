{
  if (VERBOSE) {
    System.out.println("nrtdir.deleteFiles names=" + names);
  }
  Set<String> cacheToDelete=new HashSet<>();
  Set<String> toDelete=new HashSet<>();
  for (  String name : names) {
    if (cache.fileNameExists(name)) {
      cacheToDelete.add(name);
    }
 else {
      toDelete.add(name);
    }
  }
  try {
    cache.deleteFiles(cacheToDelete);
  }
  finally {
    in.deleteFiles(toDelete);
  }
}
