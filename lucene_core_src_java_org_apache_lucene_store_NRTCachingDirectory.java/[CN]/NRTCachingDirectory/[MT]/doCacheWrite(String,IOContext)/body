{
  long bytes=0;
  if (context.mergeInfo != null) {
    bytes=context.mergeInfo.estimatedMergeBytes;
  }
 else   if (context.flushInfo != null) {
    bytes=context.flushInfo.estimatedSegmentSize;
  }
  return (bytes <= maxMergeSizeBytes) && (bytes + cache.ramBytesUsed()) <= maxCachedBytes;
}
