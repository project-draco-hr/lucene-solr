{
  final Set<String> files=new HashSet<>();
  for (  String f : cache.listAll()) {
    files.add(f);
  }
  for (  String f : in.listAll()) {
    if (!files.add(f)) {
      throw new IllegalStateException("file: " + in + " appears both in delegate and in cache: "+ "cache="+ Arrays.toString(cache.listAll())+ ",delegate="+ Arrays.toString(in.listAll()));
    }
  }
  String[] result=files.toArray(new String[files.size()]);
  Arrays.sort(result);
  return result;
}
