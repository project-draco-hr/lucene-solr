{
  CharArraySet stopWordsSet=new CharArraySet(TEST_VERSION_CURRENT,asSet("good","test","analyzer"),false);
  StopAnalyzer newStop=new StopAnalyzer(TEST_VERSION_CURRENT,stopWordsSet);
  StringReader reader=new StringReader("This is a good test of the english stop analyzer with positions");
  int expectedIncr[]={1,1,1,3,1,1,1,2,1};
  TokenStream stream=newStop.tokenStream("test",reader);
  assertNotNull(stream);
  int i=0;
  CharTermAttribute termAtt=stream.getAttribute(CharTermAttribute.class);
  PositionIncrementAttribute posIncrAtt=stream.addAttribute(PositionIncrementAttribute.class);
  stream.reset();
  while (stream.incrementToken()) {
    String text=termAtt.toString();
    assertFalse(stopWordsSet.contains(text));
    assertEquals(expectedIncr[i++],posIncrAtt.getPositionIncrement());
  }
}
