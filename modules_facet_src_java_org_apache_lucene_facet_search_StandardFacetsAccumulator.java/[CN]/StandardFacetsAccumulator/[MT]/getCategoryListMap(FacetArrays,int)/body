{
  HashMap<CategoryListIterator,Aggregator> categoryLists=new HashMap<CategoryListIterator,Aggregator>();
  for (  FacetRequest facetRequest : searchParams.getFacetRequests()) {
    Aggregator categoryAggregator=facetRequest.createAggregator(isUsingComplements,facetArrays,indexReader,taxonomyReader);
    CategoryListIterator cli=facetRequest.createCategoryListIterator(indexReader,taxonomyReader,searchParams,partition);
    Aggregator old=categoryLists.put(cli,categoryAggregator);
    if (old != null && !old.equals(categoryAggregator)) {
      throw new RuntimeException("Overriding existing category list with different aggregator. THAT'S A NO NO!");
    }
  }
  return categoryLists;
}
