{
  List<CharSequence[]> docListOfFields=new ArrayList<>(cacheCharsThreshold == 0 ? 1 : (int)Math.min(64,docIter.cost()));
  LimitedStoredFieldVisitor visitor=newLimitedStoredFieldsVisitor(fields);
  int sumChars=0;
  do {
    int docId=docIter.nextDoc();
    if (docId == DocIdSetIterator.NO_MORE_DOCS) {
      break;
    }
    visitor.init();
    searcher.doc(docId,visitor);
    CharSequence[] valuesByField=visitor.getValuesByField();
    docListOfFields.add(valuesByField);
    for (    CharSequence val : valuesByField) {
      sumChars+=(val == null ? 0 : val.length());
    }
  }
 while (sumChars <= cacheCharsThreshold && cacheCharsThreshold != 0);
  return docListOfFields;
}
