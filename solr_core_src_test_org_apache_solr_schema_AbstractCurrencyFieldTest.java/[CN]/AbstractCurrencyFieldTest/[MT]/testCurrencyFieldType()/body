{
  SolrCore core=h.getCore();
  IndexSchema schema=core.getLatestSchema();
  SchemaField amount=schema.getField(field());
  assertNotNull(amount);
  assertTrue(field() + " is not a poly field",amount.isPolyField());
  FieldType tmp=amount.getType();
  assertTrue(tmp instanceof CurrencyField);
  String currencyValue="1.50,EUR";
  List<IndexableField> fields=amount.createFields(currencyValue,2);
  assertEquals(fields.size(),3);
  for (int i=0; i < 3; i++) {
    boolean hasValue=fields.get(i).readerValue() != null || fields.get(i).numericValue() != null || fields.get(i).stringValue() != null;
    assertTrue("Doesn't have a value: " + fields.get(i),hasValue);
  }
  assertEquals(schema.getFieldTypeByName("string").toExternal(fields.get(2)),"1.50,EUR");
  ExchangeRateProvider p=((CurrencyField)tmp).getProvider();
  Set<String> availableCurrencies=p.listAvailableCurrencies();
  assertEquals(5,availableCurrencies.size());
  assert(p.reload() == true);
  assert(p.getExchangeRate("USD","EUR") == 2.5);
}
