{
  Tuple tuple=_read();
  if (tuple.EOF) {
    Map m=new HashMap();
    m.put("EOF",true);
    Tuple t=new Tuple(m);
    Map<String,Map> metrics=new HashMap();
    Iterator<Entry<String,Tuple>> it=this.eofTuples.entrySet().iterator();
    while (it.hasNext()) {
      Map.Entry<String,Tuple> entry=it.next();
      metrics.put(entry.getKey(),entry.getValue().fields);
    }
    t.setMetrics(metrics);
    return t;
  }
  return tuple;
}
