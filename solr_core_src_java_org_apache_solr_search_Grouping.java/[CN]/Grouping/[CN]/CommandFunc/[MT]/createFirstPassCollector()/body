{
  if (actualGroupsToFind <= 0) {
    fallBackCollector=new TotalHitCountCollector();
    return fallBackCollector;
  }
  groupSort=groupSort == null ? Sort.RELEVANCE : groupSort;
  firstPass=new FunctionFirstPassGroupingCollector(groupBy,context,searcher.weightSort(groupSort),actualGroupsToFind);
  return firstPass;
}
