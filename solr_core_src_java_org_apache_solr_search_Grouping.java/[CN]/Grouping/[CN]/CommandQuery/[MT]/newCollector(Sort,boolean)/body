{
  int groupDocsToCollect=getMax(groupOffset,docsPerGroup,maxDoc);
  if (sort == null || sort.equals(Sort.RELEVANCE)) {
    return TopScoreDocCollector.create(groupDocsToCollect);
  }
 else {
    return TopFieldCollector.create(searcher.weightSort(sort),groupDocsToCollect,false,needScores,needScores);
  }
}
