{
  IndexWriter writer=new IndexWriter(dir,newIndexWriterConfig(TEST_VERSION_CURRENT,new MockAnalyzer(random,MockTokenizer.WHITESPACE,false)).setMergePolicy(newLogMergePolicy(10)));
  TokenStream payloadTS1=new PayloadTokenStream("p1");
  TokenStream payloadTS2=new PayloadTokenStream("p2");
  for (int i=0; i < NUM_DOCS; i++) {
    Document doc=new Document();
    doc.add(newField("id","doc" + i,Store.NO,Index.NOT_ANALYZED_NO_NORMS));
    doc.add(newField("content","doc content " + i,Store.NO,Index.ANALYZED));
    doc.add(new Field("p",payloadTS1));
    doc.add(new Field("p",payloadTS2));
    writer.addDocument(doc);
    if (multipleCommits && (i % 4 == 0)) {
      writer.commit();
    }
  }
  writer.close();
}
