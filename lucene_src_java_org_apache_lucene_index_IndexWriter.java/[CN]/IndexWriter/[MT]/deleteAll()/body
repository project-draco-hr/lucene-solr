{
  ensureOpen();
  boolean success=false;
  try {
    finishMerges(false);
    docWriter.abort();
    segmentInfos.clear();
    deleter.checkpoint(segmentInfos,false);
    deleter.refresh();
    readerPool.dropAll();
    ++changeCount;
    segmentInfos.changed();
    success=true;
  }
 catch (  OutOfMemoryError oom) {
    handleOOM(oom,"deleteAll");
  }
 finally {
    if (!success) {
      if (infoStream.isEnabled("IW")) {
        infoStream.message("IW","hit exception during deleteAll");
      }
    }
  }
}
