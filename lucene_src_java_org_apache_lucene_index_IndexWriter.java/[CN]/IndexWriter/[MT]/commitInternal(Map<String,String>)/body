{
  if (infoStream != null) {
    infoStream.message("IW","commit: start");
  }
synchronized (commitLock) {
    if (infoStream != null) {
      infoStream.message("IW","commit: enter lock");
    }
    if (pendingCommit == null) {
      if (infoStream != null) {
        infoStream.message("IW","commit: now prepare");
      }
      prepareCommit(commitUserData);
    }
 else     if (infoStream != null) {
      infoStream.message("IW","commit: already prepared");
    }
    finishCommit();
  }
}
