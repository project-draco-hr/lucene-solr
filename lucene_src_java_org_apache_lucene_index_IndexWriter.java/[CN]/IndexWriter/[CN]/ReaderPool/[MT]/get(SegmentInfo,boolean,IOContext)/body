{
  SegmentCacheKey cacheKey=new SegmentCacheKey(info,context.context);
  SegmentReader sr=readerMap.get(cacheKey);
  if (sr == null) {
    sr=SegmentReader.get(false,info.dir,info,doOpenStores,context.context == IOContext.Context.MERGE ? -1 : config.getReaderTermsIndexDivisor(),context);
    sr.readerFinishedListeners=readerFinishedListeners;
    if (info.dir == directory) {
      readerMap.put(cacheKey,sr);
    }
  }
 else {
    if (doOpenStores) {
      sr.openDocStores();
    }
  }
  if (info.dir == directory) {
    sr.incRef();
  }
  return sr;
}
