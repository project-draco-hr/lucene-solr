{
  super.setUp();
  log.info("####SETUP_START " + getTestName());
  boolean useNewSolrXml=random().nextBoolean();
  File tmpDir=createTempDir().toFile();
  if (useNewSolrXml) {
    solrHome=ExternalPaths.EXAMPLE_HOME;
  }
 else {
    File tmpSolrHome=new File(tmpDir,"tmp-solr-home");
    FileUtils.copyDirectory(new File(ExternalPaths.EXAMPLE_HOME),tmpSolrHome);
    FileUtils.copyFile(getFile("old-solr-example/solr.xml"),new File(tmpSolrHome,"solr.xml"));
    solrHome=tmpSolrHome.getAbsolutePath();
  }
  zkDir=tmpDir.getAbsolutePath() + File.separator + "zookeeper/server1/data";
  log.info("ZooKeeper dataDir:" + zkDir);
  zkServer=new ZkTestServer(zkDir);
  zkServer.run();
  System.setProperty("zkHost",zkServer.getZkAddress());
  SolrZkClient zkClient=new SolrZkClient(zkServer.getZkHost(),AbstractZkTestCase.TIMEOUT);
  zkClient.makePath("/solr",false,true);
  zkClient.close();
  this.zkClient=new SolrZkClient(zkServer.getZkAddress(),AbstractZkTestCase.TIMEOUT);
  log.info("####SETUP_END " + getTestName());
}
