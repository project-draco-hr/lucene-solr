{
  final CloudSolrClient client=cluster.getSolrClient();
  RequestStatusState state=new Create().setCollectionName("testasynccollectioncreation").setNumShards(1).setReplicationFactor(1).setConfigName("conf1").processAndWait(client,MAX_TIMEOUT_SECONDS);
  assertSame("CreateCollection task did not complete!",RequestStatusState.COMPLETED,state);
  state=new Create().setCollectionName("testasynccollectioncreation").setNumShards(1).setConfigName("conf1").processAndWait(client,MAX_TIMEOUT_SECONDS);
  assertSame("Recreating a collection with the same should have failed.",RequestStatusState.FAILED,state);
  state=new CollectionAdminRequest.AddReplica().setCollectionName("testasynccollectioncreation").setShardName("shard1").processAndWait(client,MAX_TIMEOUT_SECONDS);
  assertSame("Add replica did not complete",RequestStatusState.COMPLETED,state);
  state=new SplitShard().setCollectionName("testasynccollectioncreation").setShardName("shard1").processAndWait(client,MAX_TIMEOUT_SECONDS * 2);
  assertEquals("Shard split did not complete. Last recorded state: " + state,RequestStatusState.COMPLETED,state);
}
