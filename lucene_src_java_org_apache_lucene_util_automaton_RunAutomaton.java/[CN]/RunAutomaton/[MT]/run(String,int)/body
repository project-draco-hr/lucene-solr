{
  int p=initial;
  int l=s.length();
  int max=-1;
  for (int r=0; offset <= l; offset++, r++) {
    if (accept[p])     max=r;
    if (offset == l)     break;
    p=step(p,s.charAt(offset));
    if (p == -1)     break;
  }
  return max;
}
