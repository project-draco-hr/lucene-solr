{
  MMapDirectory mmapDir=new MMapDirectory(_TestUtil.getTempDir("testCloneClose"));
  IndexOutput io=mmapDir.createOutput("bytes",newIOContext(random()));
  io.writeVInt(5);
  io.close();
  IndexInput one=mmapDir.openInput("bytes",IOContext.DEFAULT);
  IndexInput two=one.clone();
  IndexInput three=two.clone();
  two.close();
  assertEquals(5,one.readVInt());
  try {
    two.readVInt();
    fail("Must throw AlreadyClosedException");
  }
 catch (  AlreadyClosedException ignore) {
  }
  assertEquals(5,three.readVInt());
  one.close();
  three.close();
  mmapDir.close();
}
