{
  Document doc=new Document();
  doc.add(new StringField("id",id,Field.Store.YES));
  if (shape != null) {
    Collection<Shape> shapes;
    if (shape instanceof ShapePair) {
      shapes=new ArrayList<>(2);
      shapes.add(((ShapePair)shape).shape1);
      shapes.add(((ShapePair)shape).shape2);
    }
 else {
      shapes=Collections.singleton(shape);
    }
    for (    Shape shapei : shapes) {
      for (      Field f : strategy.createIndexableFields(shapei)) {
        doc.add(f);
      }
    }
    if (storeShape)     doc.add(new StoredField(strategy.getFieldName(),shape.toString()));
  }
  return doc;
}
