{
  Map<Class,SnitchInfoImpl> snitches=new LinkedHashMap<>();
  if (snitchConf == null)   return snitches;
  for (  Object o : snitchConf) {
    String klas=null;
    Map map=Collections.emptyMap();
    if (o instanceof Map) {
      map=(Map)o;
      klas=(String)map.get("class");
      if (klas == null) {
        throw new SolrException(SolrException.ErrorCode.BAD_REQUEST,"snitch must have  a class attribute");
      }
    }
 else {
      klas=o.toString();
    }
    try {
      if (klas.indexOf('.') == -1)       klas=Snitch.class.getPackage().getName() + "." + klas;
      Snitch inst=cc == null ? (Snitch)Snitch.class.getClassLoader().loadClass(klas).newInstance() : cc.getResourceLoader().newInstance(klas,Snitch.class);
      snitches.put(inst.getClass(),new SnitchInfoImpl(map,inst,cc));
    }
 catch (    Exception e) {
      throw new SolrException(SolrException.ErrorCode.SERVER_ERROR,e);
    }
  }
  return snitches;
}
