{
  super.setUp();
  random=newRandom();
  dir=newDirectory(random);
  IndexWriter w=new IndexWriter(dir,newIndexWriterConfig(random,TEST_VERSION_CURRENT,new MockAnalyzer()));
  Document doc;
  for (int i=0; i < NUM_DOCS; i++) {
    doc=new Document();
    doc.add(new Field("id",i + "",Field.Store.YES,Field.Index.NOT_ANALYZED));
    doc.add(new Field("f",i + " " + i,Field.Store.YES,Field.Index.ANALYZED));
    w.addDocument(doc);
  }
  w.close();
  input=IndexReader.open(dir,false);
  input.deleteDocument(input.maxDoc() - 1);
  IndexReader inputOld=input;
  input=input.reopen(true);
  inputOld.close();
}
