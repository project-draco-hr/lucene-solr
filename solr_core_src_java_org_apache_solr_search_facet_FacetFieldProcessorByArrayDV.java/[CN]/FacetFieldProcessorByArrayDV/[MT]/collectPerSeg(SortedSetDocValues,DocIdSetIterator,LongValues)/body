{
  int segMax=(int)multiDv.getValueCount();
  final int[] counts=getCountArr(segMax);
  int doc;
  while ((doc=disi.nextDoc()) != DocIdSetIterator.NO_MORE_DOCS) {
    multiDv.setDocument(doc);
    for (; ; ) {
      int segOrd=(int)multiDv.nextOrd();
      if (segOrd < 0)       break;
      counts[segOrd]++;
    }
  }
  for (int i=0; i < segMax; i++) {
    int segCount=counts[i];
    if (segCount > 0) {
      int slot=toGlobal == null ? (i) : (int)toGlobal.get(i);
      countAcc.incrementCount(slot,segCount);
    }
  }
}
