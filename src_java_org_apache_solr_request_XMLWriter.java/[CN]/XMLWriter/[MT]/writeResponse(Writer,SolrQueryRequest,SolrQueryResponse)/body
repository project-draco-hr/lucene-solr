{
  int qtime=(int)(rsp.getEndTime() - req.getStartTime());
  String ver=req.getParam("version");
  writer.write(XML_START1);
  String stylesheet=req.getParam("stylesheet");
  if (stylesheet != null && stylesheet.length() > 0) {
    writer.write(XML_STYLESHEET);
    writer.write(stylesheet);
    writer.write(XML_STYLESHEET_END);
  }
  String noSchema=req.getParam("noSchema");
  if (false && noSchema == null)   writer.write(XML_START2_SCHEMA);
 else   writer.write(XML_START2_NOSCHEMA);
  writer.write("<responseHeader><status>");
  writer.write('0');
  writer.write("</status><QTime>");
  writer.write(Integer.toString((int)qtime));
  writer.write("</QTime></responseHeader>\n");
  XMLWriter xw=new XMLWriter(writer,req.getSchema(),req.getSearcher(),ver);
  xw.defaultFieldList=rsp.getReturnFields();
  String indent=req.getParam("indent");
  if (indent != null) {
    if ("".equals(indent) || "off".equals(indent)) {
      xw.setIndent(false);
    }
 else {
      xw.setIndent(true);
    }
  }
  NamedList lst=rsp.getValues();
  int sz=lst.size();
  for (int i=0; i < sz; i++) {
    xw.writeVal(lst.getName(i),lst.getVal(i));
  }
  writer.write("\n</response>\n");
}
