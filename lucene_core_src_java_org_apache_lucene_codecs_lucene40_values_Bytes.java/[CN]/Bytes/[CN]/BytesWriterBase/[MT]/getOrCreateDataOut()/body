{
  if (datOut == null) {
    boolean success=false;
    try {
      datOut=dir.createOutput(IndexFileNames.segmentFileName(id,DV_SEGMENT_SUFFIX,DocValuesWriterBase.DATA_EXTENSION),context);
      CodecUtil.writeHeader(datOut,codecName,version);
      success=true;
    }
  finally {
      if (!success) {
        IOUtils.closeWhileHandlingException(datOut);
      }
    }
  }
  return datOut;
}
