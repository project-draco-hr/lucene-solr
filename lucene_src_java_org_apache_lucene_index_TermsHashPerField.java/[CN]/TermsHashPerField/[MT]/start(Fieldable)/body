{
  if (fieldState.attributeSource.hasAttribute(TermToBytesRefAttribute.class)) {
    termAtt=fieldState.attributeSource.getAttribute(TermToBytesRefAttribute.class);
  }
 else   if (fieldState.attributeSource.hasAttribute(TermAttribute.class)) {
    perThread.legacyTermAttributeWrapper.setTermAttribute(fieldState.attributeSource.getAttribute(TermAttribute.class));
    termAtt=perThread.legacyTermAttributeWrapper;
  }
 else {
    throw new IllegalArgumentException("Could not find a term attribute (that implements TermToBytesRefAttribute) in the TokenStream");
  }
  consumer.start(f);
  if (nextPerField != null) {
    nextPerField.start(f);
  }
}
