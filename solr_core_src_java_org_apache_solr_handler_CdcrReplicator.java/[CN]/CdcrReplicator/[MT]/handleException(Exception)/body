{
  if (e instanceof CdcrReplicatorException) {
    UpdateRequest req=((CdcrReplicatorException)e).req;
    UpdateResponse rsp=((CdcrReplicatorException)e).rsp;
    log.warn("Failed to forward update request {}. Got response {}",req,rsp);
    state.reportError(CdcrReplicatorState.ErrorType.BAD_REQUEST);
  }
 else   if (e instanceof CloudSolrClient.RouteException) {
    log.warn("Failed to forward update request",e);
    state.reportError(CdcrReplicatorState.ErrorType.BAD_REQUEST);
  }
 else {
    log.warn("Failed to forward update request",e);
    state.reportError(CdcrReplicatorState.ErrorType.INTERNAL);
  }
}
