{
  List entry=(List)o;
  int operationAndFlags=(Integer)entry.get(0);
  int oper=operationAndFlags & UpdateLog.OPERATION_MASK;
  long version=(Long)entry.get(1);
  state.getBenchmarkTimer().incrementCounter(oper);
switch (oper) {
case UpdateLog.ADD:
{
      SolrInputDocument sdoc=(SolrInputDocument)entry.get(entry.size() - 1);
      req.add(sdoc);
      return req;
    }
case UpdateLog.DELETE:
{
    byte[] idBytes=(byte[])entry.get(2);
    req.deleteById(new String(idBytes,Charset.forName("UTF-8")));
    req.setParam(DistributedUpdateProcessor.VERSION_FIELD,Long.toString(version));
    return req;
  }
case UpdateLog.DELETE_BY_QUERY:
{
  String query=(String)entry.get(2);
  req.deleteByQuery(query);
  req.setParam(DistributedUpdateProcessor.VERSION_FIELD,Long.toString(version));
  return req;
}
case UpdateLog.COMMIT:
{
return null;
}
default :
throw new SolrException(SolrException.ErrorCode.SERVER_ERROR,"Unknown Operation! " + oper);
}
}
