{
  if (responseWriter instanceof BinaryQueryResponseWriter) {
    BinaryQueryResponseWriter binWriter=(BinaryQueryResponseWriter)responseWriter;
    binWriter.write(outputStream,solrRequest,solrResponse);
  }
 else {
    OutputStream out=new OutputStream(){
      @Override public void write(      int b) throws IOException {
        outputStream.write(b);
      }
      @Override public void flush() throws IOException {
      }
    }
;
    Writer writer=buildWriter(out,ContentStreamBase.getCharsetFromContentType(contentType));
    responseWriter.write(writer,solrRequest,solrResponse);
    writer.flush();
  }
}
