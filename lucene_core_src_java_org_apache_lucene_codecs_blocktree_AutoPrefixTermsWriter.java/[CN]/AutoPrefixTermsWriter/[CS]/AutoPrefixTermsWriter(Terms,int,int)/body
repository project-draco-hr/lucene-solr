{
  this.minItemsInPrefix=minItemsInPrefix;
  this.maxItemsInPrefix=maxItemsInPrefix;
  TermsEnum termsEnum=terms.iterator();
  while (true) {
    BytesRef term=termsEnum.next();
    if (term == null) {
      break;
    }
    pushTerm(term);
  }
  if (pending.size() > 1) {
    pushTerm(BlockTreeTermsWriter.EMPTY_BYTES_REF);
    while (pending.size() >= minItemsInPrefix) {
      savePrefixes(0,pending.size());
    }
  }
  Collections.sort(prefixes);
}
