{
  try {
    if (null != driverClassName) {
      Class.forName(driverClassName);
    }
  }
 catch (  ClassNotFoundException e) {
    throw new IOException(String.format(Locale.ROOT,"Failed to load JDBC driver for '%s'",driverClassName),e);
  }
  try {
    if (null == DriverManager.getDriver(connectionUrl)) {
      throw new SQLException("DriverManager.getDriver(url) returned null");
    }
  }
 catch (  SQLException e) {
    throw new IOException(String.format(Locale.ROOT,"Failed to determine JDBC driver from connection url '%s'. Usually this means the driver is not loaded - you can have JDBCStream try to load it by providing the 'driverClassName' value",connectionUrl),e);
  }
  try {
    connection=DriverManager.getConnection(connectionUrl,connectionProperties);
  }
 catch (  SQLException e) {
    throw new IOException(String.format(Locale.ROOT,"Failed to open JDBC connection to '%s'",connectionUrl),e);
  }
  try {
    statement=connection.createStatement();
  }
 catch (  SQLException e) {
    throw new IOException(String.format(Locale.ROOT,"Failed to create a statement from JDBC connection '%s'",connectionUrl),e);
  }
  try {
    resultSet=statement.executeQuery(sqlQuery);
  }
 catch (  SQLException e) {
    throw new IOException(String.format(Locale.ROOT,"Failed to execute sqlQuery '%s' against JDBC connection '%s'",sqlQuery,connectionUrl),e);
  }
  try {
    valueSelectors=constructValueSelectors(resultSet.getMetaData());
  }
 catch (  SQLException e) {
    throw new IOException(String.format(Locale.ROOT,"Failed to generate value selectors for sqlQuery '%s' against JDBC connection '%s'",sqlQuery,connectionUrl),e);
  }
}
