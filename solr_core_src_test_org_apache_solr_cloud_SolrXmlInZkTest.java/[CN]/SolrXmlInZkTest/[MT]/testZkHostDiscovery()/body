{
  System.clearProperty("zkHost");
  try {
    Method method=SolrDispatchFilter.class.getDeclaredMethod("loadConfigSolr",SolrResourceLoader.class);
    method.setAccessible(true);
    if (solrDispatchFilter != null)     solrDispatchFilter.destroy();
    solrDispatchFilter=new SolrDispatchFilter();
    method.invoke(solrDispatchFilter,new SolrResourceLoader(null));
    fail("Should have thrown an exception");
  }
 catch (  InvocationTargetException ite) {
    assertTrue("Should be catching a SolrException",ite.getTargetException() instanceof SolrException);
    assertEquals("Caught Solr exception",ite.getTargetException().getMessage(),"Could not load solr.xml from zookeeper: zkHost system property not set");
  }
}
