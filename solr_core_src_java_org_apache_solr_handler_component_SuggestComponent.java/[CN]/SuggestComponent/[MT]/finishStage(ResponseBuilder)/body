{
  SolrParams params=rb.req.getParams();
  LOG.info("Suggester finishStage with : " + params);
  if (!params.getBool(COMPONENT_NAME,false) || rb.stage != ResponseBuilder.STAGE_GET_FIELDS)   return;
  int count=params.getInt(SUGGEST_COUNT,1);
  List<SuggesterResult> suggesterResults=new ArrayList<SuggesterResult>();
  NamedList response=new SimpleOrderedMap();
  NamedList<NamedList> namedListResult=null;
  for (  ShardRequest sreq : rb.finished) {
    for (    ShardResponse srsp : sreq.responses) {
      NamedList<NamedList> namedList=(NamedList<NamedList>)srsp.getSolrResponse().getResponse().get(SuggesterResultLabels.SUGGEST);
      LOG.info(srsp.getShard() + " : " + namedList);
      suggesterResults.add(toSuggesterResult(namedList));
    }
  }
  SuggesterResult suggesterResult=merge(suggesterResults,count);
  namedListResult=toNamedList(suggesterResult);
  response.add(SuggesterResultLabels.SUGGESTIONS,namedListResult);
  rb.rsp.add(SuggesterResultLabels.SUGGEST,response);
}
