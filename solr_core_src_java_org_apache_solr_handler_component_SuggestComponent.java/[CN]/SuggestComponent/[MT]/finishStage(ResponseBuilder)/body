{
  SolrParams params=rb.req.getParams();
  LOG.info("SuggestComponent finishStage with : " + params);
  if (!params.getBool(COMPONENT_NAME,false) || rb.stage != ResponseBuilder.STAGE_GET_FIELDS)   return;
  int count=params.getInt(SUGGEST_COUNT,1);
  List<SuggesterResult> suggesterResults=new ArrayList<SuggesterResult>();
  NamedList<NamedList<Object>> namedListResult=null;
  for (  ShardRequest sreq : rb.finished) {
    for (    ShardResponse srsp : sreq.responses) {
      NamedList<Object> resp;
      if ((resp=srsp.getSolrResponse().getResponse()) != null) {
        @SuppressWarnings("unchecked") NamedList<NamedList<Object>> namedList=(NamedList<NamedList<Object>>)resp.get(SuggesterResultLabels.SUGGEST);
        LOG.info(srsp.getShard() + " : " + namedList);
        suggesterResults.add(toSuggesterResult(namedList));
      }
    }
  }
  SuggesterResult suggesterResult=merge(suggesterResults,count);
  namedListResult=toNamedList(suggesterResult);
  rb.rsp.add(SuggesterResultLabels.SUGGEST,namedListResult);
}
