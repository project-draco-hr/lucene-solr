{
  try {
    directory=new RAMDirectory();
    IndexWriter writer=new IndexWriter(directory,analyzer,true,IndexWriter.MaxFieldLength.UNLIMITED);
    for (int row=0; row < tableModel.getRowCount(); row++) {
      Document document=new Document();
      document.add(new Field(ROW_NUMBER,"" + row,Field.Store.YES,Field.Index.ANALYZED));
      for (int column=0; column < tableModel.getColumnCount(); column++) {
        String columnName=tableModel.getColumnName(column);
        String columnValue=String.valueOf(tableModel.getValueAt(row,column)).toLowerCase();
        document.add(new Field(columnName,columnValue,Field.Store.YES,Field.Index.ANALYZED));
      }
      writer.addDocument(document);
    }
    writer.optimize();
    writer.close();
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
}
