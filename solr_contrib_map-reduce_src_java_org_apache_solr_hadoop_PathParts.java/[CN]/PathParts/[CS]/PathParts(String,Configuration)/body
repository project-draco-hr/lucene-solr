{
  if (uploadURL == null) {
    throw new IllegalArgumentException("Path must not be null: " + uploadURL);
  }
  this.uploadURL=uploadURL;
  if (conf == null) {
    throw new IllegalArgumentException("Configuration must not be null: " + uploadURL);
  }
  this.conf=conf;
  URI uri=stringToUri(uploadURL);
  this.fs=FileSystem.get(uri,conf);
  if (fs == null) {
    throw new IllegalArgumentException("File system must not be null: " + uploadURL);
  }
  this.normalizedPath=fs.makeQualified(new Path(uri));
  if (!normalizedPath.isAbsolute()) {
    throw new IllegalArgumentException("Path must be absolute: " + uploadURL);
  }
  if (getScheme() == null) {
    throw new IllegalArgumentException("Scheme must not be null: " + uploadURL);
  }
  if (getHost() == null) {
    throw new IllegalArgumentException("Host must not be null: " + uploadURL);
  }
  if (getPort() < 0) {
    throw new IllegalArgumentException("Port must not be negative: " + uploadURL);
  }
}
