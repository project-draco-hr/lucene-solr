{
  log.info("Create shard: " + req.getParamString());
  req.getParams().required().check(COLLECTION_PROP,SHARD_ID_PROP);
  ClusterState clusterState=coreContainer.getZkController().getClusterState();
  if (!ImplicitDocRouter.NAME.equals(clusterState.getCollection(req.getParams().get(COLLECTION_PROP)).getStr(ROUTER)))   throw new SolrException(ErrorCode.BAD_REQUEST,"shards can be added only to 'implicit' collections");
  Map<String,Object> map=OverseerCollectionProcessor.asMap(QUEUE_OPERATION,CREATESHARD);
  copyIfNotNull(req.getParams(),map,COLLECTION_PROP,SHARD_ID_PROP,REPLICATION_FACTOR);
  ZkNodeProps m=new ZkNodeProps(map);
  handleResponse(CREATESHARD,m,rsp);
}
