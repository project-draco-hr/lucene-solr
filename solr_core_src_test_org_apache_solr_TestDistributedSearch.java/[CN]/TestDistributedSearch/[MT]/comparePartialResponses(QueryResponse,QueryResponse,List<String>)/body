{
  NamedList<?> sinfo=(NamedList<?>)rsp.getResponse().get(ShardParams.SHARDS_INFO);
  assertNotNull("missing shard info",sinfo);
  assertEquals("should have an entry for each shard [" + sinfo + "] "+ shards,shardsArr.length,sinfo.size());
  for (  Map.Entry<String,?> entry : sinfo) {
    String shard=entry.getKey();
    NamedList<?> info=(NamedList<?>)entry.getValue();
    boolean found=false;
    for (int i=0; i < shardsArr.length; i++) {
      String s=shardsArr[i];
      if (shard.contains(s)) {
        found=true;
        if (upShards.contains(s)) {
          assertTrue("Expected to find shardAddress in the up shard info",info.get("shardAddress") != null);
        }
 else {
          assertEquals("Expected to find the partialResults header set if a shard is down",Boolean.TRUE,rsp.getHeader().get("partialResults"));
          assertTrue("Expected to find error in the down shard info",info.get("error") != null);
        }
      }
    }
    assertTrue("Couldn't find shard " + shard + " represented in shards info",found);
  }
}
