{
  List<Operation> ops=null;
  try {
    ops=SchemaManager.parse(rdr);
  }
 catch (  Exception e) {
    String msg="Error parsing schema operations ";
    log.warn(msg,e);
    return Collections.singletonList(singletonMap(ERR_MSGS,msg + ":" + e.getMessage()));
  }
  List errs=captureErrors(ops);
  if (!errs.isEmpty())   return errs;
  IndexSchema schema=req.getCore().getLatestSchema();
  if (!(schema instanceof ManagedIndexSchema)) {
    return singletonList(singletonMap(ERR_MSGS,"schema is not editable"));
  }
synchronized (schema.getSchemaUpdateLock()) {
    return doOperations(ops);
  }
}
