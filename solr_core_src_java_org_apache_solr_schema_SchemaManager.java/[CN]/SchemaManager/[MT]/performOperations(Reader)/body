{
  List<CommandOperation> ops;
  try {
    ops=CommandOperation.parse(reader);
  }
 catch (  Exception e) {
    String msg="Error parsing schema operations ";
    log.warn(msg,e);
    return Collections.singletonList(singletonMap(CommandOperation.ERR_MSGS,msg + ":" + e.getMessage()));
  }
  List errs=CommandOperation.captureErrors(ops);
  if (!errs.isEmpty())   return errs;
  IndexSchema schema=req.getCore().getLatestSchema();
  if (!(schema instanceof ManagedIndexSchema)) {
    return singletonList(singletonMap(CommandOperation.ERR_MSGS,"schema is not editable"));
  }
synchronized (schema.getSchemaUpdateLock()) {
    return doOperations(ops);
  }
}
