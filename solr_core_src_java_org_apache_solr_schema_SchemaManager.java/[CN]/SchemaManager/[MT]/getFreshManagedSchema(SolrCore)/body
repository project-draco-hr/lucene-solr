{
  SolrResourceLoader resourceLoader=core.getResourceLoader();
  String name=core.getLatestSchema().getResourceName();
  if (resourceLoader instanceof ZkSolrResourceLoader) {
    InputStream in=resourceLoader.openResource(name);
    if (in instanceof ZkSolrResourceLoader.ZkByteArrayInputStream) {
      int version=((ZkSolrResourceLoader.ZkByteArrayInputStream)in).getStat().getVersion();
      log.info("managed schema loaded . version : {} ",version);
      return new ManagedIndexSchema(core.getSolrConfig(),name,new InputSource(in),true,name,version,core.getLatestSchema().getSchemaUpdateLock());
    }
 else {
      return (ManagedIndexSchema)core.getLatestSchema();
    }
  }
 else {
    return (ManagedIndexSchema)core.getLatestSchema();
  }
}
