{
  Query dummy=pqF("DUMMY");
  FieldQuery fq=new FieldQuery(dummy,true,true);
  Set<Query> flatQueries=new HashSet<Query>();
  flatQueries.add(pqF("a","b"));
  flatQueries.add(pqF("c","d"));
  assertCollectionQueries(fq.expand(flatQueries),pqF("a","b"),pqF("c","d"));
  flatQueries=new HashSet<Query>();
  flatQueries.add(tq("a"));
  flatQueries.add(pqF("a","b"));
  assertCollectionQueries(fq.expand(flatQueries),tq("a"),pqF("a","b"));
  flatQueries=new HashSet<Query>();
  flatQueries.add(pqF("a","b"));
  flatQueries.add(tq("b"));
  assertCollectionQueries(fq.expand(flatQueries),pqF("a","b"),tq("b"));
  flatQueries=new HashSet<Query>();
  flatQueries.add(pqF("a","b","c"));
  flatQueries.add(pqF("b","c"));
  assertCollectionQueries(fq.expand(flatQueries),pqF("a","b","c"),pqF("b","c"));
  flatQueries=new HashSet<Query>();
  flatQueries.add(pqF("a","b"));
  flatQueries.add(pqF("a","b","c"));
  assertCollectionQueries(fq.expand(flatQueries),pqF("a","b"),pqF("a","b","c"));
  flatQueries=new HashSet<Query>();
  flatQueries.add(pqF("a","b","c"));
  flatQueries.add(pqF("b","d","e"));
  assertCollectionQueries(fq.expand(flatQueries),pqF("a","b","c"),pqF("b","d","e"));
}
