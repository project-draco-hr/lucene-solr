{
  BooleanQuery query=new BooleanQuery();
  query.add(new TermQuery(new Term(F,"AA")),Occur.MUST);
  query.add(toPhraseQuery(analyze("BCD",F,analyzerB),F),Occur.MUST);
  query.add(toPhraseQuery(analyze("EFGH",F,analyzerB),F),Occur.SHOULD);
  FieldQuery fq=new FieldQuery(query,true,true);
  Set<Query> flatQueries=new HashSet<>();
  fq.flatten(query,reader,flatQueries);
  assertCollectionQueries(flatQueries,tq("AA"),pqF("BC","CD"),pqF("EF","FG","GH"));
}
