{
  if (mlt == null) {
    throw new IOException("You must first call Classifier#train");
  }
  Query q;
  if (query != null) {
    Query mltQuery=mlt.like(new StringReader(text),textFieldName);
    BooleanQuery bq=new BooleanQuery();
    bq.add(query,BooleanClause.Occur.MUST);
    bq.add(mltQuery,BooleanClause.Occur.MUST);
    q=bq;
  }
 else {
    q=mlt.like(new StringReader(text),textFieldName);
  }
  TopDocs topDocs=indexSearcher.search(q,k);
  return selectClassFromNeighbors(topDocs);
}
