{
  Map<BytesRef,Integer> classCounts=new HashMap<BytesRef,Integer>();
  for (  ScoreDoc scoreDoc : topDocs.scoreDocs) {
    BytesRef cl=new BytesRef(indexSearcher.doc(scoreDoc.doc).getField(classFieldName).stringValue());
    if (cl != null) {
      Integer count=classCounts.get(cl);
      if (count != null) {
        classCounts.put(cl,count + 1);
      }
 else {
        classCounts.put(cl,1);
      }
    }
  }
  double max=0;
  BytesRef assignedClass=new BytesRef();
  for (  BytesRef cl : classCounts.keySet()) {
    Integer count=classCounts.get(cl);
    if (count > max) {
      max=count;
      assignedClass=cl.clone();
    }
  }
  double score=max / (double)k;
  return new ClassificationResult<BytesRef>(assignedClass,score);
}
