{
  Query filteredquery=new FilteredQuery(query,filter);
  Hits hits=searcher.search(filteredquery);
  assertEquals(1,hits.length());
  assertEquals(1,hits.id(0));
  QueryUtils.check(filteredquery,searcher);
  hits=searcher.search(filteredquery,new Sort("sorter"));
  assertEquals(1,hits.length());
  assertEquals(1,hits.id(0));
  filteredquery=new FilteredQuery(new TermQuery(new Term("field","one")),filter);
  hits=searcher.search(filteredquery);
  assertEquals(2,hits.length());
  QueryUtils.check(filteredquery,searcher);
  filteredquery=new FilteredQuery(new TermQuery(new Term("field","x")),filter);
  hits=searcher.search(filteredquery);
  assertEquals(1,hits.length());
  assertEquals(3,hits.id(0));
  QueryUtils.check(filteredquery,searcher);
  filteredquery=new FilteredQuery(new TermQuery(new Term("field","y")),filter);
  hits=searcher.search(filteredquery);
  assertEquals(0,hits.length());
  QueryUtils.check(filteredquery,searcher);
}
