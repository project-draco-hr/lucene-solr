{
  Map securityProps=getZkController().getZkStateReader().getSecurityProps();
  if (securityProps != null) {
    Map authorizationConf=(Map)securityProps.get("authorization");
    if (authorizationConf == null)     return;
    String klas=(String)authorizationConf.get("class");
    if (klas == null) {
      throw new SolrException(ErrorCode.SERVER_ERROR,"class is required for authorization plugin");
    }
    log.info("Initializing authorization plugin: " + klas);
    authorizationPlugin=getResourceLoader().newInstance((String)klas,AuthorizationPlugin.class);
    authorizationPlugin.init(authorizationConf);
  }
 else {
    log.info("Security conf doesn't exist. Skipping setup for authorization module.");
  }
}
