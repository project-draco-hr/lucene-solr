{
  authorizationConf=Utils.getDeepCopy(authorizationConf,4);
  SecurityPluginHolder<AuthorizationPlugin> old=authorizationPlugin;
  SecurityPluginHolder<AuthorizationPlugin> authorizationPlugin=null;
  if (authorizationConf != null) {
    String klas=(String)authorizationConf.get("class");
    if (klas == null) {
      throw new SolrException(ErrorCode.SERVER_ERROR,"class is required for authorization plugin");
    }
    if (old != null && old.getZnodeVersion() == readVersion(authorizationConf)) {
      return;
    }
    log.info("Initializing authorization plugin: " + klas);
    authorizationPlugin=new SecurityPluginHolder<>(readVersion(authorizationConf),getResourceLoader().newInstance(klas,AuthorizationPlugin.class));
    authorizationPlugin.plugin.init(authorizationConf);
  }
 else {
    log.info("Security conf doesn't exist. Skipping setup for authorization module.");
  }
  this.authorizationPlugin=authorizationPlugin;
  if (old != null) {
    try {
      old.plugin.close();
    }
 catch (    Exception e) {
    }
  }
}
