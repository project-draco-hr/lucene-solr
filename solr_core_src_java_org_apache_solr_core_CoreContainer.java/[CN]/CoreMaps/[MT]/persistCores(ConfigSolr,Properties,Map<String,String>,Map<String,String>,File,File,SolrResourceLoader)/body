{
synchronized (locker) {
    if (cfg == null) {
      ConfigSolrXml.initPersistStatic();
      persistCores(cfg,cores,loader);
      persistCores(cfg,transientCores,loader);
      ConfigSolrXml.addPersistAllCoresStatic(containerProperties,rootSolrAttribs,coresAttribs,(file == null ? configFile : file));
    }
 else {
      cfg.initPersist();
      persistCores(cfg,cores,loader);
      persistCores(cfg,transientCores,loader);
      cfg.addPersistAllCores(containerProperties,rootSolrAttribs,coresAttribs,(file == null ? configFile : file));
    }
  }
}
