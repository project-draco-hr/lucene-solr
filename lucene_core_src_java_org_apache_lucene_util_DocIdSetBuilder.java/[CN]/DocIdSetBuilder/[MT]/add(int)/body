{
  if (bitSet != null) {
    bitSet.set(doc);
  }
 else {
    if (bufferSize + 1 > buffer.length) {
      if (bufferSize + 1 >= threshold) {
        upgradeToBitSet();
        bitSet.set(doc);
        return;
      }
      growBuffer(bufferSize + 1);
    }
    buffer[bufferSize++]=doc;
  }
}
