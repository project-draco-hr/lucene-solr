{
  if (bitSet != null) {
    bitSet.set(doc);
  }
 else {
    if (bufferSize + 1 >= threshold) {
      upgradeToBitSet();
      bitSet.set(doc);
      return;
    }
    if (bufferSize + 1 > buffer.length) {
      buffer=ArrayUtil.grow(buffer,bufferSize + 1);
    }
    buffer[bufferSize++]=doc;
  }
}
