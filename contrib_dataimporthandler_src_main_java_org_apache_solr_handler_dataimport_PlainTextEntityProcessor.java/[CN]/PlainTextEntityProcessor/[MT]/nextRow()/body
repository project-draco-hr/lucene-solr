{
  if (ended)   return null;
  DataSource<Reader> ds=context.getDataSource();
  String url=context.getVariableResolver().replaceTokens(context.getEntityAttribute(URL));
  Reader r=null;
  try {
    r=ds.getData(url);
  }
 catch (  Exception e) {
    if (ABORT.equals(onError)) {
      wrapAndThrow(SEVERE,e,"Exception reading url : " + url);
    }
    return null;
  }
  StringWriter sw=new StringWriter();
  char[] buf=new char[1024];
  while (true) {
    int len=0;
    try {
      len=r.read(buf);
    }
 catch (    IOException e) {
      if (ABORT.equals(onError)) {
        wrapAndThrow(SEVERE,e,"Exception reading url : " + url);
      }
 else {
        LOG.warn("IOException while reading from data source",e);
        return null;
      }
    }
    if (len <= 0)     break;
    sw.append(new String(buf,0,len));
  }
  Map<String,Object> row=new HashMap<String,Object>();
  row.put(PLAIN_TEXT,sw.toString());
  ended=true;
  return super.applyTransformer(row);
}
