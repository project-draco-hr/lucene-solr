{
  if (ended)   return null;
  DataSource<Reader> ds=context.getDataSource();
  String url=context.replaceTokens(context.getEntityAttribute(URL));
  Reader r=null;
  try {
    r=ds.getData(url);
  }
 catch (  Exception e) {
    wrapAndThrow(SEVERE,e,"Exception reading url : " + url);
  }
  StringWriter sw=new StringWriter();
  char[] buf=new char[1024];
  while (true) {
    int len=0;
    try {
      len=r.read(buf);
    }
 catch (    IOException e) {
      IOUtils.closeQuietly(r);
      wrapAndThrow(SEVERE,e,"Exception reading url : " + url);
    }
    if (len <= 0)     break;
    sw.append(new String(buf,0,len));
  }
  Map<String,Object> row=new HashMap<String,Object>();
  row.put(PLAIN_TEXT,sw.toString());
  ended=true;
  IOUtils.closeQuietly(r);
  return row;
}
