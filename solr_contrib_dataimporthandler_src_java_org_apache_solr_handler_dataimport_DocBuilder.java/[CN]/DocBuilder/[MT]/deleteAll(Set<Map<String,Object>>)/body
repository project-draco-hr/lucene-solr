{
  LOG.info("Deleting stale documents ");
  Iterator<Map<String,Object>> iter=deletedKeys.iterator();
  while (iter.hasNext()) {
    Map<String,Object> map=iter.next();
    String keyName=currentEntityProcessorWrapper.getEntity().isDocRoot() ? currentEntityProcessorWrapper.getEntity().getPk() : currentEntityProcessorWrapper.getEntity().getSchemaPk();
    Object key=map.get(keyName);
    if (key == null) {
      keyName=findMatchingPkColumn(keyName,map);
      key=map.get(keyName);
    }
    if (key == null) {
      LOG.warn("no key was available for deleted pk query. keyName = " + keyName);
      continue;
    }
    writer.deleteDoc(key);
    importStatistics.deletedDocCount.incrementAndGet();
    iter.remove();
  }
}
