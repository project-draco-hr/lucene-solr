{
  for (  Map.Entry<String,Object> entry : arow.entrySet()) {
    String key=entry.getKey();
    Object value=entry.getValue();
    if (value == null)     continue;
    if (key.startsWith("$"))     continue;
    Set<EntityField> field=entity.getColNameVsField().get(key);
    if (field == null && dataImporter.getSchema() != null) {
      SchemaField sf=dataImporter.getSchema().getFieldOrNull(key);
      if (sf == null) {
        sf=dataImporter.getSchemaField(key);
      }
      if (sf != null) {
        addFieldToDoc(entry.getValue(),sf.getName(),1.0f,sf.multiValued(),doc);
      }
    }
 else {
      if (field != null) {
        for (        EntityField f : field) {
          String name=f.getName();
          boolean multiValued=f.isMultiValued();
          boolean toWrite=f.isToWrite();
          if (f.isDynamicName()) {
            name=vr.replaceTokens(name);
            SchemaField schemaField=dataImporter.getSchemaField(name);
            if (schemaField == null) {
              toWrite=false;
            }
 else {
              multiValued=schemaField.multiValued();
              toWrite=true;
            }
          }
          if (toWrite) {
            addFieldToDoc(entry.getValue(),name,f.getBoost(),multiValued,doc);
          }
        }
      }
    }
  }
}
