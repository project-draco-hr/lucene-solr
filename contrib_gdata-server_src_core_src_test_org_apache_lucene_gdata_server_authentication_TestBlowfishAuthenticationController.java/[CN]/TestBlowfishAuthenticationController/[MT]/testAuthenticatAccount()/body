{
  GDataAccount account=new GDataAccount();
  account.setName(accountName);
  account.setPassword("testme");
  account.setRole(AccountRole.ENTRYAMINISTRATOR);
  String token=this.controller.authenticatAccount(account,this.clientIp);
  String notSame=this.controller.calculateAuthToken("192.168.0",Integer.toString(account.getRolesAsInt()),this.accountName);
  assertNotSame(notSame,token);
  String authString="192.168.0#" + this.accountName + "#"+ account.getRolesAsInt()+ "#";
  assertTrue(this.controller.deCryptAuthToken(token).startsWith(authString));
  assertTrue(this.controller.deCryptAuthToken(notSame).startsWith(authString));
}
