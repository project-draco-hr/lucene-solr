{
  if (cmd.indexedId == null) {
    cmd.indexedId=getIndexedId(cmd.doc);
  }
synchronized (this) {
    if (pset.contains(cmd.indexedId))     return 0;
    pset.add(cmd.indexedId);
    overwrite(cmd.indexedId,cmd.doc);
    return 1;
  }
}
