{
  if (idField == null)   throw new SolrException(SolrException.ErrorCode.BAD_REQUEST,"Operation requires schema to have a unique key field");
  closeWriter();
  openSearcher();
  IndexReader ir=searcher.getReader();
  TermDocs tdocs=null;
  int num=0;
  try {
    Term term=new Term(idField.getName(),indexedId);
    num=ir.deleteDocuments(term);
    if (SolrCore.log.isLoggable(Level.FINEST)) {
      SolrCore.log.finest("deleted " + num + " docs matching id "+ idFieldType.indexedToReadable(indexedId));
    }
  }
  finally {
    try {
      if (tdocs != null)       tdocs.close();
    }
 catch (    Exception e) {
    }
  }
  return num;
}
