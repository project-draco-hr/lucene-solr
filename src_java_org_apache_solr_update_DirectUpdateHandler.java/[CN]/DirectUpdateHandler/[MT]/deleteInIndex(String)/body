{
  if (idField == null)   throw new SolrException(2,"Operation requires schema to have a unique key field");
  closeWriter();
  openSearcher();
  IndexReader ir=searcher.getReader();
  TermDocs tdocs=null;
  int num=0;
  try {
    num=ir.delete(idTerm(id));
    if (SolrCore.log.isLoggable(Level.FINEST)) {
      SolrCore.log.finest("deleted " + num + " docs matching id "+ id);
    }
  }
  finally {
    try {
      if (tdocs != null)       tdocs.close();
    }
 catch (    Exception e) {
    }
  }
  return num;
}
