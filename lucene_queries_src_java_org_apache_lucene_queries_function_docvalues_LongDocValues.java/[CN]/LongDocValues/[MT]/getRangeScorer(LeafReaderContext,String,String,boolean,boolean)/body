{
  long lower, upper;
  if (lowerVal == null) {
    lower=Long.MIN_VALUE;
  }
 else {
    lower=externalToLong(lowerVal);
    if (!includeLower && lower < Long.MAX_VALUE)     lower++;
  }
  if (upperVal == null) {
    upper=Long.MAX_VALUE;
  }
 else {
    upper=externalToLong(upperVal);
    if (!includeUpper && upper > Long.MIN_VALUE)     upper--;
  }
  final long ll=lower;
  final long uu=upper;
  return new ValueSourceScorer(readerContext,this){
    @Override public boolean matches(    int doc){
      if (!exists(doc))       return false;
      long val=longVal(doc);
      return val >= ll && val <= uu;
    }
  }
;
}
