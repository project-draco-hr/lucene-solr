{
  NormalizeCharMap currMap=this;
  for (int i=0; i < singleMatch.length(); i++) {
    char c=singleMatch.charAt(i);
    if (currMap.submap == null) {
      currMap.submap=new HashMap(1);
    }
    NormalizeCharMap map=(NormalizeCharMap)currMap.submap.get(CharacterCache.valueOf(c));
    if (map == null) {
      map=new NormalizeCharMap();
      currMap.submap.put(new Character(c),map);
    }
    currMap=map;
  }
  if (currMap.normStr != null) {
    throw new RuntimeException("MappingCharFilter: there is already a mapping for " + singleMatch);
  }
  currMap.normStr=replacement;
  currMap.diff=singleMatch.length() - replacement.length();
}
