{
  Query q=super.rewrite(reader);
  if (minRadius == 0.0) {
    return q;
  }
  BooleanQuery.Builder bqb=new BooleanQuery.Builder();
  GeoPointDistanceQuery exclude=new GeoPointDistanceQuery(field,centerLon,centerLat,minRadius);
  if (radius >= GeoProjectionUtils.SEMIMINOR_AXIS) {
    bqb.add(new BooleanClause(new GeoPointInBBoxQuery(this.field,-180.0,-90.0,180.0,90.0),BooleanClause.Occur.MUST));
  }
 else {
    bqb.add(new BooleanClause(q,BooleanClause.Occur.MUST));
  }
  bqb.add(new BooleanClause(exclude,BooleanClause.Occur.MUST_NOT));
  return bqb.build();
}
