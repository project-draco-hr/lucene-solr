{
  LeafReader parallelReader=getParallelLeafReader(reader,true,schemaGen);
  if (parallelReader != null) {
    assertFalse(parallelReader instanceof ParallelLeafReader);
    assertFalse(reader instanceof ParallelLeafReader);
    LeafReader newReader=new ParallelLeafReader(false,parallelReader,reader){
      @Override public Bits getLiveDocs(){
        return getParallelReaders()[1].getLiveDocs();
      }
      @Override public int numDocs(){
        return getParallelReaders()[1].numDocs();
      }
    }
;
    parallelReader.decRef();
    return newReader;
  }
 else {
    return reader;
  }
}
