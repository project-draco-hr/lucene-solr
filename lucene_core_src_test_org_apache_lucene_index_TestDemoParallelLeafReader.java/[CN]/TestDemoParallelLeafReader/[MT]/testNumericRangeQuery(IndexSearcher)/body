{
  NumericDocValues numbers=MultiDocValues.getNumericValues(s.getIndexReader(),"number");
  for (int i=0; i < 100; i++) {
    long min=random().nextLong();
    long max=random().nextLong();
    if (min > max) {
      long x=min;
      min=max;
      max=x;
    }
    TopDocs hits=s.search(NumericRangeQuery.newLongRange("number",min,max,true,true),100);
    for (    ScoreDoc scoreDoc : hits.scoreDocs) {
      long value=Long.parseLong(s.doc(scoreDoc.doc).get("text").split(" ")[1]);
      assertTrue(value >= min);
      assertTrue(value <= max);
      assertEquals(value,numbers.get(scoreDoc.doc));
    }
  }
}
