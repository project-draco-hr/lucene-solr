{
  assertEquals(0,reader.getRefCount());
  if (checkNormsClosed && reader instanceof SegmentReader) {
    assertTrue(((SegmentReader)reader).normsClosed());
  }
  if (checkSubReaders) {
    if (reader instanceof MultiSegmentReader) {
      SegmentReader[] subReaders=((MultiSegmentReader)reader).getSubReaders();
      for (int i=0; i < subReaders.length; i++) {
        assertReaderClosed(subReaders[i],checkSubReaders,checkNormsClosed);
      }
    }
    if (reader instanceof MultiReader) {
      IndexReader[] subReaders=((MultiReader)reader).getSubReaders();
      for (int i=0; i < subReaders.length; i++) {
        assertReaderClosed(subReaders[i],checkSubReaders,checkNormsClosed);
      }
    }
    if (reader instanceof ParallelReader) {
      IndexReader[] subReaders=((ParallelReader)reader).getSubReaders();
      for (int i=0; i < subReaders.length; i++) {
        assertReaderClosed(subReaders[i],checkSubReaders,checkNormsClosed);
      }
    }
  }
}
