{
  final Directory dir1=new MockRAMDirectory();
  createIndex(dir1,true);
  final Directory dir2=new MockRAMDirectory();
  createIndex(dir2,true);
  final Directory dir3=new MockRAMDirectory();
  createIndex(dir3,false);
  final Directory dir4=new MockRAMDirectory();
  createIndex(dir4,true);
  final Directory dir5=new MockRAMDirectory();
  createIndex(dir5,false);
  performDefaultTests(new TestReopen(){
    protected void modifyIndex(    int i) throws IOException {
      if (i == 1)       TestIndexReaderReopen.modifyIndex(i,dir1);
      TestIndexReaderReopen.modifyIndex(i,dir4);
      TestIndexReaderReopen.modifyIndex(i,dir5);
    }
    protected IndexReader openReader() throws IOException {
      ParallelReader pr=new ParallelReader();
      pr.add(IndexReader.open(dir1));
      pr.add(IndexReader.open(dir2));
      MultiReader mr=new MultiReader(new IndexReader[]{IndexReader.open(dir3),IndexReader.open(dir4)});
      return new MultiReader(new IndexReader[]{pr,mr,IndexReader.open(dir5)});
    }
  }
);
  dir1.close();
  dir2.close();
  dir3.close();
  dir4.close();
  dir5.close();
}
