{
  final int softCommitWaitMillis=500;
  final int hardCommitWaitMillis=1200;
  CommitTracker hardTracker=updater.commitTracker;
  CommitTracker softTracker=updater.softCommitTracker;
  softTracker.setTimeUpperBound(softCommitWaitMillis);
  softTracker.setDocsUpperBound(-1);
  hardTracker.setTimeUpperBound(hardCommitWaitMillis);
  hardTracker.setDocsUpperBound(-1);
  assertU(adoc("id","529","subject","the doc we care about in this test"));
  assertU(commit());
  Long soft529;
  Long hard529;
  monitor.clear();
  long del529=System.nanoTime();
  assertU(delI("529"));
  monitor.assertSaneOffers();
  soft529=monitor.soft.poll(softCommitWaitMillis * 3,MILLISECONDS);
  assertNotNull("soft529 wasn't fast enough",soft529);
  monitor.assertSaneOffers();
  Long searcher529=monitor.searcher.poll(softCommitWaitMillis,MILLISECONDS);
  assertNotNull("searcher529 wasn't fast enough",searcher529);
  monitor.assertSaneOffers();
  assertU(adoc("id","550","subject","just for noise/activity"));
  hard529=monitor.hard.poll(hardCommitWaitMillis * 3,MILLISECONDS);
  assertNotNull("hard529 wasn't fast enough",hard529);
  monitor.assertSaneOffers();
  final long soft529Ms=TimeUnit.MILLISECONDS.convert(soft529 - del529,TimeUnit.NANOSECONDS);
  assertTrue("soft529 occured too fast, in " + soft529Ms + "ms, less than soft commit interval "+ softCommitWaitMillis,soft529Ms >= softCommitWaitMillis);
  final long hard529Ms=TimeUnit.MILLISECONDS.convert(hard529 - del529,TimeUnit.NANOSECONDS);
  assertTrue("hard529 occured too fast, in " + hard529Ms + "ms, less than hard commit interval "+ hardCommitWaitMillis,hard529Ms >= hardCommitWaitMillis);
  long slowTestFudge=Math.max(300,12 * (soft529Ms - softCommitWaitMillis));
  final long softCommitToSearcherOpenMs=TimeUnit.MILLISECONDS.convert(searcher529 - soft529,TimeUnit.NANOSECONDS);
  assertTrue("searcher529 wasn't soon enough after soft529: Took " + softCommitToSearcherOpenMs + "ms, >= acceptable "+ slowTestFudge+ "ms (fudge)",softCommitToSearcherOpenMs < slowTestFudge);
  assertTrue("hard529 was before searcher529: " + searcher529 + " !<= "+ hard529,searcher529 <= hard529);
  monitor.hard.clear();
  monitor.soft.clear();
  assertNull("Got a hard commit we weren't expecting",monitor.hard.poll(2,SECONDS));
  assertNull("Got a soft commit we weren't expecting",monitor.soft.poll(0,MILLISECONDS));
  monitor.assertSaneOffers();
}
