{
  List<String> rawCollectionsList=StrUtils.splitSmart(collection,",",true);
  Set<String> collectionsList=new HashSet<>();
  for (  String collectionName : rawCollectionsList) {
    if (!clusterState.getCollections().contains(collectionName)) {
      Aliases aliases=zkStateReader.getAliases();
      String alias=aliases.getCollectionAlias(collectionName);
      if (alias != null) {
        List<String> aliasList=StrUtils.splitSmart(alias,",",true);
        collectionsList.addAll(aliasList);
        continue;
      }
      DocCollection docCollection=getDocCollection(clusterState,collection);
      if (docCollection == null) {
        throw new SolrException(ErrorCode.BAD_REQUEST,"Collection not found: " + collectionName);
      }
    }
    collectionsList.add(collectionName);
  }
  return collectionsList;
}
