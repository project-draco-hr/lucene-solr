{
synchronized (reader.getUpdateLock()) {
    try {
      reader.updateCloudState(true);
      final CloudState state=reader.getCloudState();
      final CloudState newState=setShardLeader(state,collection,shardId,props.getCoreUrl());
      if (state != newState) {
        log.info("Announcing new leader: coll: " + collection + " shard: "+ shardId+ " props:"+ props);
        zkClient.setData(ZkStateReader.CLUSTER_STATE,ZkStateReader.toJSON(newState),true);
      }
 else {
        log.debug("State was not changed.");
      }
    }
 catch (    KeeperException e) {
      log.warn("Could not announce new leader coll:" + collection + " shard:"+ shardId+ ", exception: "+ e.getClass());
    }
catch (    InterruptedException e) {
      Thread.currentThread().interrupt();
      log.warn("Could not promote new leader coll:" + collection + " shard:"+ shardId+ ", exception: "+ e.getClass());
    }
  }
}
