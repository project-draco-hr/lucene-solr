{
  for (  Entry<String,DocCollection> e : colls.entrySet()) {
    DocCollection c=e.getValue();
    if (c == null) {
      isClusterStateModified=true;
      state=state.copyWith(singletonMap(e.getKey(),(DocCollection)null));
      updateNodes.put(ZkStateReader.getCollectionPath(e.getKey()),null);
      continue;
    }
    if (c.getStateFormat() > 1) {
      updateNodes.put(ZkStateReader.getCollectionPath(c.getName()),new ClusterState(-1,Collections.<String>emptySet(),singletonMap(c.getName(),c)));
    }
 else {
      isClusterStateModified=true;
    }
    state=state.copyWith(singletonMap(e.getKey(),c));
  }
  return state;
}
