{
  final String collection=message.getStr(ZkStateReader.COLLECTION_PROP);
  final String sliceId=message.getStr(ZkStateReader.SHARD_ID_PROP);
  log.info("Removing collection: " + collection + " shard: "+ sliceId+ " from clusterstate");
  final Map<String,DocCollection> newCollections=new LinkedHashMap<String,DocCollection>(clusterState.getCollectionStates());
  DocCollection coll=newCollections.get(collection);
  Map<String,Slice> newSlices=new LinkedHashMap<String,Slice>(coll.getSlicesMap());
  newSlices.remove(sliceId);
  DocCollection newCollection=new DocCollection(coll.getName(),newSlices,coll.getProperties(),coll.getRouter());
  newCollections.put(newCollection.getName(),newCollection);
  return new ClusterState(clusterState.getLiveNodes(),newCollections);
}
