{
  StringBuilder sb=new StringBuilder();
  String baseUrl=message.getStr(ZkStateReader.BASE_URL_PROP);
  String coreName=message.getStr(ZkStateReader.CORE_NAME_PROP);
  sb.append(baseUrl);
  if (baseUrl != null && !baseUrl.endsWith("/"))   sb.append("/");
  sb.append(coreName == null ? "" : coreName);
  if (!(sb.substring(sb.length() - 1).equals("/")))   sb.append("/");
  clusterState=setShardLeader(clusterState,message.getStr(ZkStateReader.COLLECTION_PROP),message.getStr(ZkStateReader.SHARD_ID_PROP),sb.length() > 0 ? sb.toString() : null);
  return clusterState;
}
