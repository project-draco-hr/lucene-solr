{
  if (!updateNodes.isEmpty()) {
    for (    Entry<String,Object> e : updateNodes.entrySet()) {
      if (e.getValue() == null) {
        if (zkClient.exists(e.getKey(),true))         zkClient.delete(e.getKey(),0,true);
      }
 else {
        if (zkClient.exists(e.getKey(),true)) {
          log.info("going to update_collection",e.getKey());
          zkClient.setData(e.getKey(),ZkStateReader.toJSON(e.getValue()),true);
        }
 else {
          log.info("going to create_collection {}",e.getValue());
          zkClient.create(e.getKey(),ZkStateReader.toJSON(e.getValue()),CreateMode.PERSISTENT,true);
        }
      }
    }
    updateNodes.clear();
  }
  if (isClusterStateModified) {
    lastUpdatedTime=System.nanoTime();
    zkClient.setData(ZkStateReader.CLUSTER_STATE,ZkStateReader.toJSON(clusterState),true);
    isClusterStateModified=false;
  }
}
