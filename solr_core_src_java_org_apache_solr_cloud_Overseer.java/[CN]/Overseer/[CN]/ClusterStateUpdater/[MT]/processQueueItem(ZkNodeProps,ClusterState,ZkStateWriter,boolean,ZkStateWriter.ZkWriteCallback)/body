{
  final String operation=message.getStr(QUEUE_OPERATION);
  List<ZkWriteCommand> zkWriteCommands=null;
  final TimerContext timerContext=stats.time(operation);
  try {
    zkWriteCommands=processMessage(clusterState,message,operation);
    stats.success(operation);
  }
 catch (  Exception e) {
    log.error("Overseer could not process the current clusterstate state update message, skipping the message.",e);
    stats.error(operation);
  }
 finally {
    timerContext.stop();
  }
  if (zkWriteCommands != null) {
    for (    ZkWriteCommand zkWriteCommand : zkWriteCommands) {
      clusterState=zkStateWriter.enqueueUpdate(clusterState,zkWriteCommand,callback);
    }
    if (!enableBatching) {
      clusterState=zkStateWriter.writePendingUpdates();
    }
  }
  return clusterState;
}
