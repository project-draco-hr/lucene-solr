{
  this.zkClient=reader.getZkClient();
  this.zkStats=zkStats;
  this.stateUpdateQueue=getInQueue(zkClient,zkStats);
  this.workQueue=getInternalQueue(zkClient,zkStats);
  this.failureMap=getFailureMap(zkClient);
  this.runningMap=getRunningMap(zkClient);
  this.completedMap=getCompletedMap(zkClient);
  this.myId=myId;
  this.reader=reader;
  clusterProps=reader.getClusterProps();
  reader.setEphemeralCollectionData(Collections.unmodifiableMap(updateNodes));
}
