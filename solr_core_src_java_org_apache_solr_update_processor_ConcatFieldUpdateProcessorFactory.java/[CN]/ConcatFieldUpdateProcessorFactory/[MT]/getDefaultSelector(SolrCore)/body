{
  return new FieldMutatingUpdateProcessor.FieldNameSelector(){
    @Override public boolean shouldMutate(    final String fieldName){
      final IndexSchema schema=core.getLatestSchema();
      FieldType type=schema.getFieldTypeNoEx(fieldName);
      if (null == type)       return false;
      if (!(TextField.class.isInstance(type) || StrField.class.isInstance(type))) {
        return false;
      }
      SchemaField sf=schema.getFieldOrNull(fieldName);
      if (null == sf)       return false;
      return !sf.multiValued();
    }
  }
;
}
