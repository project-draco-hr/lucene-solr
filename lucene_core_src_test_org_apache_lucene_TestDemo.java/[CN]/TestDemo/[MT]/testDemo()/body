{
  Analyzer analyzer=new MockAnalyzer(random());
  Directory directory=newDirectory();
  RandomIndexWriter iwriter=new RandomIndexWriter(random(),directory,analyzer);
  Document doc=new Document();
  String longTerm="longtermlongtermlongtermlongtermlongtermlongtermlongtermlongtermlongtermlongtermlongtermlongtermlongtermlongtermlongtermlongtermlongtermlongterm";
  String text="This is the text to be indexed. " + longTerm;
  doc.add(newField("fieldname",text,TextField.TYPE_STORED));
  iwriter.addDocument(doc);
  iwriter.close();
  IndexReader ireader=IndexReader.open(directory);
  IndexSearcher isearcher=new IndexSearcher(ireader);
  assertEquals(1,isearcher.search(new TermQuery(new Term("fieldname",longTerm)),1).totalHits);
  Query query=new TermQuery(new Term("fieldname","text"));
  TopDocs hits=isearcher.search(query,null,1);
  assertEquals(1,hits.totalHits);
  for (int i=0; i < hits.scoreDocs.length; i++) {
    Document hitDoc=isearcher.doc(hits.scoreDocs[i].doc);
    assertEquals(text,hitDoc.get("fieldname"));
  }
  PhraseQuery phraseQuery=new PhraseQuery();
  phraseQuery.add(new Term("fieldname","to"));
  phraseQuery.add(new Term("fieldname","be"));
  assertEquals(1,isearcher.search(phraseQuery,null,1).totalHits);
  ireader.close();
  directory.close();
}
