{
  assumeTrue("default codec does not support SORTED_SET",defaultCodecSupportsSortedSet());
  SortedSetDocValues dv=reader.getSortedSetDocValues(SORTED_SET_DV_FIELD);
  int maxDoc=reader.maxDoc();
  BytesRef bytes=new BytesRef();
  for (int i=0; i < maxDoc; i++) {
    dv.setDocument(i);
    dv.lookupOrd(dv.nextOrd(),bytes);
    int value=sortedValues[i].intValue();
    assertEquals("incorrect sorted-set DocValues for doc " + i,Integer.valueOf(value).toString(),bytes.utf8ToString());
    dv.lookupOrd(dv.nextOrd(),bytes);
    assertEquals("incorrect sorted-set DocValues for doc " + i,Integer.valueOf(value + 1).toString(),bytes.utf8ToString());
    assertEquals(SortedSetDocValues.NO_MORE_ORDS,dv.nextOrd());
  }
}
