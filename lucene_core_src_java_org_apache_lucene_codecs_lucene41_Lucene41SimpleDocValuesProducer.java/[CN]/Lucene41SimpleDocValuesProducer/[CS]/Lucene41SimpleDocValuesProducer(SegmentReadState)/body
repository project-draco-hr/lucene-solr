{
  String metaName=IndexFileNames.segmentFileName(state.segmentInfo.name,state.segmentSuffix,"dvm");
  IndexInput in=state.directory.openInput(metaName,state.context);
  boolean success=false;
  try {
    CodecUtil.checkHeader(in,Lucene41SimpleDocValuesFormat.METADATA_CODEC,Lucene41SimpleDocValuesFormat.VERSION_START,Lucene41SimpleDocValuesFormat.VERSION_START);
    numerics=new HashMap<Integer,NumericEntry>();
    ords=new HashMap<Integer,NumericEntry>();
    binaries=new HashMap<Integer,BinaryEntry>();
    readFields(in,state.fieldInfos);
    success=true;
  }
  finally {
    if (success) {
      IOUtils.close(in);
    }
 else {
      IOUtils.closeWhileHandlingException(in);
    }
  }
  String dataName=IndexFileNames.segmentFileName(state.segmentInfo.name,state.segmentSuffix,"dvd");
  data=state.directory.openInput(dataName,state.context);
  CodecUtil.checkHeader(data,Lucene41SimpleDocValuesFormat.DATA_CODEC,Lucene41SimpleDocValuesFormat.VERSION_START,Lucene41SimpleDocValuesFormat.VERSION_START);
}
