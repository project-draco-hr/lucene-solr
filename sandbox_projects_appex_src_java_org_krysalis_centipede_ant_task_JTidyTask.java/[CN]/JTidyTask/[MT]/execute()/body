{
  try {
    PrintWriter pw=new PrintWriter(new FileWriter(log));
    tidy.setErrout(pw);
    BufferedInputStream in=new BufferedInputStream(new FileInputStream(src));
    PrintWriter out=new PrintWriter(new FileWriter(dest));
    org.w3c.dom.Document domDoc=tidy.parseDOM(in,null);
    domDoc.normalize();
    stripDuplicateAttributes(domDoc,null);
    org.apache.xml.serialize.OutputFormat format=new org.apache.xml.serialize.OutputFormat();
    format.setIndenting(true);
    format.setEncoding("ISO-8859-1");
    format.setPreserveSpace(true);
    format.setLineSeparator("\n");
    org.apache.xml.serialize.XMLSerializer serializer=new org.apache.xml.serialize.XMLSerializer(out,format);
    serializer.serialize(domDoc);
    out.flush();
    out.close();
    in.close();
    pw.flush();
    pw.close();
  }
 catch (  IOException ioe) {
    throw new BuildException(ioe);
  }
}
