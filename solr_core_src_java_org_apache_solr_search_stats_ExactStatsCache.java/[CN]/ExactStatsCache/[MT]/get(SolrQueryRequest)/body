{
  Map<String,CollectionStats> currentGlobalColStats=(Map<String,CollectionStats>)req.getContext().get(CURRENT_GLOBAL_COL_STATS);
  Map<String,TermStats> currentGlobalTermStats=(Map<String,TermStats>)req.getContext().get(CURRENT_GLOBAL_TERM_STATS);
  if (currentGlobalColStats == null) {
    currentGlobalColStats=Collections.emptyMap();
  }
  if (currentGlobalTermStats == null) {
    currentGlobalTermStats=Collections.emptyMap();
  }
  LOG.debug("Returning StatsSource. Collection stats={}, Term stats size= {}",currentGlobalColStats,currentGlobalTermStats.size());
  return new ExactStatsSource(currentGlobalTermStats,currentGlobalColStats);
}
