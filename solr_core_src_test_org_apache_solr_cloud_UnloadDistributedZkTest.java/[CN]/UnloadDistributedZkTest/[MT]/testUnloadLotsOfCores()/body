{
  SolrClient client=clients.get(2);
  String url3=getBaseUrl(client);
  try (final HttpSolrClient adminClient=new HttpSolrClient(url3)){
    adminClient.setConnectionTimeout(15000);
    adminClient.setSoTimeout(60000);
    ThreadPoolExecutor executor=new ThreadPoolExecutor(0,Integer.MAX_VALUE,5,TimeUnit.SECONDS,new SynchronousQueue<Runnable>(),new DefaultSolrThreadFactory("testExecutor"));
    int cnt=atLeast(3);
    createCores(adminClient,executor,"multiunload",2,cnt);
    executor.shutdown();
    executor.awaitTermination(120,TimeUnit.SECONDS);
    executor=new ThreadPoolExecutor(0,Integer.MAX_VALUE,5,TimeUnit.SECONDS,new SynchronousQueue<Runnable>(),new DefaultSolrThreadFactory("testExecutor"));
    for (int j=0; j < cnt; j++) {
      final int freezeJ=j;
      executor.execute(new Runnable(){
        @Override public void run(){
          Unload unloadCmd=new Unload(true);
          unloadCmd.setCoreName("multiunload" + freezeJ);
          try {
            adminClient.request(unloadCmd);
          }
 catch (          SolrServerException|IOException e) {
            throw new RuntimeException(e);
          }
        }
      }
);
      Thread.sleep(random().nextInt(50));
    }
    executor.shutdown();
    executor.awaitTermination(120,TimeUnit.SECONDS);
  }
 }
