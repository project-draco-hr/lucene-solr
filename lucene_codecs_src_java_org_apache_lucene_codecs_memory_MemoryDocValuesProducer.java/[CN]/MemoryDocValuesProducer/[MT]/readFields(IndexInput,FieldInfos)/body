{
  int numEntries=0;
  int fieldNumber=meta.readVInt();
  while (fieldNumber != -1) {
    numEntries++;
    FieldInfo info=infos.fieldInfo(fieldNumber);
    if (info == null) {
      throw new CorruptIndexException("invalid field number: " + fieldNumber,meta);
    }
    int fieldType=meta.readByte();
    if (fieldType == NUMBER) {
      numerics.put(info.name,readNumericEntry(meta));
    }
 else     if (fieldType == BYTES) {
      binaries.put(info.name,readBinaryEntry(meta));
    }
 else     if (fieldType == FST) {
      fsts.put(info.name,readFSTEntry(meta));
    }
 else     if (fieldType == SORTED_SET) {
      SortedSetEntry entry=new SortedSetEntry();
      entry.singleton=false;
      sortedSets.put(info.name,entry);
    }
 else     if (fieldType == SORTED_SET_SINGLETON) {
      SortedSetEntry entry=new SortedSetEntry();
      entry.singleton=true;
      sortedSets.put(info.name,entry);
    }
 else     if (fieldType == SORTED_NUMERIC) {
      SortedNumericEntry entry=new SortedNumericEntry();
      entry.singleton=false;
      entry.packedIntsVersion=meta.readVInt();
      entry.blockSize=meta.readVInt();
      entry.addressOffset=meta.readLong();
      entry.valueCount=meta.readLong();
      sortedNumerics.put(info.name,entry);
    }
 else     if (fieldType == SORTED_NUMERIC_SINGLETON) {
      SortedNumericEntry entry=new SortedNumericEntry();
      entry.singleton=true;
      sortedNumerics.put(info.name,entry);
    }
 else {
      throw new CorruptIndexException("invalid entry type: " + fieldType + ", fieldName="+ info.name,meta);
    }
    fieldNumber=meta.readVInt();
  }
  return numEntries;
}
