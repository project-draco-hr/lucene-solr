{
  if (count != numValues) {
    throw new IllegalStateException("Wrong number of values added, expected: " + numValues + ", got: "+ count);
  }
  if (finished) {
    throw new IllegalStateException("#finish has been called already");
  }
  if (bufferSize > 0) {
    flush();
  }
  finished=true;
}
