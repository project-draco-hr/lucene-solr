{
  this.clearCore();
  int start=0;
  UpdateLog ulog=h.getCore().getUpdateHandler().getUpdateLog();
  CdcrUpdateLog.CdcrLogReader reader=((CdcrUpdateLog)ulog).newLogReader();
  LinkedList<Long> versions=new LinkedList<>();
  addDocs(10,start,versions);
  start+=10;
  assertU(commit());
  addDocs(11,start,versions);
  start+=11;
  assertU(commit());
  for (int i=0; i < 10; i++) {
    assertNotNull(reader.next());
  }
  Object o=reader.next();
  assertNotNull(o);
  List entry=(List)o;
  int opAndFlags=(Integer)entry.get(0);
  assertEquals(UpdateLog.COMMIT,opAndFlags & UpdateLog.OPERATION_MASK);
  for (int i=0; i < 11; i++) {
    assertNotNull(reader.next());
  }
  o=reader.next();
  assertNotNull(o);
  entry=(List)o;
  opAndFlags=(Integer)entry.get(0);
  assertEquals(UpdateLog.COMMIT,opAndFlags & UpdateLog.OPERATION_MASK);
  assertNull(reader.next());
  addDocs(10,start,versions);
  start+=10;
  assertU(commit());
  for (int i=0; i < 11; i++) {
    assertNotNull(reader.next());
  }
  assertNull(reader.next());
}
