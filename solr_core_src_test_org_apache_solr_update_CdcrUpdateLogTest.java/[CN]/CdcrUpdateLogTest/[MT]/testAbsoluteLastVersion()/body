{
  this.clearCore();
  CdcrUpdateLog ulog=(CdcrUpdateLog)h.getCore().getUpdateHandler().getUpdateLog();
  File logDir=new File(h.getCore().getUpdateHandler().getUpdateLog().getLogDir());
  CdcrUpdateLog.CdcrLogReader reader=ulog.newLogReader();
  int start=0;
  LinkedList<Long> versions=new LinkedList<>();
  addDocs(10,start,versions);
  start+=10;
  deleteByQuery("*:*");
  assertU(commit());
  deleteByQuery("*:*");
  addDocs(10,start,versions);
  start+=10;
  assertU(commit());
  assertEquals(2,ulog.getLogList(logDir).length);
  for (  long version : ulog.getStartingVersions()) {
    assertTrue(version > 0);
  }
  for (int i=0; i < 10; i++) {
    reader.next();
  }
  Object o=reader.next();
  assertTrue((Long)((List)o).get(1) < 0);
  assertTrue(reader.getLastVersion() > 0);
  reader.next();
  o=reader.next();
  assertTrue((Long)((List)o).get(1) < 0);
  assertTrue(reader.getLastVersion() > 0);
}
