{
  this.clearCore();
  CdcrUpdateLog ulog=(CdcrUpdateLog)h.getCore().getUpdateHandler().getUpdateLog();
  File logDir=new File(h.getCore().getUpdateHandler().getUpdateLog().getLogDir());
  CdcrUpdateLog.CdcrLogReader reader=ulog.newLogReader();
  int start=0;
  LinkedList<Long> versions=new LinkedList<>();
  addDocs(10,start,versions);
  start+=10;
  assertU(commit());
  addDocs(10,start,versions);
  start+=10;
  assertU(commit());
  assertEquals(2,ulog.getLogList(logDir).length);
  for (int i=0; i < 10; i++) {
    assertNotNull(reader.next());
  }
  CdcrUpdateLog.CdcrLogReader subReader=reader.getSubReader();
  for (int i=0; i < 6; i++) {
    assertNotNull(subReader.next());
  }
  assertEquals(6,subReader.getNumberOfRemainingRecords());
  addDocs(105,start,versions);
  start+=105;
  assertU(commit());
  assertEquals(3,ulog.getLogList(logDir).length);
  reader.forwardSeek(subReader);
  subReader.close();
  List o=(List)reader.next();
  assertNotNull(o);
  assertTrue(o.get(2) instanceof SolrInputDocument);
  assertEquals("15",((SolrInputDocument)o.get(2)).getFieldValue("id"));
  for (int i=0; i < 6; i++) {
    assertNotNull(reader.next());
  }
  assertEquals(105,reader.getNumberOfRemainingRecords());
  addDocs(10,start,versions);
  start+=10;
  assertU(commit());
  assertEquals(2,ulog.getLogList(logDir).length);
}
