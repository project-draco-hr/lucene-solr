{
  this.clearCore();
  CdcrUpdateLog ulog=(CdcrUpdateLog)h.getCore().getUpdateHandler().getUpdateLog();
  File logDir=new File(h.getCore().getUpdateHandler().getUpdateLog().getLogDir());
  int start=0;
  LinkedList<Long> versions=new LinkedList<>();
  addDocs(10,start,versions);
  start+=10;
  assertU(commit());
  addDocs(10,start,versions);
  start+=10;
  assertU(commit());
  addDocs(105,start,versions);
  start+=105;
  assertU(commit());
  assertEquals(1,ulog.getLogList(logDir).length);
  ulog.enableBuffer();
  addDocs(10,start,versions);
  start+=10;
  assertU(commit());
  addDocs(10,start,versions);
  start+=10;
  assertU(commit());
  addDocs(105,start,versions);
  start+=105;
  assertU(commit());
  assertEquals(4,ulog.getLogList(logDir).length);
  ulog.disableBuffer();
  addDocs(10,start,versions);
  start+=10;
  assertU(commit());
  assertEquals(2,ulog.getLogList(logDir).length);
}
