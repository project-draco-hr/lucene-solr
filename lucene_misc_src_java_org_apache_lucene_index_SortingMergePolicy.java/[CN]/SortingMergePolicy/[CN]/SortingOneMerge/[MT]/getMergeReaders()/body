{
  if (unsortedReaders == null) {
    unsortedReaders=super.getMergeReaders();
    if (infoStream.isEnabled("SMP")) {
      infoStream.message("SMP","sorting " + unsortedReaders);
      for (      LeafReader leaf : unsortedReaders) {
        String sortDescription=getSortDescription(leaf);
        if (sortDescription == null) {
          sortDescription="not sorted";
        }
        infoStream.message("SMP","seg=" + leaf + " "+ sortDescription);
      }
    }
    List<LeafReader> wrapped=new ArrayList<>(unsortedReaders.size());
    for (    LeafReader leaf : unsortedReaders) {
      if (leaf instanceof SegmentReader) {
        leaf=new MergeReaderWrapper((SegmentReader)leaf);
      }
      wrapped.add(leaf);
    }
    final LeafReader atomicView;
    if (wrapped.size() == 1) {
      atomicView=wrapped.get(0);
    }
 else {
      final CompositeReader multiReader=new MultiReader(wrapped.toArray(new LeafReader[wrapped.size()]));
      atomicView=new SlowCompositeReaderWrapper(multiReader,true);
    }
    docMap=sorter.sort(atomicView);
    sortedView=SortingLeafReader.wrap(atomicView,docMap);
  }
  if (docMap == null) {
    if (infoStream.isEnabled("SMP")) {
      infoStream.message("SMP","readers already sorted, omitting sort");
    }
    return unsortedReaders;
  }
 else {
    if (infoStream.isEnabled("SMP")) {
      infoStream.message("SMP","sorting readers by " + sort);
    }
    return Collections.singletonList(sortedView);
  }
}
