{
  int docCount=0;
  for (int i=0; i < mergeState.storedFieldsReaders.length; i++) {
    StoredFieldsReader storedFieldsReader=mergeState.storedFieldsReaders[i];
    storedFieldsReader.checkIntegrity();
    int maxDoc=mergeState.maxDocs[i];
    Bits liveDocs=mergeState.liveDocs[i];
    for (int docID=0; docID < maxDoc; docID++) {
      if (liveDocs != null && !liveDocs.get(docID)) {
        continue;
      }
      DocumentStoredFieldVisitor visitor=new DocumentStoredFieldVisitor();
      storedFieldsReader.visitDocument(docID,visitor);
      StoredDocument doc=visitor.getDocument();
      addDocument(doc,mergeState.mergeFieldInfos);
      docCount++;
      mergeState.checkAbort.work(300);
    }
  }
  finish(mergeState.mergeFieldInfos,docCount);
  return docCount;
}
