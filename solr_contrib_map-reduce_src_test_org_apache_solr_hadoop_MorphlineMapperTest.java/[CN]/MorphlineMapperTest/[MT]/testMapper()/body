{
  MorphlineMapper mapper=new MorphlineMapper();
  MapDriver<LongWritable,Text,Text,SolrInputDocumentWritable> mapDriver=MapDriver.newMapDriver(mapper);
  ;
  Configuration config=mapDriver.getConfiguration();
  setupHadoopConfig(config);
  mapDriver.withInput(new LongWritable(0L),new Text("hdfs://localhost/" + URLEncoder.encode(DOCUMENTS_DIR,"UTF-8") + "/sample-statuses-20120906-141433.avro"));
  SolrInputDocument sid=new SolrInputDocument();
  sid.addField("id","uniqueid1");
  sid.addField("user_name","user1");
  sid.addField("text","content of record one");
  SolrInputDocumentWritable sidw=new SolrInputDocumentWritable(sid);
  mapDriver.withCacheArchive(solrHomeZip.getAbsolutePath()).withOutput(new Text("0"),sidw);
  List<Pair<Text,SolrInputDocumentWritable>> result=mapDriver.run();
  for (  Pair<Text,SolrInputDocumentWritable> p : result) {
    System.out.println(p.getFirst());
    System.out.println(p.getSecond());
  }
}
