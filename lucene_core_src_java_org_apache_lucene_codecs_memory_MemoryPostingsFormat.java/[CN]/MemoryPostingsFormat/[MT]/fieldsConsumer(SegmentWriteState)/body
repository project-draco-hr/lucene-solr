{
  final String fileName=IndexFileNames.segmentFileName(state.segmentName,state.segmentSuffix,EXTENSION);
  final IndexOutput out=state.directory.createOutput(fileName,state.context);
  return new FieldsConsumer(){
    @Override public TermsConsumer addField(    FieldInfo field){
      if (field.indexOptions.compareTo(IndexOptions.DOCS_AND_FREQS_AND_POSITIONS_AND_OFFSETS) >= 0) {
        throw new UnsupportedOperationException("this codec cannot index offsets");
      }
      if (VERBOSE)       System.out.println("\naddField field=" + field.name);
      return new TermsWriter(out,field,doPackFST);
    }
    @Override public void close() throws IOException {
      try {
        out.writeVInt(0);
      }
  finally {
        out.close();
      }
    }
  }
;
}
