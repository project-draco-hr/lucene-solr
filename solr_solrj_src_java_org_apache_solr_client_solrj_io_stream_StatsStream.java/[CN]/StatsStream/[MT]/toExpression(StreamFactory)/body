{
  StreamExpression expression=new StreamExpression(factory.getFunctionName(this.getClass()));
  expression.addParameter(collection);
  ModifiableSolrParams mParams=new ModifiableSolrParams(params);
  for (  Entry<String,String[]> param : mParams.getMap().entrySet()) {
    expression.addParameter(new StreamExpressionNamedParameter(param.getKey(),String.join(",",param.getValue())));
  }
  expression.addParameter(new StreamExpressionNamedParameter("zkHost",zkHost));
  for (  Metric metric : metrics) {
    expression.addParameter(metric.toExpression(factory));
  }
  return expression;
}
