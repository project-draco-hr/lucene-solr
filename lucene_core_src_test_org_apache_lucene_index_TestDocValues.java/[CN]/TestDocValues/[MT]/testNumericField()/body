{
  Directory dir=newDirectory();
  IndexWriter iw=new IndexWriter(dir,newIndexWriterConfig(null));
  Document doc=new Document();
  doc.add(new NumericDocValuesField("foo",3));
  iw.addDocument(doc);
  DirectoryReader dr=DirectoryReader.open(iw,true);
  LeafReader r=getOnlySegmentReader(dr);
  assertNotNull(DocValues.getNumeric(r,"foo"));
  assertNotNull(DocValues.getSortedNumeric(r,"foo"));
  assertNotNull(DocValues.getDocsWithField(r,"foo"));
  try {
    DocValues.getBinary(r,"foo");
    fail();
  }
 catch (  IllegalStateException expected) {
  }
  try {
    DocValues.getSorted(r,"foo");
    fail();
  }
 catch (  IllegalStateException expected) {
  }
  try {
    DocValues.getSortedSet(r,"foo");
    fail();
  }
 catch (  IllegalStateException expected) {
  }
  dr.close();
  iw.close();
  dir.close();
}
