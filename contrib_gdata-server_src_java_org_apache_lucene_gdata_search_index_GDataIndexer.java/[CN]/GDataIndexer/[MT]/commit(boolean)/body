{
  if (LOG.isInfoEnabled())   LOG.info("Commit called with optimize = " + optimize);
  int changes=this.docsAdded.intValue() + this.docsDeleted.intValue() + this.docsUpdated.intValue();
  if (changes == 0)   return;
  this.committed.incrementAndGet();
  if (optimize)   this.optimized.incrementAndGet();
  doDeltete();
  if (optimize) {
    closeSearcher();
    openWriter();
    this.writer.optimize();
  }
  closeSearcher();
  closeWriter();
  this.docsAdded.set(0);
  this.docsDeleted.set(0);
  this.docsUpdated.set(0);
  notifyCommitListeners(this.serviceConfiguration.getName());
}
