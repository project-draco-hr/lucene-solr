{
  TreeMap<String,Integer> termMap=new TreeMap<String,Integer>();
  IndexReader indexReader=IndexReader.open(indexName,true);
  Fields fields=MultiFields.getFields(indexReader);
  if (fields != null) {
    FieldsEnum fieldsEnum=fields.iterator();
    String curField;
    while ((curField=fieldsEnum.next()) != null) {
      TermsEnum terms=fieldsEnum.terms();
      BytesRef text;
      while ((text=terms.next()) != null) {
        if ((field == null) || field.equals(curField)) {
          termMap.put(curField + ":" + text.utf8ToString(),Integer.valueOf((terms.docFreq())));
        }
      }
    }
  }
  Iterator<String> termIterator=termMap.keySet().iterator();
  for (int ii=0; termIterator.hasNext() && ii < 100; ii++) {
    String termDetails=termIterator.next();
    Integer termFreq=termMap.get(termDetails);
    message(termDetails + ": " + termFreq);
  }
  indexReader.close();
}
