{
  final BytesRef buf=new BytesRef();
  offsets=new int[maxDoc + 1];
  int[] ords=new int[maxDoc];
  int totOrds=0;
  final IntDecoder decoder=clp.createEncoder().createMatchingDecoder();
  final IntsRef values=new IntsRef(32);
  for (int docID=0; docID < maxDoc; docID++) {
    offsets[docID]=totOrds;
    dv.get(docID,buf);
    if (buf.length > 0) {
      decoder.decode(buf,values);
      if (totOrds + values.length >= ords.length) {
        ords=ArrayUtil.grow(ords,totOrds + values.length + 1);
      }
      for (int i=0; i < values.length; i++) {
        ords[totOrds++]=values.ints[i];
      }
    }
  }
  offsets[maxDoc]=totOrds;
  if ((double)totOrds / ords.length < 0.9) {
    this.ordinals=new int[totOrds];
    System.arraycopy(ords,0,this.ordinals,0,totOrds);
  }
 else {
    this.ordinals=ords;
  }
}
