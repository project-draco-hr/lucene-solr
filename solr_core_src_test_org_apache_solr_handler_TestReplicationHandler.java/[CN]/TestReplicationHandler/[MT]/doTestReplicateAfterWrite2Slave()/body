{
  clearIndexWithReplication();
  nDocs--;
  for (int i=0; i < nDocs; i++) {
    index(masterClient,"id",i,"name","name = " + i);
  }
  invokeReplicationCommand(masterJetty.getLocalPort(),"disableReplication");
  invokeReplicationCommand(slaveJetty.getLocalPort(),"disablepoll");
  masterClient.commit();
  assertEquals(nDocs,numFound(rQuery(nDocs,"*:*",masterClient)));
  index(slaveClient,"id",551,"name","name = " + 551);
  slaveClient.commit(true,true);
  index(slaveClient,"id",552,"name","name = " + 552);
  slaveClient.commit(true,true);
  index(slaveClient,"id",553,"name","name = " + 553);
  slaveClient.commit(true,true);
  index(slaveClient,"id",554,"name","name = " + 554);
  slaveClient.commit(true,true);
  index(slaveClient,"id",555,"name","name = " + 555);
  slaveClient.commit(true,true);
  assertEquals(1,numFound(rQuery(1,"id:555",slaveClient)));
  invokeReplicationCommand(masterJetty.getLocalPort(),"enablereplication");
  invokeReplicationCommand(slaveJetty.getLocalPort(),"fetchindex");
}
