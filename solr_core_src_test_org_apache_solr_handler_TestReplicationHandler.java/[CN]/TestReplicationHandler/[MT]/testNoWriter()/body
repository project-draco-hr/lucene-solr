{
  useFactory(null);
  System.setProperty("solr.tests.reopenReaders","false");
  try {
    slaveJetty.stop();
    masterJetty.stop();
    slaveJetty.start(true);
    masterJetty.start(true);
    index(slaveClient,"id","123456");
    slaveClient.commit();
    slaveJetty.stop();
    slaveJetty.start(true);
  }
  finally {
    System.clearProperty("solr.tests.reopenReaders");
  }
  CoreContainer cores=((SolrDispatchFilter)slaveJetty.getDispatchFilter().getFilter()).getCores();
  Collection<SolrCore> theCores=cores.getCores();
  assertEquals(1,theCores.size());
  SolrCore core=(SolrCore)theCores.toArray()[0];
  assertNull(core.getDeletionPolicy().getLatestCommit());
  pullFromMasterToSlave();
  resetFactory();
}
