{
  int timeSlept=0;
  NamedList res=null;
  SolrDocumentList docList=null;
  do {
    res=query(query,server);
    docList=(SolrDocumentList)res.get("response");
    timeSlept+=100;
    Thread.sleep(100);
  }
 while (docList.getNumFound() != expectedDocCount && timeSlept < 30000);
  return res;
}
