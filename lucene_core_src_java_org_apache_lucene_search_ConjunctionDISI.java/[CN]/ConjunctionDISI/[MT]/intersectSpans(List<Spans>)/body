{
  if (spanList.size() < 2) {
    throw new IllegalArgumentException("Cannot make a ConjunctionDISI of less than 2 iterators");
  }
  final List<DocIdSetIterator> allIterators=new ArrayList<>();
  final List<TwoPhaseIterator> twoPhaseIterators=new ArrayList<>();
  for (  Spans spans : spanList) {
    addSpans(spans,allIterators,twoPhaseIterators);
  }
  if (twoPhaseIterators.isEmpty()) {
    return new ConjunctionDISI(allIterators);
  }
 else {
    return new TwoPhase(allIterators,twoPhaseIterators);
  }
}
