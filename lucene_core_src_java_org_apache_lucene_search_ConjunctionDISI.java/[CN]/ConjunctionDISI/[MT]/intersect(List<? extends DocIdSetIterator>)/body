{
  final List<DocIdSetIterator> allIterators=new ArrayList<>();
  final List<TwoPhaseDocIdSetIterator> twoPhaseIterators=new ArrayList<>();
  for (  DocIdSetIterator iterator : iterators) {
    if (iterator instanceof Scorer) {
      TwoPhaseDocIdSetIterator twoPhaseIterator=((Scorer)iterator).asTwoPhaseIterator();
      if (twoPhaseIterator != null) {
        allIterators.add(twoPhaseIterator.approximation());
        twoPhaseIterators.add(twoPhaseIterator);
      }
 else {
        allIterators.add(iterator);
      }
    }
 else {
      allIterators.add(iterator);
    }
  }
  if (twoPhaseIterators.isEmpty()) {
    return new ConjunctionDISI(allIterators);
  }
 else {
    return new TwoPhase(allIterators,twoPhaseIterators);
  }
}
