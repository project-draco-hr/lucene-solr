{
  while (queries.hasNext()) {
    SpatialTestQuery q=queries.next();
    String msg=q.line;
    SearchResults got=executeQuery(strategy.makeQuery(q.args),100);
    if (storeShape && got.numFound > 0) {
      assertNotNull(ctx.readShape(got.results.get(0).document.get(strategy.getFieldName())));
    }
    if (concern.orderIsImportant) {
      Iterator<String> ids=q.ids.iterator();
      for (      SearchResult r : got.results) {
        String id=r.document.get("id");
        if (!ids.hasNext()) {
          Assert.fail(msg + " :: Did not get enough results.  Expect" + q.ids+ ", got: "+ got.toDebugString());
        }
        Assert.assertEquals("out of order: " + msg,ids.next(),id);
      }
      if (ids.hasNext()) {
        Assert.fail(msg + " :: expect more results then we got: " + ids.next());
      }
    }
 else {
      if (concern.resultsAreSuperset) {
        Set<String> found=new HashSet<String>();
        for (        SearchResult r : got.results) {
          found.add(r.document.get("id"));
        }
        for (        String s : q.ids) {
          if (!found.contains(s)) {
            Assert.fail("Results are mising id: " + s + " :: "+ found);
          }
        }
      }
 else {
        List<String> found=new ArrayList<String>();
        for (        SearchResult r : got.results) {
          found.add(r.document.get("id"));
        }
        Collections.sort(q.ids);
        Collections.sort(found);
        Assert.assertEquals(msg,q.ids.toString(),found.toString());
      }
    }
  }
}
