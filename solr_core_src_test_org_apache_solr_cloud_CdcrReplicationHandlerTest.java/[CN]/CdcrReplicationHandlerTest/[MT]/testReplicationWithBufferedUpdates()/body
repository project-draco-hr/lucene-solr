{
  List<CloudJettyRunner> slaves=this.getShardToSlaveJetty(SOURCE_COLLECTION,SHARD1);
  AtomicInteger numDocs=new AtomicInteger(0);
  ScheduledExecutorService executor=Executors.newSingleThreadScheduledExecutor(new DefaultSolrThreadFactory("cdcr-test-update-scheduler"));
  executor.scheduleWithFixedDelay(new UpdateThread(numDocs),10,10,TimeUnit.MILLISECONDS);
  this.restartServer(slaves.get(0));
  executor.shutdown();
  executor.awaitTermination(500,TimeUnit.MILLISECONDS);
  assertNumDocs(numDocs.get(),SOURCE_COLLECTION);
  assertNumDocs(numDocs.get(),slaves.get(0));
}
