{
  if (leafReader == null) {
    throw new IOException("You must first call Classifier#train");
  }
  String[] tokenizedDoc=tokenizeDoc(inputDocument);
  List<ClassificationResult<BytesRef>> dataList=calculateLogLikelihood(tokenizedDoc);
  ArrayList<ClassificationResult<BytesRef>> returnList=new ArrayList<>();
  if (!dataList.isEmpty()) {
    Collections.sort(dataList);
    double smax=dataList.get(0).getScore();
    double sumLog=0;
    for (    ClassificationResult<BytesRef> cr : dataList) {
      sumLog+=Math.exp(cr.getScore() - smax);
    }
    double loga=smax;
    loga+=Math.log(sumLog);
    for (    ClassificationResult<BytesRef> cr : dataList) {
      returnList.add(new ClassificationResult<>(cr.getAssignedClass(),Math.exp(cr.getScore() - loga)));
    }
  }
  return returnList;
}
