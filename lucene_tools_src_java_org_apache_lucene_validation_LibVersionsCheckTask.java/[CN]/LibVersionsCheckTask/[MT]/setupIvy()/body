{
  IvySettings ivySettings=new IvySettings();
  try {
    ivySettings.setVariable("common.build.dir",commonBuildDir.getAbsolutePath());
    ivySettings.setVariable("ivy.exclude.types","source|javadoc");
    ivySettings.setVariable("ivy.resolution-cache.dir",ivyResolutionCacheDir.getAbsolutePath());
    ivySettings.setVariable("ivy.lock-strategy",ivyLockStrategy);
    ivySettings.setVariable("ivysettings.xml",getProject().getProperty("ivysettings.xml"));
    ivySettings.setBaseDir(commonBuildDir);
    ivySettings.setDefaultConflictManager(new NoConflictManager());
    ivy=Ivy.newInstance(ivySettings);
    ivy.configure(topLevelIvySettingsFile);
  }
 catch (  Exception e) {
    throw new BuildException("Exception reading " + topLevelIvySettingsFile.getPath() + ": "+ e.toString(),e);
  }
}
