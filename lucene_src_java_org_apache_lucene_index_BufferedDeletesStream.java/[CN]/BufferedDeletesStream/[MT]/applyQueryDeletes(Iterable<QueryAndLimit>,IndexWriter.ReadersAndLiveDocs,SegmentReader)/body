{
  long delCount=0;
  final AtomicReaderContext readerContext=(AtomicReaderContext)reader.getTopReaderContext();
  boolean any=false;
  for (  QueryAndLimit ent : queriesIter) {
    Query query=ent.query;
    int limit=ent.limit;
    final DocIdSet docs=new QueryWrapperFilter(query).getDocIdSet(readerContext,readerContext.reader.getLiveDocs());
    if (docs != null) {
      final DocIdSetIterator it=docs.iterator();
      if (it != null) {
        while (true) {
          int doc=it.nextDoc();
          if (doc >= limit) {
            break;
          }
          if (!any) {
            rld.initWritableLiveDocs();
            any=true;
          }
          if (rld.delete(doc)) {
            delCount++;
          }
        }
      }
    }
  }
  return delCount;
}
