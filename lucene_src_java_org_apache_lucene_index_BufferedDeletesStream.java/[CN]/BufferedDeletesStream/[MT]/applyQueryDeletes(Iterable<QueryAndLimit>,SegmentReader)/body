{
  long delCount=0;
  final AtomicReaderContext readerContext=(AtomicReaderContext)reader.getTopReaderContext();
  for (  QueryAndLimit ent : queriesIter) {
    Query query=ent.query;
    int limit=ent.limit;
    final DocIdSet docs=new QueryWrapperFilter(query).getDocIdSet(readerContext);
    if (docs != null) {
      final DocIdSetIterator it=docs.iterator();
      if (it != null) {
        while (true) {
          int doc=it.nextDoc();
          if (doc >= limit)           break;
          reader.deleteDocument(doc);
          delCount++;
        }
      }
    }
  }
  return delCount;
}
