{
  int size;
  if (offsetOut != null) {
    size=VALUE_SIZE_VAR;
    offsetBuffer=new AppendingLongBuffer();
    this.offsets=offsetOut;
    CodecUtil.writeHeader(offsetOut,CODEC_NAME,VERSION_START);
  }
 else {
    size=maxLength;
    offsetBuffer=null;
    this.offsets=null;
  }
  CodecUtil.writeHeader(dataOut,CODEC_NAME,VERSION_START);
  dataOut.writeInt(size);
  dataOut.writeInt(maxLength);
  dataOut.writeInt(valueCount);
  CodecUtil.writeHeader(indexOut,CODEC_NAME,VERSION_START);
  this.data=dataOut;
  this.index=indexOut;
  this.valueCount=valueCount;
  ords=PackedInts.getWriter(index,docCount,PackedInts.bitsRequired(valueCount - 1),PackedInts.DEFAULT);
}
