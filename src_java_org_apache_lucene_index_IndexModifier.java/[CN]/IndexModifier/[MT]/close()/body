{
synchronized (directory) {
    if (!open)     throw new IllegalStateException("Index is closed already");
    if (indexWriter != null) {
      indexWriter.close();
      indexWriter=null;
    }
 else     if (indexReader != null) {
      indexReader.close();
      indexReader=null;
    }
    open=false;
    if (closeDir) {
      directory.close();
    }
    closeDir=false;
  }
}
