{
  if (termNum >= maxTermCounts.length) {
    int[] newMaxTermCounts=new int[maxTermCounts.length * 2];
    System.arraycopy(maxTermCounts,0,newMaxTermCounts,0,termNum);
    maxTermCounts=newMaxTermCounts;
  }
  final BytesRef term=te.term();
  if (te.docFreq() > maxTermDocFreq) {
    TopTerm topTerm=new TopTerm();
    topTerm.term=new BytesRef(term);
    topTerm.termNum=termNum;
    bigTerms.put(topTerm.termNum,topTerm);
    if (deState == null) {
      deState=new SolrIndexSearcher.DocsEnumState();
      deState.termsEnum=te;
    }
    maxTermCounts[termNum]=searcher.getDocSet(new TermQuery(new Term(field,topTerm.term)),deState).size();
    System.out.println("  big term termNum=" + termNum + " term="+ topTerm.term.utf8ToString()+ " size="+ maxTermCounts[termNum]+ " dF="+ te.docFreq());
  }
}
