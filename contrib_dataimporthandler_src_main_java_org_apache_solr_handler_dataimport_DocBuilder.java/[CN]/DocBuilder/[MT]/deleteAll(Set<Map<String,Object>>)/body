{
  LOG.info("Deleting stale documents ");
  Iterator<Map<String,Object>> iter=deletedKeys.iterator();
  while (iter.hasNext()) {
    Map<String,Object> map=iter.next();
    Object key=null;
    if (root.pk != null) {
      key=map.get(root.pk);
    }
    if (key == null && map.size() == 1) {
      for (      Map.Entry<String,Object> e : map.entrySet()) {
        key=e.getValue();
        break;
      }
    }
    if (key == null) {
      LOG.warn("no key was available for deleteted pk query");
      continue;
    }
    writer.deleteDoc(key);
    importStatistics.deletedDocCount.incrementAndGet();
    iter.remove();
  }
}
