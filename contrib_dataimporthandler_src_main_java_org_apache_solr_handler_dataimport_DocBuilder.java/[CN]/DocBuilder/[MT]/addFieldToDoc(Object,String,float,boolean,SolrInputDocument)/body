{
  if (value instanceof Collection) {
    Collection collection=(Collection)value;
    if (multiValued) {
      for (      Object o : collection) {
        doc.addField(name,o,boost);
      }
    }
 else {
      if (doc.getField(name) == null)       for (      Object o : collection) {
        doc.addField(name,o,boost);
        break;
      }
    }
  }
 else   if (multiValued) {
    doc.addField(name,value,boost);
  }
 else {
    if (doc.getField(name) == null)     doc.addField(name,value,boost);
  }
}
