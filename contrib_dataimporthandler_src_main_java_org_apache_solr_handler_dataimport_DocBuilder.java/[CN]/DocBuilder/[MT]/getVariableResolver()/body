{
  VariableResolverImpl resolver=new VariableResolverImpl();
  Map<String,Object> indexerNamespace=new HashMap<String,Object>();
  if (dataImporter.getLastIndexTime() != null)   indexerNamespace.put(LAST_INDEX_TIME,DataImporter.DATE_TIME_FORMAT.get().format(dataImporter.getLastIndexTime()));
  indexerNamespace.put(INDEX_START_TIME,dataImporter.getIndexStartTime());
  indexerNamespace.put("request",requestParameters.requestParams);
  indexerNamespace.put("functions",EvaluatorBag.getFunctionsNamespace(resolver,dataImporter.getConfig().functions,this));
  if (dataImporter.getConfig().script != null) {
    indexerNamespace.put(DataConfig.SCRIPT,dataImporter.getConfig().script.script);
    indexerNamespace.put(DataConfig.SCRIPT_LANG,dataImporter.getConfig().script.language);
  }
  resolver.addNamespace(DataConfig.IMPORTER_NS,indexerNamespace);
  return resolver;
}
