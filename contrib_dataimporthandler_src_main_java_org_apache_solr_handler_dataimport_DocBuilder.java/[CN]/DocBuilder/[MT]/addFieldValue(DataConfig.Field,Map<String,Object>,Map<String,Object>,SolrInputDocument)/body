{
  if (!field.toWrite)   return;
  Object value=arow.get(field.column);
  if (value == null) {
    if (lowerCaseMap != null) {
      value=lowerCaseMap.get(field.column.toLowerCase());
    }
    if (value == null)     return;
  }
  if (value instanceof Collection) {
    Collection collection=(Collection)value;
    if (field.multiValued) {
      for (      Object o : collection) {
        doc.addField(field.nameOrColName,o,field.boost);
      }
    }
 else {
      if (doc.getField(field.nameOrColName) == null)       for (      Object o : collection) {
        doc.addField(field.nameOrColName,o,field.boost);
        break;
      }
    }
  }
 else   if (field.multiValued) {
    doc.addField(field.nameOrColName,value,field.boost);
  }
 else {
    if (doc.getField(field.nameOrColName) == null)     doc.addField(field.nameOrColName,value,field.boost);
  }
}
