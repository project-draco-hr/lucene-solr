{
  VariableResolverImpl resolver=new VariableResolverImpl();
  Map<String,Object> indexerNamespace=new HashMap<String,Object>();
  if (context.getLastIndexTime() != null)   indexerNamespace.put(LAST_INDEX_TIME,DataImporter.DATE_TIME_FORMAT.format(context.getLastIndexTime()));
  indexerNamespace.put(INDEX_START_TIME,context.getIndexStartTime());
  indexerNamespace.put("request",requestParameters);
  indexerNamespace.put("defaults",defaultVariables);
  indexerNamespace.put("functions",EvaluatorBag.getFunctionsNamespace(resolver,dataImporter.getConfig().evaluators));
  if (context.getConfig().script != null) {
    indexerNamespace.put(DataConfig.SCRIPT,context.getConfig().script.script);
    indexerNamespace.put(DataConfig.SCRIPT_LANG,context.getConfig().script.language);
  }
  resolver.addNamespace(DataConfig.IMPORTER_NS,indexerNamespace);
  return resolver;
}
