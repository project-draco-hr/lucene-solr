{
  String str="[{'id':'1'},{'id':'2'}]".replace('\'','"');
  SolrQueryRequest req=req("commitWithin","100","overwrite","false");
  SolrQueryResponse rsp=new SolrQueryResponse();
  BufferingRequestProcessor p=new BufferingRequestProcessor(null);
  JsonLoader loader=new JsonLoader(req,p);
  loader.load(req,rsp,new ContentStreamBase.StringStream(str));
  assertEquals(2,p.addCommands.size());
  AddUpdateCommand add=p.addCommands.get(0);
  SolrInputDocument d=add.solrDoc;
  SolrInputField f=d.getField("id");
  assertEquals("1",f.getValue());
  assertEquals(add.commitWithin,100);
  assertEquals(add.overwrite,false);
  add=p.addCommands.get(1);
  d=add.solrDoc;
  f=d.getField("id");
  assertEquals("2",f.getValue());
  assertEquals(add.commitWithin,100);
  assertEquals(add.overwrite,false);
  req.close();
}
