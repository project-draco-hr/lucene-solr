{
  Runtime rt=Runtime.getRuntime();
  long max=rt.maxMemory();
  long total=rt.totalMemory();
  long free=rt.freeMemory();
  long half=free / 2;
  if (half >= ABSOLUTE_MIN_SORT_BUFFER_SIZE) {
    return new BufferSize(Math.min(MIN_BUFFER_SIZE_MB * MB,half));
  }
  half=(max - total) / 2;
  return new BufferSize(Math.min(MIN_BUFFER_SIZE_MB * MB,half));
}
