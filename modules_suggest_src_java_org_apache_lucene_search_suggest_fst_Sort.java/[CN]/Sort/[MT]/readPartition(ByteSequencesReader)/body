{
  long start=System.currentTimeMillis();
  Arrays.fill(this.buffer,null);
  int bytesLimit=this.ramBufferSize.bytes;
  byte[][] data=this.buffer;
  byte[] line;
  int linesRead=0;
  while ((line=reader.read()) != null) {
    if (linesRead + 1 >= data.length) {
      data=Arrays.copyOf(data,ArrayUtil.oversize(linesRead + MIN_EXPECTED_GROWTH,RamUsageEstimator.NUM_BYTES_OBJECT_REF));
    }
    data[linesRead++]=line;
    bytesLimit-=line.length + RamUsageEstimator.NUM_BYTES_ARRAY_HEADER;
    if (bytesLimit < 0) {
      break;
    }
  }
  this.buffer=data;
  sortInfo.readTime+=(System.currentTimeMillis() - start);
  return linesRead;
}
