{
  final int segCounts[];
  if (map == null) {
    segCounts=counts;
  }
 else {
    segCounts=new int[1 + si.getValueCount()];
  }
  int doc;
  while ((doc=disi.nextDoc()) != DocIdSetIterator.NO_MORE_DOCS) {
    segCounts[1 + si.getOrd(doc)]++;
  }
  if (map != null) {
    migrateGlobal(counts,segCounts,subIndex,map);
  }
}
