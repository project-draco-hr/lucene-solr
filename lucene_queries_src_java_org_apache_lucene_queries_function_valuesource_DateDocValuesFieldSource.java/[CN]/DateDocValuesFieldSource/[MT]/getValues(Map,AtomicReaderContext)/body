{
  final DocValues.Source source=getSource(readerContext.reader(),DocValues.Type.FIXED_INTS_64);
  final Bits liveDocs=readerContext.reader().getLiveDocs();
switch (source.getType()) {
case FIXED_INTS_64:
case VAR_INTS:
    if (source.hasArray() && source.getArray() instanceof long[]) {
      final long[] values=(long[])source.getArray();
      return new DVDateValues(this,source,liveDocs){
        @Override public long longVal(        int doc){
          return values[doc];
        }
      }
;
    }
  return new DVDateValues(this,source,liveDocs);
default :
throw new IllegalStateException(getClass().getSimpleName() + " only works with 64-bits integer types, not " + source.getType());
}
}
