{
  final int docBase=context.docBase;
  termsIndex=FieldCache.DEFAULT.getTermsIndex(context.reader(),field);
  FieldComparator<BytesRef> perSegComp=new AnyOrdComparator(termsIndex,docBase);
  currentReaderGen++;
  if (bottomSlot != -1) {
    perSegComp.setBottom(bottomSlot);
  }
  return perSegComp;
}
