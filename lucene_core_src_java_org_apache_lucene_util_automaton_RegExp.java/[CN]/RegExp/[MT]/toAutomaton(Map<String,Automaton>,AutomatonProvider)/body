{
  List<Automaton> list;
  Automaton a=null;
switch (kind) {
case REGEXP_UNION:
    list=new ArrayList<Automaton>();
  findLeaves(exp1,Kind.REGEXP_UNION,list,automata,automaton_provider);
findLeaves(exp2,Kind.REGEXP_UNION,list,automata,automaton_provider);
a=BasicOperations.union(list);
MinimizationOperations.minimize(a);
break;
case REGEXP_CONCATENATION:
list=new ArrayList<Automaton>();
findLeaves(exp1,Kind.REGEXP_CONCATENATION,list,automata,automaton_provider);
findLeaves(exp2,Kind.REGEXP_CONCATENATION,list,automata,automaton_provider);
a=BasicOperations.concatenate(list);
MinimizationOperations.minimize(a);
break;
case REGEXP_INTERSECTION:
a=exp1.toAutomaton(automata,automaton_provider).intersection(exp2.toAutomaton(automata,automaton_provider));
MinimizationOperations.minimize(a);
break;
case REGEXP_OPTIONAL:
a=exp1.toAutomaton(automata,automaton_provider).optional();
MinimizationOperations.minimize(a);
break;
case REGEXP_REPEAT:
a=exp1.toAutomaton(automata,automaton_provider).repeat();
MinimizationOperations.minimize(a);
break;
case REGEXP_REPEAT_MIN:
a=exp1.toAutomaton(automata,automaton_provider).repeat(min);
MinimizationOperations.minimize(a);
break;
case REGEXP_REPEAT_MINMAX:
a=exp1.toAutomaton(automata,automaton_provider).repeat(min,max);
MinimizationOperations.minimize(a);
break;
case REGEXP_COMPLEMENT:
a=exp1.toAutomaton(automata,automaton_provider).complement();
MinimizationOperations.minimize(a);
break;
case REGEXP_CHAR:
a=BasicAutomata.makeChar(c);
break;
case REGEXP_CHAR_RANGE:
a=BasicAutomata.makeCharRange(from,to);
break;
case REGEXP_ANYCHAR:
a=BasicAutomata.makeAnyChar();
break;
case REGEXP_EMPTY:
a=BasicAutomata.makeEmpty();
break;
case REGEXP_STRING:
a=BasicAutomata.makeString(s);
break;
case REGEXP_ANYSTRING:
a=BasicAutomata.makeAnyString();
break;
case REGEXP_AUTOMATON:
Automaton aa=null;
if (automata != null) aa=automata.get(s);
if (aa == null && automaton_provider != null) try {
aa=automaton_provider.getAutomaton(s);
}
 catch (IOException e) {
throw new IllegalArgumentException(e);
}
if (aa == null) throw new IllegalArgumentException("'" + s + "' not found");
a=aa.clone();
break;
case REGEXP_INTERVAL:
a=BasicAutomata.makeInterval(min,max,digits);
break;
}
return a;
}
