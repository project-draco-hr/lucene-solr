{
  AtomicReaderContext[] leaves=ReaderUtil.leaves(topLevelReaderContext);
  if (leaves.length == 1) {
    return query.getSpans(leaves[0],leaves[0].reader.getLiveDocs());
  }
  return new MultiSpansWrapper(leaves,query);
}
