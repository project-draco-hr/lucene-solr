{
  SolrParams params=params("q","*:*","rows","0","stats","true","facet.query","{!tag=ttt}price_ti:[25 TO 100]","facet","true","facet.pivot","{!query=t}place_t,company_t");
  QueryResponse rsp=query(params);
  assertNullFacetTypeInsidePivot(FacetParams.FACET_QUERY,rsp.getFacetPivot().get("place_t,company_t"));
  params=params("q","*:*","rows","0","stats","true","facet","true","facet.pivot","{!query=t}place_t,company_t");
  rsp=query(params);
  assertNullFacetTypeInsidePivot(FacetParams.FACET_QUERY,rsp.getFacetPivot().get("place_t,company_t"));
  params=params("q","*:*","rows","0","facet.query","{!tag=t}price_ti:[25 TO 100]","hang","","facet","true","facet.pivot","{!query=$hang}place_t,company_t");
  rsp=query(params);
  assertNullFacetTypeInsidePivot(FacetParams.FACET_QUERY,rsp.getFacetPivot().get("place_t,company_t"));
  params=params("q","*:*","rows","0","facet.query","{!tag=t}price_ti:[25 TO 100]","hang","price_ti:[0 TO 20]","facet","true","facet.pivot","{!query=$hang}place_t,company_t");
  rsp=query(params);
  assertNullFacetTypeInsidePivot(FacetParams.FACET_QUERY,rsp.getFacetPivot().get("place_t,company_t"));
}
