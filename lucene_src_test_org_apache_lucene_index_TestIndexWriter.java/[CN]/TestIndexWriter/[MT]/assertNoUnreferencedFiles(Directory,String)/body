{
  String[] startFiles=dir.listAll();
  SegmentInfos infos=new SegmentInfos();
  infos.read(dir);
  new IndexWriter(dir,new IndexWriterConfig(TEST_VERSION_CURRENT,new MockAnalyzer(random))).rollback();
  String[] endFiles=dir.listAll();
  Arrays.sort(startFiles);
  Arrays.sort(endFiles);
  if (!Arrays.equals(startFiles,endFiles)) {
    fail(message + ": before delete:\n    " + arrayToString(startFiles)+ "\n  after delete:\n    "+ arrayToString(endFiles));
  }
}
