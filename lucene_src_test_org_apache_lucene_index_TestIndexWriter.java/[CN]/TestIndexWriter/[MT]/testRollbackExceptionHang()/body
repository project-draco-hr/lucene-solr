{
  MockRAMDirectory dir=new MockRAMDirectory();
  MockIndexWriter4 w=new MockIndexWriter4(dir,new IndexWriterConfig(TEST_VERSION_CURRENT,new MockAnalyzer()));
  addDoc(w);
  w.doFail=true;
  try {
    w.rollback();
    fail("did not hit intentional RuntimeException");
  }
 catch (  RuntimeException re) {
  }
  w.doFail=false;
  w.rollback();
}
