{
  MockDirectoryWrapper dir=newDirectory();
  IndexWriter writer=new IndexWriter(dir,newIndexWriterConfig(TEST_VERSION_CURRENT,new MockAnalyzer()).setRAMBufferSizeMB(0.000001));
  ((LogMergePolicy)writer.getMergePolicy()).setMergeFactor(10);
  int lastNumFile=dir.listAll().length;
  for (int j=0; j < 9; j++) {
    Document doc=new Document();
    doc.add(newField("field","aaa" + j,Field.Store.YES,Field.Index.ANALYZED));
    writer.addDocument(doc);
    int numFile=dir.listAll().length;
    assertTrue(numFile > lastNumFile);
    lastNumFile=numFile;
  }
  writer.close();
  dir.close();
}
