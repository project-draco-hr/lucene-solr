{
  int pri=Thread.currentThread().getPriority();
  try {
    MockRAMDirectory dir=new MockRAMDirectory();
    IndexWriter iw=new IndexWriter(dir,new IndexWriterConfig(TEST_VERSION_CURRENT,new StandardAnalyzer(TEST_VERSION_CURRENT)).setMaxBufferedDocs(2));
    ((LogMergePolicy)iw.getMergePolicy()).setMergeFactor(2);
    Document document=new Document();
    document.add(new Field("tvtest","a b c",Field.Store.NO,Field.Index.ANALYZED,Field.TermVector.YES));
    Thread.currentThread().setPriority(Thread.MAX_PRIORITY);
    for (int i=0; i < 4; i++)     iw.addDocument(document);
    iw.close();
  }
  finally {
    Thread.currentThread().setPriority(pri);
  }
}
