{
  final SolrParams params=req.getParams();
  log.info("I have been requested to sync up my shard");
  ZkController zkController=coreContainer.getZkController();
  if (zkController == null) {
    throw new SolrException(ErrorCode.BAD_REQUEST,"Only valid for SolrCloud");
  }
  String cname=params.get(CoreAdminParams.CORE);
  if (cname == null) {
    throw new IllegalArgumentException(CoreAdminParams.CORE + " is required");
  }
  SolrCore core=null;
  SyncStrategy syncStrategy=null;
  try {
    core=coreContainer.getCore(cname);
    if (core != null) {
      syncStrategy=new SyncStrategy();
      Map<String,Object> props=new HashMap<String,Object>();
      props.put(ZkStateReader.BASE_URL_PROP,zkController.getBaseUrl());
      props.put(ZkStateReader.CORE_NAME_PROP,cname);
      props.put(ZkStateReader.NODE_NAME_PROP,zkController.getNodeName());
      boolean success=syncStrategy.sync(zkController,core,new ZkNodeProps(props));
      if (log.isDebugEnabled()) {
        try {
          RefCounted<SolrIndexSearcher> searchHolder=core.getNewestSearcher(false);
          SolrIndexSearcher searcher=searchHolder.get();
          try {
            log.debug(core.getCoreDescriptor().getCoreContainer().getZkController().getNodeName() + " synched " + searcher.search(new MatchAllDocsQuery(),1).totalHits);
          }
  finally {
            searchHolder.decref();
          }
        }
 catch (        Exception e) {
          throw new SolrException(ErrorCode.SERVER_ERROR,null,e);
        }
      }
      if (!success) {
        throw new SolrException(ErrorCode.SERVER_ERROR,"Sync Failed");
      }
    }
 else {
      SolrException.log(log,"Cound not find core to call sync:" + cname);
    }
  }
  finally {
    if (core != null) {
      core.close();
    }
    if (syncStrategy != null) {
      syncStrategy.close();
    }
  }
}
