{
  Directory dir;
  long size=0;
  try {
    if (!core.getDirectoryFactory().exists(core.getIndexDir())) {
      dir=core.getDirectoryFactory().get(core.getNewIndexDir(),DirContext.DEFAULT,core.getSolrConfig().indexConfig.lockType);
    }
 else {
      dir=core.getDirectoryFactory().get(core.getIndexDir(),DirContext.DEFAULT,core.getSolrConfig().indexConfig.lockType);
    }
    try {
      size=DirectoryFactory.sizeOfDirectory(dir);
    }
  finally {
      core.getDirectoryFactory().release(dir);
    }
  }
 catch (  IOException e) {
    SolrException.log(log,"IO error while trying to get the size of the Directory",e);
  }
  return size;
}
