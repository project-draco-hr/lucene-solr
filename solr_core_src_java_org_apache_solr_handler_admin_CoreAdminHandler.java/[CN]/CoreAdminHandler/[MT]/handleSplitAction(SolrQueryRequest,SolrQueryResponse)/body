{
  SolrParams params=adminReq.getParams();
  List<DocRouter.Range> ranges=null;
  String[] pathsArr=params.getParams("path");
  String rangesStr=params.get("ranges");
  String cname=params.get(CoreAdminParams.CORE,"");
  SolrCore core=coreContainer.getCore(cname);
  SolrQueryRequest req=new LocalSolrQueryRequest(core,params);
  List<SolrCore> newCores=null;
  try {
    List<String> paths=null;
    int partitions=pathsArr != null ? pathsArr.length : params.getInt("partitions",2);
    DocRouter.Range currentRange=new DocRouter.Range(Integer.MIN_VALUE,Integer.MAX_VALUE);
    DocRouter hp=new DocRouter();
    ranges=hp.partitionRange(partitions,currentRange);
    if (pathsArr == null) {
      newCores=new ArrayList<SolrCore>(partitions);
      for (int i=0; i < partitions; i++) {
        SolrCore newCore=createCore(core,i,ranges.get(i));
        newCores.add(newCore);
      }
    }
 else {
      paths=Arrays.asList(pathsArr);
    }
    SplitIndexCommand cmd=new SplitIndexCommand(req,paths,newCores,ranges);
    core.getUpdateHandler().split(cmd);
  }
 catch (  Exception e) {
    log.error("ERROR executing split:",e);
    throw new RuntimeException(e);
  }
 finally {
    if (req != null)     req.close();
    if (core != null)     core.close();
    if (newCores != null) {
      for (      SolrCore newCore : newCores) {
        newCore.close();
      }
    }
  }
  return false;
}
