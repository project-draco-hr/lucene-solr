{
  SolrParams params=req.getParams();
  String cname=params.get(CoreAdminParams.NAME,"");
  log.info("Starting to buffer updates on core:" + cname);
  try (SolrCore core=coreContainer.getCore(cname)){
    if (core == null)     throw new SolrException(ErrorCode.BAD_REQUEST,"Core [" + cname + "] does not exist");
    UpdateLog updateLog=core.getUpdateHandler().getUpdateLog();
    if (updateLog.getState() != UpdateLog.State.ACTIVE) {
      throw new SolrException(ErrorCode.SERVER_ERROR,"Core " + cname + " not in active state");
    }
    updateLog.bufferUpdates();
    rsp.add("core",cname);
    rsp.add("status","BUFFERING");
  }
 catch (  Throwable e) {
    if (e instanceof SolrException)     throw (SolrException)e;
 else     throw new SolrException(ErrorCode.SERVER_ERROR,"Could not start buffering updates",e);
  }
 finally {
    if (req != null)     req.close();
  }
}
