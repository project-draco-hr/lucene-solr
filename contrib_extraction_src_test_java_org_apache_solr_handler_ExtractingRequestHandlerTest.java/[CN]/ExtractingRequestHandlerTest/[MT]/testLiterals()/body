{
  ExtractingRequestHandler handler=(ExtractingRequestHandler)h.getCore().getRequestHandler("/update/extract");
  assertTrue("handler is null and it shouldn't be",handler != null);
  loadLocal("version_control.xml","ext.map.created","extractedDate","ext.map.producer","extractedProducer","ext.map.creator","extractedCreator","ext.map.Keywords","extractedKeywords","ext.map.Author","extractedAuthor","ext.def.fl","extractedContent","ext.literal.id","one","ext.map.language","extractedLanguage","ext.literal.extractionLiteralMV","one","ext.literal.extractionLiteralMV","two","ext.map.Last-Modified","extractedDate");
  assertQ(req("stream_name:version_control.xml"),"//*[@numFound='0']");
  assertU(commit());
  assertQ(req("stream_name:version_control.xml"),"//*[@numFound='1']");
  assertQ(req("extractionLiteralMV:one"),"//*[@numFound='1']");
  assertQ(req("extractionLiteralMV:two"),"//*[@numFound='1']");
  try {
    loadLocal("version_control.xml","ext.map.created","extractedDate","ext.map.producer","extractedProducer","ext.map.creator","extractedCreator","ext.map.Keywords","extractedKeywords","ext.map.Author","extractedAuthor","ext.def.fl","extractedContent","ext.literal.id","two","ext.map.language","extractedLanguage","ext.literal.extractionLiteral","one","ext.literal.extractionLiteral","two","ext.map.Last-Modified","extractedDate");
    assertTrue("Exception should have been thrown",false);
  }
 catch (  SolrException e) {
  }
  loadLocal("version_control.xml","ext.map.created","extractedDate","ext.map.producer","extractedProducer","ext.map.creator","extractedCreator","ext.map.Keywords","extractedKeywords","ext.map.Author","extractedAuthor","ext.def.fl","extractedContent","ext.literal.id","three","ext.map.language","extractedLanguage","ext.literal.extractionLiteral","one","ext.map.Last-Modified","extractedDate");
  assertU(commit());
  assertQ(req("extractionLiteral:one"),"//*[@numFound='1']");
}
