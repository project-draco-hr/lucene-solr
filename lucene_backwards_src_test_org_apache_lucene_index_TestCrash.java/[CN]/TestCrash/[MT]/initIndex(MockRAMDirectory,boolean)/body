{
  dir.setLockFactory(NoLockFactory.getNoLockFactory());
  IndexWriter writer=new IndexWriter(dir,new WhitespaceAnalyzer(),IndexWriter.MaxFieldLength.UNLIMITED);
  writer.setMaxBufferedDocs(10);
  ((ConcurrentMergeScheduler)writer.getMergeScheduler()).setSuppressExceptions();
  if (initialCommit) {
    writer.commit();
  }
  Document doc=new Document();
  doc.add(new Field("content","aaa",Field.Store.YES,Field.Index.ANALYZED));
  doc.add(new Field("id","0",Field.Store.YES,Field.Index.ANALYZED));
  for (int i=0; i < 157; i++)   writer.addDocument(doc);
  return writer;
}
