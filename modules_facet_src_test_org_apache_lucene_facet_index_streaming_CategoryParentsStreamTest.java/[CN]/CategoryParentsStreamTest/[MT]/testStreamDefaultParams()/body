{
  Directory directory=newDirectory();
  TaxonomyWriter taxonomyWriter=new LuceneTaxonomyWriter(directory);
  CategoryParentsStream stream=new CategoryParentsStream(new CategoryAttributesStream(categoryContainer),taxonomyWriter,new DefaultFacetIndexingParams());
  int nTokens;
  for (nTokens=0; stream.incrementToken(); nTokens++) {
  }
  assertEquals("Wrong number of tokens",6,nTokens);
  taxonomyWriter.close();
  directory.close();
}
