{
  final TaxonomyWriter taxonomyWriter=new LuceneTaxonomyWriter(new RAMDirectory());
  FacetIndexingParams indexingParams=new DefaultFacetIndexingParams(){
    @Override protected OrdinalPolicy fixedOrdinalPolicy(){
      return new NonTopLevelOrdinalPolicy();
    }
    @Override protected PathPolicy fixedPathPolicy(){
      return new NonTopLevelPathPolicy();
    }
  }
;
  CategoryParentsStream stream=new CategoryParentsStream(new CategoryAttributesStream(categoryContainer),taxonomyWriter,indexingParams);
  int nTokens;
  for (nTokens=0; stream.incrementToken(); nTokens++) {
  }
  assertEquals("Wrong number of tokens",4,nTokens);
  taxonomyWriter.close();
}
