{
  Iterable<ContentStream> streams=req.getContentStreams();
  if (streams == null) {
    throw new SolrException(SolrException.ErrorCode.BAD_REQUEST,"missing content stream");
  }
  try {
    for (    ContentStream stream : streams) {
      runCommandsTillSuccess(stream);
    }
  }
 catch (  Exception e) {
    resp.setException(e);
    resp.add(CommandOperation.ERR_MSGS,singletonList(SchemaManager.getErrorStr(e)));
  }
}
