{
  final String coreName=core.getName();
  final CoreContainer cc=core.getCoreDescriptor().getCoreContainer();
  final String overlayPath=(zkSolrResourceLoader).getConfigSetZkPath() + "/" + ConfigOverlay.RESOURCE_NAME;
  final String solrConfigPath=(zkSolrResourceLoader).getConfigSetZkPath() + "/" + core.getSolrConfig().getName();
  return new Runnable(){
    @Override public void run(){
      log.info("config update listener called for core {}",coreName);
      SolrZkClient zkClient=cc.getZkController().getZkClient();
      int solrConfigversion, overlayVersion;
      try (SolrCore core=cc.getCore(coreName)){
        if (core.isClosed())         return;
        solrConfigversion=core.getSolrConfig().getOverlay().getZnodeVersion();
        overlayVersion=core.getSolrConfig().getZnodeVersion();
      }
       if (checkStale(zkClient,overlayPath,solrConfigversion) || checkStale(zkClient,solrConfigPath,overlayVersion)) {
        log.info("core reload {}",coreName);
        cc.reload(coreName);
      }
    }
  }
;
}
