{
  if (!(core.getResourceLoader() instanceof ZkSolrResourceLoader))   return;
  final ZkSolrResourceLoader zkSolrResourceLoader=(ZkSolrResourceLoader)core.getResourceLoader();
  if (zkSolrResourceLoader != null) {
    Runnable listener=new Runnable(){
      @Override public void run(){
        try {
          if (core.isClosed())           return;
          Stat stat=zkSolrResourceLoader.getZkController().getZkClient().exists((zkSolrResourceLoader).getCollectionZkPath() + "/" + ConfigOverlay.RESOURCE_NAME,null,true);
          if (stat == null)           return;
          if (stat.getVersion() > core.getSolrConfig().getOverlay().getZnodeVersion()) {
            core.getCoreDescriptor().getCoreContainer().reload(core.getName());
          }
        }
 catch (        KeeperException.NoNodeException nne) {
        }
catch (        KeeperException e) {
          log.error("error refreshing solrconfig ",e);
        }
catch (        InterruptedException e) {
          Thread.currentThread().isInterrupted();
        }
      }
    }
;
    zkSolrResourceLoader.getZkController().registerConfListenerForCore(zkSolrResourceLoader.getCollectionZkPath(),core,listener);
  }
}
