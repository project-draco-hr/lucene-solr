{
  List<String> activeReplicaCoreUrls=new ArrayList<>();
  ClusterState clusterState=zkController.getZkStateReader().getClusterState();
  Set<String> liveNodes=clusterState.getLiveNodes();
  Collection<Slice> activeSlices=clusterState.getActiveSlices(collection);
  if (activeSlices != null && activeSlices.size() > 0) {
    for (    Slice next : activeSlices) {
      Map<String,Replica> replicasMap=next.getReplicasMap();
      if (replicasMap != null) {
        for (        Map.Entry<String,Replica> entry : replicasMap.entrySet()) {
          Replica replica=entry.getValue();
          if (ZkStateReader.ACTIVE.equals(replica.getStr(ZkStateReader.STATE_PROP)) && liveNodes.contains(replica.getNodeName())) {
            activeReplicaCoreUrls.add(replica.getCoreUrl());
          }
        }
      }
    }
  }
  return activeReplicaCoreUrls;
}
