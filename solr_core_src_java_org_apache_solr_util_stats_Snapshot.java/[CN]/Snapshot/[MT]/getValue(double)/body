{
  if (quantile < 0.0 || quantile > 1.0) {
    throw new IllegalArgumentException(quantile + " is not in [0..1]");
  }
  if (values.length == 0) {
    return 0.0;
  }
  final double pos=quantile * (values.length + 1);
  if (pos < 1) {
    return values[0];
  }
  if (pos >= values.length) {
    return values[values.length - 1];
  }
  final double lower=values[(int)pos - 1];
  final double upper=values[(int)pos];
  return lower + (pos - floor(pos)) * (upper - lower);
}
