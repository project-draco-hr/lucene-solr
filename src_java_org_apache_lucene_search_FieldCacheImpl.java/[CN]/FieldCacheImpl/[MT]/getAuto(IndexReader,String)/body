{
  field=field.intern();
  Object ret=lookup(reader,field,SortField.AUTO);
  if (ret == null) {
    TermEnum enumerator=reader.terms(new Term(field,""));
    try {
      Term term=enumerator.term();
      if (term == null) {
        throw new RuntimeException("no terms in field " + field + " - cannot determine sort type");
      }
      if (term.field() == field) {
        String termtext=term.text().trim();
        try {
          Integer.parseInt(termtext);
          ret=getInts(reader,field);
        }
 catch (        NumberFormatException nfe1) {
          try {
            Float.parseFloat(termtext);
            ret=getFloats(reader,field);
          }
 catch (          NumberFormatException nfe2) {
            ret=getStringIndex(reader,field);
          }
        }
        if (ret != null) {
          store(reader,field,SortField.AUTO,ret);
        }
      }
 else {
        throw new RuntimeException("field \"" + field + "\" does not appear to be indexed");
      }
    }
  finally {
      enumerator.close();
    }
  }
  return ret;
}
