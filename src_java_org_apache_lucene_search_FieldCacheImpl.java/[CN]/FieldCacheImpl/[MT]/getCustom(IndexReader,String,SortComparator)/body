{
  field=field.intern();
  Object ret=lookup(reader,field,comparator);
  if (ret == null) {
    final Comparable[] retArray=new Comparable[reader.maxDoc()];
    TermDocs termDocs=reader.termDocs();
    TermEnum termEnum=reader.terms(new Term(field,""));
    try {
      do {
        Term term=termEnum.term();
        if (term == null || term.field() != field)         break;
        Comparable termval=comparator.getComparable(term.text());
        termDocs.seek(termEnum);
        while (termDocs.next()) {
          retArray[termDocs.doc()]=termval;
        }
      }
 while (termEnum.next());
    }
  finally {
      termDocs.close();
      termEnum.close();
    }
    store(reader,field,comparator,retArray);
    return retArray;
  }
  return (Comparable[])ret;
}
