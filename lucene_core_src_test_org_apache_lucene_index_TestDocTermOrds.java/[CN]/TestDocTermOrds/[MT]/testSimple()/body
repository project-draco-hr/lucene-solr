{
  Directory dir=newDirectory();
  final RandomIndexWriter w=new RandomIndexWriter(random(),dir,newIndexWriterConfig(TEST_VERSION_CURRENT,new MockAnalyzer(random())).setMergePolicy(newLogMergePolicy()));
  Document doc=new Document();
  Field field=newField("field","",TextField.TYPE_UNSTORED);
  doc.add(field);
  field.setStringValue("a b c");
  w.addDocument(doc);
  field.setStringValue("d e f");
  w.addDocument(doc);
  field.setStringValue("a f");
  w.addDocument(doc);
  final IndexReader r=w.getReader();
  w.close();
  final DocTermOrds dto=new DocTermOrds(SlowCompositeReaderWrapper.wrap(r),"field");
  TermOrdsIterator iter=dto.lookup(0,null);
  final int[] buffer=new int[5];
  assertEquals(3,iter.read(buffer));
  assertEquals(0,buffer[0]);
  assertEquals(1,buffer[1]);
  assertEquals(2,buffer[2]);
  iter=dto.lookup(1,iter);
  assertEquals(3,iter.read(buffer));
  assertEquals(3,buffer[0]);
  assertEquals(4,buffer[1]);
  assertEquals(5,buffer[2]);
  iter=dto.lookup(2,iter);
  assertEquals(2,iter.read(buffer));
  assertEquals(0,buffer[0]);
  assertEquals(5,buffer[1]);
  r.close();
  dir.close();
}
