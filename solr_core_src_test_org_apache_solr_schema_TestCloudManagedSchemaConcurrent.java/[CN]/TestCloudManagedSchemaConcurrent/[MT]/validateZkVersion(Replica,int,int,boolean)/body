{
  final String replicaUrl=(new ZkCoreNodeProps(replica)).getCoreUrl();
  RestTestHarness testHarness=new RestTestHarness(new RESTfulServerProvider(){
    public String getBaseURL(){
      return replicaUrl.endsWith("/") ? replicaUrl.substring(0,replicaUrl.length() - 1) : replicaUrl;
    }
  }
);
  long waitMs=waitSecs * 1000L;
  if (waitMs > 0)   Thread.sleep(waitMs);
  try {
    testHarness.validateQuery("/schema/zkversion?wt=xml","//zkversion=" + schemaZkVersion);
  }
 catch (  Exception exc) {
    if (retry) {
      Thread.sleep(waitMs > 0 ? waitMs : 2000L);
      testHarness.validateQuery("/schema/zkversion?wt=xml","//zkversion=" + schemaZkVersion);
    }
 else {
      throw exc;
    }
  }
}
