{
  final Directory dir=newDirectory();
  final IndexWriter writer=new IndexWriter(dir,new IndexWriterConfig(TEST_VERSION_CURRENT,new MockAnalyzer()));
  addDoc(writer,"1","the big dogs went running to the market");
  addDoc(writer,"2","the cat chased the mouse, then the cat ate the mouse quickly");
  writer.close();
  final IndexReader reader=IndexReader.open(dir,true);
  final IndexSearcher searcher=newSearcher(reader);
  assertEquals(2,hitCount(searcher,"the"));
  assertEquals(1,hitCount(searcher,"cat"));
  assertEquals(1,hitCount(searcher,"dogs"));
  assertEquals(0,hitCount(searcher,"rabbit"));
  assertEquals(1,searcher.search(createSpan(0,true,new SpanQuery[]{createSpan(4,false,"chased","cat"),createSpan("ate")}),10).totalHits);
  searcher.close();
  reader.close();
  dir.close();
}
