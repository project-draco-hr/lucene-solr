{
  String aliasName=message.getStr("name");
  Map previousMDCContext=MDC.getCopyOfContextMap();
  MDCUtils.setCollection(aliasName);
  Map<String,Map<String,String>> newAliasesMap=new HashMap<>();
  Map<String,String> newCollectionAliasesMap=new HashMap<>();
  newCollectionAliasesMap.putAll(aliases.getCollectionAliasMap());
  newCollectionAliasesMap.remove(aliasName);
  newAliasesMap.put("collection",newCollectionAliasesMap);
  Aliases newAliases=new Aliases(newAliasesMap);
  byte[] jsonBytes=null;
  if (newAliases.collectionAliasSize() > 0) {
    jsonBytes=ZkStateReader.toJSON(newAliases.getAliasMap());
  }
  try {
    zkStateReader.getZkClient().setData(ZkStateReader.ALIASES,jsonBytes,true);
    checkForAliasAbsence(aliasName);
    Thread.sleep(100);
  }
 catch (  KeeperException e) {
    log.error("",e);
    throw new SolrException(ErrorCode.SERVER_ERROR,e);
  }
catch (  InterruptedException e) {
    log.warn("",e);
    throw new SolrException(ErrorCode.SERVER_ERROR,e);
  }
 finally {
    MDCUtils.cleanupMDC(previousMDCContext);
  }
}
