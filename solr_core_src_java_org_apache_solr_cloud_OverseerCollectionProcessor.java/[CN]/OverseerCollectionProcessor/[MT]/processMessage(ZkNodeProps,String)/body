{
  log.warn("OverseerCollectionProcessor.processMessage : " + operation + " , "+ message.toString());
  NamedList results=new NamedList();
  try {
    if (CREATECOLLECTION.equals(operation)) {
      createCollection(zkStateReader.getClusterState(),message,results);
    }
 else     if (DELETECOLLECTION.equals(operation)) {
      deleteCollection(message,results);
    }
 else     if (RELOADCOLLECTION.equals(operation)) {
      ModifiableSolrParams params=new ModifiableSolrParams();
      params.set(CoreAdminParams.ACTION,CoreAdminAction.RELOAD.toString());
      collectionCmd(zkStateReader.getClusterState(),message,params,results,ZkStateReader.ACTIVE);
    }
 else     if (CREATEALIAS.equals(operation)) {
      createAlias(zkStateReader.getAliases(),message);
    }
 else     if (DELETEALIAS.equals(operation)) {
      deleteAlias(zkStateReader.getAliases(),message);
    }
 else     if (SPLITSHARD.equals(operation)) {
      splitShard(zkStateReader.getClusterState(),message,results);
    }
 else     if (CREATESHARD.equals(operation)) {
      createShard(zkStateReader.getClusterState(),message,results);
    }
 else     if (DELETESHARD.equals(operation)) {
      deleteShard(zkStateReader.getClusterState(),message,results);
    }
 else     if (DELETEREPLICA.equals(operation)) {
      deleteReplica(zkStateReader.getClusterState(),message,results);
    }
 else     if (MIGRATE.equals(operation)) {
      migrate(zkStateReader.getClusterState(),message,results);
    }
 else     if (REMOVEROLE.isEqual(operation) || ADDROLE.isEqual(operation)) {
      processRoleCommand(message,operation);
    }
 else     if (ADDREPLICA.isEqual(operation)) {
      addReplica(zkStateReader.getClusterState(),message,results);
    }
 else {
      throw new SolrException(ErrorCode.BAD_REQUEST,"Unknown operation:" + operation);
    }
  }
 catch (  Exception e) {
    SolrException.log(log,"Collection " + operation + " of "+ operation+ " failed",e);
    results.add("Operation " + operation + " caused exception:",e);
    SimpleOrderedMap nl=new SimpleOrderedMap();
    nl.add("msg",e.getMessage());
    nl.add("rspCode",e instanceof SolrException ? ((SolrException)e).code() : -1);
    results.add("exception",nl);
  }
  return new OverseerSolrResponse(results);
}
