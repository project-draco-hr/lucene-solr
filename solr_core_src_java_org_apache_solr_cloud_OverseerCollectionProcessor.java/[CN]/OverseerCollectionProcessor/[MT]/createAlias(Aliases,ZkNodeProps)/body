{
  String aliasName=message.getStr(NAME);
  String collections=message.getStr("collections");
  Map<String,Map<String,String>> newAliasesMap=new HashMap<>();
  Map<String,String> newCollectionAliasesMap=new HashMap<>();
  Map<String,String> prevColAliases=aliases.getCollectionAliasMap();
  if (prevColAliases != null) {
    newCollectionAliasesMap.putAll(prevColAliases);
  }
  newCollectionAliasesMap.put(aliasName,collections);
  newAliasesMap.put("collection",newCollectionAliasesMap);
  Aliases newAliases=new Aliases(newAliasesMap);
  byte[] jsonBytes=null;
  if (newAliases.collectionAliasSize() > 0) {
    jsonBytes=Utils.toJSON(newAliases.getAliasMap());
  }
  try {
    zkStateReader.getZkClient().setData(ZkStateReader.ALIASES,jsonBytes,true);
    checkForAlias(aliasName,collections);
    Thread.sleep(100);
  }
 catch (  KeeperException e) {
    log.error("",e);
    throw new SolrException(ErrorCode.SERVER_ERROR,e);
  }
catch (  InterruptedException e) {
    log.warn("",e);
    throw new SolrException(ErrorCode.SERVER_ERROR,e);
  }
}
