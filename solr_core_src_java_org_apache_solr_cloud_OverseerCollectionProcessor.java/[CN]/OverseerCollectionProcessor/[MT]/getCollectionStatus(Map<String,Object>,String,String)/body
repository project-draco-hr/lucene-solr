{
  if (collection == null) {
    throw new SolrException(ErrorCode.BAD_REQUEST,"Collection: " + name + " not found");
  }
  if (shardStr == null) {
    return collection;
  }
 else {
    Map<String,Object> shards=(Map<String,Object>)collection.get("shards");
    Map<String,Object> selected=new HashMap<>();
    List<String> selectedShards=Arrays.asList(shardStr.split(","));
    for (    String selectedShard : selectedShards) {
      if (!shards.containsKey(selectedShard)) {
        throw new SolrException(ErrorCode.BAD_REQUEST,"Collection: " + name + " shard: "+ selectedShard+ " not found");
      }
      selected.put(selectedShard,shards.get(selectedShard));
      collection.put("shards",selected);
    }
    return collection;
  }
}
