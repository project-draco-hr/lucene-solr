{
  String collectionName=message.getStr(COLLECTION_PROP);
  String shardId=message.getStr(SHARD_ID_PROP);
  String baseURL=message.getStr(BASE_URL_PROP);
  String coreName=message.getStr(CORE_NAME_PROP);
  if (StringUtils.isBlank(collectionName) || StringUtils.isBlank(shardId) || StringUtils.isBlank(baseURL)|| StringUtils.isBlank(coreName)) {
    throw new SolrException(ErrorCode.BAD_REQUEST,String.format(Locale.ROOT,"The '%s', '%s', '%s' and '%s' parameters are required when assigning a leader",COLLECTION_PROP,SHARD_ID_PROP,BASE_URL_PROP,CORE_NAME_PROP));
  }
  SolrZkClient zkClient=zkStateReader.getZkClient();
  DistributedQueue inQueue=Overseer.getInQueue(zkClient);
  Map<String,Object> propMap=new HashMap<>();
  propMap.put(Overseer.QUEUE_OPERATION,Overseer.OverseerAction.LEADER.toLower());
  propMap.put(COLLECTION_PROP,collectionName);
  propMap.put(SHARD_ID_PROP,shardId);
  propMap.put(BASE_URL_PROP,baseURL);
  propMap.put(CORE_NAME_PROP,coreName);
  inQueue.offer(zkStateReader.toJSON(propMap));
}
