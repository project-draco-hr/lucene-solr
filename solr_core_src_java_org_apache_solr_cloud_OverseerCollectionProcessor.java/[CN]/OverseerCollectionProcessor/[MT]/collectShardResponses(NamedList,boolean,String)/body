{
  ShardResponse srsp;
  do {
    srsp=shardHandler.takeCompletedOrError();
    if (srsp != null) {
      processResponse(results,srsp);
      if (abortOnError && srsp.getException() != null) {
        throw new SolrException(ErrorCode.SERVER_ERROR,msgOnError,srsp.getException());
      }
    }
  }
 while (srsp != null);
}
