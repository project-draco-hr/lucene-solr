{
  log.info("Process current queue of collection creations");
  LeaderStatus isLeader=amILeader();
  while (isLeader == LeaderStatus.DONT_KNOW) {
    log.debug("am_i_leader unclear {}",isLeader);
    isLeader=amILeader();
  }
  while (!this.isClosed) {
    try {
      isLeader=amILeader();
      if (LeaderStatus.NO == isLeader) {
        break;
      }
 else       if (LeaderStatus.YES != isLeader) {
        log.debug("am_i_leader unclear {}",isLeader);
        continue;
      }
      QueueEvent head=workQueue.peek(true);
      final ZkNodeProps message=ZkNodeProps.load(head.getBytes());
      log.info("Overseer Collection Processor: Get the message id:" + head.getId() + " message:"+ message.toString());
      final String operation=message.getStr(QUEUE_OPERATION);
      SolrResponse response=processMessage(message,operation);
      head.setBytes(SolrResponse.serializable(response));
      workQueue.remove(head);
      log.info("Overseer Collection Processor: Message id:" + head.getId() + " complete, response:"+ response.getResponse().toString());
    }
 catch (    KeeperException e) {
      if (e.code() == KeeperException.Code.SESSIONEXPIRED || e.code() == KeeperException.Code.CONNECTIONLOSS) {
        log.warn("Overseer cannot talk to ZK");
        return;
      }
      SolrException.log(log,"",e);
      throw new ZooKeeperException(SolrException.ErrorCode.SERVER_ERROR,"",e);
    }
catch (    InterruptedException e) {
      Thread.currentThread().interrupt();
      return;
    }
catch (    Throwable e) {
      SolrException.log(log,"",e);
    }
  }
}
