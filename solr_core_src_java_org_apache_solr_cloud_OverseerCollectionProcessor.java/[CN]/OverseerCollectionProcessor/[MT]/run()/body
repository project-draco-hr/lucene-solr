{
  log.info("Process current queue of collection creations");
  while (amILeader() && !isClosed) {
    try {
      QueueEvent head=workQueue.peek(true);
      final ZkNodeProps message=ZkNodeProps.load(head.getBytes());
      log.info("Overseer Collection Processor: Get the message id:" + head.getId() + " message:"+ message.toString());
      final String operation=message.getStr(QUEUE_OPERATION);
      SolrResponse response=processMessage(message,operation);
      head.setBytes(SolrResponse.serializable(response));
      workQueue.remove(head);
      log.info("Overseer Collection Processor: Message id:" + head.getId() + " complete, response:"+ response.getResponse().toString());
    }
 catch (    KeeperException e) {
      if (e.code() == KeeperException.Code.SESSIONEXPIRED || e.code() == KeeperException.Code.CONNECTIONLOSS) {
        log.warn("Overseer cannot talk to ZK");
        return;
      }
      SolrException.log(log,"",e);
      throw new ZooKeeperException(SolrException.ErrorCode.SERVER_ERROR,"",e);
    }
catch (    InterruptedException e) {
      Thread.currentThread().interrupt();
      return;
    }
catch (    Throwable e) {
      SolrException.log(log,"",e);
    }
  }
}
