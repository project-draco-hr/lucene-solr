{
  Map<String,Int> termFreqMap=new HashMap<String,Int>();
  for (  String fieldName : fieldNames) {
    final Fields vectors=ir.getTermVectors(docNum);
    final Terms vector;
    if (vectors != null) {
      vector=vectors.terms(fieldName);
    }
 else {
      vector=null;
    }
    if (vector == null) {
      Document d=ir.document(docNum);
      IndexableField fields[]=d.getFields(fieldName);
      for (int j=0; j < fields.length; j++) {
        final String stringValue=fields[j].stringValue();
        if (stringValue != null) {
          addTermFrequencies(new StringReader(stringValue),termFreqMap,fieldName);
        }
      }
    }
 else {
      addTermFrequencies(termFreqMap,vector);
    }
  }
  return createQueue(termFreqMap);
}
