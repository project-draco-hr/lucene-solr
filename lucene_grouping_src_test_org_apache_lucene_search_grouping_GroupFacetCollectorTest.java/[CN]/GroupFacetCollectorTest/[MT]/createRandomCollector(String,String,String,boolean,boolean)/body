{
  BytesRef facetPrefixBR=facetPrefix == null ? null : new BytesRef(facetPrefix);
  if (useDv) {
    return DVGroupFacetCollector.createDvGroupFacetCollector(groupField,DocValues.Type.BYTES_VAR_SORTED,random().nextBoolean(),facetField,DocValues.Type.BYTES_VAR_SORTED,random().nextBoolean(),facetPrefixBR,random().nextInt(1024));
  }
 else {
    return TermGroupFacetCollector.createTermGroupFacetCollector(groupField,facetField,multipleFacetsPerDocument,facetPrefixBR,random().nextInt(1024));
  }
}
