{
  if (Constants.JAVA_VENDOR.startsWith("Sun") && Constants.JAVA_VERSION.startsWith("1.5")) {
    String defLang=Locale.getDefault().getLanguage();
    assumeFalse("Sun JRE 1.5 suffers from http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6240963 under Turkish locale",defLang.equals("tr") || defLang.equals("az"));
  }
  QueryTemplateManager qtm=new QueryTemplateManager();
  qtm.addQueryTemplate("albumBooleanQuery",getClass().getResourceAsStream("albumBooleanQuery.xsl"));
  qtm.addQueryTemplate("albumFilteredQuery",getClass().getResourceAsStream("albumFilteredQuery.xsl"));
  qtm.addQueryTemplate("albumLuceneClassicQuery",getClass().getResourceAsStream("albumLuceneClassicQuery.xsl"));
  for (int i=0; i < queryForms.length; i++) {
    Properties queryFormProperties=getPropsFromString(queryForms[i]);
    Document doc=qtm.getQueryAsDOM(queryFormProperties,queryFormProperties.getProperty("template"));
    Query q=builder.getQuery(doc.getDocumentElement());
    int h=searcher.search(q,null,1000).totalHits;
    int expectedHits=Integer.parseInt(queryFormProperties.getProperty("expectedMatches"));
    assertEquals("Number of results should match for query " + queryForms[i],expectedHits,h);
  }
}
