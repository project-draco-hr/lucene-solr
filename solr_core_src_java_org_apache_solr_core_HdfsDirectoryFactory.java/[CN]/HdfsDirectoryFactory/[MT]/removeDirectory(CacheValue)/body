{
  Configuration conf=getConf();
  FileSystem fileSystem=null;
  try {
    fileSystem=FileSystem.get(new URI(cacheValue.path),conf);
    boolean success=fileSystem.delete(new Path(cacheValue.path),true);
    if (!success) {
      throw new RuntimeException("Could not remove directory");
    }
  }
 catch (  Exception e) {
    LOG.error("Could not remove directory",e);
    throw new SolrException(ErrorCode.SERVER_ERROR,"Could not remove directory",e);
  }
 finally {
    IOUtils.closeQuietly(fileSystem);
  }
}
