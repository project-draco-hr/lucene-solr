{
  if (null == rawLockType) {
    LOG.warn("No lockType configured, assuming 'hdfs'.");
    rawLockType="hdfs";
  }
  final String lockType=rawLockType.toLowerCase(Locale.ROOT).trim();
switch (lockType) {
case "hdfs":
    return new HdfsLockFactory(new Path(lockPath),getConf());
case "single":
  return new SingleInstanceLockFactory();
case "none":
return NoLockFactory.getNoLockFactory();
default :
throw new SolrException(SolrException.ErrorCode.SERVER_ERROR,"Unrecognized lockType: " + rawLockType);
}
}
