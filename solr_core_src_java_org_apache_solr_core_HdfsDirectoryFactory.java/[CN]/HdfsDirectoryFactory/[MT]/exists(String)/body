{
  final Path hdfsDirPath=new Path(path);
  final Configuration conf=getConf();
  FileSystem fileSystem=null;
  try {
    fileSystem=tmpFsCache.get(path,new Callable<FileSystem>(){
      @Override public FileSystem call() throws IOException {
        return FileSystem.get(hdfsDirPath.toUri(),conf);
      }
    }
);
  }
 catch (  ExecutionException e) {
    throw new RuntimeException(e);
  }
  try {
    return fileSystem.exists(hdfsDirPath);
  }
 catch (  IOException e) {
    LOG.error("Error checking if hdfs path exists",e);
    throw new RuntimeException("Error checking if hdfs path exists",e);
  }
}
