{
  if (null == rawLockType) {
    LOG.warn("No lockType configured, assuming 'hdfs'.");
    rawLockType="hdfs";
  }
  final String lockType=rawLockType.toLowerCase(Locale.ROOT).trim();
switch (lockType) {
case "hdfs":
    return HdfsLockFactory.INSTANCE;
case DirectoryFactory.LOCK_TYPE_SINGLE:
  return new SingleInstanceLockFactory();
case DirectoryFactory.LOCK_TYPE_NONE:
return NoLockFactory.INSTANCE;
default :
throw new SolrException(SolrException.ErrorCode.SERVER_ERROR,"Unrecognized lockType: " + rawLockType);
}
}
