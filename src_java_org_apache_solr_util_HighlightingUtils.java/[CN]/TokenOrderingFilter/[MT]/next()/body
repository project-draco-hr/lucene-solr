{
  while (!done && queue.size() < windowSize) {
    Token newTok=input.next();
    if (newTok == null) {
      done=true;
      break;
    }
    ListIterator<Token> iter=queue.listIterator(queue.size());
    while (iter.hasPrevious()) {
      if (newTok.startOffset() >= iter.previous().startOffset()) {
        iter.next();
        break;
      }
    }
    iter.add(newTok);
  }
  return queue.isEmpty() ? null : queue.removeFirst();
}
