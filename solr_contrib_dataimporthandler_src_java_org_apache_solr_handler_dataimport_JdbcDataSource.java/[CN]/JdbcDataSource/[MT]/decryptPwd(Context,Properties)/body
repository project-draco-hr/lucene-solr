{
  String encryptionKey=context.replaceTokens(initProps.getProperty("encryptKeyFile"));
  if (initProps.getProperty("password") != null && encryptionKey != null) {
    try {
      try (Reader fr=new InputStreamReader(new FileInputStream(encryptionKey),UTF_8)){
        char[] chars=new char[100];
        int len=fr.read(chars);
        if (len < 6)         throw new DataImportHandlerException(SEVERE,"There should be a password of length 6 atleast " + encryptionKey);
        Properties props=new Properties();
        props.putAll(initProps);
        String password=null;
        try {
          password=CryptoKeys.decodeAES(initProps.getProperty("password"),new String(chars,0,len)).trim();
        }
 catch (        SolrException se) {
          throw new DataImportHandlerException(SEVERE,"Error decoding password",se.getCause());
        }
        props.put("password",password);
        initProps=props;
      }
     }
 catch (    IOException e) {
      throw new DataImportHandlerException(SEVERE,"Could not load encryptKeyFile  " + encryptionKey);
    }
  }
  return initProps;
}
