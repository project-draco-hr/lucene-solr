{
  try {
    Connection c=getConnection();
    stmt=c.createStatement(ResultSet.TYPE_FORWARD_ONLY,ResultSet.CONCUR_READ_ONLY);
    stmt.setFetchSize(batchSize);
    stmt.setMaxRows(maxRows);
    LOG.debug("Executing SQL: " + query);
    long start=System.currentTimeMillis();
    if (stmt.execute(query)) {
      resultSet=stmt.getResultSet();
    }
    LOG.trace("Time taken for sql :" + (System.currentTimeMillis() - start));
    colNames=readFieldNames(resultSet.getMetaData());
  }
 catch (  Exception e) {
    wrapAndThrow(SEVERE,e,"Unable to execute query: " + query);
  }
  if (resultSet == null) {
    rSetIterator=new ArrayList<Map<String,Object>>().iterator();
    return;
  }
  rSetIterator=new Iterator<Map<String,Object>>(){
    @Override public boolean hasNext(){
      return hasnext();
    }
    @Override public Map<String,Object> next(){
      return getARow();
    }
    @Override public void remove(){
    }
  }
;
}
