{
  if (resultSet == null)   return null;
  Map<String,Object> result=new HashMap<>();
  for (  String colName : colNames) {
    try {
      if (!convertType) {
        Object value=resultSet.getObject(colName);
        if (value instanceof BigDecimal || value instanceof BigInteger) {
          result.put(colName,value.toString());
        }
 else {
          result.put(colName,value);
        }
        continue;
      }
      Integer type=fieldNameVsType.get(colName);
      if (type == null)       type=Types.VARCHAR;
switch (type) {
case Types.INTEGER:
        result.put(colName,resultSet.getInt(colName));
      break;
case Types.FLOAT:
    result.put(colName,resultSet.getFloat(colName));
  break;
case Types.BIGINT:
result.put(colName,resultSet.getLong(colName));
break;
case Types.DOUBLE:
result.put(colName,resultSet.getDouble(colName));
break;
case Types.DATE:
result.put(colName,resultSet.getTimestamp(colName));
break;
case Types.BOOLEAN:
result.put(colName,resultSet.getBoolean(colName));
break;
case Types.BLOB:
result.put(colName,resultSet.getBytes(colName));
break;
default :
result.put(colName,resultSet.getString(colName));
break;
}
}
 catch (SQLException e) {
logError("Error reading data ",e);
wrapAndThrow(SEVERE,e,"Error reading data from database");
}
}
return result;
}
