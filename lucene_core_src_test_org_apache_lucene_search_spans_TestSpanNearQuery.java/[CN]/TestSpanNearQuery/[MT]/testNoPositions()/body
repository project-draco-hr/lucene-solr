{
  Directory dir=newDirectory();
  RandomIndexWriter iw=new RandomIndexWriter(random(),dir);
  Document doc=new Document();
  doc.add(new StringField("foo","bar",Field.Store.NO));
  iw.addDocument(doc);
  IndexReader ir=iw.getReader();
  iw.close();
  IndexSearcher is=new IndexSearcher(ir);
  SpanTermQuery query=new SpanTermQuery(new Term("foo","bar"));
  SpanTermQuery query2=new SpanTermQuery(new Term("foo","baz"));
  try {
    is.search(new SpanNearQuery(new SpanQuery[]{query,query2},10,true),5);
    fail("didn't get expected exception");
  }
 catch (  IllegalStateException expected) {
    assertTrue(expected.getMessage().contains("was indexed without position data"));
  }
  ir.close();
  dir.close();
}
