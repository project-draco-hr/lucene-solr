{
  directory=dir;
  fileName=name;
  boolean success=false;
  try {
    stream=dir.openFile(name);
    int count=stream.readVInt();
    FileEntry entry=null;
    for (int i=0; i < count; i++) {
      long offset=stream.readLong();
      String id=stream.readString();
      if (entry != null) {
        entry.length=offset - entry.offset;
      }
      entry=new FileEntry();
      entry.offset=offset;
      entries.put(id,entry);
    }
    if (entry != null) {
      entry.length=stream.length() - entry.offset;
    }
    success=true;
  }
  finally {
    if (!success) {
      try {
        stream.close();
      }
 catch (      IOException e) {
      }
    }
  }
}
