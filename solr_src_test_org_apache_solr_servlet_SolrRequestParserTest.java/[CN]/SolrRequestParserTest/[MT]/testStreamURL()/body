{
  boolean ok=false;
  String url="http://www.apache.org/dist/lucene/solr/";
  byte[] bytes=null;
  try {
    URLConnection connection=new URL(url).openConnection();
    connection.setConnectTimeout(5000);
    connection.setReadTimeout(5000);
    connection.connect();
    bytes=IOUtils.toByteArray(connection.getInputStream());
  }
 catch (  Exception ex) {
    assumeNoException("Unable to connect to " + url + " to run the test.",ex);
    return;
  }
  SolrCore core=h.getCore();
  Map<String,String[]> args=new HashMap<String,String[]>();
  args.put(CommonParams.STREAM_URL,new String[]{url});
  List<ContentStream> streams=new ArrayList<ContentStream>();
  SolrQueryRequest req=parser.buildRequestFrom(core,new MultiMapSolrParams(args),streams);
  assertEquals(1,streams.size());
  assertArrayEquals(bytes,IOUtils.toByteArray(streams.get(0).getStream()));
  req.close();
}
