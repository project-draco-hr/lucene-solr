{
  SortedDocValues source=getDirectSorted(field);
  final int valueCount=source.getValueCount();
  final byte[][] values=new byte[valueCount][];
  BytesRef scratch=new BytesRef();
  for (int ord=0; ord < valueCount; ord++) {
    source.lookupOrd(ord,scratch);
    values[ord]=new byte[scratch.length];
    System.arraycopy(scratch.bytes,scratch.offset,values[ord],0,scratch.length);
  }
  final int[] ords=new int[maxDoc];
  for (int docID=0; docID < maxDoc; docID++) {
    ords[docID]=source.getOrd(docID);
  }
  return new SortedDocValues(){
    @Override public int getOrd(    int docID){
      return ords[docID];
    }
    @Override public void lookupOrd(    int ord,    BytesRef result){
      result.bytes=values[ord];
      result.offset=0;
      result.length=result.bytes.length;
    }
    @Override public int getValueCount(){
      return valueCount;
    }
  }
;
}
