{
  TestSpellChecker checker=new TestSpellChecker();
  NamedList spellchecker=new NamedList();
  spellchecker.add("classname",IndexBasedSpellChecker.class.getName());
  File tmpDir=new File(System.getProperty("java.io.tmpdir"));
  File indexDir=new File(tmpDir,"spellingIdx" + new Date().getTime());
  indexDir.mkdirs();
  spellchecker.add(AbstractLuceneSpellChecker.INDEX_DIR,indexDir.getAbsolutePath());
  spellchecker.add(IndexBasedSpellChecker.FIELD,"title");
  spellchecker.add(AbstractLuceneSpellChecker.SPELLCHECKER_ARG_NAME,spellchecker);
  spellchecker.add(AbstractLuceneSpellChecker.STRING_DISTANCE,JaroWinklerDistance.class.getName());
  SolrCore core=h.getCore();
  String dictName=checker.init(spellchecker,core.getResourceLoader());
  assertTrue(dictName + " is not equal to " + SolrSpellChecker.DEFAULT_DICTIONARY_NAME,dictName.equals(SolrSpellChecker.DEFAULT_DICTIONARY_NAME) == true);
  RefCounted<SolrIndexSearcher> holder=core.getSearcher();
  SolrIndexSearcher searcher=holder.get();
  try {
    checker.build(core,searcher);
    SpellChecker sc=checker.getSpellChecker();
    assertTrue("sc is null and it shouldn't be",sc != null);
    StringDistance sd=sc.getStringDistance();
    assertTrue("sd is null and it shouldn't be",sd != null);
    assertTrue("sd is not an instance of " + JaroWinklerDistance.class.getName(),sd instanceof JaroWinklerDistance);
  }
  finally {
    holder.decref();
  }
}
