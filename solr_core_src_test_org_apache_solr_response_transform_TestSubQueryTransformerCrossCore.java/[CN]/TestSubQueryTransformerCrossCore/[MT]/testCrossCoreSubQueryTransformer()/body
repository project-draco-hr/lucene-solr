{
  assertQ("make sure request is parsed in this core",req("q","name_s:john","fl","*,depts:[subquery]","depts.q","{!field f=text_t}These guys"),"//result/doc/str[@name='name_s_dv'][.='john']/../result[@name='depts']/doc");
  assertQ("make sure request is parsed in that core",req("q","name_s:john","fl","*,depts:[subquery fromIndex=fromCore]","depts.q","{!field f=text_t}These guys"),"count(//result/doc/str[@name='name_s_dv'][.='john']/../result[@name='depts']/doc)=0");
  assertQ("make sure request is parsed in that core",req("q","-name_s:dave","indent","true","fl","*,depts:[subquery fromIndex=fromCore]","depts.q","{!field f=text_t v=$row.text_t}","depts.fl","dept_id_s"),"//result/doc/str[@name='name_s_dv'][.='john']/.." + "/result[@name='depts']/doc/str[@name='dept_id_s'][.='Engineering']","//result/doc/str[@name='name_s_dv'][.='tina']/.." + "/result[@name='depts']/doc/str[@name='dept_id_s'][.='Engineering']","//result/doc/str[@name='name_s_dv'][.='mark']/.." + "/result[@name='depts']/doc/str[@name='dept_id_s'][.='Marketing']");
}
