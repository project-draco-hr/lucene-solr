{
  groupFieldTermIndex=FieldCache.DEFAULT.getTermsIndex(context.reader(),groupField);
  countFieldTermIndex=FieldCache.DEFAULT.getTermsIndex(context.reader(),countField);
  ordSet.clear();
  for (  GroupCount group : groups) {
    int groupOrd=group.groupValue == null ? 0 : groupFieldTermIndex.binarySearchLookup(group.groupValue,spare);
    if (groupOrd < 0) {
      continue;
    }
    groupCounts[ordSet.put(groupOrd)]=group;
    group.ords=new int[group.uniqueValues.size()];
    Arrays.fill(group.ords,-1);
    int i=0;
    for (    BytesRef value : group.uniqueValues) {
      int countOrd=value == null ? 0 : countFieldTermIndex.binarySearchLookup(value,new BytesRef());
      if (countOrd >= 0) {
        group.ords[i++]=countOrd;
      }
    }
  }
}
