{
  int maxDoc=reader.maxDoc();
  final byte[] values;
  final ByteParser parser=(ByteParser)key.custom;
  if (parser == null) {
    return wrapper.getBytes(reader,key.field,DEFAULT_BYTE_PARSER,setDocsWithField);
  }
  values=new byte[maxDoc];
  Uninvert u=new Uninvert(){
    private byte currentValue;
    @Override public void visitTerm(    BytesRef term){
      currentValue=parser.parseByte(term);
    }
    @Override public void visitDoc(    int docID){
      values[docID]=currentValue;
    }
    @Override protected TermsEnum termsEnum(    Terms terms) throws IOException {
      return parser.termsEnum(terms);
    }
  }
;
  u.uninvert(reader,key.field,setDocsWithField);
  if (setDocsWithField) {
    wrapper.setDocsWithField(reader,key.field,u.docsWithField);
  }
  return new BytesFromArray(values);
}
