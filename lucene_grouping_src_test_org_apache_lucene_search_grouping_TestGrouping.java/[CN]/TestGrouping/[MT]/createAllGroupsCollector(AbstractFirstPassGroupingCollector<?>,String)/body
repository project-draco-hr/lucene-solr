{
  if (firstPassGroupingCollector.getClass().isAssignableFrom(TermFirstPassGroupingCollector.class)) {
    return new TermAllGroupsCollector(groupField);
  }
 else   if (firstPassGroupingCollector.getClass().isAssignableFrom(DVFirstPassGroupingCollector.class)) {
    boolean diskResident=random().nextBoolean();
    return DVAllGroupsCollector.create(groupField + "_dv",Type.BYTES_VAR_SORTED,diskResident);
  }
 else {
    ValueSource vs=new BytesRefFieldSource(groupField);
    return new FunctionAllGroupsCollector(vs,new HashMap<Object,Object>());
  }
}
