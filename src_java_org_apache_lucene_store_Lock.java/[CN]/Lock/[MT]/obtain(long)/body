{
  boolean locked=obtain();
  int maxSleepCount=(int)(lockWaitTimeout / LOCK_POLL_INTERVAL);
  int sleepCount=0;
  while (!locked) {
    if (++sleepCount == maxSleepCount) {
      throw new IOException("Lock obtain timed out");
    }
    try {
      Thread.sleep(LOCK_POLL_INTERVAL);
    }
 catch (    InterruptedException e) {
      throw new IOException(e.toString());
    }
    locked=obtain();
  }
  return locked;
}
