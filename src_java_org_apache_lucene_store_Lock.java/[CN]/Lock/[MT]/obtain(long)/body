{
  boolean locked=obtain();
  int maxSleepCount=(int)(lockWaitTimeout / LOCK_POLL_INTERVAL);
  int sleepCount=0;
  while (!locked) {
    if (++sleepCount == maxSleepCount) {
      String s="Lock obtain timed out";
      if (lockName != null) {
        s+=", lock name =" + lockName;
      }
      throw new IOException(s);
    }
    try {
      Thread.sleep(LOCK_POLL_INTERVAL);
    }
 catch (    InterruptedException e) {
      throw new IOException(e.toString());
    }
    locked=obtain();
  }
  return locked;
}
