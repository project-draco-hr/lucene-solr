{
  if (fieldsWriter == null) {
    segment=docWriter.getSegment();
    if (segment != null) {
      fieldsWriter=new FieldsWriter(docWriter.directory,segment,fieldInfos);
      docWriter.addOpenFile(IndexFileNames.segmentFileName(segment,"",IndexFileNames.FIELDS_EXTENSION));
      docWriter.addOpenFile(IndexFileNames.segmentFileName(segment,"",IndexFileNames.FIELDS_INDEX_EXTENSION));
      lastDocID=0;
    }
  }
}
