{
  Document doc=new Document();
  doc.add(newStringField("f1","v1",Field.Store.YES));
  FieldType customType2=new FieldType(StringField.TYPE_STORED);
  customType2.setStoreTermVectors(true);
  customType2.setStoreTermVectorOffsets(true);
  customType2.setStoreTermVectorPositions(true);
  doc.add(newField("f1","v2",customType2));
  doc.add(newField("f2","v1",customType2));
  doc.add(newStringField("f2","v2",Field.Store.YES));
  IndexWriter writer=new IndexWriter(dir,newIndexWriterConfig(TEST_VERSION_CURRENT,new MockAnalyzer(random())));
  try {
    writer.addDocument(doc);
    fail("did not hit exception");
  }
 catch (  IllegalArgumentException iae) {
    assertEquals("all instances of a given field name must have the same term vectors settings (storeTermVectors changed for field=\"f1\")",iae.getMessage());
  }
  writer.shutdown();
}
