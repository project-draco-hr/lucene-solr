{
  final BucketTable table=bucketTable;
  final int i=doc & BucketTable.MASK;
  final Bucket bucket=table.buckets[i];
  final int coord=(mask & REQUIRED_MASK) == REQUIRED_MASK ? requiredNrMatchers : 1;
  if (bucket.doc != doc) {
    bucket.doc=doc;
    bucket.score=scorer.score();
    bucket.bits=mask;
    bucket.coord=coord;
    bucket.next=table.first;
    table.first=bucket;
  }
 else {
    bucket.score+=scorer.score();
    bucket.bits|=mask;
    bucket.coord+=coord;
  }
}
