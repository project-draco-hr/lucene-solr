{
  fakeScorer.doc=-1;
  collector.setScorer(fakeScorer);
  BulkScorerAndDoc top=advance(min);
  while (top.next < max) {
    final int windowBase=top.next & ~MASK;
    final int windowMin=Math.max(min,windowBase);
    final int windowMax=Math.min(max,windowBase + SIZE);
    scoreWindow(collector,windowBase,windowMin,windowMax);
    top=head.top();
  }
  return top.next;
}
