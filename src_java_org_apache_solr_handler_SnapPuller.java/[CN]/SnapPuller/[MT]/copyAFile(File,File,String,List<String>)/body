{
  File indexFileInTmpDir=new File(tmpIdxDir,fname);
  File indexFileInIndex=new File(indexDir,fname);
  boolean success=indexFileInTmpDir.renameTo(indexFileInIndex);
  if (!success) {
    try {
      LOG.error("Unable to move index file from: " + indexFileInTmpDir + " to: "+ indexFileInIndex+ "Trying to do a copy");
      FileUtils.copyFile(indexFileInTmpDir,indexFileInIndex);
      success=true;
    }
 catch (    IOException e) {
      LOG.error("Unable to copy index file from: " + indexFileInTmpDir + " to: "+ indexFileInIndex,e);
    }
  }
  if (!success) {
    for (    String f : copiedfiles) {
      File indexFile=new File(indexDir,f);
      if (indexFile.exists())       indexFile.delete();
    }
    delTree(tmpIdxDir);
    return false;
  }
  return true;
}
