{
  final int chunkSize=chunkSize();
  if (version >= VERSION_BIG_CHUNKS && chunkSize >= 2 * CompressingStoredFieldsReader.this.chunkSize) {
    bytes.offset=bytes.length=0;
    for (int decompressed=0; decompressed < chunkSize; ) {
      final int toDecompress=Math.min(chunkSize - decompressed,CompressingStoredFieldsReader.this.chunkSize);
      decompressor.decompress(fieldsStream,toDecompress,0,toDecompress,spare);
      bytes.bytes=ArrayUtil.grow(bytes.bytes,bytes.length + spare.length);
      System.arraycopy(spare.bytes,spare.offset,bytes.bytes,bytes.length,spare.length);
      bytes.length+=spare.length;
      decompressed+=toDecompress;
    }
  }
 else {
    decompressor.decompress(fieldsStream,chunkSize,0,chunkSize,bytes);
  }
  if (bytes.length != chunkSize) {
    throw new CorruptIndexException("Corrupted: expected chunk size = " + chunkSize() + ", got "+ bytes.length,fieldsStream);
  }
}
