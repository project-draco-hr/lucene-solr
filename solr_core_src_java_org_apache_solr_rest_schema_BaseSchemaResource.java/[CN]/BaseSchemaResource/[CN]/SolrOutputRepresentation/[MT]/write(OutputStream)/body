{
  if (getRequest().getMethod() != Method.HEAD) {
    if (responseWriter instanceof BinaryQueryResponseWriter) {
      BinaryQueryResponseWriter binWriter=(BinaryQueryResponseWriter)responseWriter;
      binWriter.write(outputStream,solrRequest,solrResponse);
    }
 else {
      String charset=ContentStreamBase.getCharsetFromContentType(contentType);
      Writer out=(charset == null || charset.equalsIgnoreCase("UTF-8")) ? new OutputStreamWriter(outputStream,UTF8) : new OutputStreamWriter(outputStream,charset);
      out=new FastWriter(out);
      responseWriter.write(out,solrRequest,solrResponse);
      out.flush();
    }
  }
}
