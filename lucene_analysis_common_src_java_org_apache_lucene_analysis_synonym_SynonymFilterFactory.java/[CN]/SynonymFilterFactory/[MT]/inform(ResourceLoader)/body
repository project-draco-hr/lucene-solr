{
  final TokenizerFactory factory=tokenizerFactory == null ? null : loadTokenizerFactory(loader,tokenizerFactory);
  Analyzer analyzer=new Analyzer(){
    @Override protected TokenStreamComponents createComponents(    String fieldName,    Reader reader){
      Tokenizer tokenizer=factory == null ? new WhitespaceTokenizer(Version.LUCENE_50,reader) : factory.create(reader);
      TokenStream stream=ignoreCase ? new LowerCaseFilter(Version.LUCENE_50,tokenizer) : tokenizer;
      return new TokenStreamComponents(tokenizer,stream);
    }
  }
;
  try {
    if (format == null || format.equals("solr")) {
      map=loadSolrSynonyms(loader,true,analyzer);
    }
 else     if (format.equals("wordnet")) {
      map=loadWordnetSynonyms(loader,true,analyzer);
    }
 else {
      throw new IllegalArgumentException("Unrecognized synonyms format: " + format);
    }
  }
 catch (  ParseException e) {
    throw new IOException("Error parsing synonyms file:",e);
  }
}
