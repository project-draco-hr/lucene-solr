{
  Directory dir=newFSDirectory(_TestUtil.getTempDir("TestNorms.testMaxByteNorms"));
  buildIndex(dir,true);
  AtomicReader open=SlowCompositeReaderWrapper.wrap(DirectoryReader.open(dir));
  DocValues normValues=open.normValues(byteTestField);
  assertNotNull(normValues);
  Source source=normValues.getSource();
  assertTrue(source.hasArray());
  assertEquals(Type.FIXED_INTS_8,normValues.getType());
  byte[] norms=(byte[])source.getArray();
  for (int i=0; i < open.maxDoc(); i++) {
    Document document=open.document(i);
    int expected=Integer.parseInt(document.get(byteTestField));
    assertEquals((byte)expected,norms[i]);
  }
  open.close();
  dir.close();
}
