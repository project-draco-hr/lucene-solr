{
  IndexWriter writer=new IndexWriter(dir,newIndexWriterConfig(TEST_VERSION_CURRENT,new MockAnalyzer(random,MockTokenizer.WHITESPACE,false)).setMergePolicy(newLogMergePolicy(10)));
  TokenStream payloadTS1=new PayloadTokenStream("p1");
  TokenStream payloadTS2=new PayloadTokenStream("p2");
  FieldType customType=new FieldType(TextField.TYPE_NOT_STORED);
  customType.setOmitNorms(true);
  for (int i=0; i < NUM_DOCS; i++) {
    Document doc=new Document();
    doc.add(newField("id","doc" + i,customType));
    doc.add(newTextField("content","doc content " + i,Field.Store.NO));
    doc.add(new TextField("p",payloadTS1));
    doc.add(new TextField("p",payloadTS2));
    writer.addDocument(doc);
    if (multipleCommits && (i % 4 == 0)) {
      writer.commit();
    }
  }
  writer.close();
}
