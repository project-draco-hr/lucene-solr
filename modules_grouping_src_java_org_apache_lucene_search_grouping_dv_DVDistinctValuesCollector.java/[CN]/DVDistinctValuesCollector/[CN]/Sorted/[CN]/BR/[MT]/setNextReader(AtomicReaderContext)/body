{
  super.setNextReader(context);
  for (  GroupCount group : groups) {
    int groupOrd=groupFieldSource.getOrdByValue((BytesRef)group.groupValue,spare);
    if (groupOrd < 0) {
      continue;
    }
    groupCounts[ordSet.put(groupOrd)]=group;
    group.ords=new int[group.uniqueValues.size()];
    Arrays.fill(group.ords,-1);
    int i=0;
    for (    Comparable<?> value : group.uniqueValues) {
      int countOrd=countFieldSource.getOrdByValue((BytesRef)value,spare);
      if (countOrd >= 0) {
        group.ords[i++]=countOrd;
      }
    }
  }
}
