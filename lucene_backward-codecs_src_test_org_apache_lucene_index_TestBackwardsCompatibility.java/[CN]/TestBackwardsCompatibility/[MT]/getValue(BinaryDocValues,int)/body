{
  BytesRef term=bdv.get(idx);
  idx=term.offset;
  byte b=term.bytes[idx++];
  long value=b & 0x7FL;
  for (int shift=7; (b & 0x80L) != 0; shift+=7) {
    b=term.bytes[idx++];
    value|=(b & 0x7FL) << shift;
  }
  return value;
}
