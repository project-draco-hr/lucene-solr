{
  Map<String,Int> termFreqMap=new HashMap<String,Int>();
  for (  String fieldName : fieldNames) {
    TermFreqVector vector=ir.getTermFreqVector(docNum,fieldName);
    if (vector == null) {
      Document d=ir.document(docNum);
      IndexableField fields[]=d.getFields(fieldName);
      if (fields != null) {
        for (int j=0; j < fields.length; j++) {
          final String stringValue=fields[j].stringValue();
          if (stringValue != null) {
            addTermFrequencies(new StringReader(stringValue),termFreqMap,fieldName);
          }
        }
      }
    }
 else {
      addTermFrequencies(termFreqMap,vector);
    }
  }
  return createQueue(termFreqMap);
}
