{
  IndexWriter writer=new IndexWriter(dir,analyzer,IndexWriter.MaxFieldLength.LIMITED);
  writer.setSimilarity(similarity);
  writer.addDocument(doc);
  writer.flush();
  SegmentInfo info=writer.newestSegment();
  writer.close();
  return info;
}
