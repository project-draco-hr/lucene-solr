{
  boolean success=false;
  segment=segmentInfo.name;
  IndexInput docIn=null;
  IndexInput posIn=null;
  IndexInput payIn=null;
  try {
    docIn=dir.openInput(IndexFileNames.segmentFileName(segmentInfo.name,segmentSuffix,BlockPackedPostingsFormat.DOC_EXTENSION),ioContext);
    CodecUtil.checkHeader(docIn,BlockPackedPostingsWriter.DOC_CODEC,BlockPackedPostingsWriter.VERSION_START,BlockPackedPostingsWriter.VERSION_START);
    if (fieldInfos.hasProx()) {
      posIn=dir.openInput(IndexFileNames.segmentFileName(segmentInfo.name,segmentSuffix,BlockPackedPostingsFormat.POS_EXTENSION),ioContext);
      CodecUtil.checkHeader(posIn,BlockPackedPostingsWriter.POS_CODEC,BlockPackedPostingsWriter.VERSION_START,BlockPackedPostingsWriter.VERSION_START);
      if (fieldInfos.hasPayloads() || fieldInfos.hasOffsets()) {
        payIn=dir.openInput(IndexFileNames.segmentFileName(segmentInfo.name,segmentSuffix,BlockPackedPostingsFormat.PAY_EXTENSION),ioContext);
        CodecUtil.checkHeader(payIn,BlockPackedPostingsWriter.PAY_CODEC,BlockPackedPostingsWriter.VERSION_START,BlockPackedPostingsWriter.VERSION_START);
      }
    }
    this.docIn=docIn;
    this.posIn=posIn;
    this.payIn=payIn;
    success=true;
  }
  finally {
    if (!success) {
      IOUtils.closeWhileHandlingException(docIn,posIn,payIn);
    }
  }
}
