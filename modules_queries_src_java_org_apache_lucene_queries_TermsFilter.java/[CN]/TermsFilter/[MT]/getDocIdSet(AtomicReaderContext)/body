{
  IndexReader reader=context.reader;
  FixedBitSet result=new FixedBitSet(reader.maxDoc());
  Fields fields=reader.fields();
  if (fields == null) {
    return result;
  }
  BytesRef br=new BytesRef();
  Bits liveDocs=reader.getLiveDocs();
  String lastField=null;
  Terms termsC=null;
  TermsEnum termsEnum=null;
  DocsEnum docs=null;
  for (  Term term : terms) {
    if (!term.field().equals(lastField)) {
      termsC=fields.terms(term.field());
      termsEnum=termsC.iterator();
      lastField=term.field();
    }
    if (terms != null) {
      br.copy(term.bytes());
      if (termsEnum.seekCeil(br) == TermsEnum.SeekStatus.FOUND) {
        docs=termsEnum.docs(liveDocs,docs);
        while (docs.nextDoc() != DocsEnum.NO_MORE_DOCS) {
          result.set(docs.docID());
        }
      }
    }
  }
  return result;
}
