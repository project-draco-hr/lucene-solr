{
  if (!LuceneTestCase.OLD_FORMAT_IMPERSONATION_IS_ACTIVE) {
    return super.fieldsConsumer(state);
  }
 else {
    return new Lucene42DocValuesConsumer(state,DATA_CODEC,DATA_EXTENSION,METADATA_CODEC,METADATA_EXTENSION,acceptableOverheadRatio);
  }
}
