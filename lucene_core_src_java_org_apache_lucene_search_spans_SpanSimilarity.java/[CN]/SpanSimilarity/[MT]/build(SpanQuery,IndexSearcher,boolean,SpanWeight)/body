{
  if (!needsScores)   return new NonScoringSimilarity(query.getField());
  Map<Term,TermContext> contexts=new HashMap<>();
  for (  SpanWeight w : weights) {
    w.extractTermContexts(contexts);
  }
  if (contexts.size() == 0)   return null;
  TermStatistics[] stats=new TermStatistics[contexts.size()];
  int i=0;
  for (  Term term : contexts.keySet()) {
    stats[i]=searcher.termStatistics(term,contexts.get(term));
    i++;
  }
  return new ScoringSimilarity(query,searcher,stats);
}
