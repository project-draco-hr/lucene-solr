{
  File idir=new File(dcore.getInstanceDir());
  if (!idir.isAbsolute()) {
    idir=new File(loader.getInstanceDir(),dcore.getInstanceDir());
  }
  String instanceDir=idir.getPath();
  SolrResourceLoader solrLoader=new SolrResourceLoader(instanceDir,libLoader,dcore.getCoreProperties());
  SolrConfig config=new SolrConfig(solrLoader,dcore.getConfigName(),null);
  IndexSchema schema=null;
  if (indexSchemaCache != null) {
    File schemFile=new File(dcore.getInstanceDir() + dcore.getSchemaName());
    if (schemFile.exists()) {
      String key=schemFile.getAbsolutePath() + ":" + new SimpleDateFormat("yyyyMMddhhmmss").format(new Date(schemFile.lastModified()));
      schema=indexSchemaCache.get(key);
      if (schema == null) {
        schema=new IndexSchema(config,dcore.getSchemaName(),null);
        indexSchemaCache.put(key,schema);
      }
    }
  }
  if (schema == null) {
    schema=new IndexSchema(config,dcore.getSchemaName(),null);
  }
  SolrCore core=new SolrCore(dcore.getName(),null,config,schema,dcore);
  return core;
}
