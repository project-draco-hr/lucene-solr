{
  TimerContext time=stats.time(dir + "_offer");
  try {
    while (true) {
      try {
        zookeeper.create(dir + "/" + PREFIX,data,CreateMode.PERSISTENT_SEQUENTIAL,true);
        return;
      }
 catch (      KeeperException.NoNodeException e) {
        try {
          zookeeper.create(dir,new byte[0],CreateMode.PERSISTENT,true);
        }
 catch (        KeeperException.NodeExistsException ne) {
        }
      }
    }
  }
  finally {
    time.stop();
  }
}
