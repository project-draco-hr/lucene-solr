{
  TreeMap<Long,String> orderedChildren;
  while (true) {
    try {
      orderedChildren=orderedChildren(null);
    }
 catch (    KeeperException.NoNodeException e) {
      throw new NoSuchElementException();
    }
    if (orderedChildren.size() == 0)     throw new NoSuchElementException();
    for (    String headNode : orderedChildren.values()) {
      if (headNode != null) {
        try {
          return new QueueEvent(dir + "/" + headNode,zookeeper.getData(dir + "/" + headNode,null,null,true),null);
        }
 catch (        KeeperException.NoNodeException e) {
        }
      }
    }
  }
}
