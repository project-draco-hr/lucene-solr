{
  long waitNanos=TimeUnit.MILLISECONDS.toNanos(waitMillis);
  while (waitNanos > 0) {
    firstElement();
    updateLock.lockInterruptibly();
    try {
      if (!knownChildren.isEmpty()) {
        return new TreeSet<>(knownChildren);
      }
      waitNanos=notEmpty.awaitNanos(waitNanos);
    }
  finally {
      updateLock.unlock();
    }
  }
  return Collections.emptySortedSet();
}
