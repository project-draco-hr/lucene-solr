{
  TreeMap<Long,String> orderedChildren;
  TimerContext time=stats.time(dir + "_remove");
  try {
    while (true) {
      try {
        orderedChildren=orderedChildren(null);
      }
 catch (      KeeperException.NoNodeException e) {
        throw new NoSuchElementException();
      }
      if (orderedChildren.size() == 0)       throw new NoSuchElementException();
      for (      String headNode : orderedChildren.values()) {
        String path=dir + "/" + headNode;
        try {
          byte[] data=zookeeper.getData(path,null,null,true);
          zookeeper.delete(path,-1,true);
          return data;
        }
 catch (        KeeperException.NoNodeException e) {
        }
      }
    }
  }
  finally {
    time.stop();
  }
}
