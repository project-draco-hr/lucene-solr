{
  TreeMap<Long,String> orderedChildren=new TreeMap<>();
  List<String> childNames=zookeeper.getChildren(dir,watcher,true);
  stats.setQueueLength(childNames.size());
  for (  String childName : childNames) {
    try {
      if (!childName.regionMatches(0,prefix,0,prefix.length())) {
        LOG.debug("Found child node with improper name: " + childName);
        continue;
      }
      String suffix=childName.substring(prefix.length());
      Long childId=new Long(suffix);
      orderedChildren.put(childId,childName);
    }
 catch (    NumberFormatException e) {
      LOG.warn("Found child node with improper format : " + childName + " "+ e,e);
    }
  }
  return orderedChildren;
}
