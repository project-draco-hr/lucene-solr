{
  if (!block) {
    return peek();
  }
  TreeMap<Long,String> orderedChildren;
  while (true) {
    LatchChildWatcher childWatcher=new LatchChildWatcher();
    try {
      orderedChildren=orderedChildren(childWatcher);
    }
 catch (    KeeperException.NoNodeException e) {
      zookeeper.create(dir,new byte[0],acl,CreateMode.PERSISTENT);
      continue;
    }
    if (orderedChildren.size() == 0) {
      childWatcher.await();
      continue;
    }
    for (    String headNode : orderedChildren.values()) {
      String path=dir + "/" + headNode;
      try {
        byte[] data=zookeeper.getData(path,false,null);
        return data;
      }
 catch (      KeeperException.NoNodeException e) {
      }
    }
  }
}
