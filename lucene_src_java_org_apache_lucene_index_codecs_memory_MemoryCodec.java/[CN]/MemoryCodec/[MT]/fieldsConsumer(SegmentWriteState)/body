{
  final String fileName=IndexFileNames.segmentFileName(state.segmentName,state.codecId,EXTENSION);
  final IndexOutput out=state.directory.createOutput(fileName);
  return new FieldsConsumer(){
    @Override public TermsConsumer addField(    FieldInfo field){
      if (VERBOSE)       System.out.println("\naddField field=" + field.name);
      return new TermsWriter(out,field);
    }
    @Override public void close() throws IOException {
      try {
        out.writeVInt(0);
      }
  finally {
        out.close();
      }
    }
  }
;
}
