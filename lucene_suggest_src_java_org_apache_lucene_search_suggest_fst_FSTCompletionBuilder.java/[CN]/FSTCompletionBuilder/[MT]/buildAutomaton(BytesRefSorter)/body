{
  final Outputs<Object> outputs=NoOutputs.getSingleton();
  final Object empty=outputs.getNoOutput();
  final Builder<Object> builder=new Builder<>(FST.INPUT_TYPE.BYTE1,0,0,true,true,shareMaxTailLength,outputs,null,false,PackedInts.DEFAULT,true,15);
  BytesRef scratch=new BytesRef();
  BytesRef entry;
  final IntsRef scratchIntsRef=new IntsRef();
  int count=0;
  BytesRefIterator iter=sorter.iterator();
  while ((entry=iter.next()) != null) {
    count++;
    if (scratch.compareTo(entry) != 0) {
      builder.add(Util.toIntsRef(entry,scratchIntsRef),empty);
      scratch.copyBytes(entry);
    }
  }
  return count == 0 ? null : builder.finish();
}
