{
  try {
    out.append('{');
    boolean firstField=true;
    for (    SolrInputField sfield : doc) {
      if (firstField)       firstField=false;
 else       out.append(',');
      JSONUtil.writeString(sfield.getName(),0,sfield.getName().length(),out);
      out.append(':');
      if (sfield.getValueCount() > 1) {
        out.append('[');
        boolean firstVal=true;
        for (        Object val : sfield) {
          if (firstVal)           firstVal=false;
 else           out.append(',');
          out.append(JSONUtil.toJSON(val));
        }
        out.append(']');
      }
 else {
        out.append(JSONUtil.toJSON(sfield.getValue()));
      }
    }
    boolean firstChildDoc=true;
    if (doc.hasChildDocuments()) {
      out.append(",\"_childDocuments_\": [");
      List<SolrInputDocument> childDocuments=doc.getChildDocuments();
      for (      SolrInputDocument childDocument : childDocuments) {
        if (firstChildDoc)         firstChildDoc=false;
 else         out.append(',');
        json(childDocument,out);
      }
      out.append(']');
    }
    out.append('}');
  }
 catch (  IOException e) {
  }
}
