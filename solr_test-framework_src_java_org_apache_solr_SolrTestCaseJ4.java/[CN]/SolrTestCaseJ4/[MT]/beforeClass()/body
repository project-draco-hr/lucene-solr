{
  String cname=getSimpleClassName();
  LEAVE_TEST_TMP_DIR_ANNOTATION=RandomizedContext.current().getTargetClass().isAnnotationPresent(SuppressTempDirCleanUp.class);
  boolean ensureClosed=!(LEAVE_TEST_TMP_DIR || LEAVE_TEST_TMP_DIR_ANNOTATION);
  rootTmpDir=TestUtil.createTempDir("solrtest-" + cname,null,ensureClosed);
  initCoreDataDir=TestUtil.createTempDir("solrtest-" + cname,rootTmpDir);
  System.err.println("Creating dataDir: " + initCoreDataDir.getAbsolutePath());
  System.setProperty("jetty.testMode","true");
  System.setProperty("enable.update.log",usually() ? "true" : "false");
  System.setProperty("tests.shardhandler.randomSeed",Long.toString(random().nextLong()));
  System.setProperty("solr.clustering.enabled","false");
  setupLogging();
  startTrackingSearchers();
  startTrackingZkClients();
  ignoreException("ignore_exception");
  newRandomConfig();
  sslConfig=buildSSLConfig();
  HttpClientUtil.setConfigurer(sslConfig.getHttpClientConfigurer());
  if (isSSLMode()) {
    System.setProperty("urlScheme","https");
  }
}
