{
  if (sslConfig == null) {
    SSLConfig sslConfig=new SSLConfig();
    return sslConfig;
  }
  if (null == getExampleKeystoreFile()) {
    log.info("Solr's example keystore not defined (not a solr test?) skipping SSL randomization");
    return null;
  }
  assertTrue("test keystore does not exist, randomized ssl testing broken: " + getExampleKeystoreFile().getAbsolutePath(),getExampleKeystoreFile().exists());
  SSLConfig sslConfig=new SSLConfig();
  final boolean trySsl=random().nextBoolean();
  final boolean trySslClientAuth=false;
  log.info("Randomized ssl ({}) and clientAuth ({})",trySsl,trySslClientAuth);
  String keystorePath=null == TEST_KEYSTORE ? null : TEST_KEYSTORE.getAbsolutePath();
  initSSLConfig(sslConfig,keystorePath);
  sslConfig.useSsl=trySsl;
  sslConfig.clientAuth=trySslClientAuth;
  return sslConfig;
}
