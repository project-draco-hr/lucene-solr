{
  meta.writeVInt(field.number);
  meta.writeByte(Lucene45DocValuesFormat.SORTED_SET);
  if (isSingleValued(docToOrdCount)) {
    meta.writeVInt(SORTED_SET_SINGLE_VALUED_SORTED);
    addSortedField(field,values,singletonView(docToOrdCount,ords,-1L));
    return;
  }
  meta.writeVInt(SORTED_SET_WITH_ADDRESSES);
  addTermsDict(field,values);
  addNumericField(field,ords,false);
  meta.writeVInt(field.number);
  meta.writeByte(Lucene45DocValuesFormat.NUMERIC);
  meta.writeVInt(DELTA_COMPRESSED);
  meta.writeLong(-1L);
  meta.writeVInt(PackedInts.VERSION_CURRENT);
  meta.writeLong(data.getFilePointer());
  meta.writeVLong(maxDoc);
  meta.writeVInt(BLOCK_SIZE);
  final MonotonicBlockPackedWriter writer=new MonotonicBlockPackedWriter(data,BLOCK_SIZE);
  long addr=0;
  for (  Number v : docToOrdCount) {
    addr+=v.longValue();
    writer.add(addr);
  }
  writer.finish();
}
