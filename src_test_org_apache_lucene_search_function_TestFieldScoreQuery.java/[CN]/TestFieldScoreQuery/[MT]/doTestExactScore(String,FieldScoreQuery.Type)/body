{
  IndexSearcher s=new IndexSearcher(dir,true);
  Query q=new FieldScoreQuery(field,tp);
  TopDocs td=s.search(q,null,1000);
  assertEquals("All docs should be matched!",N_DOCS,td.totalHits);
  ScoreDoc sd[]=td.scoreDocs;
  for (int i=0; i < sd.length; i++) {
    float score=sd[i].score;
    log(s.explain(q,sd[i].doc));
    String id=s.getIndexReader().document(sd[i].doc).get(ID_FIELD);
    float expectedScore=expectedFieldScore(id);
    assertEquals("score of " + id + " shuould be "+ expectedScore+ " != "+ score,expectedScore,score,TEST_SCORE_TOLERANCE_DELTA);
  }
}
