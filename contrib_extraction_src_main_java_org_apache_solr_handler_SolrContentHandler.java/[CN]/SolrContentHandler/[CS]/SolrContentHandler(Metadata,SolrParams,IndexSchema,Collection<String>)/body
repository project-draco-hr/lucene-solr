{
  document=new SolrInputDocument();
  this.metadata=metadata;
  this.params=params;
  this.schema=schema;
  this.dateFormats=dateFormats;
  this.ignoreUndeclaredFields=params.getBool(ExtractingParams.IGNORE_UNDECLARED_FIELDS,false);
  this.indexAttribs=params.getBool(ExtractingParams.INDEX_ATTRIBUTES,false);
  this.defaultFieldName=params.get(ExtractingParams.DEFAULT_FIELDNAME);
  this.metadataPrefix=params.get(ExtractingParams.METADATA_PREFIX,"");
  if (defaultFieldName == null && params.getBool(ExtractingParams.EXTRACT_ONLY,false) == false) {
    throw new SolrException(SolrException.ErrorCode.SERVER_ERROR,"No default field name specified");
  }
  String[] captureFields=params.getParams(ExtractingParams.CAPTURE_FIELDS);
  if (captureFields != null && captureFields.length > 0) {
    fieldBuilders=new HashMap<String,StringBuilder>();
    for (int i=0; i < captureFields.length; i++) {
      fieldBuilders.put(captureFields[i],new StringBuilder());
    }
  }
  bldrStack.push(catchAllBuilder);
}
