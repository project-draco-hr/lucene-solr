{
  mergeIndexesCommands.incrementAndGet();
  int rc;
  log.info("start " + cmd);
  List<DirectoryReader> readers=cmd.readers;
  if (readers != null && readers.size() > 0) {
    List<LeafReader> leaves=new ArrayList<>();
    for (    DirectoryReader reader : readers) {
      for (      LeafReaderContext leaf : reader.leaves()) {
        leaves.add(leaf.reader());
      }
    }
    RefCounted<IndexWriter> iw=solrCoreState.getIndexWriter(core);
    try {
      iw.get().addIndexes(leaves.toArray(new LeafReader[leaves.size()]));
    }
  finally {
      iw.decref();
    }
    rc=1;
  }
 else {
    rc=0;
  }
  log.info("end_mergeIndexes");
  if (rc == 1 && commitTracker.getTimeUpperBound() > 0) {
    commitTracker.scheduleCommitWithin(commitTracker.getTimeUpperBound());
  }
 else   if (rc == 1 && softCommitTracker.getTimeUpperBound() > 0) {
    softCommitTracker.scheduleCommitWithin(softCommitTracker.getTimeUpperBound());
  }
  return rc;
}
