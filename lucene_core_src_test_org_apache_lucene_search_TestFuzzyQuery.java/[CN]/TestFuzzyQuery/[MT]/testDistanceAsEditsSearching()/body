{
  Directory index=newDirectory();
  RandomIndexWriter w=new RandomIndexWriter(random(),index);
  addDoc("foobar",w);
  addDoc("test",w);
  addDoc("working",w);
  IndexReader reader=w.getReader();
  IndexSearcher searcher=newSearcher(reader);
  w.shutdown();
  FuzzyQuery q=new FuzzyQuery(new Term("field","fouba"),2);
  ScoreDoc[] hits=searcher.search(q,10).scoreDocs;
  assertEquals(1,hits.length);
  assertEquals("foobar",searcher.doc(hits[0].doc).get("field"));
  q=new FuzzyQuery(new Term("field","foubara"),2);
  hits=searcher.search(q,10).scoreDocs;
  assertEquals(1,hits.length);
  assertEquals("foobar",searcher.doc(hits[0].doc).get("field"));
  try {
    q=new FuzzyQuery(new Term("field","t"),3);
    fail();
  }
 catch (  IllegalArgumentException expected) {
  }
  reader.close();
  index.close();
}
