{
  DocValues.Type dvType=field.fieldInfo.getDocValuesType();
  if (DocValues.isNumber(dvType)) {
    Source source=loadDirectSource();
    long[] values=new long[maxDoc];
    for (int docID=0; docID < maxDoc; docID++) {
      values[docID]=source.getInt(docID);
    }
    return DocValuesArraySource.forType(DocValues.Type.FIXED_INTS_64).newFromArray(values);
  }
 else   if (DocValues.isBytes(dvType)) {
    Source source=loadDirectSource();
    final byte[][] values=new byte[maxDoc][];
    for (int docID=0; docID < maxDoc; docID++) {
      BytesRef value=source.getBytes(docID,null);
      byte[] bytes=new byte[value.length];
      System.arraycopy(value.bytes,value.offset,bytes,0,value.length);
      values[docID]=bytes;
    }
    return new Source(dvType){
      @Override public BytesRef getBytes(      int docID,      BytesRef bytesIn){
        return new BytesRef(values[docID]);
      }
    }
;
  }
 else   if (DocValues.isSortedBytes(dvType)) {
    return null;
  }
  return null;
}
