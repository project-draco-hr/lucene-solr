{
  IndexWriter iw=new IndexWriter(indexDir,new IndexWriterConfig(ExampleUtils.EXAMPLE_VER,SimpleUtils.analyzer));
  TaxonomyWriter taxo=new DirectoryTaxonomyWriter(taxoDir,OpenMode.CREATE);
  int nDocsAdded=0;
  int nFacetsAdded=0;
  for (int docNum=0; docNum < SimpleUtils.docTexts.length; docNum++) {
    List<CategoryPath> facetList=Arrays.asList(SimpleUtils.categories[docNum]);
    CategoryDocumentBuilder categoryDocBuilder=new CategoryDocumentBuilder(taxo).setCategoryPaths(facetList);
    Document doc=new Document();
    doc.add(new TextField(SimpleUtils.TITLE,SimpleUtils.docTitles[docNum],Field.Store.YES));
    doc.add(new TextField(SimpleUtils.TEXT,SimpleUtils.docTexts[docNum],Field.Store.NO));
    categoryDocBuilder.build(doc);
    iw.addDocument(doc);
    nDocsAdded++;
    nFacetsAdded+=facetList.size();
  }
  taxo.commit();
  iw.commit();
  taxo.close();
  iw.close();
  ExampleUtils.log("Indexed " + nDocsAdded + " documents with overall "+ nFacetsAdded+ " facets.");
}
