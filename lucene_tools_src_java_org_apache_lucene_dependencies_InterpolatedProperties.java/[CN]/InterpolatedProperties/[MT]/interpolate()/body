{
  StringBuffer buffer=new StringBuffer();
  for (  Map.Entry<?,?> entry : entrySet()) {
    buffer.setLength(0);
    Matcher matcher=PROPERTY_REFERENCE_PATTERN.matcher(entry.getValue().toString());
    while (matcher.find()) {
      String interpolatedValue=getProperty(matcher.group(1));
      if (null != interpolatedValue) {
        matcher.appendReplacement(buffer,interpolatedValue);
      }
    }
    matcher.appendTail(buffer);
    setProperty((String)entry.getKey(),buffer.toString());
  }
}
