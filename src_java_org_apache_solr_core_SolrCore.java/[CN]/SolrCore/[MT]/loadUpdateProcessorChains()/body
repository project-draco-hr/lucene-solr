{
  final Map<String,UpdateRequestProcessorChain> map=new HashMap<String,UpdateRequestProcessorChain>();
  UpdateRequestProcessorChain def=null;
  Map<String,List<PluginInfo>> infos=solrConfig.getUpdateProcessorChainInfo();
  if (!infos.isEmpty()) {
    boolean defaultProcessed=false;
    List<PluginInfo> defProcessorChainInfo=infos.get(null);
    for (    Map.Entry<String,List<PluginInfo>> e : solrConfig.getUpdateProcessorChainInfo().entrySet()) {
      List<PluginInfo> processorsInfo=e.getValue();
      if (processorsInfo == defProcessorChainInfo && defaultProcessed) {
        map.put(e.getKey(),def);
        continue;
      }
      UpdateRequestProcessorFactory[] chain=new UpdateRequestProcessorFactory[processorsInfo.size()];
      for (int i=0; i < processorsInfo.size(); i++) {
        PluginInfo info=processorsInfo.get(i);
        chain[i]=createInstance(info.className,UpdateRequestProcessorFactory.class,null);
        chain[i].init(info.initArgs);
      }
      UpdateRequestProcessorChain processorChain=new UpdateRequestProcessorChain(chain);
      map.put(e.getKey(),processorChain);
      if (e.getKey() == null || processorsInfo == defProcessorChainInfo) {
        defaultProcessed=true;
        def=processorChain;
      }
    }
  }
  if (def == null) {
    UpdateRequestProcessorFactory[] factories=new UpdateRequestProcessorFactory[]{new RunUpdateProcessorFactory(),new LogUpdateProcessorFactory()};
    def=new UpdateRequestProcessorChain(factories);
  }
  map.put(null,def);
  map.put("",def);
  return map;
}
