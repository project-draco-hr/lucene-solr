{
  builder.startDoc();
  int attrcount=xpp.getAttributeCount();
  float docBoost=1.0f;
  for (int i=0; i < attrcount; i++) {
    String attrName=xpp.getAttributeName(i);
    String attrVal=xpp.getAttributeValue(i);
    if ("boost".equals(attrName)) {
      docBoost=Float.parseFloat(attrVal);
    }
 else {
      log.warning("Unknown attribute doc/@" + attrName);
    }
  }
  if (docBoost != 1.0f)   builder.setBoost(docBoost);
  while (true) {
    int eventType=xpp.nextTag();
    if (eventType == XmlPullParser.END_TAG)     break;
    String tname=xpp.getName();
    if (!"field".equals(tname)) {
      log.warning("unexpected XML tag doc/" + tname);
      throw new SolrException(400,"unexpected XML tag doc/" + tname);
    }
    attrcount=xpp.getAttributeCount();
    String name=null;
    float boost=1.0f;
    boolean isNull=false;
    for (int i=0; i < attrcount; i++) {
      String attrName=xpp.getAttributeName(i);
      String attrVal=xpp.getAttributeValue(i);
      if ("name".equals(attrName)) {
        name=attrVal;
      }
 else       if ("boost".equals(attrName)) {
        boost=Float.parseFloat(attrVal);
      }
 else       if ("null".equals(attrName)) {
        isNull=StrUtils.parseBoolean(attrVal);
      }
 else {
        log.warning("Unknown attribute doc/field/@" + attrName);
      }
    }
    String val=xpp.nextText();
    if (!isNull) {
      if (docBoost != 1.0f) {
        builder.addField(name,val,docBoost);
      }
 else {
        builder.addField(name,val);
      }
    }
  }
}
