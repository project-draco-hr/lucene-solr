{
  final int qtime=(int)(rsp.getEndTime() - req.getStartTime());
  responseHeader.add("status",rsp.getException() == null ? 0 : 500);
  responseHeader.add("QTime",qtime);
  final String EP_PARAM="echoParams";
  final String EXPLICIT="explicit";
  final String epValue=req.getParams().get(EP_PARAM);
  if (EXPLICIT.equals(epValue)) {
    responseHeader.add("params",req.getOriginalParams().toNamedList());
  }
 else   if (epValue != null) {
    throw new SolrException(400,"Invalid value '" + epValue + "' for "+ EP_PARAM+ " parameter, use '"+ EXPLICIT+ "'");
  }
}
