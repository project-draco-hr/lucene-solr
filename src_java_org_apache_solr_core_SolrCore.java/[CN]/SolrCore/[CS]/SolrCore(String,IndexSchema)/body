{
synchronized (SolrCore.class) {
    core=this;
    if (dataDir == null) {
      dataDir=SolrConfig.config.get("dataDir",Config.getInstanceDir() + "data");
    }
    log.info("Opening new SolrCore at " + Config.getInstanceDir() + ", dataDir="+ dataDir);
    if (schema == null) {
      schema=new IndexSchema("schema.xml");
    }
    this.schema=schema;
    this.dataDir=dataDir;
    this.index_path=dataDir + "/" + "index";
    this.maxWarmingSearchers=SolrConfig.config.getInt("query/maxWarmingSearchers",Integer.MAX_VALUE);
    parseListeners();
    initIndex();
    initWriters();
    reqHandlers.initHandlersFromConfig(SolrConfig.config);
    try {
      getSearcher(false,false,null);
      updateHandler=createUpdateHandler(SolrConfig.config.get("updateHandler/@class",DirectUpdateHandler.class.getName()));
    }
 catch (    IOException e) {
      throw new RuntimeException(e);
    }
  }
}
