{
  while (true) {
    final double[] oldValues=variance.get();
    final double[] newValues=new double[2];
    if (oldValues[0] == -1) {
      newValues[0]=value;
      newValues[1]=0;
    }
 else {
      final double oldM=oldValues[0];
      final double oldS=oldValues[1];
      final double newM=oldM + ((value - oldM) / getCount());
      final double newS=oldS + ((value - oldM) * (value - newM));
      newValues[0]=newM;
      newValues[1]=newS;
    }
    if (variance.compareAndSet(oldValues,newValues)) {
      return;
    }
  }
}
