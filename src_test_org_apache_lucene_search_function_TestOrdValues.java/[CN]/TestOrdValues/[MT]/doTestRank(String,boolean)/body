{
  IndexSearcher s=new IndexSearcher(dir);
  ValueSource vs;
  if (inOrder) {
    vs=new OrdFieldSource(field);
  }
 else {
    vs=new ReverseOrdFieldSource(field);
  }
  Query q=new ValueSourceQuery(vs);
  log("test: " + q);
  QueryUtils.check(q,s);
  Hits h=s.search(q);
  assertEquals("All docs should be matched!",N_DOCS,h.length());
  String prevID=inOrder ? "IE" : "IC";
  for (int i=0; i < h.length(); i++) {
    String resID=h.doc(i).get(ID_FIELD);
    log(i + ".   score=" + h.score(i)+ "  -  "+ resID);
    log(s.explain(q,h.id(i)));
    if (inOrder) {
      assertTrue("res id " + resID + " should be < prev res id "+ prevID,resID.compareTo(prevID) < 0);
    }
 else {
      assertTrue("res id " + resID + " should be > prev res id "+ prevID,resID.compareTo(prevID) > 0);
    }
    prevID=resID;
  }
}
