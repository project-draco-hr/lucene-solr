{
  super(reader,field);
  this.automaton=runAutomaton.getAutomaton();
  this.finite=finite;
  this.runAutomaton=runAutomaton;
  if (finite) {
    this.commonSuffixRef=null;
  }
 else   if (commonSuffixRef == null) {
    this.commonSuffixRef=SpecialOperations.getCommonSuffixBytesRef(automaton);
  }
 else {
    this.commonSuffixRef=commonSuffixRef;
  }
  allTransitions=new Transition[runAutomaton.getSize()][];
  for (  State state : this.automaton.getNumberedStates()) {
    state.sortTransitions(Transition.CompareByMinMaxThenDestUTF8InUTF16Order);
    state.trimTransitionsArray();
    allTransitions[state.getNumber()]=state.transitionsArray;
  }
  visited=new long[runAutomaton.getSize()];
  setUseTermsCache(finite);
  termComp=getComparator();
}
