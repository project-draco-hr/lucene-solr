{
  IndexSchema schema=searcher.getSchema();
  SchemaField keyField=schema.getUniqueKeyField();
  if (keyField != null) {
    Set<String> selector=Collections.singleton(keyField.getName());
    String uniqueKeys[]=new String[topDocs.scoreDocs.length];
    for (int i=0; i < topDocs.scoreDocs.length; i++) {
      int docid=topDocs.scoreDocs[i].doc;
      StoredDocument doc=searcher.doc(docid,selector);
      String id=schema.printableUniqueKey(doc);
      uniqueKeys[i]=id;
    }
    return uniqueKeys;
  }
 else {
    return new String[topDocs.scoreDocs.length];
  }
}
