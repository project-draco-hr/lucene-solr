{
  if (q == null) {
    return;
  }
  boolean allNestedTermQueries=false;
  if (q instanceof BooleanQuery) {
    allNestedTermQueries=true;
    for (    BooleanClause clause : ((BooleanQuery)q).clauses()) {
      if (!(clause.getQuery() instanceof TermQuery)) {
        allNestedTermQueries=false;
        break;
      }
    }
  }
  if (allNestedTermQueries) {
    clauses.addAll(((BooleanQuery)q).clauses());
  }
 else {
    BooleanClause.Occur occur=operator == OR_OPERATOR ? BooleanClause.Occur.SHOULD : BooleanClause.Occur.MUST;
    if (q instanceof BooleanQuery) {
      for (      BooleanClause clause : ((BooleanQuery)q).clauses()) {
        clauses.add(newBooleanClause(clause.getQuery(),occur));
      }
    }
 else {
      clauses.add(newBooleanClause(q,occur));
    }
  }
}
