{
  CollectionAdminResponse response;
  if (router.equals(ImplicitDocRouter.NAME)) {
    CollectionAdminRequest.Create create=new CollectionAdminRequest.Create();
    create.setConfigName(config);
    create.setCollectionName(name);
    create.setReplicationFactor(1);
    create.setMaxShardsPerNode(1);
    create.setRouterName(router);
    create.setShards("a,b,c");
    response=create.process(solrCluster.getSolrClient());
  }
 else {
    CollectionAdminRequest.Create create=new CollectionAdminRequest.Create();
    create.setConfigName(config);
    create.setCollectionName(name);
    create.setNumShards(2);
    create.setReplicationFactor(1);
    create.setMaxShardsPerNode(1);
    response=create.process(solrCluster.getSolrClient());
  }
  if (response.getStatus() != 0 || response.getErrorMessages() != null) {
    fail("Could not create collection. Response" + response.toString());
  }
  ZkStateReader zkStateReader=solrCluster.getSolrClient().getZkStateReader();
  AbstractDistribZkTestBase.waitForRecoveriesToFinish(name,zkStateReader,false,true,100);
}
