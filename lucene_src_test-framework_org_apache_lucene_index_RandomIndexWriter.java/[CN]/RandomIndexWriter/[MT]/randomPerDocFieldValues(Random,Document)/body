{
  ValueType[] values=ValueType.values();
  ValueType type=values[random.nextInt(values.length)];
  String name="random_" + type.name() + ""+ docValuesFieldPrefix;
  if ("PreFlex".equals(codecProvider.getFieldCodec(name)) || doc.getField(name) != null)   return;
  IndexDocValuesField docValuesField=new IndexDocValuesField(name);
switch (type) {
case BYTES_FIXED_DEREF:
case BYTES_FIXED_STRAIGHT:
case BYTES_FIXED_SORTED:
    final String randomUnicodeString=_TestUtil.randomFixedByteLengthUnicodeString(random,fixedBytesLength);
  BytesRef fixedRef=new BytesRef(randomUnicodeString);
if (fixedRef.length > fixedBytesLength) {
  fixedRef=new BytesRef(fixedRef.bytes,0,fixedBytesLength);
}
 else {
  fixedRef.grow(fixedBytesLength);
  fixedRef.length=fixedBytesLength;
}
docValuesField.setBytes(fixedRef,type);
break;
case BYTES_VAR_DEREF:
case BYTES_VAR_STRAIGHT:
case BYTES_VAR_SORTED:
BytesRef ref=new BytesRef(_TestUtil.randomUnicodeString(random,200));
docValuesField.setBytes(ref,type);
break;
case FLOAT_32:
docValuesField.setFloat(random.nextFloat());
break;
case FLOAT_64:
docValuesField.setFloat(random.nextDouble());
break;
case VAR_INTS:
docValuesField.setInt(random.nextLong());
break;
case FIXED_INTS_16:
docValuesField.setInt(random.nextInt(Short.MAX_VALUE));
break;
case FIXED_INTS_32:
docValuesField.setInt(random.nextInt());
break;
case FIXED_INTS_64:
docValuesField.setInt(random.nextLong());
break;
case FIXED_INTS_8:
docValuesField.setInt(random.nextInt(128));
break;
default :
throw new IllegalArgumentException("no such type: " + type);
}
doc.add(docValuesField);
}
