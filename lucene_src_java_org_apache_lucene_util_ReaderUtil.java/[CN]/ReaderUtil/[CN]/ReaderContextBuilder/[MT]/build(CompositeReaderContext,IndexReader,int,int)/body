{
  IndexReader[] sequentialSubReaders=reader.getSequentialSubReaders();
  if (sequentialSubReaders == null) {
    AtomicReaderContext atomic=new AtomicReaderContext(parent,reader,ord,docBase,leafOrd,leafDocBase);
    leaves[leafOrd++]=atomic;
    leafDocBase+=reader.maxDoc();
    return atomic;
  }
 else {
    ReaderContext[] children=new ReaderContext[sequentialSubReaders.length];
    final CompositeReaderContext newParent;
    if (parent == null) {
      newParent=new CompositeReaderContext(reader,children,leaves);
    }
 else {
      newParent=new CompositeReaderContext(parent,reader,ord,docBase,children);
    }
    int newDocBase=0;
    for (int i=0; i < sequentialSubReaders.length; i++) {
      build(newParent,sequentialSubReaders[i],i,newDocBase);
      newDocBase+=sequentialSubReaders[i].maxDoc();
    }
    return newParent;
  }
}
