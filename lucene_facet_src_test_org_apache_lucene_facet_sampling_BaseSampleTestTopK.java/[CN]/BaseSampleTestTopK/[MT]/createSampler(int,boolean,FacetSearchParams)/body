{
  SamplingParams samplingParams=new SamplingParams();
  samplingParams.setSampleFixer(new TakmiSampleFixer(indexReader,taxoReader,sParams));
  final double retryFactor=Math.pow(1.01,nTrial);
  samplingParams.setOversampleFactor(5.0 * retryFactor);
  samplingParams.setSampleRatio(0.8 * retryFactor);
  samplingParams.setMinSampleSize((int)(100 * retryFactor));
  samplingParams.setMaxSampleSize((int)(10000 * retryFactor));
  samplingParams.setSamplingThreshold(11000);
  Sampler sampler=useRandomSampler ? new RandomSampler(samplingParams,new Random(random().nextLong())) : new RepeatableSampler(samplingParams);
  return sampler;
}
