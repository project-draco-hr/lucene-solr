{
  CategoryListParams clp=new CategoryListParams();
  FacetIndexingParams iParams=new DefaultFacetIndexingParams(clp);
  Directory indexDir=newDirectory();
  Directory taxoDir=newDirectory();
  populateIndex(iParams,indexDir,taxoDir);
  TaxonomyReader taxo=new DirectoryTaxonomyReader(taxoDir);
  IndexReader reader=DirectoryReader.open(indexDir);
  CategoryListCache clCache=null;
  if (cacheCLI) {
    clCache=new CategoryListCache();
    clCache.loadAndRegister(clp,reader,taxo,iParams);
  }
  ScoredDocIDs allDocs=ScoredDocIdsUtils.createAllDocsScoredDocIDs(reader);
  countForbiddenDimension="date";
  validateFacetedSearch(iParams,taxo,reader,clCache,allDocs,"author",5,5);
  countForbiddenDimension="author";
  validateFacetedSearch(iParams,taxo,reader,clCache,allDocs,"date",5,2);
  countForbiddenDimension=null;
  validateFacetedSearch(iParams,taxo,reader,clCache,allDocs,new String[]{"author","date"},new int[]{5,5},new int[]{5,2});
  taxo.close();
  reader.close();
  indexDir.close();
  taxoDir.close();
}
