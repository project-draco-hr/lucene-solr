{
  MockAnalyzer analyzer=new MockAnalyzer();
  Directory index=newDirectory();
  RandomIndexWriter w=new RandomIndexWriter(random,index);
  addDoc("Lucene in Action",w);
  addDoc("Lucene for Dummies",w);
  addDoc("Giga byte",w);
  addDoc("ManagingGigabytesManagingGigabyte",w);
  addDoc("ManagingGigabytesManagingGigabytes",w);
  addDoc("The Art of Computer Science",w);
  addDoc("J. K. Rowling",w);
  addDoc("JK Rowling",w);
  addDoc("Joanne K Roling",w);
  addDoc("Bruce Willis",w);
  addDoc("Willis bruce",w);
  addDoc("Brute willis",w);
  addDoc("B. willis",w);
  IndexReader r=w.getReader();
  w.close();
  Query q=new QueryParser(TEST_VERSION_CURRENT,"field",analyzer).parse("giga~0.9");
  IndexSearcher searcher=new IndexSearcher(r);
  ScoreDoc[] hits=searcher.search(q,10).scoreDocs;
  assertEquals(1,hits.length);
  assertEquals("Giga byte",searcher.doc(hits[0].doc).get("field"));
  searcher.close();
  r.close();
  index.close();
}
