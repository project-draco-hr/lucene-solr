{
  RAMDirectory directory=new RAMDirectory();
  IndexWriter writer=new IndexWriter(directory,new IndexWriterConfig(TEST_VERSION_CURRENT,new MockAnalyzer()));
  addDoc("Lucene",writer);
  addDoc("Lucene",writer);
  addDoc("Lucenne",writer);
  writer.optimize();
  writer.close();
  IndexSearcher searcher=new IndexSearcher(directory,true);
  IndexReader reader=searcher.getIndexReader();
  FuzzyQuery query=new FuzzyQuery(new Term("field","Lucene"));
  query.setRewriteMethod(new MultiTermQuery.TopTermsBoostOnlyBooleanQueryRewrite());
  ScoreDoc[] hits=searcher.search(query,null,1000).scoreDocs;
  assertEquals(3,hits.length);
  assertEquals("Lucene",reader.document(hits[0].doc).get("field"));
  assertEquals("Lucene",reader.document(hits[1].doc).get("field"));
  assertEquals("Lucenne",reader.document(hits[2].doc).get("field"));
  searcher.close();
  reader.close();
}
