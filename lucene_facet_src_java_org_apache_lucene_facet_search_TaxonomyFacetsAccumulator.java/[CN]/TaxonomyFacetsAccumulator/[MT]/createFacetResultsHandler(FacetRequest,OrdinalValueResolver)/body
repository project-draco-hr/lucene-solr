{
  if (fr.getDepth() == 1 && fr.getSortOrder() == SortOrder.DESCENDING) {
    return new DepthOneFacetResultsHandler(taxonomyReader,fr,facetArrays,resolver);
  }
  if (fr.getResultMode() == ResultMode.PER_NODE_IN_TREE) {
    return new TopKInEachNodeHandler(taxonomyReader,fr,resolver,facetArrays);
  }
 else {
    return new TopKFacetResultsHandler(taxonomyReader,fr,resolver,facetArrays);
  }
}
