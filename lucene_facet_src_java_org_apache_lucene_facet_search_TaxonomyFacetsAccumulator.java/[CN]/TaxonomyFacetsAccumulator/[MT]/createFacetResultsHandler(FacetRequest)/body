{
  if (fr.getDepth() == 1 && fr.getSortOrder() == SortOrder.DESCENDING) {
    FacetArraysSource fas=fr.getFacetArraysSource();
    if (fas == FacetArraysSource.INT) {
      return new IntFacetResultsHandler(taxonomyReader,fr,facetArrays);
    }
    if (fas == FacetArraysSource.FLOAT) {
      return new FloatFacetResultsHandler(taxonomyReader,fr,facetArrays);
    }
  }
  if (fr.getResultMode() == ResultMode.PER_NODE_IN_TREE) {
    return new TopKInEachNodeHandler(taxonomyReader,fr,facetArrays);
  }
  return new TopKFacetResultsHandler(taxonomyReader,fr,facetArrays);
}
