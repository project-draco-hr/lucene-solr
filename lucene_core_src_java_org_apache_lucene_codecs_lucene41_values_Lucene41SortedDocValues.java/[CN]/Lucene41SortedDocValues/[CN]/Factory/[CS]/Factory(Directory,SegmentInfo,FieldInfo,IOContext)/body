{
  boolean success=false;
  IndexInput datIn=null;
  IndexInput indexIn=null;
  IndexInput offsetIn=null;
  try {
    datIn=dir.openInput(Lucene41DocValuesConsumer.getDocValuesFileName(segmentInfo,field,Lucene41DocValuesConsumer.DATA_EXTENSION),context);
    CodecUtil.checkHeader(datIn,CODEC_NAME,VERSION_START,VERSION_START);
    indexIn=dir.openInput(Lucene41DocValuesConsumer.getDocValuesFileName(segmentInfo,field,Lucene41DocValuesConsumer.INDEX_EXTENSION),context);
    CodecUtil.checkHeader(indexIn,CODEC_NAME,VERSION_START,VERSION_START);
    indexHeader=PackedInts.readHeader(indexIn);
    this.size=datIn.readInt();
    this.maxLength=datIn.readInt();
    this.baseOffset=datIn.getFilePointer();
    if (size == Lucene41BinaryDocValuesConsumer.VALUE_SIZE_VAR) {
      offsetIn=dir.openInput(Lucene41DocValuesConsumer.getDocValuesFileName(segmentInfo,field,Lucene41DocValuesConsumer.OFFSET_EXTENSION),context);
      CodecUtil.checkHeader(offsetIn,CODEC_NAME,VERSION_START,VERSION_START);
      this.offsetHeader=PackedInts.readHeader(offsetIn);
    }
 else {
      offsetIn=null;
      this.offsetHeader=null;
    }
    this.offsetIn=offsetIn;
    this.indexIn=indexIn;
    this.datIn=datIn;
    success=true;
  }
  finally {
    if (!success) {
      IOUtils.closeWhileHandlingException(datIn,indexIn,offsetIn);
    }
  }
}
