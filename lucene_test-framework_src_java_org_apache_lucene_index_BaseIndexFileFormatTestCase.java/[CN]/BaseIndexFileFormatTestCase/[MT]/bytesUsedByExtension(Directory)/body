{
  Map<String,Long> bytesUsedByExtension=new HashMap<>();
  for (  String file : d.listAll()) {
    final String ext=IndexFileNames.getExtension(file);
    final long previousLength=bytesUsedByExtension.containsKey(ext) ? bytesUsedByExtension.get(ext) : 0;
    bytesUsedByExtension.put(ext,previousLength + d.fileLength(file));
  }
  bytesUsedByExtension.keySet().removeAll(excludedExtensionsFromByteCounts());
  return bytesUsedByExtension;
}
