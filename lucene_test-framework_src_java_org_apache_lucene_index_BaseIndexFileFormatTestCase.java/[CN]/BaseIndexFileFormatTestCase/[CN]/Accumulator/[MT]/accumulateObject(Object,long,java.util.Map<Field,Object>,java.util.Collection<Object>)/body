{
  if (EXCLUDED_OBJECTS.contains(o)) {
    return 0L;
  }
  for (Class<?> clazz=o.getClass(); clazz != null; clazz=clazz.getSuperclass()) {
    if (EXCLUDED_CLASSES.contains(clazz) && o != root) {
      return 0;
    }
  }
  if (o instanceof Collection) {
    Collection<?> coll=(Collection<?>)o;
    queue.addAll((Collection<?>)o);
    return (long)coll.size() * RamUsageEstimator.NUM_BYTES_OBJECT_REF;
  }
 else   if (o instanceof Map) {
    final Map<?,?> map=(Map<?,?>)o;
    queue.addAll(map.keySet());
    queue.addAll(map.values());
    return 2L * map.size() * RamUsageEstimator.NUM_BYTES_OBJECT_REF;
  }
  return super.accumulateObject(o,shallowSize,fieldValues,queue);
}
