{
  Cell cell=new Cell(minPackedValue,maxPackedValue);
  if (firstPhase) {
    while (stack.size() > 0 && stack.get(stack.size() - 1).contains(cell)) {
      stack.remove(stack.size() - 1);
    }
    stack.add(cell);
    return Relation.CELL_CROSSES_QUERY;
  }
 else {
    Relation result=in.compare(minPackedValue,maxPackedValue);
    if (targetStackUpto < stackToTargetDoc.size() && cell.equals(stackToTargetDoc.get(targetStackUpto))) {
      b.append("  on cell " + stackToTargetDoc.get(targetStackUpto) + ", wrapped visitor returned "+ result);
      targetStackUpto++;
    }
    return result;
  }
}
