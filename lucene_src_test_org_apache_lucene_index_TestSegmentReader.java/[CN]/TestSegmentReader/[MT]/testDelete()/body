{
  Document docToDelete=new Document();
  DocHelper.setupDoc(docToDelete);
  SegmentInfo info=DocHelper.writeDoc(random,dir,docToDelete);
  SegmentReader deleteReader=SegmentReader.get(false,info,IndexReader.DEFAULT_TERMS_INDEX_DIVISOR);
  assertTrue(deleteReader != null);
  assertTrue(deleteReader.numDocs() == 1);
  deleteReader.deleteDocument(0);
  assertFalse(deleteReader.getLiveDocs().get(0));
  assertTrue(deleteReader.hasDeletions() == true);
  assertTrue(deleteReader.numDocs() == 0);
  deleteReader.close();
}
