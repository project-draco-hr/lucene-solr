{
  CollectionAdminRequest.Create create=new CollectionAdminRequest.Create();
  create.setConfigName("conf1");
  create.setCollectionName("test_configset_delete");
  create.setNumShards(1);
  create.process(cloudClient);
  waitForCollection(cloudClient.getZkStateReader(),"test_configset_delete",1);
  ConfigSetAdminRequest.Delete deleteConfigRequest=new ConfigSetAdminRequest.Delete();
  deleteConfigRequest.setConfigSetName("conf1");
  try {
    deleteConfigRequest.process(cloudClient);
    fail("The config deletion should cause an exception as it's currently being used by a collection.");
  }
 catch (  SolrException e) {
  }
  CollectionAdminRequest.Delete deleteCollectionRequest=new CollectionAdminRequest.Delete();
  deleteCollectionRequest.setCollectionName("test_configset_delete");
  deleteCollectionRequest.process(cloudClient);
}
