{
  assertU(adoc("id","1","t_s","A"));
  assertU(adoc("id","2","t_s","B"));
  assertU(adoc("id","3","t_s","C"));
  assertU(adoc("id","4","t_s","C"));
  assertU(adoc("id","5","t_s","D"));
  assertU(adoc("id","6","t_s","E"));
  assertU(adoc("id","7","t_s","E"));
  assertU(adoc("id","8","t_s","E"));
  assertU(adoc("id","9","t_s","F"));
  assertU(adoc("id","10","t_s","G"));
  assertU(adoc("id","11","t_s","G"));
  assertU(adoc("id","12","t_s","G"));
  assertU(adoc("id","13","t_s","G"));
  assertU(adoc("id","14","t_s","G"));
  assertU(commit());
  assertQ("check counts for unlimited facet",req("q","id:[* TO *]","facet","true","facet.field","t_s"),"*[count(//lst[@name='facet_fields']/lst[@name='t_s']/int)=7]","//lst[@name='t_s']/int[@name='G'][.='5']","//lst[@name='t_s']/int[@name='E'][.='3']","//lst[@name='t_s']/int[@name='C'][.='2']","//lst[@name='t_s']/int[@name='A'][.='1']","//lst[@name='t_s']/int[@name='B'][.='1']","//lst[@name='t_s']/int[@name='D'][.='1']","//lst[@name='t_s']/int[@name='F'][.='1']");
  assertQ("check counts for facet with generous limit",req("q","id:[* TO *]","facet","true","facet.limit","100","facet.field","t_s"),"*[count(//lst[@name='facet_fields']/lst[@name='t_s']/int)=7]","//lst[@name='t_s']/int[1][@name='G'][.='5']","//lst[@name='t_s']/int[2][@name='E'][.='3']","//lst[@name='t_s']/int[3][@name='C'][.='2']","//lst[@name='t_s']/int[@name='A'][.='1']","//lst[@name='t_s']/int[@name='B'][.='1']","//lst[@name='t_s']/int[@name='D'][.='1']","//lst[@name='t_s']/int[@name='F'][.='1']");
  assertQ("check counts for limited facet",req("q","id:[* TO *]","facet","true","facet.limit","2","facet.field","t_s"),"*[count(//lst[@name='facet_fields']/lst[@name='t_s']/int)=2]","//lst[@name='t_s']/int[1][@name='G'][.='5']","//lst[@name='t_s']/int[2][@name='E'][.='3']");
}
