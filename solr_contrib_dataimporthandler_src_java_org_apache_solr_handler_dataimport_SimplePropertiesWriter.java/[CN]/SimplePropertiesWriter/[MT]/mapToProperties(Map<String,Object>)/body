{
  Properties p=new Properties();
  for (  Map.Entry<String,Object> entry : propObjs.entrySet()) {
    String key=entry.getKey();
    String val=null;
    String lastKeyPart=key;
    int lastDotPos=key.lastIndexOf('.');
    if (lastDotPos != -1 && key.length() > lastDotPos + 1) {
      lastKeyPart=key.substring(lastDotPos + 1);
    }
    if (LAST_INDEX_KEY.equals(lastKeyPart) && entry.getValue() instanceof Date) {
      val=convertDateToString((Date)entry.getValue());
    }
 else {
      val=entry.getValue().toString();
    }
    p.put(key,val);
  }
  return p;
}
