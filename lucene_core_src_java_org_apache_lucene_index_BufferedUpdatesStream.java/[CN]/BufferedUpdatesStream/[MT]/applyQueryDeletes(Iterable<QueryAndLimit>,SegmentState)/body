{
  long delCount=0;
  final LeafReaderContext readerContext=segState.reader.getContext();
  for (  QueryAndLimit ent : queriesIter) {
    Query query=ent.query;
    int limit=ent.limit;
    final DocIdSet docs=new QueryWrapperFilter(query).getDocIdSet(readerContext,segState.reader.getLiveDocs());
    if (docs != null) {
      final DocIdSetIterator it=docs.iterator();
      if (it != null) {
        while (true) {
          int doc=it.nextDoc();
          if (doc >= limit) {
            break;
          }
          if (!segState.any) {
            segState.rld.initWritableLiveDocs();
            segState.any=true;
          }
          if (segState.rld.delete(doc)) {
            delCount++;
          }
        }
      }
    }
  }
  return delCount;
}
