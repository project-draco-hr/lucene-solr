{
  DIHCache cache=queryVsCache.get(query);
  if (cache == null) {
    cache=instantiateCache(context);
    queryVsCache.put(query,cache);
    populateCache(query,rowIterator);
    queryVsCacheIterator.put(query,cache.iterator());
  }
  if (dataSourceRowCache == null || !dataSourceRowCache.hasNext()) {
    dataSourceRowCache=null;
    Iterator<Map<String,Object>> cacheIter=queryVsCacheIterator.get(query);
    if (cacheIter.hasNext()) {
      List<Map<String,Object>> dsrcl=new ArrayList<Map<String,Object>>(1);
      dsrcl.add(cacheIter.next());
      dataSourceRowCache=dsrcl.iterator();
    }
  }
  if (dataSourceRowCache == null) {
    return null;
  }
  return getFromRowCacheTransformed();
}
