{
  Directory d=newDirectory();
  IndexWriterConfig cfg=newIndexWriterConfig(TEST_VERSION_CURRENT,new MockAnalyzer(random));
  IndexWriter w=new IndexWriter(d,cfg);
  final int numValues=50 + atLeast(10);
  indexValues(w,numValues,Type.BYTES_FIXED_STRAIGHT,null,false,1);
  DirectoryReader r=DirectoryReader.open(w,true);
  DocValues docValues=getDocValues(r,Type.BYTES_FIXED_STRAIGHT.name());
  assertNotNull(docValues);
  Source source=docValues.getSource();
switch (source.type()) {
case BYTES_FIXED_STRAIGHT:
{
      BytesRef ref=new BytesRef();
      if (source.hasArray()) {
        byte[] values=(byte[])source.getArray();
        for (int i=0; i < numValues; i++) {
          source.getBytes(i,ref);
          assertEquals(1,ref.length);
          assertEquals(values[i],ref.bytes[ref.offset]);
        }
      }
    }
  break;
default :
fail("unexpected value " + source.type());
}
r.close();
w.close();
d.close();
}
