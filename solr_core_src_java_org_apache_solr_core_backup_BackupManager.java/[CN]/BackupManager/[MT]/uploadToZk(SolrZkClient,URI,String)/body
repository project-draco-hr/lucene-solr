{
  Preconditions.checkArgument(repository.exists(sourceDir),"Path {} does not exist",sourceDir);
  Preconditions.checkArgument(repository.getPathType(sourceDir) == PathType.DIRECTORY,"Path {} is not a directory",sourceDir);
  for (  String file : repository.listAll(sourceDir)) {
    String zkNodePath=destZkPath + "/" + file;
    URI path=repository.createURI(sourceDir.getPath(),file);
    PathType t=repository.getPathType(path);
switch (t) {
case FILE:
{
        try (IndexInput is=repository.openInput(sourceDir,file,IOContext.DEFAULT)){
          byte[] arr=new byte[(int)is.length()];
          is.readBytes(arr,0,(int)is.length());
          zkClient.makePath(zkNodePath,arr,true);
        }
 catch (        KeeperException|InterruptedException e) {
          throw new IOException(e);
        }
        break;
      }
case DIRECTORY:
{
      if (!file.startsWith(".")) {
        uploadToZk(zkClient,path,zkNodePath);
      }
      break;
    }
default :
  throw new IllegalStateException("Unknown path type " + t);
}
}
}
