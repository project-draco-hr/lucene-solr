{
  String token=request.getHeader(AuthenticationController.AUTHORIZATION_HEADER);
  if (token == null || !token.startsWith("GoogleLogin")) {
    Cookie[] cookies=request.getCookies();
    if (cookies == null) {
      return null;
    }
    for (int i=0; i < cookies.length; i++) {
      if (cookies[i].getName().equals(AuthenticationController.TOKEN_KEY)) {
        token=cookies[i].getValue();
        break;
      }
    }
  }
  if (token != null)   token=token.substring(token.indexOf("=") + 1);
  return token;
}
