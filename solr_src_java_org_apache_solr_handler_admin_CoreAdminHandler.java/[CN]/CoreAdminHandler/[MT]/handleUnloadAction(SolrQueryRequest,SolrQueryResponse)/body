{
  SolrParams params=req.getParams();
  String cname=params.get(CoreAdminParams.CORE);
  SolrCore core=coreContainer.remove(cname);
  if (core == null) {
    throw new SolrException(SolrException.ErrorCode.BAD_REQUEST,"No such core exists '" + cname + "'");
  }
  if (params.getBool(CoreAdminParams.DELETE_INDEX,false)) {
    core.addCloseHook(new CloseHook(){
      @Override public void preClose(      SolrCore core){
      }
      @Override public void postClose(      SolrCore core){
        File dataDir=new File(core.getIndexDir());
        for (        File file : dataDir.listFiles()) {
          if (!file.delete()) {
            log.error(file.getAbsolutePath() + " could not be deleted on core unload");
          }
        }
        if (!dataDir.delete())         log.error(dataDir.getAbsolutePath() + " could not be deleted on core unload");
      }
    }
);
  }
  core.close();
  return coreContainer.isPersistent();
}
