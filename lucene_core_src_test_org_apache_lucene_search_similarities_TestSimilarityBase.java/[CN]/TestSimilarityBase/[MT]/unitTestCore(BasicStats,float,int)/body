{
  for (  SimilarityBase sim : sims) {
    BasicStats realStats=(BasicStats)sim.computeWeight(toCollectionStats(stats),toTermStats(stats));
    realStats.normalize(1f,stats.getBoost());
    float score=sim.score(realStats,freq,docLen);
    float explScore=sim.explain(realStats,1,Explanation.match(freq,"freq"),docLen).getValue();
    assertFalse("Score infinite: " + sim.toString(),Float.isInfinite(score));
    assertFalse("Score NaN: " + sim.toString(),Float.isNaN(score));
    assertTrue("Score negative: " + sim.toString(),score >= 0);
    assertEquals("score() and explain() return different values: " + sim.toString(),score,explScore,FLOAT_EPSILON);
  }
}
