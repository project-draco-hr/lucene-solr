{
  DirectoryReader reader1=DirectoryReader.open(dir);
  DirectoryTaxonomyReader taxReader=new DirectoryTaxonomyReader(taxDir);
  IndexSearcher searcher=newSearcher(reader1);
  FacetsCollector collector=new FacetsCollector();
  FacetsCollector.search(searcher,new MatchAllDocsQuery(),10,collector);
  Facets facets=new FastTaxonomyFacetCounts(taxReader,facetConfig,collector);
  FacetResult result=facets.getTopChildren(10,"tag");
  for (  LabelAndValue lv : result.labelValues) {
    int weight=lv.value.intValue();
    String label=lv.label;
    if (VERBOSE) {
      System.out.println(label + ": " + weight);
    }
    assertEquals(NUM_DOCS,weight);
  }
  reader1.close();
  taxReader.close();
}
