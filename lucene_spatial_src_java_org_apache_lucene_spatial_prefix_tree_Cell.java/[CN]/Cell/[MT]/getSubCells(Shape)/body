{
  if (shapeFilter instanceof Point) {
    Cell subCell=getSubCell((Point)shapeFilter);
    subCell.shapeRel=SpatialRelation.CONTAINS;
    return Collections.singletonList(subCell);
  }
  Collection<Cell> cells=getSubCells();
  if (shapeFilter == null) {
    return cells;
  }
  List<Cell> copy=new ArrayList<Cell>(cells.size());
  for (  Cell cell : cells) {
    SpatialRelation rel=cell.getShape().relate(shapeFilter);
    if (rel == SpatialRelation.DISJOINT)     continue;
    cell.shapeRel=rel;
    if (rel == SpatialRelation.WITHIN)     cell.setLeaf();
    copy.add(cell);
  }
  return copy;
}
