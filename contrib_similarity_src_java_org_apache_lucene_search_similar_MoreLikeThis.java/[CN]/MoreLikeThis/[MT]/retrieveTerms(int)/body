{
  Map termFreqMap=new HashMap();
  for (int i=0; i < fieldNames.length; i++) {
    String fieldName=fieldNames[i];
    TermFreqVector vector=ir.getTermFreqVector(docNum,fieldName);
    if (vector == null) {
      Document d=ir.document(docNum);
      String text=d.get(fieldName);
      if (text != null) {
        addTermFrequencies(new StringReader(text),termFreqMap,fieldName);
      }
    }
 else {
      addTermFrequencies(termFreqMap,vector);
    }
  }
  return createQueue(termFreqMap);
}
