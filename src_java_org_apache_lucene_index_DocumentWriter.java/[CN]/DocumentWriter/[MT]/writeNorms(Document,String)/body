{
  for (int n=0; n < fieldInfos.size(); n++) {
    FieldInfo fi=fieldInfos.fieldInfo(n);
    if (fi.isIndexed) {
      float norm=fieldBoosts[n] * similarity.lengthNorm(fi.name,fieldLengths[n]);
      OutputStream norms=directory.createFile(segment + ".f" + n);
      try {
        norms.writeByte(similarity.encodeNorm(norm));
      }
  finally {
        norms.close();
      }
    }
  }
}
