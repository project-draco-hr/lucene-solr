{
  termBuffer.set(field,text);
  Posting ti=(Posting)postingTable.get(termBuffer);
  if (ti != null) {
    int freq=ti.freq;
    if (ti.positions.length == freq) {
      int[] newPositions=new int[freq * 2];
      int[] positions=ti.positions;
      System.arraycopy(positions,0,newPositions,0,freq);
      ti.positions=newPositions;
      if (ti.payloads != null) {
        Payload[] newPayloads=new Payload[freq * 2];
        Payload[] payloads=ti.payloads;
        System.arraycopy(payloads,0,newPayloads,0,payloads.length);
        ti.payloads=newPayloads;
      }
    }
    ti.positions[freq]=position;
    if (payload != null) {
      if (ti.payloads == null) {
        ti.payloads=new Payload[ti.positions.length];
      }
      ti.payloads[freq]=payload;
    }
    if (offset != null) {
      if (ti.offsets.length == freq) {
        TermVectorOffsetInfo[] newOffsets=new TermVectorOffsetInfo[freq * 2];
        TermVectorOffsetInfo[] offsets=ti.offsets;
        System.arraycopy(offsets,0,newOffsets,0,freq);
        ti.offsets=newOffsets;
      }
      ti.offsets[freq]=offset;
    }
    ti.freq=freq + 1;
  }
 else {
    Term term=new Term(field,text,false);
    postingTable.put(term,new Posting(term,position,payload,offset));
  }
}
