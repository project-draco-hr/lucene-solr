{
  final String baseUrl=getBaseUrl((HttpSolrServer)clients.get(0));
  String collectionName="halfdeletedcollection";
  Create createCmd=new Create();
  createCmd.setCoreName("halfdeletedcollection_shard1_replica1");
  createCmd.setCollection(collectionName);
  String dataDir=SolrTestCaseJ4.dataDir.getAbsolutePath() + File.separator + System.currentTimeMillis()+ "halfcollection"+ "_hdn";
  createCmd.setDataDir(dataDir);
  createCmd.setNumShards(2);
  if (secondConfigSet) {
    createCmd.setCollectionConfigName("conf1");
  }
  createNewSolrServer("",baseUrl).request(createCmd);
  ModifiableSolrParams params=new ModifiableSolrParams();
  params.set("action",CollectionAction.DELETE.toString());
  params.set("name",collectionName);
  QueryRequest request=new QueryRequest(params);
  request.setPath("/admin/collections");
  NamedList<Object> resp=createNewSolrServer("",baseUrl).request(request);
  checkForMissingCollection(collectionName);
  params=new ModifiableSolrParams();
  params.set("action",CollectionAction.CREATE.toString());
  params.set("name",collectionName);
  params.set(NUM_SLICES,2);
  request=new QueryRequest(params);
  request.setPath("/admin/collections");
  if (secondConfigSet) {
    params.set(COLLECTION_CONFIG_NAME,"conf1");
  }
  resp=createNewSolrServer("",baseUrl).request(request);
}
