{
  final String collectionName="halfdeletedcollection";
  Create createCmd=new Create();
  createCmd.setCoreName("halfdeletedcollection_shard1_replica1");
  createCmd.setCollection(collectionName);
  createCmd.setCollectionConfigName("conf");
  String dataDir=createTempDir().toFile().getAbsolutePath();
  createCmd.setDataDir(dataDir);
  createCmd.setNumShards(2);
  createCmd.process(cluster.getSolrClient());
  CollectionAdminRequest.deleteCollection(collectionName).process(cluster.getSolrClient());
  assertFalse(CollectionAdminRequest.listCollections(cluster.getSolrClient()).contains(collectionName));
  CollectionAdminRequest.createCollection(collectionName,"conf",2,1).process(cluster.getSolrClient());
  assertTrue(CollectionAdminRequest.listCollections(cluster.getSolrClient()).contains(collectionName));
}
