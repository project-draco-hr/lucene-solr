{
  SolrException exp=null;
  long timeoutAt=System.currentTimeMillis() + 30000;
  while (System.currentTimeMillis() < timeoutAt) {
    boolean missing=false;
    try {
      collectionClient.query(new SolrQuery("*:*"));
    }
 catch (    SolrException e) {
      if (!(e.code() == 403 || e.code() == 503 || e.code() == 404)) {
        throw e;
      }
      exp=e;
      missing=true;
    }
    if (!missing) {
      return;
    }
    Thread.sleep(50);
  }
  fail("Could not find the new collection - " + exp.code() + " : "+ collectionClient.getBaseURL());
}
