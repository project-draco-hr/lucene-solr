{
  while (true) {
    boolean done=true;
    for (    Thread thread : threads) {
      if (thread.getState() != state) {
        done=false;
        break;
      }
    }
    if (done) {
      return;
    }
    if (random().nextBoolean()) {
      Thread.yield();
    }
 else {
      Thread.sleep(1);
    }
  }
}
