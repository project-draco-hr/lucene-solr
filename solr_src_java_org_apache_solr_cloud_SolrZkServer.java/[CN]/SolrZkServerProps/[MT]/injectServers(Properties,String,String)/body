{
  if (zkRun != null && props.getProperty("clientPort") == null) {
    int portIdx=zkRun.lastIndexOf(':');
    if (portIdx > 0) {
      String portStr=zkRun.substring(portIdx + 1);
      props.setProperty("clientPort",portStr);
    }
  }
  boolean hasServers=hasServers(props);
  if (!hasServers && zkHost != null) {
    int alg=Integer.parseInt(props.getProperty("electionAlg","3").trim());
    String[] hosts=zkHost.split(",");
    int serverNum=0;
    for (    String hostAndPort : hosts) {
      hostAndPort=hostAndPort.trim();
      int portIdx=hostAndPort.lastIndexOf(':');
      String clientPortStr=hostAndPort.substring(portIdx + 1);
      int clientPort=Integer.parseInt(clientPortStr);
      String host=hostAndPort.substring(0,portIdx);
      String serverStr=host + ':' + (clientPort + 1);
      if (alg != 0) {
        serverStr=serverStr + ':' + (clientPort + 2);
      }
      props.setProperty("server." + serverNum,serverStr);
      serverNum++;
    }
  }
}
