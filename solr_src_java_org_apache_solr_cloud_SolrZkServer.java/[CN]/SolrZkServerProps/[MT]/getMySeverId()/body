{
  if (zkRun == null && solrPort == null)   return null;
  Map<Long,QuorumPeer.QuorumServer> slist=getServers();
  String myHost="localhost";
  InetSocketAddress thisAddr=null;
  if (zkRun != null && zkRun.length() > 0) {
    String parts[]=zkRun.split(":");
    myHost=parts[0];
    thisAddr=new InetSocketAddress(myHost,Integer.parseInt(parts[1]) + 1);
  }
 else {
    thisAddr=new InetSocketAddress(myHost,Integer.parseInt(solrPort) + 1001);
  }
  Long me=null;
  boolean multiple=false;
  int port=0;
  for (  QuorumPeer.QuorumServer server : slist.values()) {
    if (server.addr.getHostName().equals(myHost)) {
      multiple=me != null;
      me=server.id;
      port=server.addr.getPort();
    }
  }
  if (!multiple) {
    setClientPort(port - 1);
    return me;
  }
  if (me == null) {
    return null;
  }
  for (  QuorumPeer.QuorumServer server : slist.values()) {
    if (server.addr.equals(thisAddr)) {
      if (clientPortAddress == null || clientPortAddress.getPort() <= 0)       setClientPort(server.addr.getPort() - 1);
      return server.id;
    }
  }
  return null;
}
