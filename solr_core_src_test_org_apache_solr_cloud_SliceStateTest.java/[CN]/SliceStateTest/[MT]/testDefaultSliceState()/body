{
  Map<String,DocCollection> collectionStates=new HashMap<>();
  Set<String> liveNodes=new HashSet<>();
  liveNodes.add("node1");
  Map<String,Slice> slices=new HashMap<>();
  Map<String,Replica> sliceToProps=new HashMap<>();
  Map<String,Object> props=new HashMap<>();
  Replica replica=new Replica("node1",props);
  sliceToProps.put("node1",replica);
  Slice slice=new Slice("shard1",sliceToProps,null);
  assertEquals("Default state not set to active",Slice.ACTIVE,slice.getState());
  slices.put("shard1",slice);
  collectionStates.put("collection1",new DocCollection("collection1",slices,null,DocRouter.DEFAULT));
  ZkStateReader mockZkStateReader=ClusterStateTest.getMockZkStateReader(collectionStates.keySet());
  ClusterState clusterState=new ClusterState(-1,liveNodes,collectionStates,mockZkStateReader);
  byte[] bytes=ZkStateReader.toJSON(clusterState);
  ClusterState loadedClusterState=ClusterState.load(-1,bytes,liveNodes,mockZkStateReader,null);
  assertEquals("Default state not set to active","active",loadedClusterState.getSlice("collection1","shard1").getState());
}
