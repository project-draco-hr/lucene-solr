{
  final String docID=doc.get(BasicDocMaker.ID_FIELD);
  if (docID == null) {
    throw new IllegalStateException("document must define the docid field");
  }
  getRunData().getIndexWriter().updateDocument(new Term(BasicDocMaker.ID_FIELD,docID),doc);
  return 1;
}
