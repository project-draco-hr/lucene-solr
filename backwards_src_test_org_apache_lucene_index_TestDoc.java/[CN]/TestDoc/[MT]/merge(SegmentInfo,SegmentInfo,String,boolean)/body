{
  SegmentReader r1=SegmentReader.get(true,si1,IndexReader.DEFAULT_TERMS_INDEX_DIVISOR);
  SegmentReader r2=SegmentReader.get(true,si2,IndexReader.DEFAULT_TERMS_INDEX_DIVISOR);
  SegmentMerger merger=new SegmentMerger(si1.dir,merged);
  merger.add(r1);
  merger.add(r2);
  merger.merge();
  merger.closeReaders();
  if (useCompoundFile) {
    List filesToDelete=merger.createCompoundFile(merged + ".cfs");
    for (Iterator iter=filesToDelete.iterator(); iter.hasNext(); )     si1.dir.deleteFile((String)iter.next());
  }
  return new SegmentInfo(merged,si1.docCount + si2.docCount,si1.dir,useCompoundFile,true);
}
