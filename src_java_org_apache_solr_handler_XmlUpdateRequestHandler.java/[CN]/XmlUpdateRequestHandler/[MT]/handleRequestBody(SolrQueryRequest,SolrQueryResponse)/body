{
  Iterable<ContentStream> streams=req.getContentStreams();
  if (streams == null) {
    if (!RequestHandlerUtils.handleCommit(req,rsp,false)) {
      throw new SolrException(400,"missing content stream");
    }
    return;
  }
  for (  ContentStream stream : req.getContentStreams()) {
    Reader reader=stream.getReader();
    try {
      rsp.add("update",this.update(reader));
    }
  finally {
      IOUtils.closeQuietly(reader);
    }
  }
  RequestHandlerUtils.handleCommit(req,rsp,false);
}
