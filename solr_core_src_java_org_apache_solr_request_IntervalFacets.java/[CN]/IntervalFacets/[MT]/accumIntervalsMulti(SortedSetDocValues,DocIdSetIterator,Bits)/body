{
  for (  FacetInterval interval : intervals) {
    interval.updateContext(ssdv);
  }
  int doc;
  while ((doc=disi.nextDoc()) != DocIdSetIterator.NO_MORE_DOCS) {
    if (bits != null && bits.get(doc) == false) {
      continue;
    }
    ssdv.setDocument(doc);
    long currOrd;
    int currentInterval=0;
    while ((currOrd=ssdv.nextOrd()) != SortedSetDocValues.NO_MORE_ORDS) {
      boolean evaluateNextInterval=true;
      while (evaluateNextInterval && currentInterval < intervals.length) {
        IntervalCompareResult result=intervals[currentInterval].includes(currOrd);
switch (result) {
case INCLUDED:
          intervals[currentInterval].incCount();
        currentInterval++;
      break;
case LOWER_THAN_START:
    evaluateNextInterval=false;
  break;
case GREATER_THAN_END:
currentInterval++;
break;
}
}
}
}
}
