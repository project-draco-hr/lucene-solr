{
  SolrClient client=getSolrClient();
  client.deleteByQuery("*:*");
  SolrInputDocument[] doc=new SolrInputDocument[3];
  for (int i=0; i < 3; i++) {
    doc[i]=new SolrInputDocument();
    doc[i].setField("id",i + " & 222",1.0f);
  }
  String id=(String)doc[0].getField("id").getFirstValue();
  client.add(doc[0]);
  client.commit();
  assertNumFound("*:*",1);
  client.deleteById(id);
  client.commit();
  assertNumFound("*:*",0);
  client.add(doc[0]);
  client.commit();
  assertNumFound("*:*",1);
  client.deleteByQuery("id:\"" + ClientUtils.escapeQueryChars(id) + "\"");
  client.commit();
  assertNumFound("*:*",0);
  for (  SolrInputDocument d : doc) {
    client.add(d);
  }
  client.commit();
  assertNumFound("*:*",3);
  List<String> ids=new ArrayList<>();
  for (  SolrInputDocument d : doc) {
    ids.add(d.getFieldValue("id").toString());
  }
  client.deleteById(ids);
  client.commit();
  assertNumFound("*:*",0);
}
