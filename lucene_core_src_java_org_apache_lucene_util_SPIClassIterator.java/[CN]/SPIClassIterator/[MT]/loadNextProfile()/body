{
  ArrayList<String> lines=null;
  while (profilesEnum.hasMoreElements()) {
    if (lines != null) {
      lines.clear();
    }
 else {
      lines=new ArrayList<>();
    }
    final URL url=profilesEnum.nextElement();
    try {
      final InputStream in=url.openStream();
      boolean success=false;
      try {
        final BufferedReader reader=new BufferedReader(new InputStreamReader(in,StandardCharsets.UTF_8));
        String line;
        while ((line=reader.readLine()) != null) {
          final int pos=line.indexOf('#');
          if (pos >= 0) {
            line=line.substring(0,pos);
          }
          line=line.trim();
          if (line.length() > 0) {
            lines.add(line);
          }
        }
        success=true;
      }
  finally {
        if (success) {
          IOUtils.close(in);
        }
 else {
          IOUtils.closeWhileHandlingException(in);
        }
      }
    }
 catch (    IOException ioe) {
      throw new ServiceConfigurationError("Error loading SPI class list from URL: " + url,ioe);
    }
    if (!lines.isEmpty()) {
      this.linesIterator=lines.iterator();
      return true;
    }
  }
  return false;
}
