{
  String solrUrl=cli.getOptionValue("solrUrl","http://localhost:8983/solr");
  if (!solrUrl.endsWith("/"))   solrUrl+="/";
  String systemInfoUrl=solrUrl + "admin/info/system";
  CloseableHttpClient httpClient=getHttpClient();
  int result=-1;
  Tool tool=null;
  try {
    Map<String,Object> systemInfo=getJson(httpClient,systemInfoUrl,2);
    if ("solrcloud".equals(systemInfo.get("mode"))) {
      tool=new CreateCollectionTool();
    }
 else {
      tool=new CreateCoreTool();
    }
    result=tool.runTool(cli);
  }
  finally {
    closeHttpClient(httpClient);
  }
  return result;
}
