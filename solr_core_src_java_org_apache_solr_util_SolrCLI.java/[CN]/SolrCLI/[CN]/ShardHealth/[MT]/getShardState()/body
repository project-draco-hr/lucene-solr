{
  boolean healthy=true;
  boolean hasLeader=false;
  boolean atLeastOneActive=false;
  for (  ReplicaHealth replicaHealth : replicas) {
    if (replicaHealth.isLeader)     hasLeader=true;
    if (!ZkStateReader.ACTIVE.equals(replicaHealth.status)) {
      healthy=false;
    }
 else {
      atLeastOneActive=true;
    }
  }
  if (!hasLeader)   return ShardState.no_leader;
  return healthy ? ShardState.healthy : (atLeastOneActive ? ShardState.degraded : ShardState.down);
}
