{
  if (!SpatialOperation.is(args.getOperation(),SpatialOperation.Intersects,SpatialOperation.IsWithin))   throw new UnsupportedSpatialOperation(args.getOperation());
  Shape shape=args.getShape();
  if (!(shape instanceof Rectangle))   throw new InvalidShapeException("Only Rectangle is currently supported, got " + shape.getClass());
  Rectangle bbox=(Rectangle)shape;
  if (bbox.getCrossesDateLine()) {
    throw new UnsupportedOperationException("Crossing dateline not yet supported");
  }
  return new ConstantScoreQuery(makeWithin(bbox));
}
