{
  RAMDirectory directory=new MockRAMDirectory();
  IndexWriter writer=new IndexWriter(directory,ANALYZER,true,IndexWriter.MaxFieldLength.UNLIMITED);
  for (int iter=0; iter < 7; iter++) {
    ConcurrentMergeScheduler cms=new ConcurrentMergeScheduler();
    writer.setMergeScheduler(cms);
    writer.setMaxBufferedDocs(2);
    for (int j=0; j < 21; j++) {
      Document doc=new Document();
      doc.add(new Field("content","a b c",Field.Store.NO,Field.Index.ANALYZED));
      writer.addDocument(doc);
    }
    writer.close();
    TestIndexWriter.assertNoUnreferencedFiles(directory,"testNoExtraFiles");
    writer=new IndexWriter(directory,ANALYZER,false,IndexWriter.MaxFieldLength.UNLIMITED);
  }
  writer.close();
  directory.close();
}
