{
  query.setSlop(slop);
  RAMDirectory ramDir=new RAMDirectory();
  IndexWriter writer=new IndexWriter(ramDir,new IndexWriterConfig(TEST_VERSION_CURRENT,new MockAnalyzer(MockTokenizer.WHITESPACE,false)));
  writer.addDocument(doc);
  writer.close();
  IndexSearcher searcher=new IndexSearcher(ramDir,true);
  TopDocs td=searcher.search(query,null,10);
  assertEquals("slop: " + slop + "  query: "+ query+ "  doc: "+ doc+ "  Wrong number of hits",expectedNumResults,td.totalHits);
  searcher.close();
  ramDir.close();
  return td.getMaxScore();
}
