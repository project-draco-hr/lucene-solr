{
  int nresults=facetRequest.getNumResults();
  boolean accending=(facetRequest.getSortOrder() == SortOrder.ASCENDING);
  if (nresults == Integer.MAX_VALUE) {
    return new AllValueHeap(accending);
  }
  if (accending) {
switch (facetRequest.getSortBy()) {
case VALUE:
      return new MaxValueHeap(nresults);
case ORDINAL:
    return new MaxOrdinalHeap(nresults);
}
}
 else {
switch (facetRequest.getSortBy()) {
case VALUE:
  return new MinValueHeap(nresults);
case ORDINAL:
return new MinOrdinalHeap(nresults);
}
}
throw new IllegalArgumentException("none supported facet request: " + facetRequest);
}
