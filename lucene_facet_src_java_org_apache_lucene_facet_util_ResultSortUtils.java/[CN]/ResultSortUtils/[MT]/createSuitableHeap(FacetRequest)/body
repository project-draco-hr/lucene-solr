{
  int nresults=facetRequest.numResults;
  boolean accending=(facetRequest.getSortOrder() == SortOrder.ASCENDING);
  if (nresults == Integer.MAX_VALUE) {
    return new AllValueHeap(accending);
  }
  if (accending) {
    return new MaxValueHeap(nresults);
  }
 else {
    return new MinValueHeap(nresults);
  }
}
