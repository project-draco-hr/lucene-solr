{
  super(input);
  dictionary=TokenInfoDictionary.getInstance();
  fst=dictionary.getFST();
  unkDictionary=UnknownDictionary.getInstance();
  characterDefinition=unkDictionary.getCharacterDefinition();
  this.userDictionary=userDictionary;
  costs=ConnectionCosts.getInstance();
  fstReader=fst.getBytesReader(0);
  if (userDictionary != null) {
    userFST=userDictionary.getFST();
    userFSTReader=userFST.getBytesReader(0);
  }
 else {
    userFST=null;
    userFSTReader=null;
  }
  this.discardPunctuation=discardPunctuation;
switch (mode) {
case SEARCH:
    searchMode=true;
  extendedMode=false;
outputCompounds=true;
break;
case EXTENDED:
searchMode=true;
extendedMode=true;
outputCompounds=false;
break;
default :
searchMode=false;
extendedMode=false;
outputCompounds=false;
break;
}
buffer.reset(input);
resetState();
dictionaryMap.put(Type.KNOWN,dictionary);
dictionaryMap.put(Type.UNKNOWN,unkDictionary);
dictionaryMap.put(Type.USER,userDictionary);
}
