{
  pq.clear();
  for (PhrasePositions pp=first; pp != null; pp=pp.next) {
    pp.firstPosition();
    pq.put(pp);
  }
  pqToList();
  int freq=0;
  do {
    while (first.position < last.position) {
      do {
        if (!first.nextPosition())         return freq;
      }
 while (first.position < last.position);
      firstToLast();
    }
    freq++;
  }
 while (last.nextPosition());
  return freq;
}
