{
  PerDocValues leftPerDoc=MultiPerDocValues.getPerDocs(leftReader);
  PerDocValues rightPerDoc=MultiPerDocValues.getPerDocs(rightReader);
  Fields leftFields=MultiFields.getFields(leftReader);
  Fields rightFields=MultiFields.getFields(rightReader);
  if (leftFields == null || rightFields == null) {
    assertNull(info,leftFields);
    assertNull(info,rightFields);
    return;
  }
  FieldsEnum fieldsEnum=leftFields.iterator();
  String field;
  while ((field=fieldsEnum.next()) != null) {
    IndexDocValues leftDocValues=leftPerDoc.docValues(field);
    IndexDocValues rightDocValues=rightPerDoc.docValues(field);
    if (leftDocValues == null || rightDocValues == null) {
      assertNull(info,leftDocValues);
      assertNull(info,rightDocValues);
      continue;
    }
    assertDocValuesSource(leftDocValues.getDirectSource(),rightDocValues.getDirectSource());
    assertDocValuesSource(leftDocValues.getSource(),rightDocValues.getSource());
  }
}
