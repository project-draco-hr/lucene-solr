{
  int facetOrd=facetFieldTermsIndex.getOrd(doc);
  if (facetOrd < startFacetOrd || facetOrd >= endFacetOrd) {
    return;
  }
  int groupOrd=groupFieldTermsIndex.getOrd(doc);
  int segmentGroupedFacetsIndex=(groupOrd * facetFieldTermsIndex.numOrd()) + facetOrd;
  if (segmentGroupedFacetHits.exists(segmentGroupedFacetsIndex)) {
    return;
  }
  segmentTotalCount++;
  segmentFacetCounts[facetOrd]++;
  segmentGroupedFacetHits.put(segmentGroupedFacetsIndex);
  groupedFacetHits.add(new GroupedFacetHit(groupOrd == 0 ? null : groupFieldTermsIndex.lookup(groupOrd,new BytesRef()),facetOrd == 0 ? null : facetFieldTermsIndex.lookup(facetOrd,new BytesRef())));
}
