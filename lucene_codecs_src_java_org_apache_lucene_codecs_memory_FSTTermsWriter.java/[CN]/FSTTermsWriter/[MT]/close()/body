{
  if (out != null) {
    IOException ioe=null;
    try {
      final long dirStart=out.getFilePointer();
      out.writeVInt(fields.size());
      for (      FieldMetaData field : fields) {
        out.writeVInt(field.fieldInfo.number);
        out.writeVLong(field.numTerms);
        if (field.fieldInfo.getIndexOptions() != IndexOptions.DOCS_ONLY) {
          out.writeVLong(field.sumTotalTermFreq);
        }
        out.writeVLong(field.sumDocFreq);
        out.writeVInt(field.docCount);
        out.writeVInt(field.longsSize);
        field.dict.save(out);
      }
      writeTrailer(out,dirStart);
      CodecUtil.writeFooter(out);
    }
 catch (    IOException ioe2) {
      ioe=ioe2;
    }
 finally {
      IOUtils.closeWhileHandlingException(ioe,out,postingsWriter);
      out=null;
    }
  }
}
