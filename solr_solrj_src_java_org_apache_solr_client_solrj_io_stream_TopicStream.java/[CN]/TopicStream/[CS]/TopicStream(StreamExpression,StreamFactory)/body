{
  String checkpointCollectionName=factory.getValueOperand(expression,0);
  String collectionName=factory.getValueOperand(expression,1);
  List<StreamExpressionNamedParameter> namedParams=factory.getNamedOperands(expression);
  StreamExpressionNamedParameter zkHostExpression=factory.getNamedOperand(expression,"zkHost");
  StreamExpressionNamedParameter idParam=factory.getNamedOperand(expression,"id");
  if (null == idParam) {
    throw new IOException("invalid TopicStream id cannot be null");
  }
  StreamExpressionNamedParameter flParam=factory.getNamedOperand(expression,"fl");
  if (null == flParam) {
    throw new IOException("invalid TopicStream fl cannot be null");
  }
  long checkpointEvery=-1;
  StreamExpressionNamedParameter checkpointEveryParam=factory.getNamedOperand(expression,"checkpointEvery");
  if (checkpointEveryParam != null) {
    checkpointEvery=Long.parseLong(((StreamExpressionValue)checkpointEveryParam.getParameter()).getValue());
  }
  if (null == checkpointCollectionName) {
    throw new IOException(String.format(Locale.ROOT,"invalid expression %s - checkpointCollectionName expected as first operand",expression));
  }
  if (null == collectionName) {
    throw new IOException(String.format(Locale.ROOT,"invalid expression %s - collectionName expected as second operand",expression));
  }
  if (0 == namedParams.size()) {
    throw new IOException(String.format(Locale.ROOT,"invalid expression %s - at least one named parameter expected. eg. 'q=*:*'",expression));
  }
  Map<String,String> params=new HashMap<String,String>();
  for (  StreamExpressionNamedParameter namedParam : namedParams) {
    if (!namedParam.getName().equals("zkHost") && !namedParam.getName().equals("id") && !namedParam.getName().equals("checkpointEvery")) {
      params.put(namedParam.getName(),namedParam.getParameter().toString().trim());
    }
  }
  String zkHost=null;
  if (null == zkHostExpression) {
    zkHost=factory.getCollectionZkHost(collectionName);
    if (zkHost == null) {
      zkHost=factory.getDefaultZkHost();
    }
  }
 else   if (zkHostExpression.getParameter() instanceof StreamExpressionValue) {
    zkHost=((StreamExpressionValue)zkHostExpression.getParameter()).getValue();
  }
  if (null == zkHost) {
    throw new IOException(String.format(Locale.ROOT,"invalid expression %s - zkHost not found for collection '%s'",expression,collectionName));
  }
  init(zkHost,checkpointCollectionName,collectionName,((StreamExpressionValue)idParam.getParameter()).getValue(),checkpointEvery,params);
}
