{
  StreamExpression expression=new StreamExpression(factory.getFunctionName(this.getClass()));
  expression.addParameter(checkpointCollection);
  expression.addParameter(collection);
  for (  Entry<String,String> param : params.entrySet()) {
    String value=param.getValue();
    value=value.replace("\"","\\\"");
    expression.addParameter(new StreamExpressionNamedParameter(param.getKey(),value));
  }
  expression.addParameter(new StreamExpressionNamedParameter("zkHost",zkHost));
  expression.addParameter(new StreamExpressionNamedParameter("id",id));
  expression.addParameter(new StreamExpressionNamedParameter("checkpointEvery",Long.toString(checkpointEvery)));
  return expression;
}
