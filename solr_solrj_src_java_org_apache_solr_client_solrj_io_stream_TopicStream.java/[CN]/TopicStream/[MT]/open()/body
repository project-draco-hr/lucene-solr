{
  this.tuples=new TreeSet();
  this.solrStreams=new ArrayList();
  this.eofTuples=Collections.synchronizedMap(new HashMap());
  if (cache != null) {
    cloudSolrClient=cache.getCloudSolrClient(zkHost);
  }
 else {
    cloudSolrClient=new Builder().withZkHost(zkHost).build();
    this.cloudSolrClient.connect();
  }
  if (checkpoints.size() == 0) {
    getPersistedCheckpoints();
    if (checkpoints.size() == 0) {
      getCheckpoints();
    }
  }
  constructStreams();
  openStreams();
}
