{
  this.tuples=new TreeSet();
  this.solrStreams=new ArrayList();
  this.eofTuples=Collections.synchronizedMap(new HashMap());
  if (checkpoints.size() == 0 && streamContext.numWorkers > 1) {
    this.id=this.id + "_" + streamContext.workerID;
  }
  if (streamContext.getSolrClientCache() != null) {
    cloudSolrClient=streamContext.getSolrClientCache().getCloudSolrClient(zkHost);
  }
 else {
    cloudSolrClient=new Builder().withZkHost(zkHost).build();
    this.cloudSolrClient.connect();
  }
  if (checkpoints.size() == 0) {
    getPersistedCheckpoints();
    if (checkpoints.size() == 0) {
      getCheckpoints();
    }
  }
  constructStreams();
  openStreams();
}
