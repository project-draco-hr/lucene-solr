{
  TokenStream stream=new WhitespaceTokenizer(new StringReader(doc));
  stream=new PartOfSpeechTaggingFilter(stream);
  stream=new LowerCaseFilter(stream);
  stream=new StopFilter(stream,stopwords);
  stream=new CachingTokenFilter(stream);
  stream=new PartOfSpeechAnnotatingFilter(stream);
switch (api) {
case 0:
    consumeStreamNewAPI(stream);
  consumeStreamNewAPI(stream);
break;
case 1:
consumeStreamOldAPI(stream);
consumeStreamOldAPI(stream);
break;
case 2:
consumeStreamVeryOldAPI(stream);
consumeStreamVeryOldAPI(stream);
break;
case 3:
consumeStreamNewAPI(stream);
consumeStreamOldAPI(stream);
consumeStreamVeryOldAPI(stream);
consumeStreamNewAPI(stream);
consumeStreamVeryOldAPI(stream);
break;
}
}
