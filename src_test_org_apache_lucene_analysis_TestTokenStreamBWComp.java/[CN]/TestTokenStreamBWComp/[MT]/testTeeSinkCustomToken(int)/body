{
  TokenStream stream=new WhitespaceTokenizer(new StringReader(doc));
  stream=new PartOfSpeechTaggingFilter(stream);
  stream=new LowerCaseFilter(stream);
  stream=new StopFilter(stream,stopwords);
  SinkTokenizer sink=new SinkTokenizer();
  TokenStream stream1=new PartOfSpeechAnnotatingFilter(sink);
  stream=new TeeTokenFilter(stream,sink);
  stream=new PartOfSpeechAnnotatingFilter(stream);
switch (api) {
case 0:
    consumeStreamNewAPI(stream);
  consumeStreamNewAPI(stream1);
break;
case 1:
consumeStreamOldAPI(stream);
consumeStreamOldAPI(stream1);
break;
case 2:
consumeStreamVeryOldAPI(stream);
consumeStreamVeryOldAPI(stream1);
break;
}
}
