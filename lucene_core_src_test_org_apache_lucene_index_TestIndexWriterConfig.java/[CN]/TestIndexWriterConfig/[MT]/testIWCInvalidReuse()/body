{
  IndexWriterConfig iwc=newIndexWriterConfig(TEST_VERSION_CURRENT,new MockAnalyzer(random()));
  Directory dir=newDirectory();
  RandomIndexWriter riw=new RandomIndexWriter(random(),dir,iwc);
  IndexWriterConfig privateIWC=riw.w.getConfig();
  riw.close();
  try {
    new RandomIndexWriter(random(),dir,privateIWC);
    fail("did not hit expected exception");
  }
 catch (  IllegalStateException ise) {
  }
  dir.close();
}
