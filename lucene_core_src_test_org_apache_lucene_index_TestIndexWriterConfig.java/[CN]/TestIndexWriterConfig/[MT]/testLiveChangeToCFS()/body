{
  Directory dir=newDirectory();
  IndexWriterConfig iwc=new IndexWriterConfig(TEST_VERSION_CURRENT,new MockAnalyzer(random()));
  iwc.setMergePolicy(newLogMergePolicy(true));
  ((LogMergePolicy)iwc.getMergePolicy()).setUseCompoundFile(false);
  IndexWriter w=new IndexWriter(dir,iwc);
  LogMergePolicy lmp=((LogMergePolicy)w.getConfig().getMergePolicy());
  lmp.setNoCFSRatio(1.0);
  lmp.setMaxCFSSegmentSizeMB(Double.POSITIVE_INFINITY);
  Document doc=new Document();
  doc.add(newStringField("field","foo",Store.NO));
  w.addDocument(doc);
  w.commit();
  for (  String file : dir.listAll()) {
    assertFalse(file.endsWith(".frq"));
  }
  w.close();
  dir.close();
}
