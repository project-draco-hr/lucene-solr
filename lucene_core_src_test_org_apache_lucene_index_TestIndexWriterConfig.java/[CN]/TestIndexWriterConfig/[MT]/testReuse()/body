{
  Directory dir=newDirectory();
  IndexWriterConfig conf=newIndexWriterConfig(TEST_VERSION_CURRENT,null);
  new RandomIndexWriter(random(),dir,conf).shutdown();
  try {
    assertNotNull(new RandomIndexWriter(random(),dir,conf));
    fail("should have hit AlreadySetException");
  }
 catch (  AlreadySetException e) {
  }
  try {
    assertNotNull(new RandomIndexWriter(random(),dir,conf.clone()));
    fail("should have hit AlreadySetException");
  }
 catch (  AlreadySetException e) {
  }
  conf=newIndexWriterConfig(TEST_VERSION_CURRENT,null);
  new RandomIndexWriter(random(),dir,conf.clone()).shutdown();
  new RandomIndexWriter(random(),dir,conf.clone()).shutdown();
  dir.close();
}
