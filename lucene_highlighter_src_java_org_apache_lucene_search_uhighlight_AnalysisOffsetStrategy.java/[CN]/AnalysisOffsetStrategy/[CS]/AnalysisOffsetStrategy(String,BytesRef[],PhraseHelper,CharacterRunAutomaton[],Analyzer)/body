{
  super(field,extractedTerms,phraseHelper,automata);
  this.analyzer=analyzer;
  this.automata=automata;
  if (terms.length > 0 && !strictPhrases.hasPositionSensitivity()) {
    this.automata=convertTermsToAutomata(terms,automata);
    terms=ZERO_LEN_BYTES_REF_ARRAY;
  }
  if (terms.length > 0 || strictPhrases.willRewrite()) {
    boolean storePayloads=strictPhrases.hasPositionSensitivity();
    memoryIndex=new MemoryIndex(true,storePayloads);
    leafReader=(LeafReader)memoryIndex.createSearcher().getIndexReader();
    preMemIndexFilterAutomaton=buildCombinedAutomaton(field,terms,this.automata,strictPhrases);
  }
 else {
    memoryIndex=null;
    leafReader=null;
    preMemIndexFilterAutomaton=null;
  }
}
