{
  IntOpenHashSet boostDocs=null;
  if (boosted != null) {
    SchemaField idField=indexSearcher.getSchema().getUniqueKeyField();
    String fieldName=idField.getName();
    HashSet<BytesRef> localBoosts=new HashSet(boosted.size() * 2);
    Iterator<String> boostedIt=boosted.iterator();
    while (boostedIt.hasNext()) {
      localBoosts.add(new BytesRef(boostedIt.next()));
    }
    boostDocs=new IntOpenHashSet(boosted.size() * 2);
    List<AtomicReaderContext> leaves=indexSearcher.getTopReaderContext().leaves();
    TermsEnum termsEnum=null;
    DocsEnum docsEnum=null;
    for (    AtomicReaderContext leaf : leaves) {
      AtomicReader reader=leaf.reader();
      int docBase=leaf.docBase;
      Bits liveDocs=reader.getLiveDocs();
      Terms terms=reader.terms(fieldName);
      termsEnum=terms.iterator(termsEnum);
      Iterator<BytesRef> it=localBoosts.iterator();
      while (it.hasNext()) {
        BytesRef ref=it.next();
        if (termsEnum.seekExact(ref)) {
          docsEnum=termsEnum.docs(liveDocs,docsEnum);
          int doc=docsEnum.nextDoc();
          if (doc != -1) {
            boostDocs.add(doc + docBase);
            it.remove();
          }
        }
      }
    }
  }
  return boostDocs;
}
