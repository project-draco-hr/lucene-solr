{
  try {
    IntOpenHashSet boostDocs=getBoostDocs(indexSearcher,(Set<String>)(this.context.get(QueryElevationComponent.BOOSTED)));
    if (this.min != null || this.max != null) {
      return new CollapsingFieldValueCollector(this.maxDoc,this.leafCount,this.docValues,this.searcher,this.nullPolicy,max != null ? this.max : this.min,max != null,needsScores(this.solrParams),this.fieldType,boostDocs);
    }
 else {
      return new CollapsingScoreCollector(this.maxDoc,this.leafCount,this.docValues,this.nullPolicy,boostDocs);
    }
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
}
