{
  this.maxDoc=maxDoc;
  this.contexts=new LeafReaderContext[segments];
  this.collapseField=collapseField;
  this.nullValue=nullValue;
  this.nullPolicy=nullPolicy;
  this.needsScores=needsScores;
  if (funcQuery != null) {
    this.collapseStrategy=new IntValueSourceStrategy(maxDoc,field,size,collapseField,nullValue,nullPolicy,max,this.needsScores,boostDocsMap,funcQuery,searcher);
  }
 else {
    if (fieldType instanceof TrieIntField || fieldType instanceof TrieFloatField) {
      this.collapseStrategy=new IntIntStrategy(maxDoc,size,collapseField,field,nullValue,nullPolicy,max,this.needsScores,boostDocsMap);
    }
 else {
      throw new IOException("min/max must be TrieInt or TrieFloat when collapsing on numeric fields .");
    }
  }
}
