{
  int globalDoc=contextDoc + this.docBase;
  int ord=-1;
  if (this.ordinalMap != null) {
    if (contextDoc > segmentValues.docID()) {
      segmentValues.advance(contextDoc);
    }
    if (contextDoc == segmentValues.docID()) {
      ord=(int)segmentOrdinalMap.get(segmentValues.ordValue());
    }
  }
 else {
    if (globalDoc > segmentValues.docID()) {
      segmentValues.advance(globalDoc);
    }
    if (globalDoc == segmentValues.docID()) {
      ord=segmentValues.ordValue();
    }
  }
  collapseStrategy.collapse(ord,contextDoc,globalDoc);
}
