{
  Relation relation;
  do {
    if ((shift % GeoPointField.PRECISION_STEP) == 0 && (relation=relationImpl.relate(decodeLatitude(start),decodeLatitude(end),decodeLongitude(start),decodeLongitude(end))) != Relation.CELL_OUTSIDE_QUERY) {
      if (shift == maxShift || relation == Relation.CELL_INSIDE_QUERY) {
        setRange(relation == Relation.CELL_CROSSES_QUERY);
        advanceVariables();
        return true;
      }
    }
    if (shift != maxShift && relationImpl.cellIntersectsMBR(start,end) == true) {
      end=start | (1L << --shift) - 1;
    }
 else {
      advanceVariables();
    }
  }
 while (shift < 62);
  return false;
}
