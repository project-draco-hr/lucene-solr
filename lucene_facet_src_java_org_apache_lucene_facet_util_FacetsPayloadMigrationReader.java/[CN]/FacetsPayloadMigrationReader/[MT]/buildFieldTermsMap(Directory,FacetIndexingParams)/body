{
  DirectoryReader reader=DirectoryReader.open(dir);
  final Map<String,Term> fieldTerms=new HashMap<String,Term>();
  for (  AtomicReaderContext context : reader.leaves()) {
    for (    CategoryListParams clp : fip.getAllCategoryListParams()) {
      Terms terms=context.reader().terms(clp.field);
      if (terms != null) {
        TermsEnum te=terms.iterator(null);
        BytesRef termBytes=null;
        while ((termBytes=te.next()) != null) {
          String term=termBytes.utf8ToString();
          if (term.startsWith(PAYLOAD_TERM_TEXT)) {
            if (term.equals(PAYLOAD_TERM_TEXT)) {
              fieldTerms.put(clp.field,new Term(clp.field,term));
            }
 else {
              fieldTerms.put(clp.field + term.substring(PAYLOAD_TERM_TEXT.length()),new Term(clp.field,term));
            }
          }
        }
      }
    }
  }
  reader.close();
  return fieldTerms;
}
