{
  ensureOpen();
  if (cp.length == 0) {
    return ROOT_ORDINAL;
  }
synchronized (ordinalCache) {
    Integer res=ordinalCache.get(cp);
    if (res != null) {
      if (res.intValue() < indexReader.maxDoc()) {
        return res.intValue();
      }
 else {
        return TaxonomyReader.INVALID_ORDINAL;
      }
    }
  }
  int ret=TaxonomyReader.INVALID_ORDINAL;
  DocsEnum docs=MultiFields.getTermDocsEnum(indexReader,null,Consts.FULL,new BytesRef(FacetsConfig.pathToString(cp.components,cp.length)),0);
  if (docs != null && docs.nextDoc() != DocIdSetIterator.NO_MORE_DOCS) {
    ret=docs.docID();
synchronized (ordinalCache) {
      ordinalCache.put(cp,Integer.valueOf(ret));
    }
  }
  return ret;
}
