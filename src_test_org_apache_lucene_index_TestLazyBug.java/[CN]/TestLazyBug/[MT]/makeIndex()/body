{
  Directory dir=new RAMDirectory();
  try {
    Random r=new Random(BASE_SEED + 42);
    Analyzer analyzer=new SimpleAnalyzer();
    IndexWriter writer=new IndexWriter(dir,analyzer,true,IndexWriter.MaxFieldLength.LIMITED);
    writer.setUseCompoundFile(false);
    for (int d=1; d <= NUM_DOCS; d++) {
      Document doc=new Document();
      for (int f=1; f <= NUM_FIELDS; f++) {
        doc.add(new Field("f" + f,data[f % data.length] + '#' + data[r.nextInt(data.length)],Field.Store.YES,Field.Index.TOKENIZED));
      }
      writer.addDocument(doc);
    }
    writer.close();
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
  return dir;
}
