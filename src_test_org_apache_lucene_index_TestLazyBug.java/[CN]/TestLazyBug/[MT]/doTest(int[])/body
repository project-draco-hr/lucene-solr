{
  Directory dir=makeIndex();
  IndexReader reader=IndexReader.open(dir);
  for (int i=0; i < docs.length; i++) {
    Document d=reader.document(docs[i],SELECTOR);
    d.get(MAGIC_FIELD);
    List fields=d.getFields();
    for (Iterator fi=fields.iterator(); fi.hasNext(); ) {
      Fieldable f=null;
      try {
        f=(Fieldable)fi.next();
        String fname=f.name();
        String fval=f.stringValue();
        assertNotNull(docs[i] + " FIELD: " + fname,fval);
        String[] vals=fval.split("#");
        if (!dataset.contains(vals[0]) || !dataset.contains(vals[1])) {
          fail("FIELD:" + fname + ",VAL:"+ fval);
        }
      }
 catch (      Exception e) {
        throw new Exception(docs[i] + " WTF: " + f.name(),e);
      }
    }
  }
  reader.close();
}
