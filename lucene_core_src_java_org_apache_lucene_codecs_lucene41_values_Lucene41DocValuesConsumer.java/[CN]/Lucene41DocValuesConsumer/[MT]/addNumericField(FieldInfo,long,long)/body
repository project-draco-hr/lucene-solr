{
  String name=getDocValuesFileName(info,field,DATA_EXTENSION);
  IndexOutput dataOut=null;
  boolean success=false;
  try {
    dataOut=getDirectory().createOutput(name,context);
    Lucene41NumericDocValuesConsumer consumer=new Lucene41NumericDocValuesConsumer(dataOut,minValue,maxValue,info.getDocCount());
    success=true;
    return consumer;
  }
  finally {
    if (!success) {
      IOUtils.close(dataOut);
    }
  }
}
