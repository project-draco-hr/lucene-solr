{
  if (cfs == null) {
    final String suffix;
    if (segmentSuffix.length() == 0) {
      suffix=Lucene41DocValuesConsumer.DV_SEGMENT_SUFFIX;
    }
 else {
      suffix=segmentSuffix + "_" + Lucene41DocValuesConsumer.DV_SEGMENT_SUFFIX;
    }
    String fileName=IndexFileNames.segmentFileName(info.name,suffix,IndexFileNames.COMPOUND_FILE_EXTENSION);
    cfs=new CompoundFileDirectory(dir,fileName,context,true);
  }
  return cfs;
}
