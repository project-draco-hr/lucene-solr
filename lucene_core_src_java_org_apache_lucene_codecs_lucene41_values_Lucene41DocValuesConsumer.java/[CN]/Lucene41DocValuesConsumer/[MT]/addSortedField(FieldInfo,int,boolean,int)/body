{
  String nameData=getDocValuesFileName(info,field,DATA_EXTENSION);
  String idxOut=getDocValuesFileName(info,field,INDEX_EXTENSION);
  String offOut=getDocValuesFileName(info,field,OFFSET_EXTENSION);
  boolean success=false;
  IndexOutput dataOut=null;
  IndexOutput indexOut=null;
  IndexOutput offsetOut=null;
  try {
    dataOut=getDirectory().createOutput(nameData,context);
    indexOut=getDirectory().createOutput(idxOut,context);
    if (fixedLength) {
      offsetOut=null;
    }
 else {
      offsetOut=getDirectory().createOutput(offOut,context);
    }
    Lucene41SortedDocValuesConsumer consumer=new Lucene41SortedDocValuesConsumer(dataOut,indexOut,offsetOut,valueCount,maxLength);
    success=true;
    return consumer;
  }
  finally {
    if (!success) {
      IOUtils.close(dataOut,indexOut);
    }
  }
}
