{
  String nameData=IndexFileNames.segmentFileName(this.info.name + "_" + field.number,DV_SEGMENT_SUFFIX,DATA_EXTENSION);
  String idxOut=IndexFileNames.segmentFileName(this.info.name + "_" + field.number,DV_SEGMENT_SUFFIX,INDEX_EXTENSION);
  boolean success=false;
  IndexOutput dataOut=null;
  IndexOutput indexOut=null;
  try {
    dataOut=dir.createOutput(nameData,context);
    indexOut=dir.createOutput(idxOut,context);
    Lucene41BinaryDocValuesConsumer consumer=new Lucene41BinaryDocValuesConsumer(dataOut,indexOut,fixedLength,maxLength);
    success=true;
    return consumer;
  }
  finally {
    if (!success) {
      IOUtils.close(dataOut,indexOut);
    }
  }
}
