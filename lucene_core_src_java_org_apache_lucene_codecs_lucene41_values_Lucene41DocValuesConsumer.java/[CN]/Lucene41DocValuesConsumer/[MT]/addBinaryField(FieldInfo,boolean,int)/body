{
  String nameData=getDocValuesFileName(info,field,DATA_EXTENSION);
  String idxOut=getDocValuesFileName(info,field,INDEX_EXTENSION);
  boolean success=false;
  IndexOutput dataOut=null;
  IndexOutput indexOut=null;
  try {
    dataOut=getDirectory().createOutput(nameData,context);
    indexOut=getDirectory().createOutput(idxOut,context);
    Lucene41BinaryDocValuesConsumer consumer=new Lucene41BinaryDocValuesConsumer(dataOut,indexOut,fixedLength,maxLength);
    success=true;
    return consumer;
  }
  finally {
    if (!success) {
      IOUtils.close(dataOut,indexOut);
    }
  }
}
