{
  for (  PointReader reader : mergeState.pointReaders) {
    if (reader instanceof Lucene60PointReader == false) {
      super.merge(mergeState);
      return;
    }
  }
  for (  FieldInfo fieldInfo : mergeState.mergeFieldInfos) {
    if (fieldInfo.getPointDimensionCount() != 0) {
      if (fieldInfo.getPointDimensionCount() == 1) {
        try (BKDWriter writer=new BKDWriter(writeState.directory,writeState.segmentInfo.name,fieldInfo.getPointDimensionCount(),fieldInfo.getPointNumBytes(),maxPointsInLeafNode,maxMBSortInHeap)){
          List<BKDReader> bkdReaders=new ArrayList<>();
          List<MergeState.DocMap> docMaps=new ArrayList<>();
          List<Integer> docIDBases=new ArrayList<>();
          for (int i=0; i < mergeState.pointReaders.length; i++) {
            PointReader reader=mergeState.pointReaders[i];
            Lucene60PointReader reader60=(Lucene60PointReader)reader;
            if (reader60 != null) {
              FieldInfos readerFieldInfos=mergeState.fieldInfos[i];
              FieldInfo readerFieldInfo=readerFieldInfos.fieldInfo(fieldInfo.name);
              if (readerFieldInfo != null) {
                BKDReader bkdReader=reader60.readers.get(readerFieldInfo.number);
                if (bkdReader != null) {
                  docIDBases.add(mergeState.docBase[i]);
                  bkdReaders.add(bkdReader);
                  docMaps.add(mergeState.docMaps[i]);
                }
              }
            }
          }
          long fp=writer.merge(dataOut,docMaps,bkdReaders,docIDBases);
          if (fp != -1) {
            indexFPs.put(fieldInfo.name,fp);
          }
        }
       }
 else {
        mergeOneField(mergeState,fieldInfo);
      }
    }
  }
  finish();
}
