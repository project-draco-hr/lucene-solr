{
  if (result == null || result.length != center.length) {
    result=new double[center.length];
  }
  if (upperRight == false) {
    distance=-distance;
  }
  distance=SIN_45 * distance;
  for (int i=0; i < center.length; i++) {
    result[i]=center[i] + distance;
  }
  return result;
}
