{
  double brng=upperRight ? DEG_45 : DEG_225;
  double lat2=Math.asin(Math.sin(latCenter) * Math.cos(distance / radius) + Math.cos(latCenter) * Math.sin(distance / radius) * Math.cos(brng));
  double lon2=lonCenter + Math.atan2(Math.sin(brng) * Math.sin(distance / radius) * Math.cos(latCenter),Math.cos(distance / radius) - Math.sin(latCenter) * Math.sin(lat2));
  if (result == null || result.length != 2) {
    result=new double[2];
  }
  result[0]=lat2;
  result[1]=lon2;
  normLng(result);
  normLat(result);
  return result;
}
