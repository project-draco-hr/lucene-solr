{
  FieldsReader reader=new FieldsReader(dir,TEST_SEGMENT_NAME,fieldInfos);
  Document doc;
  doc=reader.doc(0,new FieldSelector(){
    public FieldSelectorResult accept(    String fieldName){
      if (fieldName.equals(DocHelper.TEXT_FIELD_1_KEY) || fieldName.equals(DocHelper.LAZY_FIELD_BINARY_KEY))       return FieldSelectorResult.SIZE;
 else       if (fieldName.equals(DocHelper.TEXT_FIELD_3_KEY))       return FieldSelectorResult.LOAD;
 else       return FieldSelectorResult.NO_LOAD;
    }
  }
);
  Fieldable f1=doc.getFieldable(DocHelper.TEXT_FIELD_1_KEY);
  Fieldable f3=doc.getFieldable(DocHelper.TEXT_FIELD_3_KEY);
  Fieldable fb=doc.getFieldable(DocHelper.LAZY_FIELD_BINARY_KEY);
  assertTrue(f1.isBinary());
  assertTrue(!f3.isBinary());
  assertTrue(fb.isBinary());
  assertSizeEquals(2 * DocHelper.FIELD_1_TEXT.length(),f1.getBinaryValue());
  assertEquals(DocHelper.FIELD_3_TEXT,f3.stringValue());
  assertSizeEquals(DocHelper.LAZY_FIELD_BINARY_BYTES.length,fb.getBinaryValue());
  reader.close();
}
