{
  assertTrue(dir != null);
  assertTrue(fieldInfos != null);
  FieldsReader reader=new FieldsReader(dir,TEST_SEGMENT_NAME,fieldInfos);
  assertTrue(reader != null);
  assertTrue(reader.size() == 1);
  LoadFirstFieldSelector fieldSelector=new LoadFirstFieldSelector();
  Document doc=reader.doc(0,fieldSelector);
  assertTrue("doc is null and it shouldn't be",doc != null);
  int count=0;
  List l=doc.getFields();
  for (Iterator iter=l.iterator(); iter.hasNext(); ) {
    Field field=(Field)iter.next();
    assertTrue("field is null and it shouldn't be",field != null);
    String sv=field.stringValue();
    assertTrue("sv is null and it shouldn't be",sv != null);
    count++;
  }
  assertTrue(count + " does not equal: " + 1,count == 1);
}
