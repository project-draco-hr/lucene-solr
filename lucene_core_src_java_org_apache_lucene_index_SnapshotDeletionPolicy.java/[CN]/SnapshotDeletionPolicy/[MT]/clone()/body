{
  SnapshotDeletionPolicy other=(SnapshotDeletionPolicy)super.clone();
  other.primary=this.primary.clone();
  other.lastCommit=null;
  other.segmentsFileToIDs=new HashMap<String,Set<String>>(segmentsFileToIDs);
  other.idToSnapshot=new HashMap<String,SnapshotInfo>(idToSnapshot);
  return other;
}
