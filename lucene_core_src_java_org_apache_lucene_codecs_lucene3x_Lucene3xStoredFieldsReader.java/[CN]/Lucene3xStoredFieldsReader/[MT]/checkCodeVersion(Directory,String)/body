{
  final String indexStreamFN=IndexFileNames.segmentFileName(segment,"",FIELDS_INDEX_EXTENSION);
  IndexInput idxStream=dir.openInput(indexStreamFN,IOContext.DEFAULT);
  try {
    int format=idxStream.readInt();
    if (format < FORMAT_MINIMUM)     throw new IndexFormatTooOldException(idxStream,format,FORMAT_MINIMUM,FORMAT_CURRENT);
    if (format > FORMAT_CURRENT)     throw new IndexFormatTooNewException(idxStream,format,FORMAT_MINIMUM,FORMAT_CURRENT);
  }
  finally {
    idxStream.close();
  }
}
