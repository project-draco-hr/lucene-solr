{
  return new DocIdSet(){
    @Override public DocIdSetIterator iterator() throws IOException {
      throw new UnsupportedOperationException("Iteration is too slow; consume using DocIdSet.bits() instead");
    }
    @Override public Bits bits() throws IOException {
      final FunctionValues predFuncValues=predicateValueSource.getValues(null,context);
      return new Bits(){
        @Override public boolean get(        int index){
          if (acceptDocs != null && !acceptDocs.get(index))           return false;
          return predFuncValues.boolVal(index);
        }
        @Override public int length(){
          return context.reader().maxDoc();
        }
      }
;
    }
    @Override public long ramBytesUsed(){
      return 0L;
    }
  }
;
}
