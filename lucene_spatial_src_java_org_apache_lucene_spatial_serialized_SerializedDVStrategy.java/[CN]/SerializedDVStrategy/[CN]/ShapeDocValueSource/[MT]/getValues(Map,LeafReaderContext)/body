{
  final BinaryDocValues docValues=readerContext.reader().getBinaryDocValues(fieldName);
  return new FunctionValues(){
    int bytesRefDoc=-1;
    BytesRefBuilder bytesRef=new BytesRefBuilder();
    boolean fillBytes(    int doc){
      if (bytesRefDoc != doc) {
        bytesRef.copyBytes(docValues.get(doc));
        bytesRefDoc=doc;
      }
      return bytesRef.length() != 0;
    }
    @Override public boolean exists(    int doc){
      return fillBytes(doc);
    }
    @Override public boolean bytesVal(    int doc,    BytesRefBuilder target){
      target.clear();
      if (fillBytes(doc)) {
        target.copyBytes(bytesRef);
        return true;
      }
 else {
        return false;
      }
    }
    @Override public Object objectVal(    int docId){
      if (!fillBytes(docId))       return null;
      DataInputStream dataInput=new DataInputStream(new ByteArrayInputStream(bytesRef.bytes(),0,bytesRef.length()));
      try {
        return binaryCodec.readShape(dataInput);
      }
 catch (      IOException e) {
        throw new RuntimeException(e);
      }
    }
    @Override public Explanation explain(    int doc){
      return Explanation.match(Float.NaN,toString(doc));
    }
    @Override public String toString(    int doc){
      return description() + "=" + objectVal(doc);
    }
  }
;
}
