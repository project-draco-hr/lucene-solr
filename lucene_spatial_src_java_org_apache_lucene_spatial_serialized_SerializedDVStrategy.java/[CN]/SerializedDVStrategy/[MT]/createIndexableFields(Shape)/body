{
  int bufSize=Math.max(128,(int)(this.indexLastBufSize * 1.5));
  ByteArrayOutputStream byteStream=new ByteArrayOutputStream(bufSize);
  final BytesRef bytesRef=new BytesRef();
  try {
    ctx.getBinaryCodec().writeShape(new DataOutputStream(byteStream),shape);
    byteStream.writeTo(new FilterOutputStream(null){
      @Override public void write(      byte[] b,      int off,      int len) throws IOException {
        bytesRef.bytes=b;
        bytesRef.offset=off;
        bytesRef.length=len;
      }
    }
);
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
  this.indexLastBufSize=bytesRef.length;
  return new Field[]{new BinaryDocValuesField(getFieldName(),bytesRef)};
}
