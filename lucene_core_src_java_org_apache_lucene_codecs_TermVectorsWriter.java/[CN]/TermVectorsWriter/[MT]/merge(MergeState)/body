{
  int docCount=0;
  for (int i=0; i < mergeState.readers.size(); i++) {
    final AtomicReader reader=mergeState.readers.get(i);
    final int maxDoc=reader.maxDoc();
    final Bits liveDocs=reader.getLiveDocs();
    if (mergeState.payloadProcessorProvider != null) {
      mergeState.currentReaderPayloadProcessor=mergeState.readerPayloadProcessor[i];
    }
 else {
      mergeState.currentReaderPayloadProcessor=null;
    }
    for (int docID=0; docID < maxDoc; docID++) {
      if (liveDocs != null && !liveDocs.get(docID)) {
        continue;
      }
      Fields vectors=reader.getTermVectors(docID);
      addAllDocVectors(vectors,mergeState);
      docCount++;
      mergeState.checkAbort.work(300);
    }
  }
  finish(mergeState.fieldInfos,docCount);
  return docCount;
}
