{
  if (filter != null) {
    Filter luceneFilter=filter.getTopFilter();
    query=new BooleanQuery.Builder().add(query,BooleanClause.Occur.MUST).add(luceneFilter,BooleanClause.Occur.FILTER).build();
  }
  if (query instanceof TermQuery) {
    DocSet set=createDocSet(searcher,((TermQuery)query).getTerm());
    return set;
  }
 else   if (query instanceof DocSetProducer) {
    DocSet set=((DocSetProducer)query).createDocSet(searcher);
    return set;
  }
  return createDocSetGeneric(searcher,query);
}
