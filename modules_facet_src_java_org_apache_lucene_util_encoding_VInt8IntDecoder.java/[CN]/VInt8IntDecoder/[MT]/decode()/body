{
  int value=0;
  while (true) {
    int first=in.read();
    if (first < 0) {
      if (!legalEOS) {
        throw new IOException("Unexpected End-Of-Stream");
      }
      return EOS;
    }
    value|=first & 0x7F;
    if ((first & 0x80) == 0) {
      legalEOS=true;
      return value;
    }
    legalEOS=false;
    value<<=7;
  }
}
