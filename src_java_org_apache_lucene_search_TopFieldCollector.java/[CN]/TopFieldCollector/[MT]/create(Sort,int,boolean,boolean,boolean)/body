{
  if (sort.fields.length == 0) {
    throw new IllegalArgumentException("Sort must contain at least one field");
  }
  FieldValueHitQueue queue=FieldValueHitQueue.create(sort.fields,numHits);
  if (queue.getComparators().length == 1) {
    if (trackMaxScore) {
      return new OneComparatorScoringMaxScoreCollector(queue,numHits,fillFields);
    }
 else     if (trackDocScores) {
      return new OneComparatorScoringNoMaxScoreCollector(queue,numHits,fillFields);
    }
 else {
      return new OneComparatorNonScoringCollector(queue,numHits,fillFields);
    }
  }
  if (trackMaxScore) {
    return new MultiComparatorScoringMaxScoreCollector(queue,numHits,fillFields);
  }
 else   if (trackDocScores) {
    return new MultiComparatorScoringNoMaxScoreCollector(queue,numHits,fillFields);
  }
 else {
    return new MultiComparatorNonScoringCollector(queue,numHits,fillFields);
  }
}
