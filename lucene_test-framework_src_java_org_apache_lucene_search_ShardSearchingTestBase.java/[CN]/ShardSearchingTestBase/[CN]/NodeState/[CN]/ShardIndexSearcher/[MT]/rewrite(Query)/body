{
  final IndexSearcher localSearcher=new IndexSearcher(getIndexReader());
  final Weight weight=localSearcher.createNormalizedWeight(original,true);
  final Set<Term> terms=new HashSet<>();
  weight.extractTerms(terms);
  for (int nodeID=0; nodeID < nodeVersions.length; nodeID++) {
    if (nodeID == myNodeID) {
      continue;
    }
    final Set<Term> missing=new HashSet<>();
    for (    Term term : terms) {
      final TermAndShardVersion key=new TermAndShardVersion(nodeID,nodeVersions[nodeID],term);
      if (!termStatsCache.containsKey(key)) {
        missing.add(term);
      }
    }
    if (missing.size() != 0) {
      for (      Map.Entry<Term,TermStatistics> ent : getNodeTermStats(missing,nodeID,nodeVersions[nodeID]).entrySet()) {
        final TermAndShardVersion key=new TermAndShardVersion(nodeID,nodeVersions[nodeID],ent.getKey());
        termStatsCache.put(key,ent.getValue());
      }
    }
  }
  return weight.getQuery();
}
