{
  if (this.isClosed.get())   throw new IllegalStateException("StorageModifier is already closed");
  try {
    if (this.isClosed.get())     throw new IllegalStateException("StorageModifier is already closed");
    incrementCounter();
    if (this.persistFactor > this.modifiedCounter && this.forceWriteDocuments.size() <= 0 && this.forceWriteTerms.size() <= 0)     return;
    if (LOG.isInfoEnabled())     LOG.info("Storage modified for " + this.modifiedCounter + " times. Write Persistent index");
    writePersistentIndex((this.optimizeCounter >= this.optimizeInterval));
    requestNewIndexModifier();
    this.modifiedCounter=0;
  }
 catch (  IOException e) {
    LOG.error("Writing persistent index failed - Recovering",e);
    throw new StorageException("could not write to storage index -- " + e.getMessage(),e);
  }
}
