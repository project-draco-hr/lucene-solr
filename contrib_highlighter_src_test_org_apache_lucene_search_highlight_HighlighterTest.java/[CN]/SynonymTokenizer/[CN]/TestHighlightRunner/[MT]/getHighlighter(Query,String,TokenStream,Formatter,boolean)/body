{
  Scorer scorer=null;
  if (mode == STANDARD) {
    scorer=new QueryTermScorer(query);
  }
 else   if (mode == SPAN) {
    scorer=new QueryScorer(query,fieldName);
    if (!expanMultiTerm) {
      ((QueryScorer)scorer).setExpandMultiTermQuery(false);
    }
  }
 else {
    throw new RuntimeException("Unknown highlight mode");
  }
  return new Highlighter(formatter,scorer);
}
