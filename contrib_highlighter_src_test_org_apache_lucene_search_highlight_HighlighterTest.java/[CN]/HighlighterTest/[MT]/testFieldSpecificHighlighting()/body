{
  TestHighlightRunner helper=new TestHighlightRunner(){
    public void run() throws Exception {
      String docMainText="fred is one of the people";
      QueryParser parser=new QueryParser(FIELD_NAME,analyzer);
      Query query=parser.parse("fred category:people");
      Scorer fieldSpecificScorer=null;
      if (mode == this.SPAN) {
        TokenStream tokenStream=analyzer.tokenStream(FIELD_NAME,new StringReader(docMainText));
        CachingTokenFilter ctf=new CachingTokenFilter(tokenStream);
        fieldSpecificScorer=new SpanScorer(query,FIELD_NAME,ctf);
      }
 else       if (mode == this.STANDARD) {
        fieldSpecificScorer=new QueryScorer(query,"contents");
      }
      Highlighter fieldSpecificHighlighter=new Highlighter(new SimpleHTMLFormatter(),fieldSpecificScorer);
      fieldSpecificHighlighter.setTextFragmenter(new NullFragmenter());
      String result=fieldSpecificHighlighter.getBestFragment(analyzer,FIELD_NAME,docMainText);
      assertEquals("Should match",result,"<B>fred</B> is one of the people");
      Scorer fieldInSpecificScorer=null;
      if (mode == this.SPAN) {
        TokenStream tokenStream=analyzer.tokenStream(FIELD_NAME,new StringReader(docMainText));
        CachingTokenFilter ctf=new CachingTokenFilter(tokenStream);
        fieldInSpecificScorer=new SpanScorer(query,null,ctf);
      }
 else       if (mode == this.STANDARD) {
        fieldInSpecificScorer=new QueryScorer(query);
      }
      Highlighter fieldInSpecificHighlighter=new Highlighter(new SimpleHTMLFormatter(),fieldInSpecificScorer);
      fieldInSpecificHighlighter.setTextFragmenter(new NullFragmenter());
      result=fieldInSpecificHighlighter.getBestFragment(analyzer,FIELD_NAME,docMainText);
      assertEquals("Should match",result,"<B>fred</B> is one of the <B>people</B>");
      reader.close();
    }
  }
;
  helper.start();
}
