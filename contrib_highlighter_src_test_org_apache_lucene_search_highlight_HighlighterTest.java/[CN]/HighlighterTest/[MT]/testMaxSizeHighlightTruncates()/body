{
  String goodWord="goodtoken";
  String stopWords[]={"stoppedtoken"};
  TermQuery query=new TermQuery(new Term("data",goodWord));
  SimpleHTMLFormatter fm=new SimpleHTMLFormatter();
  Highlighter hg=new Highlighter(fm,new QueryScorer(query));
  hg.setTextFragmenter(new NullFragmenter());
  String match=null;
  StringBuffer sb=new StringBuffer();
  sb.append(goodWord);
  for (int i=0; i < 10000; i++) {
    sb.append(" ");
    sb.append(stopWords[0]);
  }
  hg.setMaxDocBytesToAnalyze(100);
  match=hg.getBestFragment(new StandardAnalyzer(stopWords),"data",sb.toString());
  assertTrue("Matched text should be no more than 100 chars in length ",match.length() < hg.getMaxDocBytesToAnalyze());
  sb.append(" ");
  sb.append(goodWord);
  match=hg.getBestFragment(new StandardAnalyzer(stopWords),"data",sb.toString());
  assertTrue("Matched text should be no more than 100 chars in length ",match.length() < hg.getMaxDocBytesToAnalyze());
}
