{
  String host="www.apache.org";
  String feedAndEntryID="/" + ProvidedServiceStub.SERVICE_NAME + "/feed/entryid";
  String queryString="max-results=25";
  String startIndex="start-index=26";
  Enumeration enu=new StringTokenizer("max-results",",");
  this.control.expectAndDefaultReturn(this.request.getParameterMap(),this.parametermap);
  this.control.expectAndDefaultReturn(this.request.getParameterNames(),enu);
  this.control.expectAndDefaultReturn(this.request.getHeader("Host"),host);
  this.control.expectAndDefaultReturn(this.request.getRequestURI(),"/" + ProvidedServiceStub.SERVICE_NAME + "/feed/");
  this.control.expectAndDefaultReturn(this.request.getPathInfo(),"/" + ProvidedServiceStub.SERVICE_NAME + "/feed/");
  this.control.expectAndReturn(this.request.getParameter("max-results"),"25",3);
  this.control.expectAndReturn(this.request.getParameter("start-index"),null);
  this.control.expectAndDefaultReturn(this.request.getParameter("alt"),null);
  this.control.expectAndDefaultReturn(this.request.getQueryString(),queryString);
  this.control.replay();
  this.feedRequest.initializeRequest();
  String nextID="http://" + host + "/"+ ProvidedServiceStub.SERVICE_NAME+ "/feed?"+ startIndex+ "&"+ queryString;
  assertEquals("Next ID",nextID,this.feedRequest.getNextId());
  this.control.verify();
  this.control.reset();
  enu=new StringTokenizer("alt,max-results,start-index",",");
  queryString="alt=rss&max-results=25";
  this.control.expectAndDefaultReturn(this.request.getParameterMap(),this.parametermap);
  this.control.expectAndDefaultReturn(this.request.getHeader("Host"),host);
  this.control.expectAndDefaultReturn(this.request.getRequestURI(),"/" + ProvidedServiceStub.SERVICE_NAME + "/feed/");
  this.control.expectAndDefaultReturn(this.request.getPathInfo(),"/" + ProvidedServiceStub.SERVICE_NAME + "/feed/");
  this.control.expectAndReturn(this.request.getParameter("max-results"),"25",4);
  this.control.expectAndReturn(this.request.getParameter("start-index"),"26",4);
  this.control.expectAndDefaultReturn(this.request.getParameter("alt"),"rss");
  this.control.expectAndDefaultReturn(this.request.getQueryString(),queryString + "&" + startIndex);
  this.control.expectAndDefaultReturn(this.request.getParameterNames(),enu);
  this.control.replay();
  this.feedRequest.initializeRequest();
  startIndex="&start-index=51";
  nextID="http://" + host + "/"+ ProvidedServiceStub.SERVICE_NAME+ "/feed?"+ queryString+ startIndex;
  assertEquals("Next ID 51",nextID,this.feedRequest.getNextId());
  this.control.reset();
  queryString="";
  this.control.expectAndDefaultReturn(this.request.getParameterMap(),this.parametermap);
  this.control.expectAndDefaultReturn(this.request.getHeader("Host"),host);
  this.control.expectAndDefaultReturn(this.request.getRequestURI(),"/" + ProvidedServiceStub.SERVICE_NAME + "/feed/");
  this.control.expectAndDefaultReturn(this.request.getPathInfo(),"/" + ProvidedServiceStub.SERVICE_NAME + "/feed/entryId/15");
  this.control.expectAndDefaultReturn(this.request.getParameter("max-results"),null);
  this.control.expectAndDefaultReturn(this.request.getParameter("alt"),null);
  this.control.expectAndDefaultReturn(this.request.getQueryString(),null);
  this.control.replay();
  this.feedRequest.initializeRequest();
  String nextId="http://" + host + "/"+ ProvidedServiceStub.SERVICE_NAME+ "/feed"+ "?max-results=25&start-index=26";
  assertEquals("next ID",nextId,this.feedRequest.getNextId());
  this.control.reset();
  this.control.expectAndDefaultReturn(this.request.getParameterMap(),this.parametermap);
  this.control.expectAndDefaultReturn(this.request.getHeader("Host"),host);
  this.control.expectAndDefaultReturn(this.request.getRequestURI(),"/" + ProvidedServiceStub.SERVICE_NAME + "/feed/");
  this.control.expectAndDefaultReturn(this.request.getPathInfo(),"/" + ProvidedServiceStub.SERVICE_NAME + "/feed/entryId/15");
  this.control.expectAndReturn(this.request.getParameter("max-results"),null,3);
  this.control.expectAndReturn(this.request.getParameter("start-index"),null,3);
  this.control.expectAndDefaultReturn(this.request.getParameter("alt"),null);
  this.control.expectAndDefaultReturn(this.request.getQueryString(),null);
  this.control.replay();
  this.feedRequest.initializeRequest();
  nextId="http://" + host + "/"+ ProvidedServiceStub.SERVICE_NAME+ "/feed"+ "?max-results=25&start-index=26";
  assertEquals("nextID",nextId,this.feedRequest.getNextId());
}
