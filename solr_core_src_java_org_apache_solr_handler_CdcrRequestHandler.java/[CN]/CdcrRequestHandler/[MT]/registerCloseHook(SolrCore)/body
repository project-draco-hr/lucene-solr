{
  core.addCloseHook(new CloseHook(){
    @Override public void preClose(    SolrCore core){
      String collectionName=core.getCoreDescriptor().getCloudDescriptor().getCollectionName();
      String shard=core.getCoreDescriptor().getCloudDescriptor().getShardId();
      log.info("Solr core is being closed - shutting down CDCR handler @ {}:{}",collectionName,shard);
      updateLogSynchronizer.shutdown();
      replicatorManager.shutdown();
      bufferStateManager.shutdown();
      processStateManager.shutdown();
      leaderStateManager.shutdown();
    }
    @Override public void postClose(    SolrCore core){
    }
  }
);
}
