{
  NamedList hosts=new NamedList();
  for (  CdcrReplicatorState state : replicatorManager.getReplicatorStates()) {
    NamedList errors=new NamedList();
    errors.add(CdcrParams.CONSECUTIVE_ERRORS,state.getConsecutiveErrors());
    errors.add(CdcrReplicatorState.ErrorType.BAD_REQUEST.toLower(),state.getErrorCount(CdcrReplicatorState.ErrorType.BAD_REQUEST));
    errors.add(CdcrReplicatorState.ErrorType.INTERNAL.toLower(),state.getErrorCount(CdcrReplicatorState.ErrorType.INTERNAL));
    NamedList lastErrors=new NamedList();
    for (    String[] lastError : state.getLastErrors()) {
      lastErrors.add(lastError[0],lastError[1]);
    }
    errors.add(CdcrParams.LAST,lastErrors);
    if (hosts.get(state.getZkHost()) == null) {
      hosts.add(state.getZkHost(),new NamedList());
    }
    ((NamedList)hosts.get(state.getZkHost())).add(state.getTargetCollection(),errors);
  }
  rsp.add(CdcrParams.ERRORS,hosts);
}
