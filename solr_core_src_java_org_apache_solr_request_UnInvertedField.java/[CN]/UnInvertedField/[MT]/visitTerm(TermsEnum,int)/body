{
  if (termNum >= maxTermCounts.length) {
    int[] newMaxTermCounts=new int[maxTermCounts.length * 2];
    System.arraycopy(maxTermCounts,0,newMaxTermCounts,0,termNum);
    maxTermCounts=newMaxTermCounts;
  }
  final BytesRef term=te.term();
  if (te.docFreq() > maxTermDocFreq) {
    TopTerm topTerm=new TopTerm();
    topTerm.term=BytesRef.deepCopyOf(term);
    topTerm.termNum=termNum;
    bigTerms.put(topTerm.termNum,topTerm);
    if (deState == null) {
      deState=new SolrIndexSearcher.DocsEnumState();
      deState.fieldName=field;
      deState.liveDocs=searcher.getLeafReader().getLiveDocs();
      deState.termsEnum=te;
      deState.docsEnum=docsEnum;
      deState.minSetSizeCached=maxTermDocFreq;
    }
    docsEnum=deState.docsEnum;
    DocSet set=searcher.getDocSet(deState);
    maxTermCounts[termNum]=set.size();
  }
}
