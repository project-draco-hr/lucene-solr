{
  String configName="solrCloudCollectionConfig";
  File configDir=new File(SolrTestCaseJ4.TEST_HOME() + File.separator + "collection1"+ File.separator+ "conf");
  miniCluster.uploadConfigDir(configDir,configName);
  Map<String,String> collectionProperties=new HashMap<>();
  collectionProperties.put(CoreDescriptor.CORE_CONFIG,"solrconfig-tlog.xml");
  collectionProperties.put("solr.tests.maxBufferedDocs","100000");
  collectionProperties.put("solr.tests.ramBufferSizeMB","100");
  collectionProperties.put("solr.tests.mergePolicy","org.apache.lucene.index.TieredMergePolicy");
  collectionProperties.put("solr.tests.mergeScheduler","org.apache.lucene.index.ConcurrentMergeScheduler");
  collectionProperties.put("solr.directoryFactory",(persistIndex ? "solr.StandardDirectoryFactory" : "solr.RAMDirectoryFactory"));
  miniCluster.createCollection(collectionName,NUM_SHARDS,REPLICATION_FACTOR,configName,createNodeSet,asyncId,collectionProperties);
}
