{
  final SpatialOperation op=args.getOperation();
  if (!SpatialOperation.is(op,SpatialOperation.IsWithin,SpatialOperation.Intersects,SpatialOperation.BBoxWithin))   throw new UnsupportedSpatialOperation(op);
  Shape qshape=args.getShape();
  int detailLevel=grid.getMaxLevelForPrecision(qshape,args.getDistPrecision());
  return new RecursivePrefixTreeFilter(fieldInfo.getFieldName(),grid,qshape,prefixGridScanLevel,detailLevel);
}
