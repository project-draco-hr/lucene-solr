{
  if (loggingPath != null) {
    File loggingConfig=new File(loggingPath);
    if (!loggingConfig.exists() && instanceDir != null) {
      loggingConfig=new File(new File(instanceDir),loggingPath);
    }
    if (loggingConfig.exists()) {
      System.setProperty("java.util.logging.config.file",loggingConfig.getAbsolutePath());
    }
 else {
      throw new SolrException(SolrException.ErrorCode.SERVER_ERROR,"can not find logging file: " + loggingConfig);
    }
  }
  if (instanceDir != null) {
    if (Config.isInstanceDirInitialized()) {
      String dir=Config.getInstanceDir();
      if (!dir.equals(instanceDir)) {
        throw new SolrException(SolrException.ErrorCode.SERVER_ERROR,"already initalized: " + dir);
      }
    }
    Config.setInstanceDir(instanceDir);
  }
  SolrConfig config=SolrConfig.createInstance("solrconfig.xml");
  if (dataDir != null) {
    IndexSchema schema=new IndexSchema(config,instanceDir + "/conf/schema.xml");
    core=new SolrCore(dataDir,config,schema);
  }
 else {
    core=SolrCore.getSolrCore();
  }
  parser=new SolrRequestParsers(core);
}
