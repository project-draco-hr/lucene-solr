{
  if (clauses.size() == 1) {
    BooleanClause c=(BooleanClause)clauses.elementAt(0);
    if (!c.prohibited) {
      Query clone=(Query)c.query.clone();
      clone.setBoost(getBoost() * clone.getBoost());
      return clone;
    }
  }
  BooleanQuery clone=(BooleanQuery)this.clone();
  boolean changed=false;
  for (int i=0; i < clauses.size(); i++) {
    BooleanClause c=(BooleanClause)clauses.elementAt(i);
    Query q=c.query.rewrite(reader);
    if (q != c.query) {
      changed=true;
      clone.clauses.setElementAt(new BooleanClause(q,c.required,c.prohibited),i);
    }
  }
  if (changed)   return clone;
 else   return this;
}
