{
  boolean allRequired=true;
  boolean noneBoolean=true;
  for (int i=0; i < weights.size(); i++) {
    BooleanClause c=(BooleanClause)clauses.get(i);
    if (!c.isRequired())     allRequired=false;
    if (c.getQuery() instanceof BooleanQuery)     noneBoolean=false;
  }
  if (allRequired && noneBoolean) {
    ConjunctionScorer result=new ConjunctionScorer(similarity);
    for (int i=0; i < weights.size(); i++) {
      Weight w=(Weight)weights.elementAt(i);
      Scorer subScorer=w.scorer(reader);
      if (subScorer == null)       return null;
      result.add(subScorer);
    }
    return result;
  }
  BooleanScorer result=new BooleanScorer(similarity);
  for (int i=0; i < weights.size(); i++) {
    BooleanClause c=(BooleanClause)clauses.get(i);
    Weight w=(Weight)weights.elementAt(i);
    Scorer subScorer=w.scorer(reader);
    if (subScorer != null)     result.add(subScorer,c.isRequired(),c.isProhibited());
 else     if (c.isRequired())     return null;
  }
  return result;
}
