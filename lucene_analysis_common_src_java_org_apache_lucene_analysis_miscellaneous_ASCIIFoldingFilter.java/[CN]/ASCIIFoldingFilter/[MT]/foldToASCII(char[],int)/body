{
  final int maxSizeNeeded=4 * length;
  if (output.length < maxSizeNeeded) {
    output=new char[ArrayUtil.oversize(maxSizeNeeded,Character.BYTES)];
  }
  outputPos=foldToASCII(input,0,output,0,length);
  if (preserveOriginal && needToPreserve(input,length)) {
    state=captureState();
  }
}
