{
  Set<String> primaryToDelete=new HashSet<>();
  Set<String> secondaryToDelete=new HashSet<>();
  for (  String name : names) {
    if (getDirectory(name) == primaryDir) {
      primaryToDelete.add(name);
    }
 else {
      secondaryToDelete.add(name);
    }
  }
  try {
    primaryDir.deleteFiles(primaryToDelete);
  }
  finally {
    secondaryDir.deleteFiles(secondaryToDelete);
  }
}
