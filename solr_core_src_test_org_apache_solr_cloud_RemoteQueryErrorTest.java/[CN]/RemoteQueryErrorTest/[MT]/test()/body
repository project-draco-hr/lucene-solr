{
  handle.clear();
  handle.put("timestamp",SKIPVAL);
  waitForThingsToLevelOut(15);
  del("*:*");
  createCollection("collection2",2,1,10);
  List<Integer> numShardsNumReplicaList=new ArrayList<>(2);
  numShardsNumReplicaList.add(2);
  numShardsNumReplicaList.add(1);
  checkForCollection("collection2",numShardsNumReplicaList,null);
  waitForRecoveriesToFinish("collection2",true);
  for (  SolrClient solrClient : clients) {
    try {
      SolrInputDocument emptyDoc=new SolrInputDocument();
      solrClient.add(emptyDoc);
      fail("Expected unique key exceptoin");
    }
 catch (    SolrException ex) {
      assertThat(ex.getMessage(),containsString("Document is missing mandatory uniqueKey field: id"));
    }
catch (    Exception ex) {
      fail("Expected a SolrException to occur, instead received: " + ex.getClass());
    }
 finally {
      solrClient.shutdown();
    }
  }
}
