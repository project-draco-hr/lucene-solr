{
  handle.clear();
  handle.put("QTime",SKIPVAL);
  handle.put("timestamp",SKIPVAL);
  waitForThingsToLevelOut(15);
  del("*:*");
  createCollection("collection2",2,1,10);
  List<Integer> numShardsNumReplicaList=new ArrayList<Integer>(2);
  numShardsNumReplicaList.add(2);
  numShardsNumReplicaList.add(1);
  checkForCollection("collection2",numShardsNumReplicaList,null);
  waitForRecoveriesToFinish("collection2",true);
  HttpSolrServer solrServer=null;
  for (  JettySolrRunner jetty : jettys) {
    int port=port=jetty.getLocalPort();
    solrServer=new HttpSolrServer("http://127.0.0.1:" + port + context+ "/collection2");
    try {
      SolrInputDocument emptyDoc=new SolrInputDocument();
      solrServer.add(emptyDoc);
      fail("Expected unique key exceptoin");
    }
 catch (    Exception ex) {
      assert(ex.getMessage().contains("Document is missing mandatory uniqueKey field: id"));
    }
 finally {
      solrServer.shutdown();
    }
  }
}
