{
  RandomIndexWriter writer=new RandomIndexWriter(random,index.index,new IndexWriterConfig(TEST_VERSION_CURRENT,new MockAnalyzer()).setOpenMode(OpenMode.CREATE));
  for (int d=minId; d <= maxId; d++) {
    Document doc=new Document();
    doc.add(new Field("id",pad(d),Field.Store.YES,Field.Index.NOT_ANALYZED));
    int r=index.allowNegativeRandomInts ? rand.nextInt() : rand.nextInt(Integer.MAX_VALUE);
    if (index.maxR < r) {
      index.maxR=r;
    }
    if (r < index.minR) {
      index.minR=r;
    }
    doc.add(new Field("rand",pad(r),Field.Store.YES,Field.Index.NOT_ANALYZED));
    doc.add(new Field("body","body",Field.Store.YES,Field.Index.NOT_ANALYZED));
    writer.addDocument(doc);
  }
  IndexReader ir=writer.getReader();
  writer.close();
  return ir;
}
