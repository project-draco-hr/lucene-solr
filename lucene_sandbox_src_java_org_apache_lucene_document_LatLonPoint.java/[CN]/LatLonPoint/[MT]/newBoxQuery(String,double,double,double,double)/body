{
  byte[][] lower=encode(minLatitude,minLongitude);
  byte[][] upper=encode(maxLatitude,maxLongitude);
  if (maxLongitude < minLongitude) {
    BooleanQuery.Builder q=new BooleanQuery.Builder();
    q.setDisableCoord(true);
    byte[][] leftOpen=new byte[2][];
    leftOpen[0]=lower[0];
    leftOpen[1]=new byte[Integer.BYTES];
    NumericUtils.intToBytes(Integer.MIN_VALUE,leftOpen[1],0);
    Query left=newBoxInternal(field,leftOpen,upper);
    q.add(new BooleanClause(left,BooleanClause.Occur.SHOULD));
    byte[][] rightOpen=new byte[2][];
    rightOpen[0]=upper[0];
    rightOpen[1]=new byte[Integer.BYTES];
    NumericUtils.intToBytes(Integer.MAX_VALUE,rightOpen[1],0);
    Query right=newBoxInternal(field,lower,rightOpen);
    q.add(new BooleanClause(right,BooleanClause.Occur.SHOULD));
    return new ConstantScoreQuery(q.build());
  }
 else {
    return newBoxInternal(field,lower,upper);
  }
}
