{
  MockIndexWriter.RANDOM=random;
  Directory directory;
  directory=new MockDirectoryWrapper(random,new RAMDirectory());
  runTest(directory);
  directory.close();
  File dirPath=_TestUtil.getTempDir("lucene.test.atomic");
  directory=FSDirectory.open(dirPath);
  runTest(directory);
  directory.close();
  _TestUtil.rmDir(dirPath);
}
