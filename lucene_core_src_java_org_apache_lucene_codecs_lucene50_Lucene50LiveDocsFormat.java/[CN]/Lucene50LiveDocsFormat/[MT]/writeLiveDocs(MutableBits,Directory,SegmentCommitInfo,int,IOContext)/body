{
  long gen=info.getNextDelGen();
  String name=IndexFileNames.fileNameFromGeneration(info.info.name,EXTENSION,gen);
  long data[]=((FixedBitSet)bits).getBits();
  try (IndexOutput output=dir.createOutput(name,context)){
    CodecUtil.writeSegmentHeader(output,CODEC_NAME,VERSION_CURRENT,info.info.getId());
    output.writeLong(gen);
    for (int i=0; i < data.length; i++) {
      output.writeLong(data[i]);
    }
    CodecUtil.writeFooter(output);
  }
 }
