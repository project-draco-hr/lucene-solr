{
  return new Spans(){
    private Spans includeSpans=include.getSpans(context,acceptDocs,termContexts);
    private boolean moreInclude=true;
    private Spans excludeSpans=exclude.getSpans(context,acceptDocs,termContexts);
    private boolean moreExclude=excludeSpans.next();
    @Override public boolean next() throws IOException {
      if (moreInclude)       moreInclude=includeSpans.next();
      while (moreInclude && moreExclude) {
        if (includeSpans.doc() > excludeSpans.doc())         moreExclude=excludeSpans.skipTo(includeSpans.doc());
        while (moreExclude && includeSpans.doc() == excludeSpans.doc() && excludeSpans.end() <= includeSpans.start() - pre) {
          moreExclude=excludeSpans.next();
        }
        if (!moreExclude || includeSpans.doc() != excludeSpans.doc() || includeSpans.end() + post <= excludeSpans.start())         break;
        moreInclude=includeSpans.next();
      }
      return moreInclude;
    }
    @Override public boolean skipTo(    int target) throws IOException {
      if (moreInclude)       moreInclude=includeSpans.skipTo(target);
      if (!moreInclude)       return false;
      if (moreExclude && includeSpans.doc() > excludeSpans.doc())       moreExclude=excludeSpans.skipTo(includeSpans.doc());
      while (moreExclude && includeSpans.doc() == excludeSpans.doc() && excludeSpans.end() <= includeSpans.start() - pre) {
        moreExclude=excludeSpans.next();
      }
      if (!moreExclude || includeSpans.doc() != excludeSpans.doc() || includeSpans.end() + post <= excludeSpans.start())       return true;
      return next();
    }
    @Override public int doc(){
      return includeSpans.doc();
    }
    @Override public int start(){
      return includeSpans.start();
    }
    @Override public int end(){
      return includeSpans.end();
    }
    @Override public Collection<byte[]> getPayload() throws IOException {
      ArrayList<byte[]> result=null;
      if (includeSpans.isPayloadAvailable()) {
        result=new ArrayList<>(includeSpans.getPayload());
      }
      return result;
    }
    @Override public boolean isPayloadAvailable() throws IOException {
      return includeSpans.isPayloadAvailable();
    }
    @Override public long cost(){
      return includeSpans.cost();
    }
    @Override public String toString(){
      return "spans(" + SpanNotQuery.this.toString() + ")";
    }
  }
;
}
