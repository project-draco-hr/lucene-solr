{
  if (zkProps == null) {
    zkProps=new SolrZkServerProps();
    zkProps.setDataDir(solrHome + '/' + "zoo_data");
    zkProps.zkRun=zkRun;
    zkProps.solrPort=solrPort;
  }
  try {
    props=SolrZkServerProps.getProperties(solrHome + '/' + "zoo.cfg");
    SolrZkServerProps.injectServers(props,zkRun,zkHost);
    zkProps.parseProperties(props);
    if (zkProps.getClientPortAddress() == null) {
      zkProps.setClientPort(Integer.parseInt(solrPort) + 1000);
    }
  }
 catch (  QuorumPeerConfig.ConfigException e) {
    if (zkRun != null)     throw new SolrException(SolrException.ErrorCode.SERVER_ERROR,e);
  }
catch (  IOException e) {
    if (zkRun != null)     throw new SolrException(SolrException.ErrorCode.SERVER_ERROR,e);
  }
}
