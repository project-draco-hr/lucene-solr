{
  long bits, val;
  do {
    bits=random.nextLong() & (~(1L << BITS_PER_LONG));
    val=bits % n;
  }
 while (bits - val + (n - 1) < 0L);
  return val;
}
