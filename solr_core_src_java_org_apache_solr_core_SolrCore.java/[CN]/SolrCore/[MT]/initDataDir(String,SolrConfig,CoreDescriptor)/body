{
  if (dataDir == null) {
    if (coreDescriptor.usingDefaultDataDir()) {
      dataDir=config.getDataDir();
    }
    if (dataDir == null) {
      try {
        dataDir=coreDescriptor.getDataDir();
        if (!directoryFactory.isAbsolute(dataDir)) {
          dataDir=directoryFactory.getDataHome(coreDescriptor);
        }
      }
 catch (      IOException e) {
        throw new SolrException(SolrException.ErrorCode.SERVER_ERROR,e);
      }
    }
  }
  return SolrResourceLoader.normalizeDir(dataDir);
}
