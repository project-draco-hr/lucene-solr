{
  File propFile=new File(cd.getInstanceDir(),"core.properties");
  if (!propFile.exists()) {
    propFile.getParentFile().mkdirs();
    Properties props=new Properties();
    props.put("name",cd.getName());
    if (cc.isZooKeeperAware()) {
      String collection=cd.getCloudDescriptor().getCollectionName();
      if (collection != null) {
        props.put("collection",collection);
      }
      String coreNodeName=cd.getCloudDescriptor().getCoreNodeName();
      if (coreNodeName != null) {
        props.put("coreNodeName",coreNodeName);
      }
      String roles=cd.getCloudDescriptor().getRoles();
      if (roles != null) {
        props.put("roles",roles);
      }
      String shardId=cd.getCloudDescriptor().getShardId();
      if (shardId != null) {
        props.put("shard",shardId);
      }
    }
    OutputStream out=null;
    try {
      out=new FileOutputStream(propFile);
      props.store(out,"");
    }
 catch (    IOException e) {
      throw new SolrException(ErrorCode.SERVER_ERROR,null,e);
    }
 finally {
      if (out != null) {
        IOUtils.closeQuietly(out);
      }
    }
  }
}
