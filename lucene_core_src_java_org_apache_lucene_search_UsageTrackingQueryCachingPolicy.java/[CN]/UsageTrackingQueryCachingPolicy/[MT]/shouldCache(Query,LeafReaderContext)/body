{
  if (query instanceof MatchAllDocsQuery || query instanceof MatchNoDocsQuery) {
    return false;
  }
  if (query instanceof BooleanQuery) {
    BooleanQuery bq=(BooleanQuery)query;
    if (bq.clauses().isEmpty()) {
      return false;
    }
  }
  if (query instanceof DisjunctionMaxQuery) {
    DisjunctionMaxQuery dmq=(DisjunctionMaxQuery)query;
    if (dmq.getDisjuncts().isEmpty()) {
      return false;
    }
  }
  if (segmentPolicy.shouldCache(query,context) == false) {
    return false;
  }
  final int frequency=frequency(query);
  final int minFrequency=minFrequencyToCache(query);
  return frequency >= minFrequency;
}
