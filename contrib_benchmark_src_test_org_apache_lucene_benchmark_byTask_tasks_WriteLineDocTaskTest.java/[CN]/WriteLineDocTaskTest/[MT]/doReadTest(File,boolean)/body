{
  InputStream in=new FileInputStream(file);
  if (bz2File) {
    in=csFactory.createCompressorInputStream("bzip2",in);
  }
  BufferedReader br=new BufferedReader(new InputStreamReader(in,"utf-8"));
  try {
    String line=br.readLine();
    assertNotNull(line);
    String[] parts=line.split(Character.toString(WriteLineDocTask.SEP));
    assertEquals(3,parts.length);
    assertEquals("title",parts[0]);
    assertEquals("date",parts[1]);
    assertEquals("body",parts[2]);
    assertNull(br.readLine());
  }
  finally {
    br.close();
  }
}
