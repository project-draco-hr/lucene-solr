{
  return new Filter(){
    @Override public String toString(    String field){
      return "Filter(" + LongRange.this.toString() + ")";
    }
    @Override public DocIdSet getDocIdSet(    LeafReaderContext context,    final Bits acceptDocs) throws IOException {
      final FunctionValues values=valueSource.getValues(Collections.emptyMap(),context);
      final int maxDoc=context.reader().maxDoc();
      final DocIdSet fastMatchDocs;
      if (fastMatchFilter != null) {
        fastMatchDocs=fastMatchFilter.getDocIdSet(context,null);
        if (fastMatchDocs == null) {
          return null;
        }
      }
 else {
        fastMatchDocs=new DocIdSet(){
          @Override public long ramBytesUsed(){
            return 0;
          }
          @Override public DocIdSetIterator iterator() throws IOException {
            return DocIdSetIterator.all(maxDoc);
          }
        }
;
      }
      return new FilteredDocIdSet(fastMatchDocs){
        @Override protected boolean match(        int docID){
          if (acceptDocs != null && acceptDocs.get(docID) == false) {
            return false;
          }
          return accept(values.longVal(docID));
        }
      }
;
    }
  }
;
}
