{
  if (maxLon < minLon) {
    BooleanQuery.Builder q=new BooleanQuery.Builder();
    q.setDisableCoord(true);
    BKDPointInBBoxQuery left=new BKDPointInBBoxQuery(field,minLat,maxLat,BKDTreeWriter.MIN_LON_INCL,maxLon);
    q.add(new BooleanClause(left,BooleanClause.Occur.SHOULD));
    BKDPointInBBoxQuery right=new BKDPointInBBoxQuery(field,minLat,maxLat,minLon,BKDTreeWriter.MAX_LON_INCL);
    q.add(new BooleanClause(right,BooleanClause.Occur.SHOULD));
    return new ConstantScoreQuery(q.build());
  }
 else {
    return super.rewrite(reader);
  }
}
