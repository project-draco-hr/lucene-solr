{
  return new ConstantScoreWeight(this){
    @Override public Scorer scorer(    LeafReaderContext context) throws IOException {
      LeafReader reader=context.reader();
      SortedNumericDocValues sdv=reader.getSortedNumericDocValues(field);
      if (sdv == null) {
        return null;
      }
      if (sdv instanceof BKDTreeSortedNumericDocValues == false) {
        throw new IllegalStateException("field \"" + field + "\" was not indexed with BKDTreeDocValuesFormat: got: "+ sdv);
      }
      BKDTreeSortedNumericDocValues treeDV=(BKDTreeSortedNumericDocValues)sdv;
      BKDTreeReader tree=treeDV.getBKDTreeReader();
      DocIdSet result=tree.intersect(minLat,maxLat,minLon,maxLon,null,treeDV.delegate);
      final DocIdSetIterator disi=result.iterator();
      return new ConstantScoreScorer(this,score(),disi);
    }
  }
;
}
