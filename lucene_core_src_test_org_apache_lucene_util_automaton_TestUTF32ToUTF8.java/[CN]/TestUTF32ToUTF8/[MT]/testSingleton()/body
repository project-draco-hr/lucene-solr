{
  int iters=atLeast(100);
  for (int iter=0; iter < iters; iter++) {
    String s=TestUtil.randomRealisticUnicodeString(random());
    LightAutomaton a=BasicAutomata.makeStringLight(s);
    LightAutomaton utf8=new UTF32ToUTF8Light().convert(a);
    IntsRef ints=new IntsRef();
    Util.toIntsRef(new BytesRef(s),ints);
    Set<IntsRef> set=new HashSet<>();
    set.add(ints);
    assertEquals(set,SpecialOperations.getFiniteStrings(utf8,-1));
  }
}
