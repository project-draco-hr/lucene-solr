{
  try {
    UpdateResponse result=solr.add(batchToWrite);
    SolrRecordWriter.incrementCounter(taskId,SolrCounters.class.getName(),SolrCounters.BATCHES_WRITTEN.toString(),1);
    SolrRecordWriter.incrementCounter(taskId,SolrCounters.class.getName(),SolrCounters.DOCUMENTS_WRITTEN.toString(),batchToWrite.size());
    if (LOG.isDebugEnabled()) {
      SolrRecordWriter.incrementCounter(taskId,SolrCounters.class.getName(),SolrCounters.BATCH_WRITE_TIME.toString(),result.getElapsedTime());
    }
    return result;
  }
 catch (  Throwable e) {
    if (e instanceof Exception) {
      setBatchWriteException((Exception)e);
    }
 else {
      setBatchWriteException(new Exception(e));
    }
    SolrRecordWriter.incrementCounter(taskId,getClass().getName() + ".errors",e.getClass().getName(),1);
    LOG.error("Unable to process batch",e);
    return null;
  }
}
