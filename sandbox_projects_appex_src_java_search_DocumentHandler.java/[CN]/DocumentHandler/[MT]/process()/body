{
  String objectid=(String)metadata.get(DataSource.OBJECT_IDENTIFIER);
  if (objectid == null)   return;
  doc=createDocument();
  addMapToDoc(metadata);
  addNestedDataSource(metadata);
  doc.add(Field.Text(ALL_DOCUMENTS_FIELD,ALL_DOCUMENTS_FIELD));
  if (writer != null) {
    addToWriter();
  }
 else {
    documents.add(doc);
  }
}
