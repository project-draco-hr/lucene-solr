{
  InputStream in=new FileInputStream(file);
switch (fileType) {
case BZIP2:
    in=csFactory.createCompressorInputStream(CompressorStreamFactory.BZIP2,in);
  break;
case GZIP:
in=csFactory.createCompressorInputStream(CompressorStreamFactory.GZIP,in);
case PLAIN:
break;
default :
assertFalse("Unknown file type!",true);
}
BufferedReader br=new BufferedReader(new InputStreamReader(in,"utf-8"));
try {
String line=br.readLine();
assertHeaderLine(line);
line=br.readLine();
assertNotNull(line);
String[] parts=line.split(Character.toString(WriteLineDocTask.SEP));
int numExpParts=expBody == null ? 2 : 3;
assertEquals(numExpParts,parts.length);
assertEquals(expTitle,parts[0]);
assertEquals(expDate,parts[1]);
if (expBody != null) {
assertEquals(expBody,parts[2]);
}
assertNull(br.readLine());
}
  finally {
br.close();
}
}
