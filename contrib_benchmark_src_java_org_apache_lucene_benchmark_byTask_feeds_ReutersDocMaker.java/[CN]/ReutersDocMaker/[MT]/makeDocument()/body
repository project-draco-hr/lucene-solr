{
  File f=null;
  String name=null;
synchronized (this) {
    f=(File)txtFiles.get(nextFile++);
    name=f.getCanonicalPath() + "_" + round;
    if (nextFile >= txtFiles.size()) {
      nextFile=0;
      round++;
    }
  }
  Document doc=new Document();
  doc.add(new Field("name",name,storeVal,indexVal,termVecVal));
  BufferedReader reader=new BufferedReader(new FileReader(f));
  String line=null;
  String dateStr=reader.readLine();
  reader.readLine();
  String title=reader.readLine();
  reader.readLine();
  StringBuffer body=new StringBuffer(1024);
  while ((line=reader.readLine()) != null) {
    body.append(line).append(' ');
  }
  Date date=dateFormat.parse(dateStr.trim());
  doc.add(new Field("date",DateTools.dateToString(date,DateTools.Resolution.SECOND),Field.Store.YES,Field.Index.UN_TOKENIZED));
  if (title != null) {
    doc.add(new Field("title",title,storeVal,indexVal,termVecVal));
  }
  if (body.length() > 0) {
    doc.add(new Field("body",body.toString(),storeVal,indexVal,termVecVal));
  }
  count++;
  addBytes(f.length());
  return doc;
}
