{
  destTaxWriter.addTaxonomy(srcTaxDir,map);
  int ordinalMap[]=map.getMap();
  FacetIndexingParams params=new DefaultFacetIndexingParams();
  DirectoryReader reader=DirectoryReader.open(srcIndexDir,-1);
  List<AtomicReaderContext> leaves=reader.leaves();
  AtomicReader wrappedLeaves[]=new AtomicReader[leaves.size()];
  for (int i=0; i < leaves.size(); i++) {
    wrappedLeaves[i]=new OrdinalMappingAtomicReader(leaves.get(i).reader(),ordinalMap,params);
  }
  try {
    destIndexWriter.addIndexes(new MultiReader(wrappedLeaves));
    destTaxWriter.commit();
    destIndexWriter.commit();
  }
  finally {
    reader.close();
  }
}
