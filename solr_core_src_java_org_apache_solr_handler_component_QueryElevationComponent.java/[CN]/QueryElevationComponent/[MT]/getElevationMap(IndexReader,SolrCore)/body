{
synchronized (elevationCache) {
    Map<String,ElevationObj> map=elevationCache.get(null);
    if (map != null)     return map;
    map=elevationCache.get(reader);
    if (map == null) {
      String f=initArgs.get(CONFIG_FILE);
      if (f == null) {
        throw new SolrException(SolrException.ErrorCode.SERVER_ERROR,"QueryElevationComponent must specify argument: " + CONFIG_FILE);
      }
      log.info("Loading QueryElevation from data dir: " + f);
      Config cfg;
      ZkController zkController=core.getCoreDescriptor().getCoreContainer().getZkController();
      if (zkController != null) {
        cfg=new Config(core.getResourceLoader(),f,null,null);
      }
 else {
        InputStream is=VersionedFile.getLatestFile(core.getDataDir(),f);
        cfg=new Config(core.getResourceLoader(),f,new InputSource(is),null);
      }
      map=loadElevationMap(cfg);
      elevationCache.put(reader,map);
    }
    return map;
  }
}
