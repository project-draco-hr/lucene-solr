{
  MimeMessage mail=(MimeMessage)part;
  Address[] adresses;
  if ((adresses=mail.getFrom()) != null && adresses.length > 0)   row.put(FROM,adresses[0].toString());
  List<String> to=new ArrayList<>();
  if ((adresses=mail.getRecipients(Message.RecipientType.TO)) != null)   addAddressToList(adresses,to);
  if ((adresses=mail.getRecipients(Message.RecipientType.CC)) != null)   addAddressToList(adresses,to);
  if ((adresses=mail.getRecipients(Message.RecipientType.BCC)) != null)   addAddressToList(adresses,to);
  if (to.size() > 0)   row.put(TO_CC_BCC,to);
  row.put(MESSAGE_ID,mail.getMessageID());
  row.put(SUBJECT,mail.getSubject());
  Date d=mail.getSentDate();
  if (d != null) {
    row.put(SENT_DATE,d);
  }
  List<String> flags=new ArrayList<>();
  for (  Flags.Flag flag : mail.getFlags().getSystemFlags()) {
    if (flag == Flags.Flag.ANSWERED)     flags.add(FLAG_ANSWERED);
 else     if (flag == Flags.Flag.DELETED)     flags.add(FLAG_DELETED);
 else     if (flag == Flags.Flag.DRAFT)     flags.add(FLAG_DRAFT);
 else     if (flag == Flags.Flag.FLAGGED)     flags.add(FLAG_FLAGGED);
 else     if (flag == Flags.Flag.RECENT)     flags.add(FLAG_RECENT);
 else     if (flag == Flags.Flag.SEEN)     flags.add(FLAG_SEEN);
  }
  flags.addAll(Arrays.asList(mail.getFlags().getUserFlags()));
  if (flags.size() == 0)   flags.add(FLAG_NONE);
  row.put(FLAGS,flags);
  String[] hdrs=mail.getHeader("X-Mailer");
  if (hdrs != null)   row.put(XMAILER,hdrs[0]);
}
