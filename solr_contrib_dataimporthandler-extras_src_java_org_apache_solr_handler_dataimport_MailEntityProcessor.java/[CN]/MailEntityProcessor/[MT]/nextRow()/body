{
  Message mail=null;
  Map<String,Object> row=null;
  do {
    mail=getNextMail();
    if (mail != null)     row=getDocumentFromMail(mail);
    if (row != null && row.get("folder") == null)     row.put("folder",mail.getFolder().getFullName());
  }
 while (row == null && mail != null);
  return row;
}
