{
  if (!connected) {
    if (!connectToMailBox())     return null;
    connected=true;
  }
  if (folderIter == null) {
    createFilters();
    folderIter=new FolderIterator(mailbox);
  }
  while (msgIter == null || !msgIter.hasNext()) {
    Folder next=folderIter.hasNext() ? folderIter.next() : null;
    if (next == null)     return null;
    msgIter=new MessageIterator(next,batchSize);
  }
  return msgIter.next();
}
