{
  boolean doPersist=false;
  SolrParams params=req.getParams();
  SolrParams required=params.required();
  String cname=required.get(CoreAdminParams.CORE);
  SolrCore core=coreContainer.getCore(cname);
  if (core != null) {
    try {
      doPersist=coreContainer.isPersistent();
      String p=required.get(CoreAdminParams.INDEX_DIRS);
      String[] dirNames=p.split(",");
      DirectoryFactory dirFactory=core.getDirectoryFactory();
      Directory[] dirs=new Directory[dirNames.length];
      for (int i=0; i < dirNames.length; i++) {
        dirs[i]=dirFactory.open(dirNames[i]);
      }
      UpdateRequestProcessorChain processorChain=core.getUpdateProcessingChain(params.get(UpdateParams.UPDATE_PROCESSOR));
      UpdateRequestProcessor processor=processorChain.createProcessor(req,rsp);
      processor.processMergeIndexes(new MergeIndexesCommand(dirs));
    }
  finally {
      core.close();
    }
  }
  return doPersist;
}
