{
  mergeIndexesCommands.incrementAndGet();
  int rc=-1;
  iwCommit.lock();
  try {
    log.info("start " + cmd);
    Directory[] dirs=cmd.dirs;
    if (dirs != null && dirs.length > 0) {
      openWriter();
      writer.addIndexes(dirs);
      rc=1;
    }
 else {
      rc=0;
    }
    log.info("end_mergeIndexes");
  }
  finally {
    iwCommit.unlock();
  }
  if (rc == 1 && tracker.timeUpperBound > 0) {
    tracker.scheduleCommitWithin(tracker.timeUpperBound);
  }
  return rc;
}
