{
  Directory dir=new CountingRAMDirectory(new RAMDirectory());
  IndexWriter writer=new IndexWriter(dir,newIndexWriterConfig(TEST_VERSION_CURRENT,new PayloadAnalyzer()).setCodec(_TestUtil.alwaysPostingsFormat(new Lucene40PostingsFormat())).setMergePolicy(newLogMergePolicy()));
  Term term=new Term("test","a");
  for (int i=0; i < 5000; i++) {
    Document d1=new Document();
    d1.add(newField(term.field(),term.text(),TextField.TYPE_UNSTORED));
    writer.addDocument(d1);
  }
  writer.commit();
  writer.forceMerge(1);
  writer.close();
  AtomicReader reader=getOnlySegmentReader(DirectoryReader.open(dir));
  for (int i=0; i < 2; i++) {
    counter=0;
    DocsAndPositionsEnum tp=reader.termPositionsEnum(reader.getLiveDocs(),term.field(),new BytesRef(term.text()),false);
    checkSkipTo(tp,14,185);
    checkSkipTo(tp,17,190);
    checkSkipTo(tp,287,200);
    checkSkipTo(tp,4800,250);
  }
}
