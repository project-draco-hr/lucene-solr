{
  String reRankQueryString=localParams.get("reRankQuery");
  if (reRankQueryString == null || reRankQueryString.trim().length() == 0) {
    throw new SolrException(SolrException.ErrorCode.BAD_REQUEST,"reRankQuery parameter is mandatory");
  }
  QParser reRankParser=QParser.getParser(reRankQueryString,null,req);
  Query reRankQuery=reRankParser.parse();
  int reRankDocs=localParams.getInt("reRankDocs",200);
  reRankDocs=Math.max(1,reRankDocs);
  double reRankWeight=localParams.getDouble("reRankWeight",2.0d);
  int start=params.getInt(CommonParams.START,CommonParams.START_DEFAULT);
  int rows=params.getInt(CommonParams.ROWS,CommonParams.ROWS_DEFAULT);
  int length=start + rows;
  return new ReRankQuery(reRankQuery,reRankDocs,reRankWeight,length);
}
