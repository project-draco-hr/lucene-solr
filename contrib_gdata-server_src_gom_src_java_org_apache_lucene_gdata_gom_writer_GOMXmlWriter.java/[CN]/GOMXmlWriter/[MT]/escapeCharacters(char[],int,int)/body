{
  for (int i=0; i < length; i++) {
    final char c=chars[i + start];
    if (c < 32) {
      if ((c != '\t' && c != '\n')) {
        write("&#");
        write(Integer.toString(c));
        write(';');
        continue;
      }
    }
 else     if (c > 127 && encoder != null && !encoder.canEncode(c)) {
      write("&#");
      write(Integer.toString(c));
      write(';');
      continue;
    }
    write(c);
  }
}
