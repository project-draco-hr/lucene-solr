{
  if (overridesTokenStreamMethod) {
    return tokenStream(fieldName,reader);
  }
  Map streamMap=(Map)getPreviousTokenStream();
  if (streamMap == null) {
    streamMap=new HashMap();
    setPreviousTokenStream(streamMap);
  }
  SavedStreams streams=(SavedStreams)streamMap.get(fieldName);
  if (streams == null) {
    streams=new SavedStreams();
    streamMap.put(fieldName,streams);
    streams.wrapped=delegate.reusableTokenStream(fieldName,reader);
    HashSet stopWords=(HashSet)stopWordsPerField.get(fieldName);
    if (stopWords != null)     streams.withStopFilter=new StopFilter(false,streams.wrapped,stopWords);
 else     streams.withStopFilter=streams.wrapped;
  }
 else {
    TokenStream result=delegate.reusableTokenStream(fieldName,reader);
    if (result == streams.wrapped) {
      streams.withStopFilter.reset();
    }
 else {
      streams.wrapped=result;
      HashSet stopWords=(HashSet)stopWordsPerField.get(fieldName);
      if (stopWords != null)       streams.withStopFilter=new StopFilter(false,streams.wrapped,stopWords);
 else       streams.withStopFilter=streams.wrapped;
    }
  }
  return streams.withStopFilter;
}
