{
  String fields[]=request.getParams().getParams(HighlightParams.FIELDS);
  if (emptyArray(fields)) {
    if (emptyArray(defaultFields)) {
      String defaultSearchField=request.getSchema().getSolrQueryParser(null).getField();
      fields=null == defaultSearchField ? new String[]{} : new String[]{defaultSearchField};
    }
 else {
      fields=defaultFields;
    }
  }
 else   if (fields.length == 1) {
    fields=SolrPluginUtils.split(fields[0]);
  }
  return fields;
}
