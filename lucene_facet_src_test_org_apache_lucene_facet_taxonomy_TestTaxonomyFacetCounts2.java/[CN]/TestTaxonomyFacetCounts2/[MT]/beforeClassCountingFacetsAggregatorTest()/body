{
  indexDir=newDirectory();
  taxoDir=newDirectory();
  IndexWriterConfig conf=newIndexWriterConfig(new MockAnalyzer(random()));
  conf.setMergePolicy(NoMergePolicy.INSTANCE);
  IndexWriter indexWriter=new IndexWriter(indexDir,conf);
  TaxonomyWriter taxoWriter=new DirectoryTaxonomyWriter(taxoDir);
  allExpectedCounts=newCounts();
  termExpectedCounts=newCounts();
  indexDocsNoFacets(indexWriter);
  indexDocsWithFacetsNoTerms(indexWriter,taxoWriter,allExpectedCounts);
  indexDocsWithFacetsAndTerms(indexWriter,taxoWriter,allExpectedCounts);
  indexDocsWithFacetsAndSomeTerms(indexWriter,taxoWriter,allExpectedCounts);
  indexWriter.close();
  IOUtils.close(taxoWriter);
}
