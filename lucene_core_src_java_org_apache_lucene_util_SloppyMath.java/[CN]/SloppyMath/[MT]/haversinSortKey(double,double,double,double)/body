{
  double x1=lat1 * TO_RADIANS;
  double x2=lat2 * TO_RADIANS;
  double h1=1 - cos(x1 - x2);
  double h2=1 - cos((lon1 - lon2) * TO_RADIANS);
  return h1 + cos(x1) * cos(x2) * h2;
}
