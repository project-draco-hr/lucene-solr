{
  double h=haversinSortKey(lat1,lon1,lat2,lon2);
  return TO_KILOMETERS * 2 * asin(Math.min(1,Math.sqrt(h * 0.5)));
}
