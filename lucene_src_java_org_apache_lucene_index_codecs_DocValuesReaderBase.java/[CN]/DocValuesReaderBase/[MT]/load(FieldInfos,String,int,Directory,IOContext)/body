{
  TreeMap<String,DocValues> values=new TreeMap<String,DocValues>();
  boolean success=false;
  try {
    for (    FieldInfo fieldInfo : fieldInfos) {
      if (fieldInfo.hasDocValues()) {
        final String field=fieldInfo.name;
        final String id=DocValuesWriterBase.docValuesId(segment,fieldInfo.number);
        values.put(field,loadDocValues(docCount,dir,id,fieldInfo.getDocValuesType(),context));
      }
    }
    success=true;
  }
  finally {
    if (!success) {
      closeInternal(values.values());
    }
  }
  return values;
}
