{
  SolrQueryRequest req=req("myField","foo_s");
  try {
    assertQueryEquals("collapse",req,"{!collapse field=$myField}");
    assertQueryEquals("collapse",req,"{!collapse field=$myField max=a}");
    assertQueryEquals("collapse",req,"{!collapse field=$myField min=a}");
    assertQueryEquals("collapse",req,"{!collapse field=$myField max=a nullPolicy=expand}");
    Map context=req.getContext();
    Set boosted=new HashSet();
    boosted.add("doc1");
    boosted.add("doc2");
    context.put("BOOSTED",boosted);
    assertQueryEquals("collapse",req,"{!collapse field=$myField min=a}","{!collapse field=$myField min=a nullPolicy=ignore}");
  }
  finally {
    req.close();
  }
}
