{
  return new SolrWriter(processor,loader.getConfigDir()){
    @Override public boolean upload(    SolrInputDocument document){
      try {
        if (requestParams.debug) {
          if (debugDocuments == null)           debugDocuments=new ArrayList<SolrInputDocument>();
          debugDocuments.add(document);
        }
        if (importer.getDocBuilder().importStatistics.docCount.get() >= requestParams.rows) {
          importer.getDocBuilder().abort();
          LOG.info("Indexing stopped at docCount = " + importer.getDocBuilder().importStatistics.docCount);
        }
        return super.upload(document);
      }
 catch (      RuntimeException e) {
        LOG.error("Exception while adding: " + document,e);
        return false;
      }
    }
  }
;
}
