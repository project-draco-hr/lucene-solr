{
  if (prefix.length() < 3) {
    throw new IllegalArgumentException("prefix must be at least 3 characters");
  }
  String newSuffix=suffix == null ? ".tmp" : suffix;
  final Random random=new Random(RandomizedContext.current().getRandom().nextLong());
  File result;
  do {
    result=genTempFile(random,prefix,newSuffix,directory);
  }
 while (!result.createNewFile());
  return result;
}
