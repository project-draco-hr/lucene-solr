{
  MergePolicy mp=w.getConfig().getMergePolicy();
  if (mp instanceof LogMergePolicy) {
    LogMergePolicy lmp=(LogMergePolicy)mp;
    lmp.setMergeFactor(Math.min(5,lmp.getMergeFactor()));
    lmp.setUseCompoundFile(true);
  }
 else   if (mp instanceof TieredMergePolicy) {
    TieredMergePolicy tmp=(TieredMergePolicy)mp;
    tmp.setMaxMergeAtOnce(Math.min(5,tmp.getMaxMergeAtOnce()));
    tmp.setSegmentsPerTier(Math.min(5,tmp.getSegmentsPerTier()));
    tmp.setUseCompoundFile(true);
  }
  MergeScheduler ms=w.getConfig().getMergeScheduler();
  if (ms instanceof ConcurrentMergeScheduler) {
    ((ConcurrentMergeScheduler)ms).setMaxThreadCount(2);
    ((ConcurrentMergeScheduler)ms).setMaxMergeCount(3);
  }
}
