{
  LinkedHashSet<String> allFiles=new LinkedHashSet<String>();
  for (int i=0; i < fileNames.length; i++) {
    int k;
    if ((k=fileNames[i].indexOf("*")) < 0) {
      allFiles.add(fileNames[i]);
    }
 else {
      String prefix=fileNames[i].substring(0,k);
      if (prefix.length() == 0)       prefix=".";
      final String suffix=fileNames[i].substring(k + 1);
      File[] files=new File(prefix).listFiles(new FilenameFilter(){
        public boolean accept(        File dir,        String name){
          return name.endsWith(suffix);
        }
      }
);
      if (files != null) {
        for (int j=0; j < files.length; j++) {
          allFiles.add(files[j].getPath());
        }
      }
    }
  }
  String[] result=new String[allFiles.size()];
  allFiles.toArray(result);
  return result;
}
