{
  Searcher searcher=null;
  try {
    if (index instanceof Directory)     searcher=new IndexSearcher((Directory)index);
 else     searcher=((MemoryIndex)index).createSearcher();
    final float[] scores=new float[1];
    searcher.search(query,new HitCollector(){
      public void collect(      int doc,      float score){
        scores[0]=score;
      }
    }
);
    float score=scores[0];
    return score;
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
 finally {
    try {
      if (searcher != null)       searcher.close();
    }
 catch (    IOException e) {
      throw new RuntimeException(e);
    }
  }
}
