{
  if (dataOut == null) {
    IndexOutput dataOutput=null;
    boolean success=false;
    try {
      dataOutput=directory.createOutput(dataFileName,IOContext.DEFAULT);
      dataOutput.writeVInt(FORMAT_CURRENT);
      dataOut=dataOutput;
      success=true;
    }
  finally {
      if (!success) {
        IOUtils.closeWhileHandlingException(dataOutput);
      }
    }
  }
  return dataOut;
}
