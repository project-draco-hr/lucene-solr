{
  if (dataOut == null) {
    boolean success=false;
    try {
      dataOut=directory.createOutput(dataFileName,context);
      dataOut.writeVInt(FORMAT_CURRENT);
      success=true;
    }
  finally {
      if (!success) {
        IOUtils.closeSafely(true,dataOut);
      }
    }
  }
}
