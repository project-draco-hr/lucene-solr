{
  if (this.key == null)   throw new IllegalArgumentException("Auth key must not be null");
  if (this.key.length() < 5 || this.key.length() > 16)   throw new IllegalArgumentException("Auth key length must be greater than 4 and less than 17");
  try {
    Provider sunJce=new com.sun.crypto.provider.SunJCE();
    Security.addProvider(sunJce);
    KeyGenerator kgen=KeyGenerator.getInstance(ALG);
    kgen.init(448);
    byte[] raw=this.key.getBytes();
    SecretKeySpec skeySpec=new SecretKeySpec(raw,ALG);
    this.deCrypt=Cipher.getInstance(ALG);
    this.enCrypt=Cipher.getInstance(ALG);
    this.deCrypt.init(Cipher.DECRYPT_MODE,skeySpec);
    this.enCrypt.init(Cipher.ENCRYPT_MODE,skeySpec);
  }
 catch (  Exception e) {
    throw new AuthenticatorException("Can't initialize BlowfishAuthenticationController -- " + e.getMessage(),e);
  }
  calculateTimeOffset();
}
