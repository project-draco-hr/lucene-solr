{
  for (int i=0; i < 50; ++i) {
    assertU(adoc("id","" + i,"floatdv","1","intdv","2","doubledv","3","longdv","4","datedv","1995-12-31T23:59:59.999Z"));
  }
  for (int i=0; i < 50; ++i) {
    if (rarely()) {
      assertU(commit());
    }
    assertU(adoc("id","1000" + i,"floatdv","" + i,"intdv","" + i,"doubledv","" + i,"longdv","" + i,"datedv",(1900 + i) + "-12-31T23:59:59.999Z","stringdv","abc" + i));
  }
  assertU(commit());
  assertQ(req("q","*:*","facet","true","rows","0","facet.field","longdv","facet.sort","count","facet.limit","1"),"//lst[@name='longdv']/int[@name='4'][.='51']");
  assertQ(req("q","*:*","facet","true","rows","0","facet.field","longdv","facet.sort","count","facet.offset","1","facet.limit","1"),"//lst[@name='longdv']/int[@name='0'][.='1']");
  assertQ(req("q","*:*","facet","true","rows","0","facet.field","longdv","facet.sort","index","facet.offset","33","facet.limit","1","facet.mincount","1"),"//lst[@name='longdv']/int[@name='33'][.='1']");
  assertQ(req("q","*:*","facet","true","rows","0","facet.field","floatdv","facet.sort","count","facet.limit","1"),"//lst[@name='floatdv']/int[@name='1.0'][.='51']");
  assertQ(req("q","*:*","facet","true","rows","0","facet.field","floatdv","facet.sort","count","facet.offset","1","facet.limit","-1","facet.mincount","1"),"//lst[@name='floatdv']/int[@name='0.0'][.='1']");
  assertQ(req("q","*:*","facet","true","rows","0","facet.field","floatdv","facet.sort","index","facet.offset","33","facet.limit","1","facet.mincount","1"),"//lst[@name='floatdv']/int[@name='33.0'][.='1']");
  assertQ(req("q","*:*","facet","true","rows","0","facet.field","doubledv","facet.sort","count","facet.limit","1"),"//lst[@name='doubledv']/int[@name='3.0'][.='51']");
  assertQ(req("q","*:*","facet","true","rows","0","facet.field","doubledv","facet.sort","count","facet.offset","1","facet.limit","-1","facet.mincount","1"),"//lst[@name='doubledv']/int[@name='0.0'][.='1']");
  assertQ(req("q","*:*","facet","true","rows","0","facet.field","doubledv","facet.sort","index","facet.offset","33","facet.limit","1","facet.mincount","1"),"//lst[@name='doubledv']/int[@name='33.0'][.='1']");
  assertQ(req("q","*:*","facet","true","rows","0","facet.field","intdv","facet.sort","count","facet.limit","1"),"//lst[@name='intdv']/int[@name='2'][.='51']");
  assertQ(req("q","*:*","facet","true","rows","0","facet.field","intdv","facet.sort","count","facet.offset","1","facet.limit","-1","facet.mincount","1"),"//lst[@name='intdv']/int[@name='0'][.='1']");
  assertQ(req("q","*:*","facet","true","rows","0","facet.field","intdv","facet.sort","index","facet.offset","33","facet.limit","1","facet.mincount","1"),"//lst[@name='intdv']/int[@name='33'][.='1']");
  assertQ(req("q","*:*","facet","true","rows","0","facet.field","datedv","facet.sort","count","facet.limit","1"),"//lst[@name='datedv']/int[@name='1995-12-31T23:59:59.999Z'][.='50']");
  assertQ(req("q","*:*","facet","true","rows","0","facet.field","datedv","facet.sort","count","facet.offset","1","facet.limit","-1","facet.mincount","1"),"//lst[@name='datedv']/int[@name='1900-12-31T23:59:59.999Z'][.='1']");
  assertQ(req("q","*:*","facet","true","rows","0","facet.field","datedv","facet.sort","index","facet.offset","33","facet.limit","1","facet.mincount","1"),"//lst[@name='datedv']/int[@name='1933-12-31T23:59:59.999Z'][.='1']");
}
