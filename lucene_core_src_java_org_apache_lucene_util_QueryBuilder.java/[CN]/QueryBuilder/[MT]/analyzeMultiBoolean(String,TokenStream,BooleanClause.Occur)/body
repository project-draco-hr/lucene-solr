{
  BooleanQuery.Builder q=newBooleanQuery(false);
  BooleanQuery.Builder currentQuery=newBooleanQuery(true);
  TermToBytesRefAttribute termAtt=stream.getAttribute(TermToBytesRefAttribute.class);
  PositionIncrementAttribute posIncrAtt=stream.getAttribute(PositionIncrementAttribute.class);
  stream.reset();
  while (stream.incrementToken()) {
    if (posIncrAtt.getPositionIncrement() != 0) {
      add(q,currentQuery.build(),operator);
      currentQuery=newBooleanQuery(true);
    }
    currentQuery.add(newTermQuery(new Term(field,BytesRef.deepCopyOf(termAtt.getBytesRef()))),BooleanClause.Occur.SHOULD);
  }
  add(q,currentQuery.build(),operator);
  return q.build();
}
