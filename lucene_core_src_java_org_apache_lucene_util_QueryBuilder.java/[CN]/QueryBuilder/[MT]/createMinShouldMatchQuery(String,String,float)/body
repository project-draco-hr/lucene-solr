{
  if (Float.isNaN(fraction) || fraction < 0 || fraction > 1) {
    throw new IllegalArgumentException("fraction should be >= 0 and <= 1");
  }
  if (fraction == 1) {
    return createBooleanQuery(field,queryText,BooleanClause.Occur.MUST);
  }
  Query query=createFieldQuery(analyzer,BooleanClause.Occur.SHOULD,field,queryText,false,0);
  if (query instanceof BooleanQuery) {
    BooleanQuery bq=(BooleanQuery)query;
    bq.setMinimumNumberShouldMatch((int)(fraction * bq.clauses().size()));
  }
  return query;
}
