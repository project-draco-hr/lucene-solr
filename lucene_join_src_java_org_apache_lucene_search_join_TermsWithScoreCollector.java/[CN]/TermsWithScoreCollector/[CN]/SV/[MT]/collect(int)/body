{
  int ord=collectedTerms.add(fromDocTerms.getTerm(doc,spare));
  if (ord < 0) {
    ord=-ord - 1;
  }
 else {
    if (ord >= scoreSums.length) {
      scoreSums=ArrayUtil.grow(scoreSums);
    }
  }
  float current=scorer.score();
  float existing=scoreSums[ord];
  if (Float.compare(existing,0.0f) == 0) {
    scoreSums[ord]=current;
  }
 else {
switch (scoreMode) {
case Total:
      scoreSums[ord]=scoreSums[ord] + current;
    break;
case Max:
  if (current > existing) {
    scoreSums[ord]=current;
  }
}
}
}
