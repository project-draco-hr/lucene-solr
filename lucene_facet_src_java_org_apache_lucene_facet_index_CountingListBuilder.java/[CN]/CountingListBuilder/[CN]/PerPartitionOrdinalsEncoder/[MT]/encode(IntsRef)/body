{
  final HashMap<String,IntsRef> partitionOrdinals=new HashMap<String,IntsRef>();
  for (int i=0; i < ordinals.length; i++) {
    int ordinal=ordinals.ints[i];
    final String name=PartitionsUtils.partitionNameByOrdinal(indexingParams,ordinal);
    IntsRef partitionOrds=partitionOrdinals.get(name);
    if (partitionOrds == null) {
      partitionOrds=new IntsRef(32);
      partitionOrdinals.put(name,partitionOrds);
      partitionEncoder.put(name,categoryListParams.createEncoder());
    }
    partitionOrds.ints[partitionOrds.length++]=ordinal % partitionSize;
  }
  HashMap<String,BytesRef> partitionBytes=new HashMap<String,BytesRef>();
  for (  Entry<String,IntsRef> e : partitionOrdinals.entrySet()) {
    String name=e.getKey();
    final IntEncoder encoder=partitionEncoder.get(name);
    final BytesRef bytes=new BytesRef(128);
    encoder.encode(e.getValue(),bytes);
    partitionBytes.put(name,bytes);
  }
  return partitionBytes;
}
