{
  String[] listAll=directory.listAll();
  directory.deleteFiles(Arrays.asList(listAll));
  IndexOutput output=directory.createOutput("testing.test",new IOContext());
  output.writeInt(12345);
  output.close();
  directory.renameFile("testing.test","testing.test.renamed");
  assertFalse(slowFileExists(directory,"testing.test"));
  assertTrue(slowFileExists(directory,"testing.test.renamed"));
  IndexInput input=directory.openInput("testing.test.renamed",new IOContext());
  assertEquals(12345,input.readInt());
  assertEquals(input.getFilePointer(),input.length());
  input.close();
  directory.deleteFiles(Collections.singleton("testing.test.renamed"));
  assertFalse(slowFileExists(directory,"testing.test.renamed"));
}
