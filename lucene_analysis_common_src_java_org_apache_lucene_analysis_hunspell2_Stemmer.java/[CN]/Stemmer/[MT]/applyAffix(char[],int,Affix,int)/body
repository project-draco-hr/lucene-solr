{
  segment.setLength(0);
  segment.append(strippedWord,0,length);
  if (!affix.checkCondition(segment)) {
    return Collections.emptyList();
  }
  List<CharsRef> stems=new ArrayList<CharsRef>();
  char wordFlags[]=dictionary.lookupWord(strippedWord,0,length,scratch);
  if (wordFlags != null && Dictionary.hasFlag(wordFlags,affix.getFlag())) {
    stems.add(new CharsRef(strippedWord,0,length));
  }
  if (affix.isCrossProduct() && recursionDepth < recursionCap) {
    stems.addAll(stem(strippedWord,length,affix.getAppendFlags(),++recursionDepth));
  }
  return stems;
}
