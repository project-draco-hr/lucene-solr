{
  this.query=Objects.requireNonNull(query);
  MultiTermQuery.RewriteMethod method=query.getRewriteMethod();
  if (method instanceof TopTermsRewrite) {
    final int pqsize=((TopTermsRewrite)method).getSize();
    setRewriteMethod(new TopTermsSpanBooleanQueryRewrite(pqsize));
  }
 else {
    setRewriteMethod(SCORING_SPAN_QUERY_REWRITE);
  }
}
