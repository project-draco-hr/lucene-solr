{
  int blockPos=(int)(position & BLOCK_MASK);
  int offset=0;
  while (blockPos + len >= BLOCK_LEN) {
    int blockLen=BLOCK_LEN - blockPos;
    System.arraycopy(b,offset,block.getData(),blockPos,blockLen);
    block.put(blocks,txn);
    len-=blockLen;
    offset+=blockLen;
    position+=blockLen;
    block.seek(position);
    block.get(blocks,txn);
    blockPos=0;
  }
  if (len > 0) {
    System.arraycopy(b,offset,block.getData(),blockPos,len);
    position+=len;
  }
  if (position > length)   length=position;
}
