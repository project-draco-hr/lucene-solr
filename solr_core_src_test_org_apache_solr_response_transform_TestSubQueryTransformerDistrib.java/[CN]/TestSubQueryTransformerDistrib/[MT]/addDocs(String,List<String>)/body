{
  StringBuilder upd=new StringBuilder("<update>");
  for (Iterator<String> iterator=docs.iterator(); iterator.hasNext(); ) {
    String add=iterator.next();
    upd.append(add);
    if (rarely()) {
      upd.append(commit("softCommit","true"));
    }
    if (!rarely() || !iterator.hasNext()) {
      if (!iterator.hasNext()) {
        upd.append(commit("softCommit","false"));
      }
      upd.append("</update>");
      ContentStreamUpdateRequest req=new ContentStreamUpdateRequest("/update");
      req.addContentStream(new ContentStreamBase.StringStream(upd.toString(),"text/xml"));
      cloudClient.request(req,collection);
      upd.setLength("<update>".length());
    }
  }
}
