{
  if (!isMutable) {
    String msg="This ManagedIndexSchema is not mutable.";
    log.error(msg);
    throw new SolrException(ErrorCode.SERVER_ERROR,msg);
  }
  if (getFieldTypeByName(typeName) != null) {
    String msg="Field type '" + typeName + "' already exists.";
    log.error(msg);
    throw new SolrException(ErrorCode.BAD_REQUEST,msg);
  }
  Map<String,FieldType> newFieldTypes=new HashMap<String,FieldType>();
  List<SchemaAware> schemaAwareList=new ArrayList<SchemaAware>();
  FieldTypePluginLoader typeLoader=new FieldTypePluginLoader(this,newFieldTypes,schemaAwareList);
  typeLoader.loadSingle(loader,FieldTypeXmlAdapter.toNode(options));
  FieldType ft=newFieldTypes.get(typeName);
  if (!schemaAwareList.isEmpty())   schemaAware.addAll(schemaAwareList);
  return ft;
}
