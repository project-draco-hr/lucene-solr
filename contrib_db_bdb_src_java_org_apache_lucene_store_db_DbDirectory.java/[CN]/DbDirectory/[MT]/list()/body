{
  Dbc cursor=null;
  List list=new ArrayList();
  try {
    try {
      DatabaseEntry key=new DatabaseEntry(new byte[0]);
      DatabaseEntry data=new DatabaseEntry((byte[])null);
      data.setPartial(true);
      cursor=files.cursor(txn,flags);
      if (cursor.get(key,data,DbConstants.DB_SET_RANGE | flags) != DbConstants.DB_NOTFOUND) {
        ByteArrayInputStream buffer=new ByteArrayInputStream(key.getData());
        DataInputStream in=new DataInputStream(buffer);
        String name=in.readUTF();
        in.close();
        list.add(name);
        while (cursor.get(key,data,DbConstants.DB_NEXT | flags) != DbConstants.DB_NOTFOUND) {
          buffer=new ByteArrayInputStream(key.getData());
          in=new DataInputStream(buffer);
          name=in.readUTF();
          in.close();
          list.add(name);
        }
      }
    }
  finally {
      if (cursor != null)       cursor.close();
    }
  }
 catch (  DatabaseException e) {
    throw new IOException(e.getMessage());
  }
  return (String[])list.toArray(new String[list.size()]);
}
