{
  if (commit != null) {
    return doOpenFromCommit(commit);
  }
  if (writer.nrtIsCurrent(segmentInfos)) {
    return null;
  }
  DirectoryReader reader=writer.getReader(applyAllDeletes,writeAllDeletes);
  if (reader.getVersion() == segmentInfos.getVersion()) {
    reader.decRef();
    return null;
  }
  return reader;
}
