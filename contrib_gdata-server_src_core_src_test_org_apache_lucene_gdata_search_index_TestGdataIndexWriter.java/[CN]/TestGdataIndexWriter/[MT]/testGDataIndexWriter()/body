{
  try {
    new GDataIndexWriter(new RAMDirectory(),true,null);
    fail("no index schema");
  }
 catch (  IllegalArgumentException e) {
  }
  GDataIndexWriter writer=new GDataIndexWriter(new RAMDirectory(),true,this.schemaNoPerFielAnalyzer);
  assertTrue(writer.getAnalyzer().getClass() == StandardAnalyzer.class);
  writer=new GDataIndexWriter(new RAMDirectory(),true,this.schemaPerFielAnalyzer);
  assertTrue(writer.getAnalyzer().getClass() == PerFieldAnalyzerWrapper.class);
  assertEquals(VALUE_GT_DEFAULT_LONG,writer.getWriteLockTimeout());
  assertEquals(VALUE_GT_DEFAULT_INT,writer.getMaxBufferedDocs());
  if (writer.getMergePolicy() instanceof LogDocMergePolicy)   assertEquals(VALUE_GT_DEFAULT_INT,writer.getMaxMergeDocs());
  assertEquals(VALUE_GT_DEFAULT_INT,writer.getMaxFieldLength());
  assertEquals(VALUE_GT_DEFAULT_INT,writer.getMergeFactor());
  assertTrue(writer.getUseCompoundFile());
}
