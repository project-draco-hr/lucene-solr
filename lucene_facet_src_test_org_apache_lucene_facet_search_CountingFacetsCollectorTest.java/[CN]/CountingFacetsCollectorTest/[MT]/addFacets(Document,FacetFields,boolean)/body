{
  List<CategoryPath> docCategories=randomCategories(random());
  for (  CategoryPath cp : docCategories) {
    if (cp.components[0].equals(CP_D.components[0])) {
      cp=cp.subpath(2);
    }
    allExpectedCounts.put(cp,allExpectedCounts.get(cp) + 1);
    if (updateTermExpectedCounts) {
      termExpectedCounts.put(cp,termExpectedCounts.get(cp) + 1);
    }
  }
  allExpectedCounts.put(CP_A,allExpectedCounts.get(CP_A) + 1);
  allExpectedCounts.put(CP_B,allExpectedCounts.get(CP_B) + 1);
  allExpectedCounts.put(CP_C,allExpectedCounts.get(CP_C) + 1);
  allExpectedCounts.put(CP_D,allExpectedCounts.get(CP_D) + 1);
  if (updateTermExpectedCounts) {
    termExpectedCounts.put(CP_A,termExpectedCounts.get(CP_A) + 1);
    termExpectedCounts.put(CP_B,termExpectedCounts.get(CP_B) + 1);
    termExpectedCounts.put(CP_C,termExpectedCounts.get(CP_C) + 1);
    termExpectedCounts.put(CP_D,termExpectedCounts.get(CP_D) + 1);
  }
  facetFields.addFields(doc,docCategories);
}
