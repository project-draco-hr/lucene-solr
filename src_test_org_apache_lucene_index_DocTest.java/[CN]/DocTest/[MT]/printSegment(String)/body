{
  Directory directory=FSDirectory.getDirectory("test",false);
  SegmentReader reader=new SegmentReader(new SegmentInfo(segment,1,directory));
  for (int i=0; i < reader.numDocs(); i++)   System.out.println(reader.document(i));
  TermEnum tis=reader.terms();
  while (tis.next()) {
    System.out.print(tis.term());
    System.out.println(" DF=" + tis.docFreq());
    TermPositions positions=reader.termPositions(tis.term());
    try {
      while (positions.next()) {
        System.out.print(" doc=" + positions.doc());
        System.out.print(" TF=" + positions.freq());
        System.out.print(" pos=");
        System.out.print(positions.nextPosition());
        for (int j=1; j < positions.freq(); j++)         System.out.print("," + positions.nextPosition());
        System.out.println("");
      }
    }
  finally {
      positions.close();
    }
  }
  tis.close();
  reader.close();
  directory.close();
}
