{
  for (int i=0; i < 100000; i++) {
    double centerLat=-90 + 180.0 * random().nextDouble();
    double centerLon=-180 + 360.0 * random().nextDouble();
    double lat1=-90 + 180.0 * random().nextDouble();
    double lon1=-180 + 360.0 * random().nextDouble();
    double lat2=-90 + 180.0 * random().nextDouble();
    double lon2=-180 + 360.0 * random().nextDouble();
    int expected=Integer.signum(Double.compare(haversinMeters(centerLat,centerLon,lat1,lon1),haversinMeters(centerLat,centerLon,lat2,lon2)));
    int actual=Integer.signum(Double.compare(haversinSortKey(centerLat,centerLon,lat1,lon1),haversinSortKey(centerLat,centerLon,lat2,lon2)));
    assertEquals(expected,actual);
    assertEquals(haversinMeters(centerLat,centerLon,lat1,lon1),haversinMeters(haversinSortKey(centerLat,centerLon,lat1,lon1)),0.0D);
    assertEquals(haversinMeters(centerLat,centerLon,lat2,lon2),haversinMeters(haversinSortKey(centerLat,centerLon,lat2,lon2)),0.0D);
  }
}
