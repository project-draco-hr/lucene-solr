{
  HashSet<String> stopWords=new HashSet<String>();
  final Terms terms=MultiFields.getTerms(reader,fieldName);
  final CharsRef spare=new CharsRef();
  if (terms != null) {
    final TermsEnum te=terms.iterator();
    BytesRef text;
    while ((text=te.next()) != null) {
      if (te.docFreq() > maxDocFreq) {
        stopWords.add(text.utf8ToChars(spare).toString());
      }
    }
  }
  stopWordsPerField.put(fieldName,stopWords);
  @SuppressWarnings("unchecked") Map<String,SavedStreams> streamMap=(Map<String,SavedStreams>)getPreviousTokenStream();
  if (streamMap != null)   streamMap.remove(fieldName);
  return stopWords.size();
}
