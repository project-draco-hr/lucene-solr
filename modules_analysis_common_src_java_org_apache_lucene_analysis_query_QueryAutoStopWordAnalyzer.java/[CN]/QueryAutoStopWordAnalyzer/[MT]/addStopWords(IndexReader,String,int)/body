{
  HashSet<String> stopWords=new HashSet<String>();
  Terms terms=MultiFields.getTerms(reader,fieldName);
  if (terms != null) {
    TermsEnum te=terms.iterator();
    BytesRef text;
    while ((text=te.next()) != null) {
      if (te.docFreq() > maxDocFreq) {
        stopWords.add(text.utf8ToString());
      }
    }
  }
  stopWordsPerField.put(fieldName,stopWords);
  Map<String,SavedStreams> streamMap=(Map<String,SavedStreams>)getPreviousTokenStream();
  if (streamMap != null)   streamMap.remove(fieldName);
  return stopWords.size();
}
