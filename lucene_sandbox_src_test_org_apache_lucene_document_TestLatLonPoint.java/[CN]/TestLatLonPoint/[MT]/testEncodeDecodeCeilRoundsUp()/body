{
  int iters=atLeast(10000);
  for (int iter=0; iter < iters; iter++) {
    final double latBase=GeoTestUtil.nextLatitude();
    final double lonBase=GeoTestUtil.nextLongitude();
    double lat=latBase;
    double lon=lonBase;
    for (int i=0; i < 1000; i++) {
      lat=Math.min(90,Math.nextUp(lat));
      lon=Math.min(180,Math.nextUp(lon));
      double latEnc=LatLonPoint.decodeLatitude(LatLonPoint.encodeLatitudeCeil(lat));
      double lonEnc=LatLonPoint.decodeLongitude(LatLonPoint.encodeLongitudeCeil(lon));
      assertTrue(latEnc >= lat);
      assertTrue(lonEnc >= lon);
    }
    lat=latBase;
    lon=lonBase;
    for (int i=0; i < 1000; i++) {
      lat=Math.max(-90,Math.nextDown(lat));
      lon=Math.max(-180,Math.nextDown(lon));
      double latEnc=LatLonPoint.decodeLatitude(LatLonPoint.encodeLatitudeCeil(lat));
      double lonEnc=LatLonPoint.decodeLongitude(LatLonPoint.encodeLongitudeCeil(lon));
      assertTrue(latEnc >= lat);
      assertTrue(lonEnc >= lon);
    }
  }
}
