{
  if (dataConfig == null)   throw new DataImportHandlerException(DataImportHandlerException.SEVERE,"Configuration not found");
  this.core=core;
  this.schema=core.getSchema();
  dataSourceProps=ds;
  loadDataConfig(dataConfig);
  for (  DataConfig.Document document : config.documents) {
    for (    DataConfig.Entity e : document.entities) {
      Map<String,DataConfig.Field> fields=new HashMap<String,DataConfig.Field>();
      initEntity(e,fields,false);
      e.implicitFields=new ArrayList<DataConfig.Field>();
      String errs=verifyWithSchema(e,fields);
      if (e.implicitFields.isEmpty())       e.implicitFields=null;
      if (errs != null) {
        throw new DataImportHandlerException(DataImportHandlerException.SEVERE,errs);
      }
    }
  }
}
