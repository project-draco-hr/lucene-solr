{
  if (dataConfig == null)   throw new DataImportHandlerException(DataImportHandlerException.SEVERE,"Configuration not found");
  this.core=core;
  this.schema=core.getSchema();
  dataSourceProps=ds;
  loadDataConfig(dataConfig);
  for (  Map.Entry<String,SchemaField> entry : schema.getFields().entrySet()) {
    config.lowerNameVsSchemaField.put(entry.getKey().toLowerCase(),entry.getValue());
  }
  for (  DataConfig.Document document : config.documents) {
    for (    DataConfig.Entity e : document.entities) {
      Map<String,DataConfig.Field> fields=new HashMap<String,DataConfig.Field>();
      initEntity(e,fields,false);
      String errs=verifyWithSchema(fields);
      if (errs != null) {
        throw new DataImportHandlerException(DataImportHandlerException.SEVERE,errs);
      }
    }
  }
}
