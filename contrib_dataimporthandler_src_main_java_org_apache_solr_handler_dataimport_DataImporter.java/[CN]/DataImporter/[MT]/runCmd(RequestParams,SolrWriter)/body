{
  String command=reqParams.command;
  if (command.equals(ABORT_CMD)) {
    if (docBuilder != null) {
      docBuilder.abort();
    }
    return;
  }
  if (!importLock.tryLock()) {
    LOG.warn("Import command failed . another import is running");
    return;
  }
  try {
    Date lastModified=sw.loadIndexStartTime();
    setLastIndexTime(lastModified);
    if (FULL_IMPORT_CMD.equals(command) || IMPORT_CMD.equals(command)) {
      doFullImport(sw,reqParams);
    }
 else     if (command.equals(DELTA_IMPORT_CMD)) {
      doDeltaImport(sw,reqParams);
    }
  }
  finally {
    importLock.unlock();
  }
}
