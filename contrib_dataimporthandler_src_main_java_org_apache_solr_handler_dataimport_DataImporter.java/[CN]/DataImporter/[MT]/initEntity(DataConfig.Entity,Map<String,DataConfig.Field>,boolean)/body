{
  if (e.pk != null)   e.primaryKeys=e.pk.split(",");
  e.allAttributes.put(DATA_SRC,e.dataSource);
  if (!docRootFound && !"false".equals(e.docRoot)) {
    e.isDocRoot=true;
  }
  if (e.fields != null) {
    for (    DataConfig.Field f : e.fields) {
      f.nameOrColName=f.getName();
      SchemaField schemaField=schema.getFields().get(f.getName());
      if (schemaField != null) {
        f.multiValued=schemaField.multiValued();
        f.allAttributes.put(MULTI_VALUED,Boolean.toString(schemaField.multiValued()));
        f.allAttributes.put(TYPE,schemaField.getType().getTypeName());
        f.allAttributes.put("indexed",Boolean.toString(schemaField.indexed()));
        f.allAttributes.put("stored",Boolean.toString(schemaField.stored()));
        f.allAttributes.put("defaultValue",schemaField.getDefaultValue());
      }
 else {
        try {
          f.allAttributes.put(TYPE,schema.getDynamicFieldType(f.getName()).getTypeName());
          f.allAttributes.put(MULTI_VALUED,"true");
          f.multiValued=true;
        }
 catch (        RuntimeException e2) {
          LOG.info("Field in data-config.xml - " + f.getName() + " not found in schema.xml");
          f.toWrite=false;
        }
      }
      fields.put(f.getName(),f);
      f.entity=e;
      f.allAttributes.put("boost",f.boost.toString());
      f.allAttributes.put("toWrite",Boolean.toString(f.toWrite));
      e.allFieldsList.add(Collections.unmodifiableMap(f.allAttributes));
    }
  }
  e.allFieldsList=Collections.unmodifiableList(e.allFieldsList);
  e.allAttributes=Collections.unmodifiableMap(e.allAttributes);
  addDataSource(e);
  if (e.entities == null)   return;
  for (  DataConfig.Entity e1 : e.entities) {
    e1.parentEntity=e;
    initEntity(e1,fields,e.isDocRoot || docRootFound);
  }
}
