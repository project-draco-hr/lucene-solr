{
  ensureOpen();
  Set<String> toSync=new HashSet<>(names);
  toSync.retainAll(staleFiles);
  for (  String name : toSync)   fsync(name);
  IOUtils.fsync(directory,true);
  staleFiles.removeAll(toSync);
}
