{
  super.setLockFactory(lockFactory);
  if (lockFactory instanceof FSLockFactory) {
    final FSLockFactory lf=(FSLockFactory)lockFactory;
    final Path dir=lf.getLockDir();
    if (dir == null) {
      lf.setLockDir(directory);
      lf.setLockPrefix(null);
    }
 else     if (dir.toRealPath().equals(directory)) {
      lf.setLockPrefix(null);
    }
  }
}
