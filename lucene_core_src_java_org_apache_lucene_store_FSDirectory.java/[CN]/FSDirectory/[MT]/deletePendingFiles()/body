{
  List<String> toDelete=new ArrayList<>(pendingDeletes);
  for (  String fileName : toDelete) {
    if (fileName.startsWith(IndexFileNames.SEGMENTS)) {
      if (deleteFile(fileName) == false) {
        return;
      }
    }
  }
  for (  String fileName : toDelete) {
    if (fileName.startsWith(IndexFileNames.SEGMENTS) == false) {
      deleteFile(fileName);
    }
  }
}
