{
  ensureOpen();
  if (pendingDeletes.contains(source)) {
    throw new NoSuchFileException("file \"" + source + "\" is pending delete and cannot be moved");
  }
  pendingDeletes.remove(dest);
  Files.move(directory.resolve(source),directory.resolve(dest),StandardCopyOption.ATOMIC_MOVE);
  IOUtils.fsync(directory,true);
  maybeDeletePendingFiles();
}
