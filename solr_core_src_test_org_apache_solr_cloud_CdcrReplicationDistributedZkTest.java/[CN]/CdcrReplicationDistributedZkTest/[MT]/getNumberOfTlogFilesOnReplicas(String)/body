{
  CollectionInfo info=collectInfo(collection);
  Map<String,List<CollectionInfo.CoreInfo>> shardToCoresMap=info.getShardToCoresMap();
  int count=0;
  for (  String shard : shardToCoresMap.keySet()) {
    for (int i=0; i < replicationFactor - 1; i++) {
      count+=numberOfFiles(info.getReplicas(shard).get(i).ulogDir);
    }
  }
  return count;
}
