{
  final SolrParams docWithDeprefixed=SolrParams.wrapDefaults(new DocRowParams(doc,prefix,separator),baseSubParams);
  try {
    Callable<QueryResponse> subQuery=new Callable<QueryResponse>(){
      @Override public QueryResponse call() throws Exception {
        try {
          return new QueryResponse(server.request(new QueryRequest(docWithDeprefixed),coreName),server);
        }
  finally {
        }
      }
    }
;
    QueryResponse response=SolrRequestInfoSuspender.doInSuspension(subQuery);
    final SolrDocumentList docList=(SolrDocumentList)response.getResults();
    doc.setField(getName(),new Result(docList));
  }
 catch (  Exception e) {
    String docString=doc.toString();
    throw new SolrException(ErrorCode.BAD_REQUEST,"while invoking " + name + ":[subquery"+ (coreName != null ? "fromIndex=" + coreName : "")+ "] on doc="+ docString.substring(0,Math.min(100,docString.length())),e.getCause());
  }
 finally {
  }
}
