{
  final SortedNumericDocValues oldDocValues=in.getSortedNumericDocValues(field);
  if (oldDocValues == null) {
    return null;
  }
  long[][] values;
synchronized (cachedSortedNumericDVs) {
    values=cachedSortedNumericDVs.get(field);
    if (values == null) {
      values=new long[maxDoc()][];
      int docID;
      while ((docID=oldDocValues.nextDoc()) != NO_MORE_DOCS) {
        int newDocID=docMap.oldToNew(docID);
        long[] docValues=new long[oldDocValues.docValueCount()];
        for (int i=0; i < docValues.length; i++) {
          docValues[i]=oldDocValues.nextValue();
        }
        values[newDocID]=docValues;
      }
      cachedSortedNumericDVs.put(field,values);
    }
  }
  return new SortingSortedNumericDocValues(oldDocValues,values);
}
