{
  boolean hasOffsets=fieldInfo.getIndexOptions().compareTo(IndexOptions.DOCS_AND_FREQS_AND_POSITIONS_AND_OFFSETS) >= 0;
  if (needsOffsets && !hasOffsets) {
    return null;
  }
  if (fieldInfo.hasPayloads() || hasOffsets) {
    SegmentFullPositionsEnum docsEnum;
    if (reuse == null || !(reuse instanceof SegmentFullPositionsEnum)) {
      docsEnum=new SegmentFullPositionsEnum(freqIn,proxIn);
    }
 else {
      docsEnum=(SegmentFullPositionsEnum)reuse;
      if (docsEnum.startFreqIn != freqIn) {
        docsEnum=new SegmentFullPositionsEnum(freqIn,proxIn);
      }
    }
    return docsEnum.reset(fieldInfo,(StandardTermState)termState,liveDocs);
  }
 else {
    SegmentDocsAndPositionsEnum docsEnum;
    if (reuse == null || !(reuse instanceof SegmentDocsAndPositionsEnum)) {
      docsEnum=new SegmentDocsAndPositionsEnum(freqIn,proxIn);
    }
 else {
      docsEnum=(SegmentDocsAndPositionsEnum)reuse;
      if (docsEnum.startFreqIn != freqIn) {
        docsEnum=new SegmentDocsAndPositionsEnum(freqIn,proxIn);
      }
    }
    return docsEnum.reset(fieldInfo,(StandardTermState)termState,liveDocs);
  }
}
