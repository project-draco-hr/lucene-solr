{
  final MockAnalyzer analyzer=new MockAnalyzer(random,MockTokenizer.SIMPLE,true,MockTokenFilter.ENGLISH_STOPSET,true);
  analyzer.setEnableChecks(false);
  TestHighlightRunner helper=new TestHighlightRunner(){
    @Override public void run() throws Exception {
      numHighlights=0;
      doSearching(new TermQuery(new Term(FIELD_NAME,"meat")));
      TokenStream tokenStream=analyzer.reusableTokenStream(FIELD_NAME,new StringReader(texts[0]));
      Highlighter highlighter=getHighlighter(query,FIELD_NAME,HighlighterTest.this);
      highlighter.setMaxDocCharsToAnalyze(30);
      highlighter.getBestFragment(tokenStream,texts[0]);
      assertTrue("Setting MaxDocBytesToAnalyze should have prevented " + "us from finding matches for this record: " + numHighlights + " found",numHighlights == 0);
    }
  }
;
  helper.start();
}
