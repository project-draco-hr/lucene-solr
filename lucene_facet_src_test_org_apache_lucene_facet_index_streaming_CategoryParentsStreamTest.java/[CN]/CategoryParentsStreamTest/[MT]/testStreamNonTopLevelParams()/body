{
  Directory directory=newDirectory();
  final TaxonomyWriter taxonomyWriter=new DirectoryTaxonomyWriter(directory);
  FacetIndexingParams indexingParams=new FacetIndexingParams(){
    @Override public OrdinalPolicy getOrdinalPolicy(){
      return new NonTopLevelOrdinalPolicy();
    }
    @Override public PathPolicy getPathPolicy(){
      return new NonTopLevelPathPolicy();
    }
  }
;
  CategoryParentsStream stream=new CategoryParentsStream(new CategoryAttributesStream(categoryContainer),taxonomyWriter,indexingParams);
  int nTokens;
  for (nTokens=0; stream.incrementToken(); nTokens++) {
  }
  assertEquals("Wrong number of tokens",4,nTokens);
  taxonomyWriter.close();
  directory.close();
}
