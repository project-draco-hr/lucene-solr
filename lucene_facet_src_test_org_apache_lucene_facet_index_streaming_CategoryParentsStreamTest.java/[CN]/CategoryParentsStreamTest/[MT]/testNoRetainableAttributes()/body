{
  Directory directory=newDirectory();
  TaxonomyWriter taxonomyWriter=new DirectoryTaxonomyWriter(directory);
  assertNotNull(new CategoryParentsStream(new CategoryAttributesStream(categoryContainer),taxonomyWriter,FacetIndexingParams.ALL_PARENTS));
  categoryContainer.addCategory(initialCatgeories[0],DummyProperty.INSTANCE);
  CategoryParentsStream stream=new CategoryParentsStream(new CategoryAttributesStream(categoryContainer),taxonomyWriter,FacetIndexingParams.ALL_PARENTS);
  int nAttributes=0;
  while (stream.incrementToken()) {
    if (stream.categoryAttribute.getProperty(DummyProperty.class) != null) {
      nAttributes++;
    }
  }
  assertEquals("Wrong number of tokens with attributes",1,nAttributes);
  taxonomyWriter.close();
  directory.close();
}
