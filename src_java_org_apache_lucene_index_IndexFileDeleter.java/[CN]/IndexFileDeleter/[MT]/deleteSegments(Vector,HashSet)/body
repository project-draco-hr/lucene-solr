{
  deleteFiles();
  for (int i=0; i < segments.size(); i++) {
    SegmentReader reader=(SegmentReader)segments.elementAt(i);
    if (reader.directory() == this.directory) {
      if (protectedSegments.contains(reader.getSegmentName())) {
        addPendingFiles(reader.files());
      }
 else {
        deleteFiles(reader.files());
      }
    }
 else {
      deleteFiles(reader.files(),reader.directory());
    }
  }
}
