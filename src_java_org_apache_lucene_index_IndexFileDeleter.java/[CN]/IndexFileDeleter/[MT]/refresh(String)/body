{
  String[] files=directory.list();
  if (files == null)   throw new IOException("cannot read directory " + directory + ": list() returned null");
  IndexFileNameFilter filter=IndexFileNameFilter.getFilter();
  String segmentPrefix1;
  String segmentPrefix2;
  if (segmentName != null) {
    segmentPrefix1=segmentName + ".";
    segmentPrefix2=segmentName + "_";
  }
 else {
    segmentPrefix1=null;
    segmentPrefix2=null;
  }
  for (int i=0; i < files.length; i++) {
    String fileName=files[i];
    if (filter.accept(null,fileName) && (segmentName == null || fileName.startsWith(segmentPrefix1) || fileName.startsWith(segmentPrefix2)) && !refCounts.containsKey(fileName)&& !fileName.equals(IndexFileNames.SEGMENTS_GEN)) {
      if (infoStream != null) {
        message("refresh [prefix=" + segmentName + "]: removing newly created unreferenced file \""+ fileName+ "\"");
      }
      deleteFile(fileName);
    }
  }
}
