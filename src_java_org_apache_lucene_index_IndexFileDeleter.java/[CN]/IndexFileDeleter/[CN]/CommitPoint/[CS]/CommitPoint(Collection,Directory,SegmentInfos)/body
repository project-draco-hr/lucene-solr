{
  this.directory=directory;
  this.commitsToDelete=commitsToDelete;
  userData=segmentInfos.getUserData();
  segmentsFileName=segmentInfos.getCurrentSegmentFileName();
  version=segmentInfos.getVersion();
  generation=segmentInfos.getGeneration();
  int size=segmentInfos.size();
  files=new ArrayList(size);
  files.add(segmentsFileName);
  gen=segmentInfos.getGeneration();
  for (int i=0; i < size; i++) {
    SegmentInfo segmentInfo=segmentInfos.info(i);
    if (segmentInfo.dir == directory) {
      files.addAll(segmentInfo.files());
    }
  }
  isOptimized=segmentInfos.size() == 1 && !segmentInfos.info(0).hasDeletions();
}
