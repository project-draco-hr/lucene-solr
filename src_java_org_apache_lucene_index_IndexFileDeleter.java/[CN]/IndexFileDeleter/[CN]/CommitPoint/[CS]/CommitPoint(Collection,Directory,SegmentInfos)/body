{
  this.directory=directory;
  this.commitsToDelete=commitsToDelete;
  segmentsFileName=segmentInfos.getCurrentSegmentFileName();
  int size=segmentInfos.size();
  files=new ArrayList(size);
  files.add(segmentsFileName);
  gen=segmentInfos.getGeneration();
  for (int i=0; i < size; i++) {
    SegmentInfo segmentInfo=segmentInfos.info(i);
    if (segmentInfo.dir == directory) {
      files.addAll(segmentInfo.files());
    }
  }
}
