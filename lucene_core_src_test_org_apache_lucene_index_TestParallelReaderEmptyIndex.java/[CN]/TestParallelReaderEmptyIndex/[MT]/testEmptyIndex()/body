{
  Directory rd1=newDirectory();
  IndexWriter iw=new IndexWriter(rd1,newIndexWriterConfig(new MockAnalyzer(random())));
  iw.close();
  Directory rd2=newDirectory(rd1);
  Directory rdOut=newDirectory();
  IndexWriter iwOut=new IndexWriter(rdOut,newIndexWriterConfig(new MockAnalyzer(random())));
  ParallelAtomicReader apr=new ParallelAtomicReader(SlowCompositeReaderWrapper.wrap(DirectoryReader.open(rd1)),SlowCompositeReaderWrapper.wrap(DirectoryReader.open(rd2)));
  iwOut.addIndexes(apr);
  iwOut.forceMerge(1);
  iwOut.addIndexes(new ParallelAtomicReader());
  iwOut.forceMerge(1);
  ParallelCompositeReader cpr=new ParallelCompositeReader(DirectoryReader.open(rd1),DirectoryReader.open(rd2));
  iwOut.addIndexes(cpr);
  iwOut.forceMerge(1);
  iwOut.addIndexes(new ParallelCompositeReader());
  iwOut.forceMerge(1);
  iwOut.close();
  rdOut.close();
  rd1.close();
  rd2.close();
}
