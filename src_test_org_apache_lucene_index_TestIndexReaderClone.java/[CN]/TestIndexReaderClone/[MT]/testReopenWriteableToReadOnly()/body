{
  final Directory dir1=new MockRAMDirectory();
  TestIndexReaderReopen.createIndex(dir1,true);
  IndexReader reader=IndexReader.open(dir1,false);
  final int docCount=reader.numDocs();
  assertTrue(deleteWorked(1,reader));
  assertEquals(docCount - 1,reader.numDocs());
  DirectoryIndexReader readOnlyReader=(DirectoryIndexReader)reader.reopen(true);
  if (!isReadOnly(readOnlyReader)) {
    fail("reader isn't read only");
  }
  assertFalse(deleteWorked(1,readOnlyReader));
  assertEquals(docCount - 1,readOnlyReader.numDocs());
  reader.close();
  readOnlyReader.close();
  dir1.close();
}
