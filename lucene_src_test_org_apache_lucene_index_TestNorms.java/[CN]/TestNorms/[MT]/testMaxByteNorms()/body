{
  Directory dir=newDirectory();
  buildIndex(dir,true);
  AtomicReader open=SlowCompositeReaderWrapper.wrap(IndexReader.open(dir));
  DocValues normValues=open.normValues(byteTestField);
  assertNotNull(normValues);
  Source source=normValues.getSource();
  assertTrue(source.hasArray());
  assertEquals(Type.FIXED_INTS_8,normValues.type());
  byte[] norms=(byte[])source.getArray();
  for (int i=0; i < open.maxDoc(); i++) {
    Document document=open.document(i);
    int expected=Integer.parseInt(document.get(byteTestField));
    assertEquals((byte)expected,norms[i]);
  }
  open.close();
  dir.close();
}
