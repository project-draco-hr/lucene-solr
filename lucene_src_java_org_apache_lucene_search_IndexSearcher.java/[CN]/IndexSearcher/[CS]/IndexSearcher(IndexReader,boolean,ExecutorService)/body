{
  reader=r;
  this.executor=executor;
  this.closeReader=closeReader;
  List<IndexReader> subReadersList=new ArrayList<IndexReader>();
  gatherSubReaders(subReadersList,reader);
  subReaders=subReadersList.toArray(new IndexReader[subReadersList.size()]);
  docStarts=new int[subReaders.length];
  subSearchers=new IndexSearcher[subReaders.length];
  int maxDoc=0;
  for (int i=0; i < subReaders.length; i++) {
    docStarts[i]=maxDoc;
    maxDoc+=subReaders[i].maxDoc();
    if (subReaders[i] == r) {
      subSearchers[i]=this;
    }
 else {
      subSearchers[i]=new IndexSearcher(subReaders[i]);
    }
  }
}
