{
  Directory dir=new RAMDirectory();
  Random random=newRandom();
  RandomIndexWriter writer=new RandomIndexWriter(random,dir);
  for (int i=0; i < 10; i++) {
    writer.addDocument(new Document());
  }
  boolean[] inOrder=new boolean[]{false,true};
  String[] actualTSDCClass=new String[]{"OutOfOrderTopScoreDocCollector","InOrderTopScoreDocCollector"};
  BooleanQuery bq=new BooleanQuery();
  bq.add(new MatchAllDocsQuery(),Occur.SHOULD);
  bq.setMinimumNumberShouldMatch(1);
  IndexReader reader=writer.getReader();
  IndexSearcher searcher=new IndexSearcher(reader);
  for (int i=0; i < inOrder.length; i++) {
    TopDocsCollector<ScoreDoc> tdc=TopScoreDocCollector.create(3,inOrder[i]);
    assertEquals("org.apache.lucene.search.TopScoreDocCollector$" + actualTSDCClass[i],tdc.getClass().getName());
    searcher.search(new MatchAllDocsQuery(),tdc);
    ScoreDoc[] sd=tdc.topDocs().scoreDocs;
    assertEquals(3,sd.length);
    for (int j=0; j < sd.length; j++) {
      assertEquals("expected doc Id " + j + " found "+ sd[j].doc,j,sd[j].doc);
    }
  }
  writer.close();
  searcher.close();
  reader.close();
  dir.close();
}
