{
  final int delta=docID - lastDocID;
  if (docID < 0 || (df > 0 && delta <= 0)) {
    throw new CorruptIndexException("docs out of order (" + docID + " <= "+ lastDocID+ " ) (docOut: "+ docOut+ ")");
  }
  if ((++df % skipInterval) == 0) {
    skipListWriter.setSkipData(lastDocID,writePayloads,lastPayloadLength);
    skipListWriter.bufferSkip(df);
  }
  lastDocID=docID;
  docOut.write(delta);
  if (indexOptions != IndexOptions.DOCS_ONLY) {
    freqOut.write(termDocFreq);
  }
}
