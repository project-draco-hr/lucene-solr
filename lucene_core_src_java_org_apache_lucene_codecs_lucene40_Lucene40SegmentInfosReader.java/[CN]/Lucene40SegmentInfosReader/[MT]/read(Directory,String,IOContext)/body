{
  final String fileName=IndexFileNames.segmentFileName(segment,"",Lucene40SegmentInfosFormat.SI_EXTENSION);
  final IndexInput input=dir.openInput(fileName,context);
  boolean success=false;
  try {
    final String version=input.readString();
    final int docCount=input.readInt();
    final int docStoreOffset=-1;
    final String docStoreSegment=segment;
    final boolean docStoreIsCompoundFile=false;
    final Map<Integer,Long> normGen=null;
    final boolean isCompoundFile=input.readByte() == SegmentInfo.YES;
    final Map<String,String> diagnostics=input.readStringStringMap();
    final SegmentInfo si=new SegmentInfo(dir,version,segment,docCount,docStoreOffset,docStoreSegment,docStoreIsCompoundFile,normGen,isCompoundFile,0,null,diagnostics);
    success=true;
    return si;
  }
  finally {
    if (!success) {
      IOUtils.closeWhileHandlingException(input);
    }
 else {
      input.close();
    }
  }
}
