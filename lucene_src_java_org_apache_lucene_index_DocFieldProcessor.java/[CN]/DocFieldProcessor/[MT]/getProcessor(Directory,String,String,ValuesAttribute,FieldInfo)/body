{
  if (attr == null)   return null;
  IndexValuesProcessor p=indexValues.get(name);
  if (p == null) {
    org.apache.lucene.index.values.Values v=attr.type();
    final String id=segment + "_" + fieldInfo.number;
switch (v) {
case PACKED_INTS:
      p=new IntValuesProcessor(dir,id,false);
    break;
case PACKED_INTS_FIXED:
  p=new IntValuesProcessor(dir,id,true);
break;
case SIMPLE_FLOAT_4BYTE:
p=new FloatValuesProcessor(dir,id,4);
break;
case SIMPLE_FLOAT_8BYTE:
p=new FloatValuesProcessor(dir,id,8);
break;
case BYTES_FIXED_STRAIGHT:
p=new BytesValuesProcessor(dir,id,true,null,Bytes.Mode.STRAIGHT);
break;
case BYTES_FIXED_DEREF:
p=new BytesValuesProcessor(dir,id,true,null,Bytes.Mode.DEREF);
break;
case BYTES_FIXED_SORTED:
p=new BytesValuesProcessor(dir,id,true,attr.bytesComparator(),Bytes.Mode.SORTED);
break;
case BYTES_VAR_STRAIGHT:
p=new BytesValuesProcessor(dir,id,false,null,Bytes.Mode.STRAIGHT);
break;
case BYTES_VAR_DEREF:
p=new BytesValuesProcessor(dir,id,false,null,Bytes.Mode.DEREF);
break;
case BYTES_VAR_SORTED:
p=new BytesValuesProcessor(dir,id,false,attr.bytesComparator(),Bytes.Mode.SORTED);
break;
}
fieldInfo.setIndexValues(v);
indexValues.put(name,p);
}
return p;
}
