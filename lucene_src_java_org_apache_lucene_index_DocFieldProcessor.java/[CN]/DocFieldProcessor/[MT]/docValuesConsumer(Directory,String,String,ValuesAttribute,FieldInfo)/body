{
  DocValuesConsumer valuesConsumer;
  if ((valuesConsumer=docValues.get(name)) == null) {
    fieldInfo.setDocValues(attr.type());
    if (fieldsConsumer == null) {
      docValuesConsumerState=docWriter.segWriteState();
      fieldsConsumer=docValuesConsumerState.segmentCodecs.codec().fieldsConsumer(docValuesConsumerState);
    }
    valuesConsumer=fieldsConsumer.addValuesField(fieldInfo);
    docValues.put(name,valuesConsumer);
  }
  return valuesConsumer;
}
