{
  DocValuesConsumer valuesConsumer;
  if ((valuesConsumer=docValues.get(name)) == null) {
    fieldInfo.setDocValues(attr.type());
    if (fieldsConsumer == null) {
      SegmentWriteState state=docWriter.segWriteState();
      fieldsConsumer=state.segmentCodecs.codec().fieldsConsumer(state);
    }
    valuesConsumer=fieldsConsumer.addValuesField(fieldInfo);
    docValues.put(name,valuesConsumer);
  }
  return valuesConsumer;
}
