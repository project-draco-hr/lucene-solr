{
  KeyPairGenerator keyGen=null;
  try {
    keyGen=KeyPairGenerator.getInstance("RSA");
  }
 catch (  NoSuchAlgorithmException e) {
    throw new SolrException(SolrException.ErrorCode.SERVER_ERROR,e);
  }
  keyGen.initialize(512);
  java.security.KeyPair keyPair=keyGen.genKeyPair();
  privateKey=keyPair.getPrivate();
  publicKey=keyPair.getPublic();
  X509EncodedKeySpec x509EncodedKeySpec=new X509EncodedKeySpec(publicKey.getEncoded());
  pubKeyStr=Base64.byteArrayToBase64(x509EncodedKeySpec.getEncoded());
}
