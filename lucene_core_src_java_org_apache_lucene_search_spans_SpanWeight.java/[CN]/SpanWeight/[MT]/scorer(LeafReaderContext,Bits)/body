{
  if (similarity == null) {
    return null;
  }
  Terms terms=context.reader().terms(similarity.getField());
  if (terms != null && terms.hasPositions() == false) {
    throw new IllegalStateException("field \"" + similarity.getField() + "\" was indexed without position data; cannot run SpanQuery (query="+ parentQuery+ ")");
  }
  Spans spans=getSpans(context,acceptDocs,collectorFactory.newCollector());
  return (spans == null) ? null : new SpanScorer(spans,this,similarity.simScorer(context));
}
