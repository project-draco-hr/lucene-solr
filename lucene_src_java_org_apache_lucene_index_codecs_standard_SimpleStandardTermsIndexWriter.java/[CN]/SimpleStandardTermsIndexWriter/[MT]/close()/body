{
  final long dirStart=out.getFilePointer();
  final int fieldCount=fields.size();
  out.writeInt(fieldCount);
  for (int i=0; i < fieldCount; i++) {
    SimpleFieldWriter field=fields.get(i);
    out.writeInt(field.fieldInfo.number);
    out.writeInt(field.numIndexTerms);
    out.writeLong(field.termsStart);
    out.writeLong(field.indexStart);
    out.writeLong(field.packedIndexStart);
    out.writeLong(field.packedOffsetsStart);
  }
  out.seek(CodecUtil.headerLength(CODEC_NAME));
  out.writeLong(dirStart);
  out.close();
}
