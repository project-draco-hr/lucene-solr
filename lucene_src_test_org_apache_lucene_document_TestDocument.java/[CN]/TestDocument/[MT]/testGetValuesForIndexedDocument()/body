{
  RAMDirectory dir=new RAMDirectory();
  RandomIndexWriter writer=new RandomIndexWriter(newRandom(),dir,new IndexWriterConfig(TEST_VERSION_CURRENT,new MockAnalyzer()));
  writer.addDocument(makeDocumentWithFields());
  IndexReader reader=writer.getReader();
  Searcher searcher=new IndexSearcher(reader);
  Query query=new TermQuery(new Term("keyword","test1"));
  ScoreDoc[] hits=searcher.search(query,null,1000).scoreDocs;
  assertEquals(1,hits.length);
  doAssert(searcher.doc(hits[0].doc),true);
  writer.close();
  searcher.close();
  reader.close();
  dir.close();
}
