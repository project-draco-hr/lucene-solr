{
  fieldsSeen.add(field.name);
  Codec codec=getCodec(field.name);
  FieldsConsumer fields=codecs.get(codec);
  if (fields == null) {
    fields=codec.fieldsConsumer(state);
    codecs.put(codec,fields);
  }
  return fields.addField(field);
}
