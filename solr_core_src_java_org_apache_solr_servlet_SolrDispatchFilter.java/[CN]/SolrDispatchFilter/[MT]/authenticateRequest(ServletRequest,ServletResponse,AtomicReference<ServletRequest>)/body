{
  final AtomicBoolean isAuthenticated=new AtomicBoolean(false);
  AuthenticationPlugin authenticationPlugin=cores.getAuthenticationPlugin();
  if (authenticationPlugin == null) {
    return true;
  }
 else {
    try {
      log.debug("Request to authenticate: " + request + ", domain: "+ request.getLocalName()+ ", port: "+ request.getLocalPort());
      authenticationPlugin.doAuthenticate(request,response,new FilterChain(){
        public void doFilter(        ServletRequest req,        ServletResponse rsp) throws IOException, ServletException {
          isAuthenticated.set(true);
          wrappedRequest.set(req);
        }
      }
);
    }
 catch (    Exception e) {
      e.printStackTrace();
      throw new SolrException(ErrorCode.SERVER_ERROR,"Error during request authentication, ",e);
    }
  }
  if (!isAuthenticated.get()) {
    response.flushBuffer();
    return false;
  }
  return true;
}
