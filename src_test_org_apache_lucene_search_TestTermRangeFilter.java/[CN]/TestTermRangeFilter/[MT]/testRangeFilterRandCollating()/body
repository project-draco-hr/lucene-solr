{
  IndexReader reader=IndexReader.open(unsignedIndex.index,true);
  IndexSearcher search=new IndexSearcher(reader);
  Collator c=Collator.getInstance(Locale.ENGLISH);
  String minRP=pad(unsignedIndex.minR);
  String maxRP=pad(unsignedIndex.maxR);
  int numDocs=reader.numDocs();
  assertEquals("num of docs",numDocs,1 + maxId - minId);
  Hits result;
  Query q=new TermQuery(new Term("body","body"));
  result=search.search(q,new TermRangeFilter("rand",minRP,maxRP,T,T,c));
  assertEquals("find all",numDocs,result.length());
  result=search.search(q,new TermRangeFilter("rand",minRP,maxRP,T,F,c));
  assertEquals("all but biggest",numDocs - 1,result.length());
  result=search.search(q,new TermRangeFilter("rand",minRP,maxRP,F,T,c));
  assertEquals("all but smallest",numDocs - 1,result.length());
  result=search.search(q,new TermRangeFilter("rand",minRP,maxRP,F,F,c));
  assertEquals("all but extremes",numDocs - 2,result.length());
  result=search.search(q,new TermRangeFilter("rand",minRP,null,T,F,c));
  assertEquals("smallest and up",numDocs,result.length());
  result=search.search(q,new TermRangeFilter("rand",null,maxRP,F,T,c));
  assertEquals("biggest and down",numDocs,result.length());
  result=search.search(q,new TermRangeFilter("rand",minRP,null,F,F,c));
  assertEquals("not smallest, but up",numDocs - 1,result.length());
  result=search.search(q,new TermRangeFilter("rand",null,maxRP,F,F,c));
  assertEquals("not biggest, but down",numDocs - 1,result.length());
  result=search.search(q,new TermRangeFilter("rand",minRP,minRP,F,F,c));
  assertEquals("min,min,F,F",0,result.length());
  result=search.search(q,new TermRangeFilter("rand",maxRP,maxRP,F,F,c));
  assertEquals("max,max,F,F",0,result.length());
  result=search.search(q,new TermRangeFilter("rand",minRP,minRP,T,T,c));
  assertEquals("min,min,T,T",1,result.length());
  result=search.search(q,new TermRangeFilter("rand",null,minRP,F,T,c));
  assertEquals("nul,min,F,T",1,result.length());
  result=search.search(q,new TermRangeFilter("rand",maxRP,maxRP,T,T,c));
  assertEquals("max,max,T,T",1,result.length());
  result=search.search(q,new TermRangeFilter("rand",maxRP,null,T,F,c));
  assertEquals("max,nul,T,T",1,result.length());
}
