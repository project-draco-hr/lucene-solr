{
  long start=System.currentTimeMillis();
  final BytesRef scratch=new BytesRef();
  while ((scratch.bytes=reader.read()) != null) {
    scratch.length=scratch.bytes.length;
    buffer.append(scratch);
    if (ramBufferSize.bytes < bufferBytesUsed.get()) {
      break;
    }
  }
  sortInfo.readTime+=(System.currentTimeMillis() - start);
  return buffer.size();
}
