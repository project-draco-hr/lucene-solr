{
  long start=System.currentTimeMillis();
  final BytesRefBuilder scratch=new BytesRefBuilder();
  while (reader.read(scratch)) {
    buffer.append(scratch.get());
    if (bufferBytesUsed.get() > ramBufferSize.bytes) {
      break;
    }
  }
  sortInfo.readTime+=(System.currentTimeMillis() - start);
  return buffer.size();
}
