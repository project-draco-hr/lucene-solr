{
  System.setProperty("solr.zkclienttimeout","93");
  System.setProperty("solrconfig","solrconfig.xml");
  System.setProperty("schema","schema.xml");
  System.setProperty("zkHostSet","localhost:9983");
  CoreContainer cc=init(SOLR_XML_LOTS_SYSVARS,"SystemVars1","SystemVars2");
  try {
    persistContainedInOrig(cc,new File(solrHomeDirectory,"solr_copy.xml"));
    final File persistXml=new File(solrHomeDirectory,"sysvars.solr.xml");
    persistContainedInOrig(cc,persistXml);
    assertXmlFile(persistXml,getAllNodes(new File(solrHomeDirectory,"solr.xml")));
  }
  finally {
    cc.shutdown();
    if (solrHomeDirectory.exists()) {
      FileUtils.deleteDirectory(solrHomeDirectory);
    }
  }
}
