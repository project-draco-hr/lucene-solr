{
  if (solrHomeDirectory.exists()) {
    FileUtils.deleteDirectory(solrHomeDirectory);
  }
  for (  String s : subDirs) {
    copyMinConf(new File(solrHomeDirectory,s));
  }
  File solrXml=new File(solrHomeDirectory,"solr.xml");
  FileUtils.write(solrXml,solrXmlString,IOUtils.CHARSET_UTF_8.toString());
  final CoreContainer cores=new CoreContainer(solrHomeDirectory.getAbsolutePath());
  cores.load(solrHomeDirectory.getAbsolutePath(),solrXml);
  cores.setPersistent(false);
  return cores;
}
