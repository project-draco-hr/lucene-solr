{
  verifyCommitOrder(commits);
  IndexCommit lastCommit=commits.get(commits.size() - 1);
  double expireTime=dir.fileModified(lastCommit.getSegmentsFileName()) / 1000.0 - expirationTimeSeconds;
  for (  final IndexCommit commit : commits) {
    double modTime=dir.fileModified(commit.getSegmentsFileName()) / 1000.0;
    if (commit != lastCommit && modTime < expireTime) {
      commit.delete();
      numDelete+=1;
    }
  }
}
