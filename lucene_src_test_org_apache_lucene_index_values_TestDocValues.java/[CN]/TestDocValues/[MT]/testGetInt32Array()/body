{
  int[] sourceArray=new int[]{1,2,3};
  Directory dir=newDirectory();
  final AtomicLong trackBytes=new AtomicLong(0);
  Writer w=Ints.getWriter(dir,"test",trackBytes,ValueType.FIXED_INTS_32,newIOContext(random));
  for (int i=0; i < sourceArray.length; i++) {
    w.add(i,(long)sourceArray[i]);
  }
  w.finish(sourceArray.length);
  IndexDocValues r=Ints.getValues(dir,"test",sourceArray.length,newIOContext(random));
  Source source=r.getSource();
  assertTrue(source.hasArray());
  int[] loaded=((int[])source.getArray());
  assertEquals(loaded.length,sourceArray.length);
  for (int i=0; i < loaded.length; i++) {
    assertEquals("value didn't match at index " + i,sourceArray[i],loaded[i]);
  }
  r.close();
  dir.close();
}
