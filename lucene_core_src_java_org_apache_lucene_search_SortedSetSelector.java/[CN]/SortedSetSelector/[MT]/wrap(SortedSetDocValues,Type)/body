{
  if (sortedSet.getValueCount() >= Integer.MAX_VALUE) {
    throw new UnsupportedOperationException("fields containing more than " + (Integer.MAX_VALUE - 1) + " unique terms are unsupported");
  }
  SortedDocValues singleton=DocValues.unwrapSingleton(sortedSet);
  if (singleton != null) {
    return singleton;
  }
 else {
switch (selector) {
case MIN:
      return new MinValue(sortedSet);
case MAX:
    return new MaxValue(sortedSet);
case MIDDLE_MIN:
  return new MiddleMinValue(sortedSet);
case MIDDLE_MAX:
return new MiddleMaxValue(sortedSet);
default :
throw new AssertionError();
}
}
}
