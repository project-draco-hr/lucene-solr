def test(fsa, utf32Start, utf32End, count):
    for i in range(count):
        r = random.randint(utf32Start, utf32End)
        dest = fsa.run([tup[0] for tup in toUTF8(r)])
        if (dest != fsa.end):
            print ('FAILED: valid %s (%s) is not accepted' % (r, ' '.join([binary(x[0]) for x in toUTF8(r)])))
            return False
    invalidRange = (MAX_UNICODE - ((utf32End - utf32Start) + 1))
    if (invalidRange >= 0):
        for i in range(count):
            r = random.randint(0, (invalidRange - 1))
            if (r >= utf32Start):
                r = (((utf32End + 1) + r) - utf32Start)
            dest = fsa.run([tup[0] for tup in toUTF8(r)])
            if (dest != (-1)):
                print ('FAILED: invalid %s (%s) is accepted' % (r, ' '.join([binary(x[0]) for x in toUTF8(r)])))
                return False
    return True
