{
  File dirFile=_TestUtil.getTempDir("TestIndexReader.testFilesOpenClose");
  Directory dir=newFSDirectory(dirFile);
  IndexWriter writer=new IndexWriter(dir,newIndexWriterConfig(TEST_VERSION_CURRENT,new MockAnalyzer(random)));
  addDoc(writer,"test");
  writer.close();
  dir.close();
  _TestUtil.rmDir(dirFile);
  dir=newFSDirectory(dirFile);
  writer=new IndexWriter(dir,newIndexWriterConfig(TEST_VERSION_CURRENT,new MockAnalyzer(random)).setOpenMode(OpenMode.CREATE));
  addDoc(writer,"test");
  writer.close();
  dir.close();
  dir=newFSDirectory(dirFile);
  IndexReader reader1=IndexReader.open(dir,false);
  reader1.close();
  dir.close();
  _TestUtil.rmDir(dirFile);
}
