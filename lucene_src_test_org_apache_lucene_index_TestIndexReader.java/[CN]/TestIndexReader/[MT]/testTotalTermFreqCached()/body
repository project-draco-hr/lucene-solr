{
  Directory dir=newDirectory();
  IndexWriter writer=new IndexWriter(dir,newIndexWriterConfig(TEST_VERSION_CURRENT,new MockAnalyzer(random)));
  Document d=new Document();
  d.add(newField("f","a a b",Field.Index.ANALYZED));
  writer.addDocument(d);
  IndexReader r=writer.getReader();
  writer.close();
  Terms terms=MultiFields.getTerms(r,"f");
  try {
    Assume.assumeTrue(terms.totalTermFreq(new BytesRef("b")) != -1);
    assertEquals(1,terms.totalTermFreq(new BytesRef("b")));
    assertEquals(2,terms.totalTermFreq(new BytesRef("a")));
    assertEquals(1,terms.totalTermFreq(new BytesRef("b")));
  }
  finally {
    r.close();
    dir.close();
  }
}
