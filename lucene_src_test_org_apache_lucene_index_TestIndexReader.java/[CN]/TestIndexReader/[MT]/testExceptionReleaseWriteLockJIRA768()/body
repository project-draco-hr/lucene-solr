{
  Directory dir=newDirectory();
  IndexWriter writer=new IndexWriter(dir,newIndexWriterConfig(TEST_VERSION_CURRENT,new MockAnalyzer()));
  addDoc(writer,"aaa");
  writer.close();
  IndexReader reader=IndexReader.open(dir,false);
  try {
    reader.deleteDocument(1);
    fail("did not hit exception when deleting an invalid doc number");
  }
 catch (  ArrayIndexOutOfBoundsException e) {
  }
  reader.close();
  if (IndexWriter.isLocked(dir)) {
    fail("write lock is still held after close");
  }
  reader=IndexReader.open(dir,false);
  Similarity sim=new DefaultSimilarity();
  try {
    reader.setNorm(1,"content",sim.encodeNormValue(2.0f));
    fail("did not hit exception when calling setNorm on an invalid doc number");
  }
 catch (  ArrayIndexOutOfBoundsException e) {
  }
  reader.close();
  if (IndexWriter.isLocked(dir)) {
    fail("write lock is still held after close");
  }
  dir.close();
}
