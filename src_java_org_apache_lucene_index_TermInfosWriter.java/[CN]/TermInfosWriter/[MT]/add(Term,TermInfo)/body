{
  if (!isIndex && term.compareTo(lastTerm) <= 0)   throw new IOException("term out of order");
  if (ti.freqPointer < lastTi.freqPointer)   throw new IOException("freqPointer out of order");
  if (ti.proxPointer < lastTi.proxPointer)   throw new IOException("proxPointer out of order");
  if (!isIndex && size % indexInterval == 0)   other.add(lastTerm,lastTi);
  writeTerm(term);
  output.writeVInt(ti.docFreq);
  output.writeVLong(ti.freqPointer - lastTi.freqPointer);
  output.writeVLong(ti.proxPointer - lastTi.proxPointer);
  if (ti.docFreq >= skipInterval) {
    output.writeVInt(ti.skipOffset);
  }
  if (isIndex) {
    output.writeVLong(other.output.getFilePointer() - lastIndexPointer);
    lastIndexPointer=other.output.getFilePointer();
  }
  lastTi.set(ti);
  size++;
}
