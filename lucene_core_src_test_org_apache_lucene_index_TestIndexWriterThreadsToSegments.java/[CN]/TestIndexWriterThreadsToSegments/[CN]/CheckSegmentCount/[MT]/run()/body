{
  try {
    int oldSegmentCount=r.leaves().size();
    DirectoryReader r2=DirectoryReader.openIfChanged(r);
    assertNotNull(r2);
    r.close();
    r=r2;
    int maxThreadStates=w.getConfig().getMaxThreadStates();
    int maxExpectedSegments=oldSegmentCount + Math.min(maxThreadStates,maxThreadCountPerIter.get());
    if (VERBOSE) {
      System.out.println("TEST: iter done; now verify oldSegCount=" + oldSegmentCount + " newSegCount="+ r2.leaves().size()+ " maxExpected="+ maxExpectedSegments);
    }
    assertTrue(r.leaves().size() <= maxExpectedSegments);
    setNextIterThreadCount();
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
}
