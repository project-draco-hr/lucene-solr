{
  InputStream is=new BufferedInputStream(new FileInputStream(file),BUFFER_SIZE);
  String fileName=file.getName();
  int idx=fileName.lastIndexOf('.');
  int type=OTHER;
  if (idx != -1) {
    Integer typeInt=extensionToType.get(fileName.substring(idx));
    if (typeInt != null) {
      type=typeInt.intValue();
    }
  }
  try {
switch (type) {
case BZIP:
      is=csFactory.createCompressorInputStream("bzip2",is);
    break;
case GZIP:
  is=csFactory.createCompressorInputStream("gz",is);
break;
default :
}
}
 catch (CompressorException e) {
IOException ioe=new IOException(e.getMessage());
ioe.initCause(e);
throw ioe;
}
return is;
}
