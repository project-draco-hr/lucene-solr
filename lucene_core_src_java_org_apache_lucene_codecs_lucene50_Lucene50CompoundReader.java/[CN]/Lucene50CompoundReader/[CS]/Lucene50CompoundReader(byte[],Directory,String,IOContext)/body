{
  this.directory=directory;
  this.fileName=fileName;
  this.entries=readEntries(segmentID,directory,fileName);
  boolean success=false;
  handle=directory.openInput(fileName,context);
  try {
    CodecUtil.checkSegmentHeader(handle,Lucene50CompoundFormat.DATA_CODEC,version,version,segmentID,"");
    CodecUtil.retrieveChecksum(handle);
    success=true;
  }
  finally {
    if (!success) {
      IOUtils.closeWhileHandlingException(handle);
    }
  }
  this.isOpen=true;
}
