{
  if (precision < 0 || precision > 0.5) {
    throw new IllegalArgumentException("Precision " + precision + " must be between [0 to 0.5]");
  }
  if (precision == 0 || shape instanceof Point) {
    return maxLevels;
  }
  Rectangle bbox=shape.getBoundingBox();
  double diagonalDist=ctx.getDistCalc().distance(ctx.makePoint(bbox.getMinX(),bbox.getMinY()),bbox.getMaxX(),bbox.getMaxY());
  return getLevelForDistance(diagonalDist * 0.5 * precision);
}
