{
  LogMergePolicy logmp=r.nextBoolean() ? new LogDocMergePolicy() : new LogByteSizeMergePolicy();
  logmp.setUseCompoundFile(r.nextBoolean());
  logmp.setCalibrateSizeByDeletes(r.nextBoolean());
  if ((TEST_NIGHTLY && random.nextBoolean()) || r.nextInt(20) == 17) {
    logmp.setMergeFactor(_TestUtil.nextInt(r,2,4));
  }
 else {
    logmp.setMergeFactor(_TestUtil.nextInt(r,5,50));
  }
  return logmp;
}
