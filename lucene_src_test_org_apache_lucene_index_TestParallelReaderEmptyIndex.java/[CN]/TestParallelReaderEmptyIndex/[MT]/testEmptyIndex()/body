{
  Random random=newRandom();
  MockRAMDirectory rd1=newDirectory(random);
  IndexWriter iw=new IndexWriter(rd1,newIndexWriterConfig(random,TEST_VERSION_CURRENT,new MockAnalyzer()));
  iw.close();
  MockRAMDirectory rd2=newDirectory(random,rd1);
  MockRAMDirectory rdOut=newDirectory(random);
  IndexWriter iwOut=new IndexWriter(rdOut,newIndexWriterConfig(random,TEST_VERSION_CURRENT,new MockAnalyzer()));
  ParallelReader pr=new ParallelReader();
  pr.add(IndexReader.open(rd1,true));
  pr.add(IndexReader.open(rd2,true));
  iwOut.addIndexes(new IndexReader[]{pr});
  iwOut.optimize();
  iwOut.close();
  _TestUtil.checkIndex(rdOut);
  rdOut.close();
  rd1.close();
  rd2.close();
}
