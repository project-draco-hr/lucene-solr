{
  SchemeRegistry schemeRegistry=new SchemeRegistry();
  schemeRegistry.register(new Scheme("http",80,PlainSocketFactory.getSocketFactory()));
  schemeRegistry.register(new Scheme("https",443,SSLSocketFactory.getSocketFactory()));
  ccm=new ThreadSafeClientConnManager(schemeRegistry);
  ccm.setDefaultMaxPerRoute(32);
  ccm.setMaxTotal(128);
  DefaultHttpClient httpClient=new DefaultHttpClient(ccm);
  httpClient.getParams().setParameter(ClientPNames.HANDLE_REDIRECTS,followRedirects);
  return httpClient;
}
