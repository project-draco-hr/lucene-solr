{
  if (httpClient instanceof DefaultHttpClient) {
    final DefaultHttpClient client=(DefaultHttpClient)httpClient;
    client.removeRequestInterceptorByClass(UseCompressionRequestInterceptor.class);
    client.removeResponseInterceptorByClass(UseCompressionResponseInterceptor.class);
    if (allowCompression) {
      client.addRequestInterceptor(new UseCompressionRequestInterceptor());
      client.addResponseInterceptor(new UseCompressionResponseInterceptor());
    }
  }
 else {
    throw new UnsupportedOperationException("HttpClient instance was not of type DefaultHttpClient");
  }
}
