{
  assertQ("Return 5 docs with id range 1937 till 1940",req("id:[2000 TO 2004]"),"*[count(//doc)=5]");
  assertQ("Return two facet counts for field airport_a",req("q","*:*","fq","id:[2000 TO 2004]","group","true","group.facet","true","group.field","hotel_s1","facet","true","facet.field","airport_s1"),"//lst[@name='facet_fields']/lst[@name='airport_s1']","*[count(//lst[@name='airport_s1']/int)=2]","//lst[@name='airport_s1']/int[@name='ams'][.='2']","//lst[@name='airport_s1']/int[@name='dus'][.='1']");
  assertQ("Return two facet counts for field airport_a with fq",req("q","*:*","fq","id:[2000 TO 2004]","fq","duration_i1:5","group","true","group.facet","true","group.field","hotel_s1","facet","true","facet.field","airport_s1"),"//lst[@name='facet_fields']/lst[@name='airport_s1']","*[count(//lst[@name='airport_s1']/int)=2]","//lst[@name='airport_s1']/int[@name='ams'][.='2']","//lst[@name='airport_s1']/int[@name='dus'][.='0']");
  assertQ("Return one facet count for field airport_s1 with prefix a",req("q","*:*","fq","id:[2000 TO 2004]","group","true","group.facet","true","group.field","hotel_s1","facet","true","facet.field","airport_s1","facet.prefix","a"),"//lst[@name='facet_fields']/lst[@name='airport_s1']","*[count(//lst[@name='airport_s1']/int)=1]","//lst[@name='airport_s1']/int[@name='ams'][.='2']");
  try {
    h.query(req("q","*:*","fq","id:[2000 TO 2004]","group.facet","true","facet","true","facet.field","airport_s1","facet.prefix","a"));
    fail("Exception should have been thrown");
  }
 catch (  SolrException e) {
    assertEquals(SolrException.ErrorCode.BAD_REQUEST.code,e.code());
  }
}
