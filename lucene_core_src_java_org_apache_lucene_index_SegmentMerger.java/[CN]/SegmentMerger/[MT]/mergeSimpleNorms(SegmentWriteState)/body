{
  if (codec.simpleNormsFormat() != null) {
    SimpleDVConsumer consumer=codec.simpleNormsFormat().normsConsumer(segmentWriteState);
    boolean success=false;
    try {
      for (      FieldInfo field : mergeState.fieldInfos) {
        if (field.isIndexed() && !field.omitsNorms()) {
          List<NumericDocValues> toMerge=new ArrayList<NumericDocValues>();
          for (          AtomicReader reader : mergeState.readers) {
            NumericDocValues norms=reader.simpleNormValues(field.name);
            if (norms == null) {
              norms=new NumericDocValues.EMPTY(reader.maxDoc());
            }
            toMerge.add(norms);
          }
          consumer.mergeNumericField(field,mergeState,toMerge);
        }
      }
    }
  finally {
      if (success) {
        IOUtils.close(consumer);
      }
 else {
        IOUtils.closeWhileHandlingException(consumer);
      }
    }
  }
}
