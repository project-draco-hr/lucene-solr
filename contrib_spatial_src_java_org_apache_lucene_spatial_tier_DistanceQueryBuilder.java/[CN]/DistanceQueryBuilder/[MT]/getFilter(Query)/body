{
  QueryWrapperFilter qf=new QueryWrapperFilter(query);
  Filter[] f;
  int[] chain;
  if (needPrecision) {
    f=new Filter[]{cartesianFilter,qf,distanceFilter};
    chain=new int[]{SerialChainFilter.AND,SerialChainFilter.AND,SerialChainFilter.SERIALAND};
  }
 else {
    f=new Filter[]{cartesianFilter,qf};
    chain=new int[]{SerialChainFilter.AND,SerialChainFilter.AND};
  }
  return new SerialChainFilter(f,chain);
}
