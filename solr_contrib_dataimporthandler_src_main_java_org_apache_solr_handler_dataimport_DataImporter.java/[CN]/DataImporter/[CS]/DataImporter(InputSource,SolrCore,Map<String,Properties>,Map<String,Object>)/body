{
  if (dataConfig == null)   throw new DataImportHandlerException(SEVERE,"Configuration not found");
  this.core=core;
  this.schema=core.getSchema();
  dataSourceProps=ds;
  if (session == null)   session=new HashMap<String,Object>();
  coreScopeSession=session;
  loadDataConfig(dataConfig);
  for (  Map.Entry<String,SchemaField> entry : schema.getFields().entrySet()) {
    config.lowerNameVsSchemaField.put(entry.getKey().toLowerCase(Locale.ENGLISH),entry.getValue());
  }
  for (  DataConfig.Entity e : config.document.entities) {
    Map<String,DataConfig.Field> fields=new HashMap<String,DataConfig.Field>();
    initEntity(e,fields,false);
    verifyWithSchema(fields);
    identifyPk(e);
    if (e.allAttributes.containsKey(SqlEntityProcessor.DELTA_QUERY))     isDeltaImportSupported=true;
  }
}
