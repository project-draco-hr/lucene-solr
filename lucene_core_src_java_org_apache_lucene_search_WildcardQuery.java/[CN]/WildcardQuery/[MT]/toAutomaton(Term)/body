{
  List<Automaton> automata=new ArrayList<Automaton>();
  String wildcardText=wildcardquery.text();
  for (int i=0; i < wildcardText.length(); ) {
    final int c=wildcardText.codePointAt(i);
    int length=Character.charCount(c);
switch (c) {
case WILDCARD_STRING:
      automata.add(BasicAutomata.makeAnyString());
    break;
case WILDCARD_CHAR:
  automata.add(BasicAutomata.makeAnyChar());
break;
case WILDCARD_ESCAPE:
if (i + length < wildcardText.length()) {
final int nextChar=wildcardText.codePointAt(i + length);
length+=Character.charCount(nextChar);
automata.add(BasicAutomata.makeChar(nextChar));
break;
}
default :
automata.add(BasicAutomata.makeChar(c));
}
i+=length;
}
return BasicOperations.concatenate(automata);
}
