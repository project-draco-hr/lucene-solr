{
  DocumentWriter dw=new DocumentWriter(ramDirectory,analyzer,this);
  dw.setInfoStream(infoStream);
  String segmentName=newRamSegmentName();
  dw.addDocument(segmentName,doc);
  SegmentInfo si=new SegmentInfo(segmentName,1,ramDirectory,false,false);
  si.setNumFields(dw.getNumFields());
  return si;
}
