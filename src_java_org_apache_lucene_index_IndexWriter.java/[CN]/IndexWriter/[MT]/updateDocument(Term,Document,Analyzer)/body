{
  ensureOpen();
  boolean doFlush=false;
  try {
    doFlush=docWriter.updateDocument(term,doc,analyzer);
  }
 catch (  IOException ioe) {
    deleter.refresh();
    throw ioe;
  }
  if (doFlush)   flush(true,false);
}
