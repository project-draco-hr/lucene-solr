{
  DocumentWriter dw=new DocumentWriter(ramDirectory,analyzer,this);
  dw.setInfoStream(infoStream);
  String segmentName=newSegmentName();
  dw.addDocument(segmentName,doc);
synchronized (this) {
    segmentInfos.addElement(new SegmentInfo(segmentName,1,ramDirectory));
    singleDocSegmentsCount++;
    maybeMergeSegments();
  }
}
