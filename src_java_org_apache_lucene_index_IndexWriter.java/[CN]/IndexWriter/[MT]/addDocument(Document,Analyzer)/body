{
  ensureOpen();
  SegmentInfo newSegmentInfo=buildSingleDocSegment(doc,analyzer);
synchronized (this) {
    ramSegmentInfos.addElement(newSegmentInfo);
    maybeFlushRamSegments();
  }
}
