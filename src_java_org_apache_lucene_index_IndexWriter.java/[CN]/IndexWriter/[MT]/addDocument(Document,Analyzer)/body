{
  ensureOpen();
  int status=0;
  boolean success=false;
  try {
    status=docWriter.addDocument(doc,analyzer);
    success=true;
  }
  finally {
    if (!success) {
      if (infoStream != null)       message("hit exception adding document");
synchronized (this) {
        final List files=docWriter.abortedFiles();
        if (files != null)         deleter.deleteNewFiles(files);
      }
    }
  }
  if ((status & 1) != 0)   flush(true,false);
  checkMaxTermLength(status);
}
