{
  Iterator iter=deleteTerms.entrySet().iterator();
  int delCount=0;
  while (iter.hasNext()) {
    Entry entry=(Entry)iter.next();
    Term term=(Term)entry.getKey();
    TermDocs docs=reader.termDocs(term);
    if (docs != null) {
      int num=((DocumentsWriter.Num)entry.getValue()).getNum();
      try {
        while (docs.next()) {
          int doc=docs.doc();
          if (doc >= num) {
            break;
          }
          reader.deleteDocument(doc);
          delCount++;
        }
      }
  finally {
        docs.close();
      }
    }
  }
  return delCount;
}
