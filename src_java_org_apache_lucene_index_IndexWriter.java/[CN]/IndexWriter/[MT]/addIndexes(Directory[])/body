{
  optimize();
  int minSegment=segmentInfos.size();
  int segmentsAddedSinceMerge=0;
  for (int i=0; i < dirs.length; i++) {
    SegmentInfos sis=new SegmentInfos();
    sis.read(dirs[i]);
    for (int j=0; j < sis.size(); j++) {
      segmentInfos.addElement(sis.info(j));
      if (++segmentsAddedSinceMerge == mergeFactor) {
        mergeSegments(minSegment++,false);
        segmentsAddedSinceMerge=0;
      }
    }
  }
  optimize();
}
