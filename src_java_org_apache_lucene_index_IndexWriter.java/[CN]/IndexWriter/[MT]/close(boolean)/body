{
  boolean doClose;
  if (hitOOM)   abort();
synchronized (this) {
    if (!closing) {
      doClose=true;
      closing=true;
    }
 else     doClose=false;
  }
  if (doClose)   closeInternal(waitForMerges);
 else   waitForClose();
}
