{
  final MergePolicy.MergeSpecification spec;
  if (optimize) {
    final int maxSegmentCount=1;
    spec=mergePolicy.findMergesForOptimize(segmentInfos,this,maxSegmentCount,segmentsToOptimize);
    if (spec != null) {
      final int numMerges=spec.merges.size();
      for (int i=0; i < numMerges; i++)       ((MergePolicy.OneMerge)spec.merges.get(i)).optimize=true;
    }
  }
 else   spec=mergePolicy.findMerges(segmentInfos,this);
  if (spec != null) {
    final int numMerges=spec.merges.size();
    for (int i=0; i < numMerges; i++)     registerMerge((MergePolicy.OneMerge)spec.merges.get(i));
  }
}
