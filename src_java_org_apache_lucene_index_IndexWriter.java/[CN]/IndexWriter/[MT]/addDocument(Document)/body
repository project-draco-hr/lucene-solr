{
  DocumentWriter dw=new DocumentWriter(ramDirectory,analyzer,maxFieldLength);
  String segmentName=newSegmentName();
  dw.addDocument(segmentName,doc);
synchronized (this) {
    segmentInfos.addElement(new SegmentInfo(segmentName,1,ramDirectory));
    maybeMergeSegments();
  }
}
