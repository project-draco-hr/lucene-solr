{
  ensureOpen();
  if (!autoCommit) {
    segmentInfos.clear();
    segmentInfos.addAll(rollbackSegmentInfos);
    docWriter.abort();
    deleter.checkpoint(segmentInfos,false);
    deleter.refresh();
    bufferedDeleteTerms.clear();
    numBufferedDeleteTerms=0;
    commitPending=false;
    docWriter.abort();
    close();
  }
 else {
    throw new IllegalStateException("abort() can only be called when IndexWriter was opened with autoCommit=false");
  }
}
