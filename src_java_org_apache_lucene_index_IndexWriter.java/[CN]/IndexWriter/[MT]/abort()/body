{
  if (!autoCommit) {
    segmentInfos.clear();
    segmentInfos.addAll(rollbackSegmentInfos);
    deleter.checkpoint(segmentInfos,false);
    deleter.refresh();
    ramSegmentInfos=new SegmentInfos();
    bufferedDeleteTerms.clear();
    numBufferedDeleteTerms=0;
    commitPending=false;
    close();
  }
 else {
    throw new IllegalStateException("abort() can only be called when IndexWriter was opened with autoCommit=false");
  }
}
