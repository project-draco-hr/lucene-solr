{
  if (infoStream != null)   message("now commit transaction");
  autoCommit=localAutoCommit;
  checkpoint();
  if (autoCommit) {
    boolean success=false;
    try {
      commit(true,0);
      success=true;
    }
  finally {
      if (!success) {
        if (infoStream != null)         message("hit exception committing transaction");
        rollbackTransaction();
      }
    }
  }
 else   deleter.decRef(localRollbackSegmentInfos);
  localRollbackSegmentInfos=null;
}
