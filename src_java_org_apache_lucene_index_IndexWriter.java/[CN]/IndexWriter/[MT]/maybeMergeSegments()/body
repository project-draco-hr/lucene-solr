{
  long targetMergeDocs=minMergeDocs;
  while (targetMergeDocs <= maxMergeDocs) {
    int minSegment=segmentInfos.size() - singleDocSegmentsCount;
    int mergeDocs=singleDocSegmentsCount;
    while (--minSegment >= 0) {
      SegmentInfo si=segmentInfos.info(minSegment);
      if (si.docCount >= targetMergeDocs)       break;
      mergeDocs+=si.docCount;
    }
    if (mergeDocs >= targetMergeDocs)     mergeSegments(minSegment + 1);
 else     break;
    targetMergeDocs*=mergeFactor;
  }
}
