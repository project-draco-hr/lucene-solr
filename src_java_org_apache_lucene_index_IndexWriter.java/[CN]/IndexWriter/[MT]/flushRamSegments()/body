{
  int minSegment=segmentInfos.size() - 1;
  int docCount=0;
  while (minSegment >= 0 && (segmentInfos.info(minSegment)).dir == ramDirectory) {
    docCount+=segmentInfos.info(minSegment).docCount;
    minSegment--;
  }
  if (minSegment < 0 || (docCount + segmentInfos.info(minSegment).docCount) > mergeFactor || !(segmentInfos.info(segmentInfos.size() - 1).dir == ramDirectory))   minSegment++;
  if (minSegment >= segmentInfos.size())   return;
  mergeSegments(minSegment);
}
