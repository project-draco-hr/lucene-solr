{
  if (poolReaders) {
    readBufferSize=BufferedIndexInput.BUFFER_SIZE;
  }
  SegmentReader sr=(SegmentReader)readerMap.get(info);
  if (sr == null) {
    sr=SegmentReader.get(info,readBufferSize,doOpenStores,termsIndexDivisor);
    readerMap.put(info,sr);
  }
 else {
    if (doOpenStores) {
      sr.openDocStores();
    }
    if (termsIndexDivisor != -1 && !sr.termsIndexLoaded()) {
      sr.loadTermsIndex(termsIndexDivisor);
    }
  }
  sr.incRef();
  return sr;
}
