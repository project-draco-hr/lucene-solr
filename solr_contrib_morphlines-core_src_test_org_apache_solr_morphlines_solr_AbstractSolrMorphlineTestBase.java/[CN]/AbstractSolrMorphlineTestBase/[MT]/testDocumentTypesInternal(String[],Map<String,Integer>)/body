{
  deleteAllDocuments();
  int numDocs=0;
  for (int i=0; i < 1; i++) {
    for (    String file : files) {
      File f=new File(file);
      byte[] body=Files.toByteArray(f);
      Record event=new Record();
      event.getFields().put(Fields.ATTACHMENT_BODY,new ByteArrayInputStream(body));
      event.getFields().put(Fields.ATTACHMENT_NAME,f.getName());
      event.getFields().put(Fields.BASE_ID,f.getName());
      load(event);
      Integer count=expectedRecords.get(file);
      if (count != null) {
        numDocs+=count;
      }
 else {
        numDocs++;
      }
      assertEquals("unexpected results in " + file,numDocs,queryResultSetSize("*:*"));
    }
  }
  assertEquals(numDocs,queryResultSetSize("*:*"));
}
