{
  StreamExpressionNamedParameter batchSizeParam=factory.getNamedOperand(expression,"batchSize");
  if (null == batchSizeParam || null == batchSizeParam.getParameter() || !(batchSizeParam.getParameter() instanceof StreamExpressionValue)) {
    throw new IOException(String.format(Locale.ROOT,"Invalid expression %s - expecting a 'batchSize' parameter of type positive integer but didn't find one",expression));
  }
  String batchSizeStr=((StreamExpressionValue)batchSizeParam.getParameter()).getValue();
  return parseBatchSize(batchSizeStr,expression);
}
