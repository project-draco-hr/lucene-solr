{
  file=new File(file.getCanonicalPath());
  FSDirectory dir;
synchronized (DIRECTORIES) {
    dir=(FSDirectory)DIRECTORIES.get(file);
    if (dir == null) {
      dir=new FSDirectory(file,create);
      DIRECTORIES.put(file,dir);
    }
 else     if (create) {
      dir.create();
    }
  }
synchronized (dir) {
    dir.refCount++;
  }
  return dir;
}
