{
  if (isOpen && --refCount <= 0) {
    isOpen=false;
synchronized (DIRECTORIES) {
      DIRECTORIES.remove(directory);
    }
  }
}
