{
  if (lockFactory == null) {
    if (disableLocks) {
      lockFactory=NoLockFactory.getNoLockFactory();
    }
 else {
      String lockClassName=System.getProperty("org.apache.lucene.store.FSDirectoryLockFactoryClass");
      if (lockClassName != null) {
        Class c;
        try {
          c=Class.forName(lockClassName);
        }
 catch (        ClassNotFoundException e) {
          throw new IOException("unable to find LockClass " + lockClassName);
        }
        try {
          lockFactory=(LockFactory)c.newInstance();
        }
 catch (        IllegalAccessException e) {
          throw new IOException("IllegalAccessException when instantiating LockClass " + lockClassName);
        }
catch (        InstantiationException e) {
          throw new IOException("InstantiationException when instantiating LockClass " + lockClassName);
        }
catch (        ClassCastException e) {
          throw new IOException("unable to cast LockClass " + lockClassName + " instance to a LockFactory");
        }
      }
 else {
        File lockDir;
        if (LOCK_DIR == null) {
          lockDir=directory;
        }
 else {
          lockDir=new File(LOCK_DIR);
        }
        lockFactory=new SimpleFSLockFactory(lockDir);
      }
    }
  }
  directory=path;
  setLockFactory(lockFactory);
  init(path,create);
}
