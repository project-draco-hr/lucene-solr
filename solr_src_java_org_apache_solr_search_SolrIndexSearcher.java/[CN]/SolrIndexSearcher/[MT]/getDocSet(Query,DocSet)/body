{
  if (filter == null)   return getDocSet(query);
  Query absQ=QueryUtils.getAbs(query);
  boolean positive=absQ == query;
  DocSet first;
  if (filterCache != null) {
    first=filterCache.get(absQ);
    if (first == null) {
      first=getDocSetNC(absQ,null);
      filterCache.put(absQ,first);
    }
    return positive ? first.intersection(filter) : filter.andNot(first);
  }
  return positive ? getDocSetNC(absQ,filter) : filter.andNot(getPositiveDocSet(absQ));
}
