{
  BooleanQuery.Builder bq=new BooleanQuery.Builder();
  BooleanClause.Occur MUST=BooleanClause.Occur.MUST;
  if (bbox.getCrossesDateLine()) {
    bq.add(rangeQuery(fieldNameX,null,bbox.getMaxX()),BooleanClause.Occur.SHOULD);
    bq.add(rangeQuery(fieldNameX,bbox.getMinX(),null),BooleanClause.Occur.SHOULD);
    bq.setMinimumNumberShouldMatch(1);
  }
 else {
    bq.add(rangeQuery(fieldNameX,bbox.getMinX(),bbox.getMaxX()),MUST);
  }
  bq.add(rangeQuery(fieldNameY,bbox.getMinY(),bbox.getMaxY()),MUST);
  return bq.build();
}
