{
  Directory dir=newDirectory();
  RandomIndexWriter iw=new RandomIndexWriter(random(),dir);
  Document doc=new Document();
  doc.add(new NumericDocValuesField("dv1",5L));
  doc.add(new SortedDocValuesField("dv2",toSortableBytes(42L)));
  iw.addDocument(doc);
  iw.commit();
  final IndexReader reader=iw.getReader();
  final LeafReaderContext ctx=reader.leaves().get(0);
  final IndexSearcher searcher=newSearcher(reader);
  iw.close();
  Query q1=DocValuesRangeQuery.newLongRange("dv1",0L,100L,random().nextBoolean(),random().nextBoolean());
  Weight w=searcher.createNormalizedWeight(q1,true);
  Scorer s=w.scorer(ctx,null);
  assertNotNull(s.asTwoPhaseIterator());
  Query q2=DocValuesRangeQuery.newBytesRefRange("dv2",toSortableBytes(0L),toSortableBytes(100L),random().nextBoolean(),random().nextBoolean());
  w=searcher.createNormalizedWeight(q2,true);
  s=w.scorer(ctx,null);
  assertNotNull(s.asTwoPhaseIterator());
  reader.close();
  dir.close();
}
