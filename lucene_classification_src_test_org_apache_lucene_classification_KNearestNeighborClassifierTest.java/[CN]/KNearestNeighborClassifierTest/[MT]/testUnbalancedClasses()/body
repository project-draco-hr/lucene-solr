{
  LeafReader leafReader=null;
  try {
    Analyzer analyzer=new EnglishAnalyzer();
    leafReader=populateSampleIndex(analyzer);
    KNearestNeighborClassifier knnClassifier=new KNearestNeighborClassifier(leafReader,null,analyzer,null,3,1,1,categoryFieldName,textFieldName);
    List<ClassificationResult<BytesRef>> classes=knnClassifier.getClasses(SUPER_STRONG_TECHNOLOGY_INPUT);
    assertTrue(classes.get(0).getScore() > classes.get(1).getScore());
    checkCorrectClassification(knnClassifier,SUPER_STRONG_TECHNOLOGY_INPUT,TECHNOLOGY_RESULT);
  }
  finally {
    if (leafReader != null) {
      leafReader.close();
    }
  }
}
