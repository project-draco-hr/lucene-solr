{
  long totalTF=0L;
  for (  final AtomicReaderContext ctx : reader.getTopReaderContext().leaves()) {
    AtomicReader r=ctx.reader();
    Bits liveDocs=r.getLiveDocs();
    if (liveDocs == null) {
      final long totTF=r.totalTermFreq(field,termText);
      if (totTF != -1) {
        totalTF+=totTF;
        continue;
      }
    }
    DocsEnum de=r.termDocsEnum(liveDocs,field,termText);
    if (de != null) {
      while (de.nextDoc() != DocIdSetIterator.NO_MORE_DOCS)       totalTF+=de.freq();
    }
  }
  return totalTF;
}
