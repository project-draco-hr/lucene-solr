{
  LOG.debug("Creating writer on {}",path);
  this.path=path;
  Configuration conf=fileSystem.getConf();
  FsServerDefaults fsDefaults=fileSystem.getServerDefaults(path);
  EnumSet<CreateFlag> flags=EnumSet.of(CreateFlag.CREATE,CreateFlag.OVERWRITE);
  if (Boolean.getBoolean(HDFS_SYNC_BLOCK)) {
    flags.add(CreateFlag.SYNC_BLOCK);
  }
  outputStream=fileSystem.create(path,FsPermission.getDefault().applyUMask(FsPermission.getUMask(conf)),flags,fsDefaults.getFileBufferSize(),fsDefaults.getReplication(),fsDefaults.getBlockSize(),null);
}
