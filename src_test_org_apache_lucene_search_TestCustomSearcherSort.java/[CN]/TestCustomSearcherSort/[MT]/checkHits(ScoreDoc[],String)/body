{
  if (hits != null) {
    Map idMap=new TreeMap();
    for (int docnum=0; docnum < hits.length; ++docnum) {
      Integer luceneId=null;
      luceneId=new Integer(hits[docnum].doc);
      if (idMap.containsKey(luceneId)) {
        StringBuffer message=new StringBuffer(prefix);
        message.append("Duplicate key for hit index = ");
        message.append(docnum);
        message.append(", previous index = ");
        message.append(((Integer)idMap.get(luceneId)).toString());
        message.append(", Lucene ID = ");
        message.append(luceneId);
        log(message.toString());
      }
 else {
        idMap.put(luceneId,new Integer(docnum));
      }
    }
  }
}
