{
  DirectoryReader indexReader=DirectoryReader.open(indexDir);
  DirectoryTaxonomyReader taxoReader=new DirectoryTaxonomyReader(taxoDir);
  IndexSearcher searcher=newSearcher(indexReader);
  FacetsCollector collector=new FacetsCollector();
  FacetsCollector.search(searcher,new MatchAllDocsQuery(),10,collector);
  Facets facets=new FastTaxonomyFacetCounts(taxoReader,facetConfig,collector);
  FacetResult result=facets.getTopChildren(10,"tag");
  for (  LabelAndValue lv : result.labelValues) {
    if (VERBOSE) {
      System.out.println(lv);
    }
    assertEquals(NUM_DOCS,lv.value.intValue());
  }
  IOUtils.close(indexReader,taxoReader);
}
