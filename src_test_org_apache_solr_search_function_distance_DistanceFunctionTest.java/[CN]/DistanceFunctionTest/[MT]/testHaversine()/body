{
  assertU(adoc("id","1","x_td","0","y_td","0","gh_s",GeoHashUtils.encode(32.7693246,-79.9289094)));
  assertU(adoc("id","2","x_td","0","y_td",String.valueOf(Math.PI / 2),"gh_s",GeoHashUtils.encode(32.7693246,-78.9289094)));
  assertU(adoc("id","3","x_td",String.valueOf(Math.PI / 2),"y_td",String.valueOf(Math.PI / 2),"gh_s",GeoHashUtils.encode(32.7693246,-80.9289094)));
  assertU(adoc("id","4","x_td",String.valueOf(Math.PI / 4),"y_td",String.valueOf(Math.PI / 4),"gh_s",GeoHashUtils.encode(32.7693246,-81.9289094)));
  assertU(adoc("id","5","x_td","45.0","y_td","45.0","gh_s",GeoHashUtils.encode(32.7693246,-81.9289094)));
  assertU(commit());
  assertQ(req("fl","*,score","q","{!func}hsin(1, x_td, y_td, 0, 0)","fq","id:1"),"//float[@name='score']='0.0'");
  assertQ(req("fl","*,score","q","{!func}hsin(1, x_td, y_td, 0, 0)","fq","id:2"),"//float[@name='score']='" + (float)(Math.PI / 2) + "'");
  assertQ(req("fl","*,score","q","{!func}hsin(1, x_td, y_td, 0, 0)","fq","id:3"),"//float[@name='score']='" + (float)(Math.PI / 2) + "'");
  assertQ(req("fl","*,score","q","{!func}hsin(1, x_td, y_td, 0, 0)","fq","id:4"),"//float[@name='score']='1.0471976'");
  assertQ(req("fl","*,score","q","{!func}hsin(1, x_td, y_td, 0, 0, true)","fq","id:5"),"//float[@name='score']='1.0471976'");
  assertQ(req("fl","*,score","q","{!func}ghhsin(" + Constants.EARTH_RADIUS_KM + ", gh_s, \""+ GeoHashUtils.encode(32,-79)+ "\",)","fq","id:1"),"//float[@name='score']='122.30894'");
  assertQ(req("fl","*,score","q","{!func}ghhsin(" + Constants.EARTH_RADIUS_KM + ", gh_s, geohash(32, -79))","fq","id:1"),"//float[@name='score']='122.30894'");
}
