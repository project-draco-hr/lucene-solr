{
  BytesRefBuilder scratch=new BytesRefBuilder();
  IndexInput clone=data.clone();
  clone.seek(0);
  ChecksumIndexInput input=new BufferedChecksumIndexInput(clone);
  while (true) {
    SimpleTextUtil.readLine(input,scratch);
    if (scratch.get().equals(END)) {
      SimpleTextUtil.checkFooter(input);
      break;
    }
  }
}
