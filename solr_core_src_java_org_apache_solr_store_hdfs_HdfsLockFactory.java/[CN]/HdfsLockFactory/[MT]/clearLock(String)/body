{
  FileSystem fs=null;
  try {
    fs=FileSystem.newInstance(lockPath.toUri(),configuration);
    if (fs.exists(lockPath)) {
      if (lockPrefix != null) {
        lockName=lockPrefix + "-" + lockName;
      }
      Path lockFile=new Path(lockPath,lockName);
      if (fs.exists(lockFile) && !fs.delete(lockFile,false)) {
        throw new IOException("Cannot delete " + lockFile);
      }
    }
  }
  finally {
    IOUtils.closeQuietly(fs);
  }
}
