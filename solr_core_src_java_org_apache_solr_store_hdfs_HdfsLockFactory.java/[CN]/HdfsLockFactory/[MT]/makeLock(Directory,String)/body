{
  if (!(dir instanceof HdfsDirectory)) {
    throw new UnsupportedOperationException("HdfsLockFactory can only be used with HdfsDirectory subclasses, got: " + dir);
  }
  final HdfsDirectory hdfsDir=(HdfsDirectory)dir;
  return new HdfsLock(hdfsDir.getHdfsDirPath(),lockName,hdfsDir.getConfiguration());
}
