{
  FSDataOutputStream file=null;
  FileSystem fs=null;
  try {
    fs=FileSystem.newInstance(lockPath.toUri(),conf);
    if (!fs.exists(lockPath)) {
      fs.mkdirs(lockPath);
    }
    file=fs.create(new Path(lockPath,lockName),false);
  }
 catch (  FileAlreadyExistsException e) {
    return false;
  }
catch (  IOException e) {
    log.error("Error creating lock file",e);
    return false;
  }
 finally {
    IOUtils.closeQuietly(file);
    IOUtils.closeQuietly(fs);
  }
  return true;
}
