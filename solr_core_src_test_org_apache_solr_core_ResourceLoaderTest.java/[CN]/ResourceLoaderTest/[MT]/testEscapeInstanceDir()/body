{
  File temp=createTempDir("testEscapeInstanceDir").toFile();
  try {
    temp.mkdirs();
    new File(temp,"dummy.txt").createNewFile();
    File instanceDir=new File(temp,"instance");
    instanceDir.mkdir();
    new File(instanceDir,"conf").mkdir();
    SolrResourceLoader loader=new SolrResourceLoader(instanceDir.getAbsolutePath());
    try {
      loader.openResource("../../dummy.txt").close();
      fail();
    }
 catch (    IOException ioe) {
      assertTrue(ioe.getMessage().startsWith("For security reasons, SolrResourceLoader"));
    }
    loader.close();
  }
  finally {
    IOUtils.rm(temp.toPath());
  }
}
