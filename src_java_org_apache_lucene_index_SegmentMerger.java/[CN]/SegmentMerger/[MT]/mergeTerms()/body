{
  try {
    freqOutput=directory.createOutput(segment + ".frq");
    proxOutput=directory.createOutput(segment + ".prx");
    termInfosWriter=new TermInfosWriter(directory,segment,fieldInfos,termIndexInterval);
    skipInterval=termInfosWriter.skipInterval;
    maxSkipLevels=termInfosWriter.maxSkipLevels;
    skipListWriter=new DefaultSkipListWriter(skipInterval,maxSkipLevels,mergedDocs,freqOutput,proxOutput);
    queue=new SegmentMergeQueue(readers.size());
    mergeTermInfos();
  }
  finally {
    if (freqOutput != null)     freqOutput.close();
    if (proxOutput != null)     proxOutput.close();
    if (termInfosWriter != null)     termInfosWriter.close();
    if (queue != null)     queue.close();
  }
}
