{
  try {
    freqOutput=directory.createFile(segment + ".frq");
    proxOutput=directory.createFile(segment + ".prx");
    termInfosWriter=new TermInfosWriter(directory,segment,fieldInfos);
    skipInterval=termInfosWriter.skipInterval;
    queue=new SegmentMergeQueue(readers.size());
    mergeTermInfos();
  }
  finally {
    if (freqOutput != null)     freqOutput.close();
    if (proxOutput != null)     proxOutput.close();
    if (termInfosWriter != null)     termInfosWriter.close();
    if (queue != null)     queue.close();
  }
}
