{
  CompoundFileWriter oneWriter=new CompoundFileWriter(directory,segment + ".cfs");
  ArrayList files=new ArrayList(COMPOUND_EXTENSIONS.length + fieldInfos.size());
  for (int i=0; i < COMPOUND_EXTENSIONS.length; i++) {
    files.add(segment + "." + COMPOUND_EXTENSIONS[i]);
  }
  for (int i=0; i < fieldInfos.size(); i++) {
    FieldInfo fi=fieldInfos.fieldInfo(i);
    if (fi.isIndexed) {
      files.add(segment + ".f" + i);
    }
  }
  Iterator it=files.iterator();
  while (it.hasNext()) {
    oneWriter.addFile((String)it.next());
  }
  oneWriter.close();
  it=files.iterator();
  while (it.hasNext()) {
    directory.deleteFile((String)it.next());
  }
}
