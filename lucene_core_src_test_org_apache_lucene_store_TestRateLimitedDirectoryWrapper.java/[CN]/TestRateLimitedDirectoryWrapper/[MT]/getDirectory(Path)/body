{
  Directory in=newFSDirectory(path);
  if (in instanceof MockDirectoryWrapper) {
    ((MockDirectoryWrapper)in).setEnableVirusScanner(false);
  }
  RateLimitedDirectoryWrapper dir=new RateLimitedDirectoryWrapper(in);
  RateLimiter limiter=new RateLimiter.SimpleRateLimiter(TestUtil.nextInt(random(),10,40));
  dir.setRateLimiter(limiter,IOContext.Context.MERGE);
  return dir;
}
