{
  List<Long> otherVersions=(List<Long>)srsp.getSolrResponse().getResponse().get("versions");
  SyncShardRequest sreq=(SyncShardRequest)srsp.getShardRequest();
  sreq.reportedVersions=otherVersions;
  Object fingerprint=srsp.getSolrResponse().getResponse().get("fingerprint");
  log.info(msg() + " Received " + otherVersions.size()+ " versions from "+ sreq.shards[0]+ " fingerprint:"+ fingerprint);
  if (fingerprint != null) {
    sreq.fingerprint=IndexFingerprint.fromObject(fingerprint);
  }
  if (otherVersions.size() == 0) {
    return getNoVersionsIsSuccess;
  }
  boolean completeList=otherVersions.size() < nUpdates;
  Collections.sort(otherVersions,absComparator);
  if (debug) {
    log.debug(msg() + " sorted versions from " + sreq.shards[0]+ " = "+ otherVersions);
  }
  long otherHigh=percentile(otherVersions,.2f);
  long otherLow=percentile(otherVersions,.8f);
  long otherHighest=otherVersions.get(0);
  if (ourHighThreshold < otherLow) {
    log.info(msg() + " Our versions are too old. ourHighThreshold=" + ourHighThreshold+ " otherLowThreshold="+ otherLow+ " ourHighest="+ ourHighest+ " otherHighest="+ otherHighest);
    return false;
  }
  if (ourLowThreshold > otherHigh) {
    log.info(msg() + " Our versions are newer. ourLowThreshold=" + ourLowThreshold+ " otherHigh="+ otherHigh+ " ourHighest="+ ourHighest+ " otherHighest="+ otherHighest);
    return true;
  }
  if (core.getSolrConfig().useRangeVersionsForPeerSync && canHandleVersionRanges(sreq.shards[0])) {
    return handleVersionsWithRanges(srsp,otherVersions,sreq,completeList,otherHigh,otherHighest);
  }
 else {
    return handleIndividualVersions(srsp,otherVersions,sreq,completeList,otherHigh,otherHighest);
  }
}
