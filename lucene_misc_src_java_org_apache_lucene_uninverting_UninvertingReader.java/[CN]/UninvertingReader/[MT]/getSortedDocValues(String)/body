{
  Type v=mapping.get(field);
  if (v == Type.SORTED) {
    return FieldCache.DEFAULT.getTermsIndex(in,field);
  }
 else   if (v != null) {
    throw new IllegalStateException("Type mismatch: " + field + " was indexed as "+ v);
  }
 else {
    return in.getSortedDocValues(field);
  }
}
