{
  Directory dir=newDirectory();
  IntStreamFactory f=new MockFixedIntBlockCodec(128).getIntFactory();
  IntIndexOutput out=f.createOutput(dir,"test",newIOContext(random));
  for (int i=0; i < 11777; i++) {
    out.write(i);
  }
  out.close();
  IntIndexInput in=f.openInput(dir,"test",newIOContext(random));
  IntIndexInput.Reader r=in.reader();
  for (int i=0; i < 11777; i++) {
    assertEquals(i,r.next());
  }
  in.close();
  dir.close();
}
