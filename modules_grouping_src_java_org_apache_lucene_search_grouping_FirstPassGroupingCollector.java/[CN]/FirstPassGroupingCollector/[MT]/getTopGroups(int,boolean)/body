{
  if (groupOffset < 0) {
    throw new IllegalArgumentException("groupOffset must be >= 0 (got " + groupOffset + ")");
  }
  if (groupMap.size() <= groupOffset) {
    return null;
  }
  if (orderedGroups == null) {
    buildSortedSet();
  }
  final Collection<SearchGroup> result=new ArrayList<SearchGroup>();
  int upto=0;
  final int sortFieldCount=groupSort.getSort().length;
  for (  CollectedSearchGroup group : orderedGroups) {
    if (upto++ < groupOffset) {
      continue;
    }
    SearchGroup searchGroup=new SearchGroup();
    searchGroup.groupValue=group.groupValue;
    if (fillFields) {
      searchGroup.sortValues=new Comparable[sortFieldCount];
      for (int sortFieldIDX=0; sortFieldIDX < sortFieldCount; sortFieldIDX++) {
        searchGroup.sortValues[sortFieldIDX]=comparators[sortFieldIDX].value(group.comparatorSlot);
      }
    }
    result.add(searchGroup);
  }
  return result;
}
