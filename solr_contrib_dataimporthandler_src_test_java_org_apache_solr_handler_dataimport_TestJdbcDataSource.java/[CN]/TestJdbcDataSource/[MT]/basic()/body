{
  JdbcDataSource dataSource=new JdbcDataSource();
  Properties p=new Properties();
  p.put("driver","com.mysql.jdbc.Driver");
  p.put("url","jdbc:mysql://localhost/autos");
  p.put("user","root");
  p.put("password","");
  List<Map<String,String>> flds=new ArrayList<Map<String,String>>();
  Map<String,String> f=new HashMap<String,String>();
  f.put("column","trim_id");
  f.put("type","long");
  flds.add(f);
  f=new HashMap<String,String>();
  f.put("column","msrp");
  f.put("type","float");
  flds.add(f);
  Context c=AbstractDataImportHandlerTestCase.getContext(null,null,dataSource,Context.FULL_DUMP,flds,null);
  dataSource.init(c,p);
  Iterator<Map<String,Object>> i=dataSource.getData("select make,model,year,msrp,trim_id from atrimlisting where make='Acura'");
  int count=0;
  Object msrp=null;
  Object trim_id=null;
  while (i.hasNext()) {
    Map<String,Object> map=i.next();
    msrp=map.get("msrp");
    trim_id=map.get("trim_id");
    count++;
  }
  Assert.assertEquals(5,count);
  Assert.assertEquals(Float.class,msrp.getClass());
  Assert.assertEquals(Long.class,trim_id.getClass());
}
