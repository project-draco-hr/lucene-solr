{
  List<Metric> metrics=new ArrayList();
  for (  String field : fields) {
    if (field.contains("(")) {
      field=field.substring(0,field.length() - 1);
      String[] parts=field.split("\\(");
      String function=parts[0];
      String column=parts[1];
      if (function.equals("min")) {
        metrics.add(new MinMetric(column));
        fieldSet.add(column);
      }
 else       if (function.equals("max")) {
        metrics.add(new MaxMetric(column));
        fieldSet.add(column);
      }
 else       if (function.equals("sum")) {
        metrics.add(new SumMetric(column));
        fieldSet.add(column);
      }
 else       if (function.equals("avg")) {
        metrics.add(new MeanMetric(column));
        fieldSet.add(column);
      }
 else       if (function.equals("count")) {
        metrics.add(new CountMetric());
      }
    }
  }
  return metrics.toArray(new Metric[metrics.size()]);
}
