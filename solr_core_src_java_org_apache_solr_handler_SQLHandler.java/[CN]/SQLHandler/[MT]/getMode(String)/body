{
  if (mode.equalsIgnoreCase("facet")) {
    return FACET;
  }
 else   if (mode.equalsIgnoreCase("map_reduce")) {
    return MAP_REDUCE;
  }
 else {
    throw new IOException("Invalid aggregation mode:" + mode);
  }
}
