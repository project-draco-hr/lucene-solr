{
  Comparator<Tuple>[] comps=new Comparator[sortItems.size()];
  for (int i=0; i < sortItems.size(); i++) {
    SortItem sortItem=sortItems.get(i);
    String ordering=sortItem.getOrdering().toString();
    ComparatorOrder comparatorOrder=ascDescComp(ordering);
    String sortKey=sortItem.getSortKey().toString();
    comps[i]=new FieldComparator(stripQuotes(sortKey),comparatorOrder);
  }
  if (comps.length == 1) {
    return comps[0];
  }
 else {
    return new MultiComp(comps);
  }
}
