{
  List<FieldComparator> adjustedSorts=new ArrayList();
  Set<String> bucketFields=new HashSet();
  Set<String> sortFields=new HashSet();
  for (  SortItem sortItem : sorts) {
    sortFields.add(getSortField(sortItem));
    adjustedSorts.add(new FieldComparator(getSortField(sortItem),ascDescComp(sortItem.getOrdering().toString())));
  }
  for (  Bucket bucket : buckets) {
    bucketFields.add(bucket.toString());
  }
  for (  SortItem sortItem : sorts) {
    String sortField=getSortField(sortItem);
    if (!bucketFields.contains(sortField)) {
      throw new IOException("All sort fields must be in the field list.");
    }
  }
  if (sorts.size() < buckets.length) {
    for (    Bucket bucket : buckets) {
      String b=bucket.toString();
      if (!sortFields.contains(b)) {
        adjustedSorts.add(new FieldComparator(bucket.toString(),ComparatorOrder.ASCENDING));
      }
    }
  }
  return adjustedSorts.toArray(new FieldComparator[adjustedSorts.size()]);
}
