{
  if (metrics.length != sqlVisitor.fields.size()) {
    throw new IOException("Only aggregate functions are allowed when group by is not specified.");
  }
  TableSpec tableSpec=new TableSpec(sqlVisitor.table,defaultZkhost);
  String zkHost=tableSpec.zkHost;
  String collection=tableSpec.collection;
  Map<String,String> params=new HashMap();
  params.put(CommonParams.Q,sqlVisitor.query);
  TupleStream tupleStream=new StatsStream(zkHost,collection,params,metrics);
  if (sqlVisitor.hasColumnAliases) {
    tupleStream=new SelectStream(tupleStream,sqlVisitor.columnAliases);
  }
  return tupleStream;
}
