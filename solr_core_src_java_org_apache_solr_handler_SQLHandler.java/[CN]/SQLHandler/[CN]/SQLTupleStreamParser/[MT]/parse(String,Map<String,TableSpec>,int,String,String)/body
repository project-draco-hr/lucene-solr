{
  SqlParser parser=new SqlParser();
  Statement statement=parser.createStatement(sql);
  SQLVisitor sqlVistor=new SQLVisitor(new StringBuilder());
  sqlVistor.process(statement,new Integer(0));
  TupleStream sqlStream=null;
  if (sqlVistor.groupByQuery) {
    sqlStream=doGroupBy(sqlVistor,tableMap,numWorkers,workerCollection,workerZkhost);
  }
 else {
    sqlStream=doSelect(sqlVistor,tableMap,numWorkers,workerCollection,workerZkhost);
  }
  return sqlStream;
}
