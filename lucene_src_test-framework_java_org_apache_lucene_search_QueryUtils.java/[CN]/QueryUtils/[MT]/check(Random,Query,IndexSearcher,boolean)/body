{
  try {
    check(q1);
    if (s != null) {
      checkFirstSkipTo(q1,s);
      checkSkipTo(q1,s);
      if (wrap) {
        IndexSearcher wrapped;
        check(random,q1,wrapped=wrapUnderlyingReader(random,s,-1),false);
        FieldCache.DEFAULT.purge(wrapped.getIndexReader());
        check(random,q1,wrapped=wrapUnderlyingReader(random,s,0),false);
        FieldCache.DEFAULT.purge(wrapped.getIndexReader());
        check(random,q1,wrapped=wrapUnderlyingReader(random,s,+1),false);
        FieldCache.DEFAULT.purge(wrapped.getIndexReader());
      }
      checkExplanations(q1,s);
      Query q2=(Query)q1.clone();
      checkEqual(s.rewrite(q1),s.rewrite(q2));
    }
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
}
