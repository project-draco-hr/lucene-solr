{
  List<TrackingShardHandlerFactory.ShardRequestAndParams> shardRequests=getShardRequests(zkStateReader,collectionName,shardId);
  List<TrackingShardHandlerFactory.ShardRequestAndParams> result=new ArrayList<>(1);
  for (  TrackingShardHandlerFactory.ShardRequestAndParams request : shardRequests) {
    if ((request.sreq.purpose & purpose) != 0) {
      result.add(request);
    }
  }
  if (result.size() > 1) {
    throw new RuntimeException("Multiple requests to the same shard with the same purpose were found. Requests: " + result);
  }
  return result.isEmpty() ? null : result.get(0);
}
