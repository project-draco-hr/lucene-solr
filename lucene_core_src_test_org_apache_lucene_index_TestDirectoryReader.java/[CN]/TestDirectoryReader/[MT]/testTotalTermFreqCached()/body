{
  Directory dir=newDirectory();
  IndexWriter writer=new IndexWriter(dir,newIndexWriterConfig(TEST_VERSION_CURRENT,new MockAnalyzer(random())));
  Document d=new Document();
  d.add(newTextField("f","a a b",Field.Store.NO));
  writer.addDocument(d);
  DirectoryReader r=writer.getReader();
  writer.close();
  try {
    Assume.assumeTrue(MultiFields.totalTermFreq(r,"f",new BytesRef("b")) != -1);
    assertEquals(1,MultiFields.totalTermFreq(r,"f",new BytesRef("b")));
    assertEquals(2,MultiFields.totalTermFreq(r,"f",new BytesRef("a")));
    assertEquals(1,MultiFields.totalTermFreq(r,"f",new BytesRef("b")));
  }
  finally {
    r.close();
    dir.close();
  }
}
