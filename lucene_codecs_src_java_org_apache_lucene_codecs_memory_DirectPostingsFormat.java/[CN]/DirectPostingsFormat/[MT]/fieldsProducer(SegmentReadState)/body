{
  FieldsProducer postings=PostingsFormat.forName("Lucene50").fieldsProducer(state);
  if (state.context.context != IOContext.Context.MERGE) {
    FieldsProducer loadedPostings;
    try {
      postings.checkIntegrity();
      loadedPostings=new DirectFields(state,postings,minSkipCount,lowFreqCutoff);
    }
  finally {
      postings.close();
    }
    return loadedPostings;
  }
 else {
    return postings;
  }
}
