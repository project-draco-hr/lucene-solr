{
  if (pulsed) {
    wrappedPostingsWriter.addPosition(position,payload);
  }
 else {
    Position pos=currentDoc.positions[currentDoc.numPositions++];
    pos.pos=position;
    if (payload != null && payload.length > 0) {
      if (pos.payload == null) {
        pos.payload=new BytesRef(payload);
      }
 else {
        pos.payload.copy(payload);
      }
    }
 else     if (pos.payload != null) {
      pos.payload.length=0;
    }
  }
}
