{
  Directory indexStore=newDirectory();
  RandomIndexWriter writer=new RandomIndexWriter(random(),indexStore);
  add("This is a test","object",writer);
  add("a note","note",writer);
  IndexReader reader=writer.getReader();
  IndexSearcher searcher=newSearcher(reader);
  searcher.setSimilarity(new ClassicSimilarity(){
    @Override public Explanation idfExplain(    CollectionStatistics collectionStats,    TermStatistics termStats[]){
      return Explanation.match(10f,"just a test");
    }
  }
);
  MultiPhraseQuery query=new MultiPhraseQuery();
  query.add(new Term[]{new Term("body","this"),new Term("body","that")});
  query.add(new Term("body","is"));
  Weight weight=query.createWeight(searcher,true);
  assertEquals(10f * 10f,weight.getValueForNormalization(),0.001f);
  writer.close();
  reader.close();
  indexStore.close();
}
