{
  int openParens=0;
  boolean isDoubleQuote=false;
  boolean isSingleQuote=false;
  boolean isEscaped=false;
  for (int idx=startingIdx; idx < clause.length(); ++idx) {
    char c=clause.charAt(idx);
    if (c == findThis && !isEscaped && !isSingleQuote && !isDoubleQuote && 0 == openParens) {
      return idx;
    }
switch (c) {
case '\\':
      isEscaped=!isEscaped;
    break;
case '"':
  if (!isEscaped && !isSingleQuote) {
    isDoubleQuote=!isDoubleQuote;
  }
isEscaped=false;
break;
case '\'':
if (!isEscaped && !isDoubleQuote) {
isSingleQuote=!isSingleQuote;
}
isEscaped=false;
break;
case '(':
if (!isEscaped && !isSingleQuote && !isDoubleQuote) {
openParens+=1;
}
isEscaped=false;
break;
case ')':
if (!isEscaped && !isSingleQuote && !isDoubleQuote) {
openParens-=1;
}
isEscaped=false;
break;
default :
isEscaped=false;
}
}
return -1;
}
