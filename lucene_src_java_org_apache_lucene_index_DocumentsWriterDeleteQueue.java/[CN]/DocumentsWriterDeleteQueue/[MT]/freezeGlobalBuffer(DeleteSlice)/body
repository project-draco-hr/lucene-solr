{
  globalBufferLock.lock();
  final Node currentTail=tail;
  if (callerSlice != null) {
    callerSlice.sliceTail=currentTail;
  }
  try {
    if (globalSlice.sliceTail != currentTail) {
      globalSlice.sliceTail=currentTail;
      globalSlice.apply(globalBufferedDeletes,BufferedDeletes.MAX_INT);
    }
    final FrozenBufferedDeletes packet=new FrozenBufferedDeletes(globalBufferedDeletes,false);
    globalBufferedDeletes.clear();
    return packet;
  }
  finally {
    globalBufferLock.unlock();
  }
}
