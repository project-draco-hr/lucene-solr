{
  testEquals(aprioriIndex,testIndex);
  IndexReader air=IndexReader.open(aprioriIndex,false);
  InstantiatedIndexReader tir=testIndex.indexReaderFactory();
  assertEquals(air.isCurrent(),tir.isCurrent());
  assertEquals(air.hasDeletions(),tir.hasDeletions());
  assertEquals(air.maxDoc(),tir.maxDoc());
  assertEquals(air.numDocs(),tir.numDocs());
  assertEquals(air.numDeletedDocs(),tir.numDeletedDocs());
  air.deleteDocument(3);
  tir.deleteDocument(3);
  assertEquals(air.isCurrent(),tir.isCurrent());
  assertEquals(air.hasDeletions(),tir.hasDeletions());
  assertEquals(air.maxDoc(),tir.maxDoc());
  assertEquals(air.numDocs(),tir.numDocs());
  assertEquals(air.numDeletedDocs(),tir.numDeletedDocs());
  air.deleteDocument(8);
  tir.deleteDocument(8);
  assertEquals(air.isCurrent(),tir.isCurrent());
  assertEquals(air.hasDeletions(),tir.hasDeletions());
  assertEquals(air.maxDoc(),tir.maxDoc());
  assertEquals(air.numDocs(),tir.numDocs());
  assertEquals(air.numDeletedDocs(),tir.numDeletedDocs());
  air.close();
  tir.close();
  air=IndexReader.open(aprioriIndex,false);
  tir=testIndex.indexReaderFactory();
  assertEquals(air.isCurrent(),tir.isCurrent());
  assertEquals(air.hasDeletions(),tir.hasDeletions());
  assertEquals(air.maxDoc(),tir.maxDoc());
  assertEquals(air.numDocs(),tir.numDocs());
  assertEquals(air.numDeletedDocs(),tir.numDeletedDocs());
  final Bits aDelDocs=MultiFields.getDeletedDocs(air);
  final Bits tDelDocs=MultiFields.getDeletedDocs(tir);
  assertTrue((aDelDocs != null && tDelDocs != null) || (aDelDocs == null && tDelDocs == null));
  if (aDelDocs != null) {
    for (int d=0; d < air.maxDoc(); d++) {
      assertEquals(aDelDocs.get(d),tDelDocs.get(d));
    }
  }
  air.close();
  tir.close();
  testEquals(aprioriIndex,testIndex);
}
