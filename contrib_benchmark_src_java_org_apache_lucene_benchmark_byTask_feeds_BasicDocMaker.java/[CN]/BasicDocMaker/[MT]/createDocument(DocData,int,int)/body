{
  int docid=incrNumDocsCreated();
  Document doc=new Document();
  doc.add(new Field("docid","doc" + docid,storeVal,indexVal,termVecVal));
  if (docData.name != null) {
    String name=(cnt < 0 ? docData.name : docData.name + "_" + cnt);
    doc.add(new Field("docname",name,storeVal,indexVal,termVecVal));
  }
  if (docData.date != null) {
    String dateStr=DateTools.dateToString(docData.date,DateTools.Resolution.SECOND);
    doc.add(new Field("docdate",dateStr,storeVal,indexVal,termVecVal));
  }
  if (docData.title != null) {
    doc.add(new Field("doctitle",docData.title,storeVal,indexVal,termVecVal));
  }
  if (docData.body != null && docData.body.length() > 0) {
    String bdy;
    if (size <= 0 || size >= docData.body.length()) {
      bdy=docData.body;
      docData.body="";
    }
 else {
      for (int n=size - 1; n < size + 20 && n < docData.body.length(); n++) {
        if (Character.isWhitespace(docData.body.charAt(n))) {
          size=n;
          break;
        }
      }
      bdy=docData.body.substring(0,size);
      docData.body=docData.body.substring(size);
    }
    doc.add(new Field(BODY_FIELD,bdy,storeVal,indexVal,termVecVal));
  }
  if (docData.props != null) {
    for (Iterator it=docData.props.keySet().iterator(); it.hasNext(); ) {
      String key=(String)it.next();
      String val=(String)docData.props.get(key);
      doc.add(new Field(key,val,storeVal,indexVal,termVecVal));
    }
    docData.props=null;
  }
  return doc;
}
