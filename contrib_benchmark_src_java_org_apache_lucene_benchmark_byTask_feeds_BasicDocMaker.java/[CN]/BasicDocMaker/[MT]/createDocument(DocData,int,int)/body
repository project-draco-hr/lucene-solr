{
  int docid=incrNumDocsCreated();
  Document doc=new Document();
  doc.add(new Field("docid","doc" + docid,storeVal,indexVal,termVecVal));
  if (docData.getName() != null) {
    String name=(cnt < 0 ? docData.getName() : docData.getName() + "_" + cnt);
    doc.add(new Field("docname",name,storeVal,indexVal,termVecVal));
  }
  if (docData.getDate() != null) {
    String dateStr=DateTools.dateToString(docData.getDate(),DateTools.Resolution.SECOND);
    doc.add(new Field("docdate",dateStr,storeVal,indexVal,termVecVal));
  }
  if (docData.getTitle() != null) {
    doc.add(new Field("doctitle",docData.getTitle(),storeVal,indexVal,termVecVal));
  }
  if (docData.getBody() != null && docData.getBody().length() > 0) {
    String bdy;
    if (size <= 0 || size >= docData.getBody().length()) {
      bdy=docData.getBody();
      docData.setBody("");
    }
 else {
      for (int n=size - 1; n < size + 20 && n < docData.getBody().length(); n++) {
        if (Character.isWhitespace(docData.getBody().charAt(n))) {
          size=n;
          break;
        }
      }
      bdy=docData.getBody().substring(0,size);
      docData.setBody(docData.getBody().substring(size));
    }
    doc.add(new Field(BODY_FIELD,bdy,storeVal,indexVal,termVecVal));
    if (storeBytes == true) {
      doc.add(new Field("bytes",bdy.getBytes("UTF-8"),Field.Store.YES));
    }
  }
  if (docData.getProps() != null) {
    for (Iterator it=docData.getProps().keySet().iterator(); it.hasNext(); ) {
      String key=(String)it.next();
      String val=(String)docData.getProps().get(key);
      doc.add(new Field(key,val,storeVal,indexVal,termVecVal));
    }
    docData.setProps(null);
  }
  return doc;
}
