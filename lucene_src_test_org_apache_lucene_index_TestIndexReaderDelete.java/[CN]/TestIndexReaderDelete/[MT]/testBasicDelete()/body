{
  Directory dir=newDirectory();
  IndexWriter writer=null;
  IndexReader reader=null;
  Term searchTerm=new Term("content","aaa");
  writer=new IndexWriter(dir,newIndexWriterConfig(TEST_VERSION_CURRENT,new MockAnalyzer(random)));
  for (int i=0; i < 100; i++) {
    addDoc(writer,searchTerm.text());
  }
  writer.close();
  reader=IndexReader.open(dir,false);
  assertEquals("first docFreq",100,reader.docFreq(searchTerm));
  assertTermDocsCount("first reader",reader,searchTerm,100);
  reader.close();
  int deleted=0;
  reader=IndexReader.open(dir,false);
  deleted=reader.deleteDocuments(searchTerm);
  assertEquals("deleted count",100,deleted);
  assertEquals("deleted docFreq",100,reader.docFreq(searchTerm));
  assertTermDocsCount("deleted termDocs",reader,searchTerm,0);
  IndexReader reader2=IndexReader.open(dir,false);
  reader.close();
  reader=IndexReader.open(dir,false);
  assertEquals("deleted docFreq",0,reader.docFreq(searchTerm));
  assertTermDocsCount("deleted termDocs",reader,searchTerm,0);
  reader.close();
  reader2.close();
  dir.close();
}
