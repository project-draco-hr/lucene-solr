def runAndSendGPGPassword(command, password):
    p = subprocess.Popen(command, shell=True, stdout=subprocess.PIPE, stderr=subprocess.STDOUT, stdin=subprocess.PIPE)
    f = open(LOG, 'ab')
    while True:
        line = p.stdout.readline()
        if (len(line) == 0):
            break
        f.write(line)
        if (line.find('Enter GPG keystore password:') != (-1)):
            time.sleep(1.0)
            p.stdin.write((password + '\n').encode('UTF-8'))
            p.stdin.write('\n'.encode('UTF-8'))
    result = p.poll()
    if (result != 0):
        msg = ('    FAILED: %s [see log %s]' % (command, LOG))
        print msg
        raise RuntimeError(msg)
