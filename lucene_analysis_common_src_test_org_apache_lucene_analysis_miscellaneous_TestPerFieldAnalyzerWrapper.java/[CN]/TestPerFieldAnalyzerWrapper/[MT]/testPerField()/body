{
  String text="Qwerty";
  Map<String,Analyzer> analyzerPerField=Collections.<String,Analyzer>singletonMap("special",new SimpleAnalyzer(TEST_VERSION_CURRENT));
  PerFieldAnalyzerWrapper analyzer=new PerFieldAnalyzerWrapper(new WhitespaceAnalyzer(TEST_VERSION_CURRENT),analyzerPerField);
  try (TokenStream tokenStream=analyzer.tokenStream("field",text)){
    CharTermAttribute termAtt=tokenStream.getAttribute(CharTermAttribute.class);
    tokenStream.reset();
    assertTrue(tokenStream.incrementToken());
    assertEquals("WhitespaceAnalyzer does not lowercase","Qwerty",termAtt.toString());
    assertFalse(tokenStream.incrementToken());
    tokenStream.end();
  }
   try (TokenStream tokenStream=analyzer.tokenStream("special",text)){
    CharTermAttribute termAtt=tokenStream.getAttribute(CharTermAttribute.class);
    tokenStream.reset();
    assertTrue(tokenStream.incrementToken());
    assertEquals("SimpleAnalyzer lowercases","qwerty",termAtt.toString());
    assertFalse(tokenStream.incrementToken());
    tokenStream.end();
  }
 }
