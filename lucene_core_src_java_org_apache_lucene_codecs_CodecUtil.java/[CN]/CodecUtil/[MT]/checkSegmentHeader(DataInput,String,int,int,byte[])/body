{
  int version=checkHeader(in,codec,minVersion,maxVersion);
  byte id[]=new byte[StringHelper.ID_LENGTH];
  in.readBytes(id,0,id.length);
  if (!Arrays.equals(id,segmentID)) {
    throw new CorruptIndexException("file mismatch, expected segment id=" + StringHelper.idToString(segmentID) + ", got="+ StringHelper.idToString(id),in);
  }
  return version;
}
