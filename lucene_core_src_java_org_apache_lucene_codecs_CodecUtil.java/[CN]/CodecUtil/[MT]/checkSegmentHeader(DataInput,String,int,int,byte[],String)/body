{
  int version=checkHeader(in,codec,minVersion,maxVersion);
  byte id[]=new byte[StringHelper.ID_LENGTH];
  in.readBytes(id,0,id.length);
  if (!Arrays.equals(id,segmentID)) {
    throw new CorruptIndexException("file mismatch, expected segment id=" + StringHelper.idToString(segmentID) + ", got="+ StringHelper.idToString(id),in);
  }
  int suffixLength=in.readByte() & 0xFF;
  byte suffixBytes[]=new byte[suffixLength];
  in.readBytes(suffixBytes,0,suffixBytes.length);
  String suffix=new String(suffixBytes,0,suffixBytes.length,StandardCharsets.UTF_8);
  if (!suffix.equals(segmentSuffix)) {
    throw new CorruptIndexException("file mismatch, expected segment suffix=" + segmentSuffix + ", got="+ suffix,in);
  }
  return version;
}
