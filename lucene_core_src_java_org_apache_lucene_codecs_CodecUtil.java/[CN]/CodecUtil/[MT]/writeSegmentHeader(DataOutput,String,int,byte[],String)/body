{
  if (segmentID.length != StringHelper.ID_LENGTH) {
    throw new IllegalArgumentException("Invalid id: " + StringHelper.idToString(segmentID));
  }
  writeHeader(out,codec,version);
  out.writeBytes(segmentID,0,segmentID.length);
  BytesRef suffixBytes=new BytesRef(segmentSuffix);
  if (suffixBytes.length != segmentSuffix.length() || suffixBytes.length >= 256) {
    throw new IllegalArgumentException("codec must be simple ASCII, less than 256 characters in length [got " + segmentSuffix + "]");
  }
  out.writeByte((byte)suffixBytes.length);
  out.writeBytes(suffixBytes.bytes,suffixBytes.offset,suffixBytes.length);
}
