{
  validateFooter(in);
  long actualChecksum=in.getChecksum();
  long expectedChecksum=readCRC(in);
  if (expectedChecksum != actualChecksum) {
    throw new CorruptIndexException("checksum failed (hardware problem?) : expected=" + Long.toHexString(expectedChecksum) + " actual="+ Long.toHexString(actualChecksum),in);
  }
  return actualChecksum;
}
