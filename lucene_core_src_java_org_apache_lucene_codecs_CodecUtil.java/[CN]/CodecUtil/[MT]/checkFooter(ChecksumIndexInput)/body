{
  validateFooter(in);
  long actualChecksum=in.getChecksum();
  long expectedChecksum=in.readLong();
  if (expectedChecksum != actualChecksum) {
    throw new CorruptIndexException("checksum failed (hardware problem?) : expected=" + Long.toHexString(expectedChecksum) + " actual="+ Long.toHexString(actualChecksum)+ " (resource="+ in+ ")");
  }
  if (in.getFilePointer() != in.length()) {
    throw new CorruptIndexException("did not read all bytes from file: read " + in.getFilePointer() + " vs size "+ in.length()+ " (resource: "+ in+ ")");
  }
  return actualChecksum;
}
