{
  if (in.length() < footerLength() + headerLength("")) {
    throw new CorruptIndexException("compound sub-files must have a valid codec header and footer: file is too small (" + in.length() + " bytes)",in);
  }
  int actualHeader=in.readInt();
  if (actualHeader != CODEC_MAGIC) {
    throw new CorruptIndexException("compound sub-files must have a valid codec header and footer: codec header mismatch: actual header=" + actualHeader + " vs expected header="+ CodecUtil.CODEC_MAGIC,in);
  }
  String codec=in.readString();
  int version=in.readInt();
  checkIndexHeaderID(in,expectedID);
  int suffixLength=in.readByte() & 0xFF;
  byte[] suffixBytes=new byte[suffixLength];
  in.readBytes(suffixBytes,0,suffixLength);
  out.writeInt(CodecUtil.CODEC_MAGIC);
  out.writeString(codec);
  out.writeInt(version);
  out.writeBytes(expectedID,0,expectedID.length);
  out.writeByte((byte)suffixLength);
  out.writeBytes(suffixBytes,0,suffixLength);
}
