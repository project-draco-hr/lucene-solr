{
  in.seek(0);
  final int actualHeader=in.readInt();
  if (actualHeader != CODEC_MAGIC) {
    throw new CorruptIndexException("codec header mismatch: actual header=" + actualHeader + " vs expected header="+ CODEC_MAGIC,in);
  }
  String codec=in.readString();
  in.readInt();
  in.seek(in.getFilePointer() + StringHelper.ID_LENGTH);
  int suffixLength=in.readByte() & 0xFF;
  byte[] bytes=new byte[headerLength(codec) + StringHelper.ID_LENGTH + 1+ suffixLength];
  in.seek(0);
  in.readBytes(bytes,0,bytes.length);
  return bytes;
}
