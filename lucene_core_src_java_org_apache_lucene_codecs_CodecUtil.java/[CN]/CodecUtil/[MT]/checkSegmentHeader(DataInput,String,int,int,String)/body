{
  int version=checkHeader(in,codec,minVersion,maxVersion);
  String id=in.readString();
  if (!id.equals(segmentID)) {
    throw new CorruptIndexException("file mismatch, expected segment id=" + segmentID + ", got="+ id,in);
  }
  return version;
}
