{
  if (scorer.docID() == -1) {
    scorer.nextDoc();
  }
  FakeScorer fake=new FakeScorer();
  collector.setScorer(fake);
  final int bufferSize=1 + random.nextInt(100);
  final int[] docIDs=new int[bufferSize];
  final float[] scores=new float[bufferSize];
  final int[] freqs=new int[bufferSize];
  int buffered=0;
  int doc=scorer.docID();
  while (doc < max) {
    docIDs[buffered]=doc;
    scores[buffered]=scorer.score();
    freqs[buffered]=scorer.freq();
    if (++buffered == bufferSize) {
      shuffle(docIDs,scores,freqs,buffered);
      flush(docIDs,scores,freqs,buffered,fake,collector);
      buffered=0;
    }
    doc=scorer.nextDoc();
  }
  shuffle(docIDs,scores,freqs,buffered);
  flush(docIDs,scores,freqs,buffered,fake,collector);
  return doc != Scorer.NO_MORE_DOCS;
}
