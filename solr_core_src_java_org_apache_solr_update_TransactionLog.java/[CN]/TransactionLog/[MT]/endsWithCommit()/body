{
  long size;
synchronized (this) {
    fos.flush();
    size=fos.size();
  }
  byte[] buf=new byte[END_MESSAGE.length()];
  long pos=size - END_MESSAGE.length() - 4;
  if (pos < 0)   return false;
  ChannelFastInputStream is=new ChannelFastInputStream(channel,pos);
  is.read(buf);
  for (int i=0; i < buf.length; i++) {
    if (buf[i] != END_MESSAGE.charAt(i))     return false;
  }
  return true;
}
