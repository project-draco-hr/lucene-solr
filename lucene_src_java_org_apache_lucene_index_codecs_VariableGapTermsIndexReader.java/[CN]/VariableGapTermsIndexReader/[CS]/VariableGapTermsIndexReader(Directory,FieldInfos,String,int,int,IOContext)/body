{
  in=dir.openInput(IndexFileNames.segmentFileName(segment,codecId,VariableGapTermsIndexWriter.TERMS_INDEX_EXTENSION),context);
  this.segment=segment;
  boolean success=false;
  try {
    readHeader(in);
    this.indexDivisor=indexDivisor;
    seekDir(in,dirOffset);
    final int numFields=in.readVInt();
    for (int i=0; i < numFields; i++) {
      final int field=in.readVInt();
      final long indexStart=in.readVLong();
      final FieldInfo fieldInfo=fieldInfos.fieldInfo(field);
      fields.put(fieldInfo,new FieldIndexData(fieldInfo,indexStart));
    }
    success=true;
  }
  finally {
    if (indexDivisor > 0) {
      in.close();
      in=null;
      if (success) {
        indexLoaded=true;
      }
    }
  }
}
