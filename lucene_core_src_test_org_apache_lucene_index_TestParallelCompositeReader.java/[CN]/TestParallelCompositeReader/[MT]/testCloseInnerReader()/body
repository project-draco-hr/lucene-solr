{
  Directory dir1=getDir1(random());
  CompositeReader ir1=DirectoryReader.open(dir1);
  assertEquals(1,ir1.getSequentialSubReaders().get(0).getRefCount());
  ParallelCompositeReader pr=new ParallelCompositeReader(true,new CompositeReader[]{ir1},new CompositeReader[]{ir1});
  IndexReader psub=pr.getSequentialSubReaders().get(0);
  assertEquals(1,psub.getRefCount());
  ir1.close();
  assertEquals("refCount of synthetic subreader should be unchanged",1,psub.getRefCount());
  try {
    psub.document(0);
    fail("Subreader should be already closed because inner reader was closed!");
  }
 catch (  AlreadyClosedException e) {
  }
  try {
    pr.document(0);
    fail("ParallelCompositeReader should be already closed because inner reader was closed!");
  }
 catch (  AlreadyClosedException e) {
  }
  pr.close();
  assertEquals(0,psub.getRefCount());
  dir1.close();
}
