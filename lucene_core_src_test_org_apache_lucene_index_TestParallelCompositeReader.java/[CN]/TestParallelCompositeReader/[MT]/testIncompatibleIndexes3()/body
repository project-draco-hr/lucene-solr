{
  Directory dir1=getDir1(random);
  Directory dir2=getDir2(random);
  CompositeReader ir1=new MultiReader(DirectoryReader.open(dir1),SlowCompositeReaderWrapper.wrap(DirectoryReader.open(dir1))), ir2=new MultiReader(DirectoryReader.open(dir2),DirectoryReader.open(dir2));
  CompositeReader[] readers=new CompositeReader[]{ir1,ir2};
  try {
    new ParallelCompositeReader(readers);
    fail("didn't get expected exception: indexes don't have same subreader structure");
  }
 catch (  IllegalArgumentException e) {
  }
  try {
    new ParallelCompositeReader(random.nextBoolean(),readers,readers);
    fail("didn't get expected exception: indexes don't have same subreader structure");
  }
 catch (  IllegalArgumentException e) {
  }
  assertEquals(1,ir1.getRefCount());
  assertEquals(1,ir2.getRefCount());
  ir1.close();
  ir2.close();
  assertEquals(0,ir1.getRefCount());
  assertEquals(0,ir2.getRefCount());
  dir1.close();
  dir2.close();
}
