{
  Directory dir1=getDir1(random());
  CompositeReader ir1=DirectoryReader.open(dir1);
  ParallelCompositeReader pr=new ParallelCompositeReader(false,new CompositeReader[]{ir1},new CompositeReader[]{ir1});
  final int[] listenerClosedCount=new int[1];
  assertEquals(3,pr.leaves().size());
  for (  LeafReaderContext cxt : pr.leaves()) {
    cxt.reader().addReaderClosedListener(new ReaderClosedListener(){
      @Override public void onClose(      IndexReader reader){
        listenerClosedCount[0]++;
      }
    }
);
  }
  pr.close();
  ir1.close();
  assertEquals(3,listenerClosedCount[0]);
  dir1.close();
}
