{
  Directory directory=newDirectory();
  IndexWriter writer=new IndexWriter(directory,newIndexWriterConfig(TEST_VERSION_CURRENT,new MockAnalyzer(random)).setMaxBufferedDocs(2).setMergePolicy(newLogMergePolicy(1000)).setSimilarityProvider(new DefaultSimilarityProvider()));
  writer.addDocument(adoc(new String[]{"id","a","title","ipod","str_s","a"}));
  writer.addDocument(adoc(new String[]{"id","b","title","ipod ipod","str_s","b"}));
  writer.addDocument(adoc(new String[]{"id","c","title","ipod ipod ipod","str_s","c"}));
  writer.addDocument(adoc(new String[]{"id","x","title","boosted","str_s","x"}));
  writer.addDocument(adoc(new String[]{"id","y","title","boosted boosted","str_s","y"}));
  writer.addDocument(adoc(new String[]{"id","z","title","boosted boosted boosted","str_s","z"}));
  IndexReader r=IndexReader.open(writer,true);
  writer.close();
  IndexSearcher searcher=newSearcher(r);
  searcher.setSimilarityProvider(new DefaultSimilarityProvider());
  runTest(searcher,true);
  runTest(searcher,false);
  searcher.close();
  r.close();
  directory.close();
}
