{
  Exception ex=null;
  try {
    rsp.rsp=server.request(req.getRequest());
    if (isZombie) {
      zombieServers.remove(zombieKey);
    }
  }
 catch (  SolrException e) {
    if (!isUpdate && RETRY_CODES.contains(e.code())) {
      ex=(!isZombie) ? addZombie(server,e) : e;
    }
 else {
      if (isZombie) {
        zombieServers.remove(zombieKey);
      }
      throw e;
    }
  }
catch (  SocketException e) {
    if (!isUpdate || e instanceof ConnectException) {
      ex=(!isZombie) ? addZombie(server,e) : e;
    }
 else {
      throw e;
    }
  }
catch (  SocketTimeoutException e) {
    if (!isUpdate) {
      ex=(!isZombie) ? addZombie(server,e) : e;
    }
 else {
      throw e;
    }
  }
catch (  SolrServerException e) {
    Throwable rootCause=e.getRootCause();
    if (!isUpdate && rootCause instanceof IOException) {
      ex=(!isZombie) ? addZombie(server,e) : e;
    }
 else     if (isUpdate && rootCause instanceof ConnectException) {
      ex=(!isZombie) ? addZombie(server,e) : e;
    }
 else {
      throw e;
    }
  }
catch (  Exception e) {
    throw new SolrServerException(e);
  }
  return ex;
}
