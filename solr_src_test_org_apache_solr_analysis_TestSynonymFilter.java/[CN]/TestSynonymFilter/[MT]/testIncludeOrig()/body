{
  SynonymMap map=new SynonymMap();
  boolean orig=true;
  boolean merge=true;
  map.add(strings("a b"),tokens("ab"),orig,merge);
  map.add(strings("a c"),tokens("ac"),orig,merge);
  map.add(strings("a"),tokens("aa"),orig,merge);
  map.add(strings("b"),tokens("bb"),orig,merge);
  map.add(strings("z x c v"),tokens("zxcv"),orig,merge);
  map.add(strings("x c"),tokens("xc"),orig,merge);
  assertTokenizesTo(map,"$",new String[]{"$"},new int[]{1});
  assertTokenizesTo(map,"a",new String[]{"a","aa"},new int[]{1,0});
  assertTokenizesTo(map,"a",new String[]{"a","aa"},new int[]{1,0});
  assertTokenizesTo(map,"$ a",new String[]{"$","a","aa"},new int[]{1,1,0});
  assertTokenizesTo(map,"a $",new String[]{"a","aa","$"},new int[]{1,0,1});
  assertTokenizesTo(map,"$ a !",new String[]{"$","a","aa","!"},new int[]{1,1,0,1});
  assertTokenizesTo(map,"a a",new String[]{"a","aa","a","aa"},new int[]{1,0,1,0});
  assertTokenizesTo(map,"b",new String[]{"b","bb"},new int[]{1,0});
  assertTokenizesTo(map,"z x c v",new String[]{"z","zxcv","x","c","v"},new int[]{1,0,1,1,1});
  assertTokenizesTo(map,"z x c $",new String[]{"z","x","xc","c","$"},new int[]{1,1,0,1,1});
  map.add(strings("zoo zoo"),tokens("zoo"),orig,merge);
  assertTokenizesTo(map,"zoo zoo $ zoo",new String[]{"zoo","zoo","zoo","$","zoo"},new int[]{1,0,1,1,1});
  map.add(strings("zoo"),tokens("zoo zoo"),orig,merge);
  assertTokenizesTo(map,"zoo zoo $ zoo",new String[]{"zoo","zoo","zoo","$","zoo","zoo","zoo"},new int[]{1,0,1,1,1,0,1});
}
