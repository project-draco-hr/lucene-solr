{
  if (isLocked()) {
    try {
      lock.release();
    }
  finally {
      lock=null;
      try {
        channel.close();
      }
  finally {
        channel=null;
        try {
          f.close();
        }
  finally {
          f=null;
synchronized (LOCK_HELD) {
            LOCK_HELD.remove(path.getCanonicalPath());
          }
        }
      }
    }
    if (!path.delete())     throw new LockReleaseFailedException("failed to delete " + path);
  }
}
