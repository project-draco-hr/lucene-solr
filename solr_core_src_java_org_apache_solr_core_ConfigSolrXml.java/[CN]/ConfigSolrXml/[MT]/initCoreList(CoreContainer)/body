{
  if (is50OrLater) {
    if (container != null) {
synchronized (coreDescriptorPlusMap) {
        String coreRoot=get(CfgProp.SOLR_COREROOTDIRECTORY,container.getSolrHome());
        walkFromHere(new File(coreRoot),container,new HashMap<String,String>(),new HashMap<String,String>());
      }
    }
  }
 else {
    coreNodes=(NodeList)evaluate("solr/cores/core",XPathConstants.NODESET);
    Set<String> names=new HashSet<String>();
    Map<String,String> dirs=new HashMap<String,String>();
    for (int idx=0; idx < coreNodes.getLength(); ++idx) {
      Node node=coreNodes.item(idx);
      String name=DOMUtil.getAttr(node,CoreDescriptor.CORE_NAME,null);
      String dataDir=DOMUtil.getAttr(node,CoreDescriptor.CORE_DATADIR,null);
      if (name != null) {
        if (!names.contains(name)) {
          names.add(name);
        }
 else {
          String msg=String.format(Locale.ROOT,"More than one core defined for core named %s",name);
          log.error(msg);
        }
      }
      if (dataDir != null) {
        if (!dirs.containsKey(dataDir)) {
          dirs.put(dataDir,name);
        }
 else {
          String msg=String.format(Locale.ROOT,"More than one core points to data dir %s. They are in %s and %s",dataDir,dirs.get(dataDir),name);
          log.warn(msg);
        }
      }
    }
  }
}
