{
  final int maxDoc=reader.maxDoc();
  int docCount=0;
  if (matchingFieldsReader != null) {
    while (docCount < maxDoc) {
      int len=Math.min(MAX_RAW_MERGE_DOCS,maxDoc - docCount);
      IndexInput stream=matchingFieldsReader.rawDocs(rawDocLengths,docCount,len);
      addRawDocuments(stream,rawDocLengths,len);
      docCount+=len;
      mergeState.checkAbort.work(300 * len);
    }
  }
 else {
    for (; docCount < maxDoc; docCount++) {
      StoredDocument doc=reader.document(docCount);
      addDocument(doc,mergeState.fieldInfos);
      mergeState.checkAbort.work(300);
    }
  }
  return docCount;
}
