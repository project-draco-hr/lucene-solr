{
  if (log.isInfoEnabled()) {
    log.info("Watcher " + this + " name:"+ name+ " got event "+ event+ " path:"+ event.getPath()+ " type:"+ event.getType());
  }
  state=event.getState();
  if (state == KeeperState.SyncConnected) {
    connected=true;
    clientConnected.countDown();
  }
 else   if (state == KeeperState.Expired) {
    connected=false;
    log.info("Attempting to reconnect to ZooKeeper...");
    try {
      connectionStrategy.reconnect(zkServerAddress,zkClientTimeout,this,new ZkClientConnectionStrategy.ZkUpdate(){
        @Override public void update(        SolrZooKeeper keeper) throws InterruptedException, TimeoutException, IOException {
          waitForConnected(SolrZkClient.DEFAULT_CLIENT_CONNECT_TIMEOUT);
          client.updateKeeper(keeper);
          if (onReconnect != null) {
            onReconnect.command();
          }
          ConnectionManager.this.connected=true;
        }
      }
);
    }
 catch (    Exception e) {
      log.error("",e);
    }
    log.info("Connected:" + connected);
  }
 else   if (state == KeeperState.Disconnected) {
    connected=false;
  }
 else {
    connected=false;
  }
  notifyAll();
}
