{
  testDir=baseDir;
  String zkDir=testDir.getAbsolutePath() + File.separator + "zookeeper/server1/data";
  zkServer=new ZkTestServer(zkDir);
  zkServer.run();
  try (SolrZkClient zkClient=new SolrZkClient(zkServer.getZkHost(),AbstractZkTestCase.TIMEOUT,45000,null)){
    zkClient.makePath("/solr/solr.xml",solrXml,false,true);
  }
   System.setProperty("solr.solrxml.location","zookeeper");
  System.setProperty("zkHost",zkServer.getZkAddress());
  jettys=new LinkedList<JettySolrRunner>();
  for (int i=0; i < numServers; ++i) {
    if (sslConfig == null) {
      startJettySolrRunner(hostContext,extraServlets,extraRequestFilters);
    }
 else {
      startJettySolrRunner(hostContext,extraServlets,extraRequestFilters,sslConfig);
    }
  }
  solrClient=buildSolrClient();
}
