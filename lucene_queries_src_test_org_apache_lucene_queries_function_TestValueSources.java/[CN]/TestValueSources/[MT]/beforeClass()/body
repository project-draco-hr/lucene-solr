{
  dir=newDirectory();
  analyzer=new MockAnalyzer(random());
  IndexWriterConfig iwConfig=newIndexWriterConfig(analyzer);
  iwConfig.setMergePolicy(newLogMergePolicy());
  RandomIndexWriter iw=new RandomIndexWriter(random(),dir,iwConfig);
  Document document=new Document();
  Field idField=new StringField("id","",Field.Store.NO);
  document.add(idField);
  Field idDVField=new SortedDocValuesField("id",new BytesRef());
  document.add(idDVField);
  Field doubleDVField=new NumericDocValuesField("double",0);
  document.add(doubleDVField);
  Field floatDVField=new NumericDocValuesField("float",0);
  document.add(floatDVField);
  Field intDVField=new NumericDocValuesField("int",0);
  document.add(intDVField);
  Field longDVField=new NumericDocValuesField("long",0);
  document.add(longDVField);
  Field stringField=new StringField("string","",Field.Store.NO);
  document.add(stringField);
  Field stringDVField=new SortedDocValuesField("string",new BytesRef());
  document.add(stringDVField);
  Field textField=new TextField("text","",Field.Store.NO);
  document.add(textField);
  for (  String[] doc : documents) {
    idField.setStringValue(doc[0]);
    idDVField.setBytesValue(new BytesRef(doc[0]));
    doubleDVField.setLongValue(Double.doubleToRawLongBits(Double.valueOf(doc[1])));
    floatDVField.setLongValue(Float.floatToRawIntBits(Float.valueOf(doc[2])));
    intDVField.setLongValue(Integer.valueOf(doc[3]));
    longDVField.setLongValue(Long.valueOf(doc[4]));
    stringField.setStringValue(doc[5]);
    stringDVField.setBytesValue(new BytesRef(doc[5]));
    textField.setStringValue(doc[6]);
    iw.addDocument(document);
  }
  reader=iw.getReader();
  searcher=newSearcher(reader);
  iw.close();
}
