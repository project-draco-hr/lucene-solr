{
  dir=newDirectory();
  IndexWriterConfig iwConfig=newIndexWriterConfig(TEST_VERSION_CURRENT,new MockAnalyzer(random()));
  iwConfig.setMergePolicy(newLogMergePolicy());
  RandomIndexWriter iw=new RandomIndexWriter(random(),dir,iwConfig);
  Document document=new Document();
  Field idField=new StringField("id","",Field.Store.NO);
  document.add(idField);
  Field doubleField=new DoubleField("double",0d,Field.Store.NO);
  document.add(doubleField);
  Field floatField=new FloatField("float",0f,Field.Store.NO);
  document.add(floatField);
  Field intField=new IntField("int",0,Field.Store.NO);
  document.add(intField);
  Field longField=new LongField("long",0L,Field.Store.NO);
  document.add(longField);
  Field stringField=new StringField("string","",Field.Store.NO);
  document.add(stringField);
  Field textField=new TextField("text","",Field.Store.NO);
  document.add(textField);
  for (  String[] doc : documents) {
    idField.setStringValue(doc[0]);
    doubleField.setDoubleValue(Double.valueOf(doc[1]));
    floatField.setFloatValue(Float.valueOf(doc[2]));
    intField.setIntValue(Integer.valueOf(doc[3]));
    longField.setLongValue(Long.valueOf(doc[4]));
    stringField.setStringValue(doc[5]);
    textField.setStringValue(doc[6]);
    iw.addDocument(document);
  }
  reader=iw.getReader();
  searcher=newSearcher(reader);
  iw.close();
}
