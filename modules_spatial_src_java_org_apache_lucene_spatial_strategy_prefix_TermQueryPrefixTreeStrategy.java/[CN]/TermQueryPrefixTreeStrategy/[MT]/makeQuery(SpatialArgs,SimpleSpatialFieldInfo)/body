{
  if (args.getOperation() != SpatialOperation.Intersects && args.getOperation() != SpatialOperation.IsWithin && args.getOperation() != SpatialOperation.Overlaps) {
    throw new UnsupportedSpatialOperation(args.getOperation());
  }
  Shape qshape=args.getShape();
  int detailLevel=grid.getMaxLevelForPrecision(qshape,args.getDistPrecision());
  List<Node> cells=grid.getNodes(qshape,detailLevel,false);
  BooleanQuery booleanQuery=new BooleanQuery();
  for (  Node cell : cells) {
    booleanQuery.add(new TermQuery(new Term(fieldInfo.getFieldName(),cell.getTokenString())),BooleanClause.Occur.SHOULD);
  }
  return booleanQuery;
}
