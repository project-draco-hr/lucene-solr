{
  final ShapeFieldCache<Point> cache=provider.getCache(readerContext.reader());
  return new FunctionValues(){
    @Override public float floatVal(    int doc){
      return (float)doubleVal(doc);
    }
    @Override public double doubleVal(    int doc){
      List<Point> vals=cache.getShapes(doc);
      if (vals != null) {
        double v=calculator.distance(from,vals.get(0));
        for (int i=1; i < vals.size(); i++) {
          v=Math.min(v,calculator.distance(from,vals.get(i)));
        }
        return v;
      }
      return Double.NaN;
    }
    @Override public String toString(    int doc){
      return description() + "=" + floatVal(doc);
    }
  }
;
}
