{
  HashMap<State,Set<State>> map=new HashMap<State,Set<State>>();
  for (  State s : states)   map.put(s,new HashSet<State>());
  for (  State s : states)   for (  Transition t : s.transitions)   map.get(t.to).add(s);
  Set<State> live=new HashSet<State>(getAcceptStates());
  LinkedList<State> worklist=new LinkedList<State>(live);
  while (worklist.size() > 0) {
    State s=worklist.removeFirst();
    for (    State p : map.get(s))     if (!live.contains(p)) {
      live.add(p);
      worklist.add(p);
    }
  }
  return live;
}
