{
  try {
    Automaton a=(Automaton)super.clone();
    if (!isSingleton()) {
      HashMap<State,State> m=new HashMap<State,State>();
      State[] states=getNumberedStates();
      for (      State s : states)       m.put(s,new State());
      for (      State s : states) {
        State p=m.get(s);
        p.accept=s.accept;
        if (s == initial)         a.initial=p;
        for (        Transition t : s.getTransitions())         p.addTransition(new Transition(t.min,t.max,m.get(t.to)));
      }
    }
    a.clearNumberedStates();
    return a;
  }
 catch (  CloneNotSupportedException e) {
    throw new RuntimeException(e);
  }
}
