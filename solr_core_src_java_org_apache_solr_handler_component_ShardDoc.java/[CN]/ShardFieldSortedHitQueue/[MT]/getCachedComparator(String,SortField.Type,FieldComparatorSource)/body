{
  Comparator comparator=null;
switch (type) {
case SCORE:
    comparator=comparatorScore(fieldname);
  break;
case STRING:
comparator=comparatorNatural(fieldname);
break;
case CUSTOM:
if (factory instanceof MissingStringLastComparatorSource) {
comparator=comparatorMissingStringLast(fieldname);
}
 else {
comparator=comparatorNatural(fieldname);
}
break;
case DOC:
throw new RuntimeException("Doc sort not supported");
default :
comparator=comparatorNatural(fieldname);
break;
}
return comparator;
}
