{
  Tuple tuple=tupleSource.read();
  if (tuple.EOF) {
    if (docsSinceCommit > 0) {
      sendCommit();
    }
  }
 else {
    if (tuple.fields.containsKey(UpdateStream.BATCH_INDEXED_FIELD_NAME) && isInteger(tuple.getString(UpdateStream.BATCH_INDEXED_FIELD_NAME))) {
      docsSinceCommit+=Integer.parseInt(tuple.getString(UpdateStream.BATCH_INDEXED_FIELD_NAME));
    }
 else {
      docsSinceCommit+=1;
    }
    if (commitBatchSize > 0 && docsSinceCommit >= commitBatchSize) {
      sendCommit();
    }
  }
  return tuple;
}
