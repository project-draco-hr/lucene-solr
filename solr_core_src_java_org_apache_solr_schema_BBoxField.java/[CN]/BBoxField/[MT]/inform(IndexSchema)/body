{
  this.schema=schema;
  FieldType numberType=schema.getFieldTypeByName(numberFieldName);
  FieldType booleanType=schema.getFieldTypeByName(booleanFieldName);
  if (numberType == null) {
    throw new RuntimeException("Cannot find number fieldType: " + numberFieldName);
  }
  if (booleanType == null) {
    throw new RuntimeException("Cannot find boolean fieldType: " + booleanFieldName);
  }
  if (!(booleanType instanceof BoolField)) {
    throw new RuntimeException("Must be a BoolField: " + booleanType);
  }
  if (!(numberType instanceof TrieDoubleField)) {
    throw new RuntimeException("Must be TrieDoubleField: " + numberType);
  }
  List<SchemaField> fields=new ArrayList<>(schema.getFields().values());
  for (  SchemaField sf : fields) {
    if (sf.getType() == this) {
      String name=sf.getName();
      register(schema,name + BBoxStrategy.SUFFIX_MINX,numberType);
      register(schema,name + BBoxStrategy.SUFFIX_MAXX,numberType);
      register(schema,name + BBoxStrategy.SUFFIX_MINY,numberType);
      register(schema,name + BBoxStrategy.SUFFIX_MAXY,numberType);
      register(schema,name + BBoxStrategy.SUFFIX_XDL,booleanType);
    }
  }
}
