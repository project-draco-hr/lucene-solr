{
  Map<String,CoreContainer.CoreLoadFailure> failures=null;
  Collection<String> cores=null;
  Exception fail=null;
  init("java_lang_error_handler");
  File solrXml=new File(solrHome,"solr.xml");
  FileUtils.write(solrXml,BAD_SOLR_XML,IOUtils.UTF_8);
  FileUtils.copyFile(getFile("solr/collection1/conf/solrconfig-defaults.xml"),FileUtils.getFile(solrHome,"col_ok","conf","solrconfig.xml"));
  FileUtils.copyFile(getFile("solr/collection1/conf/schema-minimal.xml"),FileUtils.getFile(solrHome,"col_ok","conf","schema.xml"));
  ignoreException(Pattern.quote("my_error_handler"));
  FileUtils.copyFile(getFile("solr/collection1/conf/bad-error-solrconfig.xml"),FileUtils.getFile(solrHome,"col_bad","conf","solrconfig.xml"));
  FileUtils.copyFile(getFile("solr/collection1/conf/schema-minimal.xml"),FileUtils.getFile(solrHome,"col_bad","conf","schema.xml"));
  cc=new CoreContainer(solrHome.getAbsolutePath());
  cc.load();
  cores=cc.getCoreNames();
  assertNotNull("core names is null",cores);
  assertEquals("wrong number of cores",1,cores.size());
  assertTrue("col_ok not found",cores.contains("col_ok"));
  failures=cc.getCoreInitFailures();
  assertNotNull("core failures is a null map",failures);
  assertEquals("wrong number of core failures",1,failures.size());
  fail=failures.get("col_bad").exception;
  assertNotNull("null failure for test core",fail);
  assertTrue("init failure doesn't mention root problem: " + fail.getMessage(),0 < fail.getMessage().indexOf("throwing a java.lang.Error"));
}
