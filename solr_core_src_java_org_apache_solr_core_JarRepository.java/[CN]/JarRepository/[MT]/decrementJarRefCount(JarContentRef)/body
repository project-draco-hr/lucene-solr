{
  if (ref == null)   return;
synchronized (ref.jar.references) {
    if (!ref.jar.references.remove(ref)) {
      log.error("Multiple releases for the same reference");
    }
    if (ref.jar.references.isEmpty()) {
      jars.remove(ref.jar.key);
    }
  }
}
