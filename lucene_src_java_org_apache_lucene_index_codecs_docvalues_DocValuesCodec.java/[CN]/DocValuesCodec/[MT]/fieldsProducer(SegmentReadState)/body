{
  final FieldInfos fieldInfos=state.fieldInfos;
  boolean indexed=false;
  boolean docValues=false;
  for (  FieldInfo fieldInfo : fieldInfos) {
    if (fieldInfo.getCodecId() == state.codecId) {
      indexed|=fieldInfo.isIndexed;
      docValues|=fieldInfo.hasDocValues();
      if (indexed && docValues)       break;
    }
  }
  final FieldsProducer indexedProducer=indexed ? other.fieldsProducer(state) : FieldsProducer.EMPTY;
  if (docValues) {
    return new WrappingFielsdProducer(state,indexedProducer);
  }
 else {
    return FieldsProducer.EMPTY;
  }
}
