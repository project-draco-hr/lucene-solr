{
  IndexWriter writer=initIndex();
  MockRAMDirectory dir=(MockRAMDirectory)writer.getDirectory();
  writer.close();
  writer=initIndex(dir);
  assertEquals(314,writer.docCount());
  crash(writer);
  IndexReader reader=IndexReader.open(dir,false);
  assertTrue(reader.numDocs() >= 157);
}
