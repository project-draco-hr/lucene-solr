{
  if (minimumNumberShouldMatch == 0 && clauses.size() == 1) {
    BooleanClause c=clauses.get(0);
    if (!c.isProhibited()) {
      Query query=c.getQuery().rewrite(reader);
      if (c.isScoring()) {
        if (getBoost() != 1.0f) {
          if (query == c.getQuery()) {
            query=query.clone();
          }
          query.setBoost(getBoost() * query.getBoost());
        }
      }
 else {
        query=new ConstantScoreQuery(query);
        query.setBoost(0);
      }
      return query;
    }
  }
  BooleanQuery.Builder builder=new BooleanQuery.Builder();
  builder.setDisableCoord(isCoordDisabled());
  builder.setMinimumNumberShouldMatch(getMinimumNumberShouldMatch());
  boolean actuallyRewritten=false;
  for (  BooleanClause clause : this) {
    Query query=clause.getQuery();
    Query rewritten=query.rewrite(reader);
    if (rewritten != query) {
      actuallyRewritten=true;
    }
    builder.add(rewritten,clause.getOccur());
  }
  if (actuallyRewritten) {
    BooleanQuery rewritten=builder.build();
    rewritten.setBoost(getBoost());
    return rewritten;
  }
  return super.rewrite(reader);
}
