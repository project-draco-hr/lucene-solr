{
  if (maxWriteMBPerSecDefault != null || maxWriteMBPerSecFlush != null || maxWriteMBPerSecMerge != null || maxWriteMBPerSecRead != null) {
    directory=new RateLimitedDirectoryWrapper(directory);
    if (maxWriteMBPerSecDefault != null) {
      ((RateLimitedDirectoryWrapper)directory).setMaxWriteMBPerSec(maxWriteMBPerSecDefault,Context.DEFAULT);
    }
    if (maxWriteMBPerSecFlush != null) {
      ((RateLimitedDirectoryWrapper)directory).setMaxWriteMBPerSec(maxWriteMBPerSecFlush,Context.FLUSH);
    }
    if (maxWriteMBPerSecMerge != null) {
      ((RateLimitedDirectoryWrapper)directory).setMaxWriteMBPerSec(maxWriteMBPerSecMerge,Context.MERGE);
    }
    if (maxWriteMBPerSecRead != null) {
      ((RateLimitedDirectoryWrapper)directory).setMaxWriteMBPerSec(maxWriteMBPerSecRead,Context.READ);
    }
  }
  return directory;
}
