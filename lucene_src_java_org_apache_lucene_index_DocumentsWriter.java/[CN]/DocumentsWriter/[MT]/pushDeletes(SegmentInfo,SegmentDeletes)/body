{
synchronized (indexWriter) {
    if (segmentDeletes.any()) {
      if (segmentInfo != null) {
        bufferedDeletes.pushDeletes(segmentDeletes,segmentInfo);
      }
 else       if (indexWriter.segmentInfos.size() > 0) {
        if (infoStream != null) {
          message("flush: push buffered deletes to previously flushed segment " + indexWriter.segmentInfos.lastElement());
        }
        bufferedDeletes.pushDeletes(segmentDeletes,indexWriter.segmentInfos.lastElement(),true);
      }
 else {
        if (infoStream != null) {
          message("flush: drop buffered deletes: no segments");
        }
      }
    }
  }
}
