{
  if (perThread.getNumDocsInRAM() == 0 && !flushDocStores) {
    return false;
  }
  int docStoreOffset=perThread.getDocStoreOffset();
  String docStoreSegment=perThread.getDocStoreSegment();
  SegmentInfo newSegment=perThread.flush(flushDocStores);
  if (newSegment != null) {
    newSegment.setDocStore(docStoreOffset,docStoreSegment,false);
    finishFlushedSegment(newSegment,perThread);
    return true;
  }
  return false;
}
