{
  DocumentsWriterPerThread perThread=new DocumentsWriterPerThread(directory,this,chain);
  sequenceIDLock.lock();
  try {
    numDocumentsWriterPerThreads++;
    return perThread;
  }
  finally {
    sequenceIDLock.unlock();
  }
}
