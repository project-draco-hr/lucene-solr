{
  if (pendingDeletes.any()) {
    if (newSegment != null) {
      if (infoStream != null) {
        message("flush: push buffered deletes to newSegment");
      }
      bufferedDeletes.pushDeletes(pendingDeletes,newSegment);
    }
 else     if (segmentInfos.size() > 0) {
      if (infoStream != null) {
        message("flush: push buffered deletes to previously flushed segment " + segmentInfos.lastElement());
      }
      bufferedDeletes.pushDeletes(pendingDeletes,segmentInfos.lastElement(),true);
    }
 else {
      if (infoStream != null) {
        message("flush: drop buffered deletes: no segments");
      }
    }
    pendingDeletes=new SegmentDeletes();
  }
}
