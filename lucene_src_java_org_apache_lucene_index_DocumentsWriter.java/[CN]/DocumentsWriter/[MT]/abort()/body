{
  boolean success=false;
synchronized (this) {
    pendingDeletes.clear();
  }
  try {
    if (infoStream != null) {
      message("docWriter: abort");
    }
    final Iterator<ThreadState> threadsIterator=perThreadPool.getActivePerThreadsIterator();
    while (threadsIterator.hasNext()) {
      ThreadState perThread=threadsIterator.next();
      perThread.lock();
      try {
        if (perThread.isActive()) {
          perThread.perThread.abort();
          perThread.perThread.checkAndResetHasAborted();
        }
 else {
          assert closed;
        }
      }
  finally {
        perThread.unlock();
      }
    }
    success=true;
  }
  finally {
    if (infoStream != null) {
      message("docWriter: done abort; abortedFiles=" + abortedFiles + " success="+ success);
    }
  }
}
