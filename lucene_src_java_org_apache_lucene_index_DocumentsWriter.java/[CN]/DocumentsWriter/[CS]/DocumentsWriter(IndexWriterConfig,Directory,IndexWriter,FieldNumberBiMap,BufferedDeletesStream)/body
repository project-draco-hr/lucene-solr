{
  this.directory=directory;
  this.indexWriter=writer;
  this.similarityProvider=writer.getConfig().getSimilarityProvider();
  this.bufferedDeletesStream=bufferedDeletesStream;
  this.perThreadPool=config.getIndexerThreadPool();
  this.chain=config.getIndexingChain();
  this.perThreadPool.initialize(this,globalFieldNumbers,config);
  this.config=config;
}
