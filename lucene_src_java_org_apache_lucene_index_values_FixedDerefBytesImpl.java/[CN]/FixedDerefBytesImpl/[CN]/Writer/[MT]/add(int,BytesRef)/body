{
  if (bytes.length == 0)   return;
  if (size == -1) {
    size=bytes.length;
    datOut.writeInt(size);
  }
 else   if (bytes.length != size) {
    throw new IllegalArgumentException("expected bytes size=" + size + " but got "+ bytes.length);
  }
  int ord=hash.add(bytes);
  if (ord >= 0) {
    datOut.writeBytes(bytes.bytes,bytes.offset,bytes.length);
  }
 else {
    ord=(-ord) - 1;
  }
  if (docID >= docToID.length) {
    final int size=docToID.length;
    docToID=ArrayUtil.grow(docToID,1 + docID);
    bytesUsed.addAndGet((docToID.length - size) * RamUsageEstimator.NUM_BYTES_INT);
  }
  docToID[docID]=1 + ord;
}
