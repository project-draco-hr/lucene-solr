{
synchronized (delegate) {
    if (!delegate.hasFieldCodec(fieldName)) {
      final SchemaField fieldOrNull=schema.getFieldOrNull(fieldName);
      if (fieldOrNull == null) {
        return false;
      }
      String codecName=fieldOrNull.getType().getCodec();
      if (codecName == null) {
        codecName=delegate.getDefaultFieldCodec();
      }
      delegate.setFieldCodec(fieldName,codecName);
    }
    return true;
  }
}
