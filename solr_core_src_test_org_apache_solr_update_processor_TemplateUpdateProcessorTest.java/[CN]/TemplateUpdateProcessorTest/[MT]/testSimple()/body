{
  AddUpdateCommand cmd=new AddUpdateCommand(new LocalSolrQueryRequest(null,new ModifiableSolrParams().add("processor","Template").add("Template.field","id:${firstName}_${lastName}").add("Template.field","another:${lastName}_${firstName}").add("Template.field","missing:${lastName}_${unKnown}")));
  cmd.solrDoc=new SolrInputDocument();
  cmd.solrDoc.addField("firstName","Tom");
  cmd.solrDoc.addField("lastName","Cruise");
  new TemplateUpdateProcessorFactory().getInstance(cmd.getReq(),new SolrQueryResponse(),null).processAdd(cmd);
  assertEquals("Tom_Cruise",cmd.solrDoc.getFieldValue("id"));
  assertEquals("Cruise_Tom",cmd.solrDoc.getFieldValue("another"));
  assertEquals("Cruise_",cmd.solrDoc.getFieldValue("missing"));
}
