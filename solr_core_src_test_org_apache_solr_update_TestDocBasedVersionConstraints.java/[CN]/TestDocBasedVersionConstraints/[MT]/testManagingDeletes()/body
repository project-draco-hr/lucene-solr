{
  for (long ver=1010; ver < 1020; ver++) {
    for (    String id : new String[]{"aaa","bbb","ccc","ddd"}) {
      assertU(adoc("id",id,"name","name_" + id,"my_version_l","" + ver));
    }
  }
  assertU(adoc("id","aaa","name","name_aaa","my_version_l","1030"));
  assertU(commit());
  assertJQ(req("q","*:*","fq","live_b:true"),"/response/numFound==4");
  assertJQ(req("q","id:aaa","fq","live_b:true","fl","id,my_version_l"),"/response/numFound==1","/response/docs==[{'id':'aaa','my_version_l':1030}]}");
  deleteAndGetVersion("aaa",params("del_version","1031"));
  assertU(commit());
  assertJQ(req("q","*:*","fq","live_b:true"),"/response/numFound==3");
  assertJQ(req("q","id:aaa","fq","live_b:true"),"/response/numFound==0");
  assertJQ(req("q","id:aaa","fq","live_b:false","fq","timestamp_tdt:[* TO *]","fl","id,live_b,my_version_l"),"/response/numFound==1","/response/docs==[{'id':'aaa','my_version_l':1031,'live_b':false}]}");
  assertU(adoc("id","aaa","name","XX","my_version_l","1025"));
  assertU(commit());
  assertJQ(req("q","id:aaa","fq","live_b:true"),"/response/numFound==0");
  assertU(delQ("+live_b:false"));
  assertU(commit());
  assertU(adoc("id","aaa","name","aaa","my_version_l","7"));
  assertU(commit());
  assertJQ(req("q","id:aaa","fq","live_b:true","fl","id,live_b,my_version_l"),"/response/numFound==1","/response/docs==[{'id':'aaa','my_version_l':7,'live_b':true}]}");
}
