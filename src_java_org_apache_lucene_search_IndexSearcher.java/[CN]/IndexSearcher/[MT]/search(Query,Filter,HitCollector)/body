{
  HitCollector collector=results;
  if (filter != null) {
    final BitSet bits=filter.bits(reader);
    collector=new HitCollector(){
      public final void collect(      int doc,      float score){
        if (bits.get(doc)) {
          results.collect(doc,score);
        }
      }
    }
;
  }
  Scorer scorer=query.weight(this).scorer(reader);
  if (scorer == null)   return;
  scorer.score(collector,reader.maxDoc());
}
