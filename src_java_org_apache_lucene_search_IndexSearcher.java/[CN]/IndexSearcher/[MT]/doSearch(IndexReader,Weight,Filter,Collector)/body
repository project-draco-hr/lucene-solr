{
  Scorer scorer=weight.scorer(reader);
  if (scorer == null)   return;
  if (filter == null) {
    scorer.score(collector);
    return;
  }
  DocIdSetIterator filterDocIdIterator=filter.getDocIdSet(reader).iterator();
  boolean more=filterDocIdIterator.next() && scorer.skipTo(filterDocIdIterator.doc());
  collector.setScorer(scorer);
  while (more) {
    int filterDocId=filterDocIdIterator.doc();
    if (filterDocId > scorer.doc() && !scorer.skipTo(filterDocId)) {
      more=false;
    }
 else {
      int scorerDocId=scorer.doc();
      if (scorerDocId == filterDocId) {
        collector.collect(scorerDocId);
        more=filterDocIdIterator.next();
      }
 else {
        more=filterDocIdIterator.skipTo(scorerDocId);
      }
    }
  }
}
