{
  File data=createTempDir().toFile();
  System.setProperty("hostPort",Integer.toString(port));
  System.setProperty("shard",shard);
  System.setProperty("solr.data.dir",data.getAbsolutePath());
  System.setProperty("solr.solr.home",TEST_HOME());
  Set<Integer> ports=shardPorts.get(shard);
  if (ports == null) {
    ports=new HashSet<>();
    shardPorts.put(shard,ports);
  }
  ports.add(port);
  CoreContainer container=new CoreContainer();
  container.load();
  assertTrue("Container " + port + " has no cores!",container.getCores().size() > 0);
  containerMap.put(port,container);
  System.clearProperty("solr.solr.home");
  System.clearProperty("hostPort");
}
