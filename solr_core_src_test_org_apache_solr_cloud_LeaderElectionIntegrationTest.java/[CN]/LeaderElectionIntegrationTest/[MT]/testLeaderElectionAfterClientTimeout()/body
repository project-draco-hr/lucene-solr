{
  System.setProperty("zkClientTimeout","500");
  String leader=getLeader();
  int leaderPort=getLeaderPort(leader);
  containerMap.get(leaderPort).getZkController().getZkClient().getSolrZooKeeper().pauseCnxn(2000);
  for (int i=0; i < 60; i++) {
    if (leaderPort != getLeaderPort(getLeader())) {
      break;
    }
    Thread.sleep(100);
  }
  if (VERBOSE)   System.out.println("kill everyone");
  for (  Map.Entry<Integer,CoreContainer> entry : containerMap.entrySet()) {
    if (entry.getKey() != leaderPort) {
      entry.getValue().shutdown();
    }
  }
  for (int i=0; i < 60; i++) {
    if (leaderPort == getLeaderPort(getLeader())) {
      break;
    }
    Thread.sleep(100);
  }
  assertEquals(leaderPort,getLeaderPort(getLeader()));
}
