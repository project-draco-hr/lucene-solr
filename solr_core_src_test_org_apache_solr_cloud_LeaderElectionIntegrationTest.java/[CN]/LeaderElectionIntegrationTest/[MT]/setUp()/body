{
  super.setUp();
  createTempDir();
  ignoreException("No UpdateLog found - cannot sync");
  System.setProperty("zkClientTimeout","3000");
  zkDir=dataDir.getAbsolutePath() + File.separator + "zookeeper/server1/data";
  zkServer=new ZkTestServer(zkDir);
  zkServer.run();
  System.setProperty("zkHost",zkServer.getZkAddress());
  AbstractZkTestCase.buildZooKeeper(zkServer.getZkHost(),zkServer.getZkAddress(),"solrconfig.xml","schema.xml");
  log.info("####SETUP_START " + getName());
  System.setProperty("solr.test.sys.prop1","propone");
  System.setProperty("solr.test.sys.prop2","proptwo");
  for (int i=7000; i < 7000 + NUM_SHARD_REPLICAS; i++) {
    setupContainer(i,"shard1");
  }
  setupContainer(3333,"shard2");
  zkClient=new SolrZkClient(zkServer.getZkAddress(),AbstractZkTestCase.TIMEOUT);
  reader=new ZkStateReader(zkClient);
  reader.createClusterStateWatchersAndUpdate();
  log.info("####SETUP_END " + getName());
}
