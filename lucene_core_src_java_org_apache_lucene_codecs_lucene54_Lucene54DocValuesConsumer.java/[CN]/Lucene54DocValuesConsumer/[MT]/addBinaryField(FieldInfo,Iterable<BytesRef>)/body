{
  meta.writeVInt(field.number);
  meta.writeByte(Lucene54DocValuesFormat.BINARY);
  int minLength=Integer.MAX_VALUE;
  int maxLength=Integer.MIN_VALUE;
  final long startFP=data.getFilePointer();
  long count=0;
  long missingCount=0;
  for (  BytesRef v : values) {
    final int length;
    if (v == null) {
      length=0;
      missingCount++;
    }
 else {
      length=v.length;
    }
    minLength=Math.min(minLength,length);
    maxLength=Math.max(maxLength,length);
    if (v != null) {
      data.writeBytes(v.bytes,v.offset,v.length);
    }
    count++;
  }
  meta.writeVInt(minLength == maxLength ? BINARY_FIXED_UNCOMPRESSED : BINARY_VARIABLE_UNCOMPRESSED);
  if (missingCount == 0) {
    meta.writeLong(ALL_LIVE);
  }
 else   if (missingCount == count) {
    meta.writeLong(ALL_MISSING);
  }
 else {
    meta.writeLong(data.getFilePointer());
    writeMissingBitset(values);
  }
  meta.writeVInt(minLength);
  meta.writeVInt(maxLength);
  meta.writeVLong(count);
  meta.writeLong(startFP);
  if (minLength != maxLength) {
    meta.writeLong(data.getFilePointer());
    meta.writeVInt(DIRECT_MONOTONIC_BLOCK_SHIFT);
    final DirectMonotonicWriter writer=DirectMonotonicWriter.getInstance(meta,data,count + 1,DIRECT_MONOTONIC_BLOCK_SHIFT);
    long addr=0;
    writer.add(addr);
    for (    BytesRef v : values) {
      if (v != null) {
        addr+=v.length;
      }
      writer.add(addr);
    }
    writer.finish();
    meta.writeLong(data.getFilePointer());
  }
}
