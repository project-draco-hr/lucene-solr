{
  int bitsLeft=64;
  for (int i=0; i < valueCount * iterations; ++i) {
    bitsLeft-=bitsPerValue;
    if (bitsLeft < 0) {
      values[valuesOffset++]=((blocks[blocksOffset++] & ((1L << (bitsPerValue + bitsLeft)) - 1)) << -bitsLeft) | (blocks[blocksOffset] >>> (64 + bitsLeft));
      bitsLeft+=64;
    }
 else {
      values[valuesOffset++]=(blocks[blocksOffset] >>> bitsLeft) & mask;
    }
  }
}
