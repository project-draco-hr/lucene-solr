{
  Terms tv=searcher.getIndexReader().getTermVector(doc,TEXT_FIELD_NAME);
  TermsEnum it=tv.iterator(TermsEnum.EMPTY);
  Integer position=Integer.MAX_VALUE;
  BytesRef term;
  while ((term=it.next()) != null) {
    String docTerm=term.utf8ToString();
    if (matchedTokens.contains(docTerm) || (prefixToken != null && docTerm.startsWith(prefixToken))) {
      PostingsEnum docPosEnum=it.postings(null,null,PostingsEnum.OFFSETS);
      docPosEnum.nextDoc();
      int p=docPosEnum.nextPosition();
      if (p < position) {
        position=p;
      }
    }
  }
  return calculateCoefficient(position);
}
