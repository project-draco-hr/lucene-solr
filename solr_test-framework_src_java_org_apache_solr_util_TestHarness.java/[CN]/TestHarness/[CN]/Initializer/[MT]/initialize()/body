{
  CoreContainer container=new CoreContainer(new SolrResourceLoader(SolrResourceLoader.locateSolrHome())){
{
      hostPort=System.getProperty("hostPort");
      hostContext="solr";
      defaultCoreName=CoreContainer.DEFAULT_DEFAULT_CORE_NAME;
      initZooKeeper(System.getProperty("zkHost"),10000);
    }
  }
;
  LogWatcher<?> logging=new JulWatcher("test");
  logging.registerListener(new ListenerConfig(),container);
  container.setLogging(logging);
  CoreDescriptor dcore=new CoreDescriptor(container,coreName,solrConfig.getResourceLoader().getInstanceDir());
  dcore.setConfigName(solrConfig.getResourceName());
  dcore.setSchemaName(indexSchema.getResourceName());
  SolrCore core=new SolrCore(coreName,dataDirectory,solrConfig,indexSchema,dcore);
  container.register(coreName,core,false);
  if (container.getZkController() == null && core.getUpdateHandler().getUpdateLog() != null) {
    core.getUpdateHandler().getUpdateLog().recoverFromLog();
  }
  return container;
}
