{
  String url=getFullUrl(req.node.getUrl());
  ConcurrentUpdateSolrServer server=solrServers.get(url);
  if (server == null) {
    server=new ConcurrentUpdateSolrServer(url,httpClient,100,1,updateExecutor){
      @Override public void handleError(      Throwable ex){
        scdlog.error("error",ex);
        Error error=new Error();
        error.e=(Exception)ex;
        if (ex instanceof SolrException) {
          error.statusCode=((SolrException)ex).code();
        }
        error.req=req;
        errors.add(error);
      }
    }
;
    server.setParser(new BinaryResponseParser());
    server.setRequestWriter(new BinaryRequestWriter());
    server.setPollQueueTime(0);
    solrServers.put(url,server);
  }
  return server;
}
