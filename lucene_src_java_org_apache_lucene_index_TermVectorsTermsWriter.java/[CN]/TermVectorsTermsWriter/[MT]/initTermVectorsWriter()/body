{
  if (tvx == null) {
    boolean success=false;
    try {
      IOContext context=new IOContext(new FlushInfo(docWriter.getNumDocsInRAM(),docWriter.bytesUsed()));
      tvx=docWriter.directory.createOutput(IndexFileNames.segmentFileName(docWriter.getSegment(),"",IndexFileNames.VECTORS_INDEX_EXTENSION),context);
      tvd=docWriter.directory.createOutput(IndexFileNames.segmentFileName(docWriter.getSegment(),"",IndexFileNames.VECTORS_DOCUMENTS_EXTENSION),context);
      tvf=docWriter.directory.createOutput(IndexFileNames.segmentFileName(docWriter.getSegment(),"",IndexFileNames.VECTORS_FIELDS_EXTENSION),context);
      tvx.writeInt(TermVectorsReader.FORMAT_CURRENT);
      tvd.writeInt(TermVectorsReader.FORMAT_CURRENT);
      tvf.writeInt(TermVectorsReader.FORMAT_CURRENT);
      success=true;
    }
  finally {
      if (!success) {
        IOUtils.closeSafely(true,tvx,tvd,tvf);
      }
    }
    lastDocID=0;
  }
}
