{
  File indexDirName=_TestUtil.getTempDir("index.TestLockFactory2");
  IndexWriter writer=new IndexWriter(indexDirName,new WhitespaceAnalyzer(),true,IndexWriter.MaxFieldLength.LIMITED);
  assertTrue("FSDirectory did not use correct LockFactory: got " + writer.getDirectory().getLockFactory(),SimpleFSLockFactory.class.isInstance(writer.getDirectory().getLockFactory()) || NativeFSLockFactory.class.isInstance(writer.getDirectory().getLockFactory()));
  IndexWriter writer2=null;
  try {
    writer2=new IndexWriter(indexDirName,new WhitespaceAnalyzer(),true,IndexWriter.MaxFieldLength.LIMITED);
  }
 catch (  IOException e) {
    e.printStackTrace(System.out);
    fail("Should not have hit an IOException with two IndexWriters with create=true, on default SimpleFSLockFactory");
  }
  writer.close();
  if (writer2 != null) {
    try {
      writer2.close();
    }
 catch (    LockReleaseFailedException e) {
      fail("writer2.close() should not have hit LockReleaseFailedException");
    }
  }
  _TestUtil.rmDir(indexDirName);
}
