{
  String indexDirName="index.TestLockFactory3";
  System.setProperty("org.apache.lucene.store.FSDirectoryLockFactoryClass","org.apache.lucene.store.NoLockFactory");
  IndexWriter writer=new IndexWriter(indexDirName,new WhitespaceAnalyzer(),true);
  assertTrue("FSDirectory did not use correct LockFactory: got " + writer.getDirectory().getLockFactory(),NoLockFactory.class.isInstance(writer.getDirectory().getLockFactory()));
  System.setProperty("org.apache.lucene.store.FSDirectoryLockFactoryClass","");
  writer.close();
  rmDir(indexDirName);
}
