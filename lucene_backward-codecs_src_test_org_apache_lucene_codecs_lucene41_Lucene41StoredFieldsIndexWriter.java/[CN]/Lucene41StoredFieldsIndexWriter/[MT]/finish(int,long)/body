{
  if (numDocs != totalDocs) {
    throw new IllegalStateException("Expected " + numDocs + " docs, but got "+ totalDocs);
  }
  if (blockChunks > 0) {
    writeBlock();
  }
  fieldsIndexOut.writeVInt(0);
  fieldsIndexOut.writeVLong(maxPointer);
  CodecUtil.writeFooter(fieldsIndexOut);
}
