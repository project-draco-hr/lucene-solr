{
  for (  String dim : expectedCounts.keySet()) {
    CategoryPath drillDownCP=new CategoryPath(dim);
    ArrayList<FacetRequest> request=new ArrayList<FacetRequest>(1);
    request.add(new CountFacetRequest(drillDownCP,10));
    FacetSearchParams fsp=new FacetSearchParams(request,fip);
    Query drillDown=DrillDown.query(fsp,new MatchAllDocsQuery(),drillDownCP);
    TotalHitCountCollector total=new TotalHitCountCollector();
    FacetsCollector fc=new FacetsCollector(fsp,indexReader,taxoReader);
    searcher.search(drillDown,MultiCollector.wrap(fc,total));
    assertTrue("no results for drill-down query " + drillDown,total.getTotalHits() > 0);
    List<FacetResult> facetResults=fc.getFacetResults();
    assertEquals(1,facetResults.size());
    FacetResultNode rootNode=facetResults.get(0).getFacetResultNode();
    assertEquals("wrong count for " + dim,expectedCounts.get(dim).intValue(),(int)rootNode.getValue());
  }
}
