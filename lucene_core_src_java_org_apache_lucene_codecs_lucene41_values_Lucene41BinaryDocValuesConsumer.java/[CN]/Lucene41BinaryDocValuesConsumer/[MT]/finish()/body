{
  try {
    if (buffer != null) {
      Iterator iterator=buffer.iterator();
      PackedInts.Writer writer=PackedInts.getWriter(indexOut,buffer.size() + 1,PackedInts.bitsRequired(offset),PackedInts.FASTEST);
      long previous=0;
      while (iterator.hasNext()) {
        long next=iterator.next() + previous;
        previous=next;
        writer.add(next);
      }
      writer.add(offset);
      writer.finish();
    }
  }
  finally {
    IOUtils.close(indexOut,dataOut);
  }
}
