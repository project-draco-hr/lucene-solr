def unpack(project, tmpDir, artifact, version):
    destDir = ('%s/unpack' % tmpDir)
    if os.path.exists(destDir):
        shutil.rmtree(destDir)
    os.makedirs(destDir)
    os.chdir(destDir)
    print ('    unpack %s...' % artifact)
    unpackLogFile = ('%s/%s-unpack-%s.log' % (tmpDir, project, artifact))
    if (artifact.endswith('.tar.gz') or artifact.endswith('.tgz')):
        run(('tar xzf %s/%s' % (tmpDir, artifact)), unpackLogFile)
    elif artifact.endswith('.zip'):
        run(('unzip %s/%s' % (tmpDir, artifact)), unpackLogFile)
    l = os.listdir(destDir)
    if (project == 'solr'):
        expected = ('apache-%s-%s' % (project, version))
    else:
        expected = ('%s-%s' % (project, version))
    if (l != [expected]):
        raise RuntimeError(('unpack produced entries %s; expected only %s' % (l, expected)))
    unpackPath = ('%s/%s' % (destDir, expected))
    verifyUnpacked(project, artifact, unpackPath, version)
