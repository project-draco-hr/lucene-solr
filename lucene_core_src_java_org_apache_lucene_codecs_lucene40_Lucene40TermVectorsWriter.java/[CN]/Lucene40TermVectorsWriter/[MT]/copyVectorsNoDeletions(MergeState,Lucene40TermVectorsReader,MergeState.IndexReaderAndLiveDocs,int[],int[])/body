{
  final int maxDoc=reader.reader.maxDoc();
  if (matchingVectorsReader != null) {
    int docCount=0;
    while (docCount < maxDoc) {
      int len=Math.min(MAX_RAW_MERGE_DOCS,maxDoc - docCount);
      matchingVectorsReader.rawDocs(rawDocLengths,rawDocLengths2,docCount,len);
      addRawDocuments(matchingVectorsReader,rawDocLengths,rawDocLengths2,len);
      docCount+=len;
      mergeState.checkAbort.work(300 * len);
    }
  }
 else {
    for (int docNum=0; docNum < maxDoc; docNum++) {
      InvertedFields vectors=reader.reader.getTermVectors(docNum);
      addAllDocVectors(vectors,mergeState.fieldInfos);
      mergeState.checkAbort.work(300);
    }
  }
  return maxDoc;
}
