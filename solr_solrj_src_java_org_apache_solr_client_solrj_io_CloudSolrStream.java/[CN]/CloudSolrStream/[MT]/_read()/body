{
  TupleWrapper tw=tuples.pollFirst();
  if (tw != null) {
    Tuple t=tw.getTuple();
    if (trace) {
      t.put("_COLLECTION_",this.collection);
    }
    if (tw.next()) {
      tuples.add(tw);
    }
    return t;
  }
 else {
    Map m=new HashMap();
    if (trace) {
      m.put("_COLLECTION_",this.collection);
    }
    m.put("EOF",true);
    return new Tuple(m);
  }
}
