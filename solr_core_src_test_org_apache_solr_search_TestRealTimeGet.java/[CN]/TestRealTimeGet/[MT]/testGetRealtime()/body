{
  clearIndex();
  assertU(commit());
  assertU(adoc("id","1","a_f","-1.5","a_fd","-1.5","a_fdS","-1.5","a_fs","1.0","a_fs","2.5","a_fds","1.0","a_fds","2.5","a_fdsS","1.0","a_fdsS","2.5","a_d","-1.2E99","a_dd","-1.2E99","a_ddS","-1.2E99","a_ds","1.0","a_ds","2.5","a_dds","1.0","a_dds","2.5","a_ddsS","1.0","a_ddsS","2.5","a_i","-1","a_id","-1","a_idS","-1","a_is","1","a_is","2","a_ids","1","a_ids","2","a_idsS","1","a_idsS","2","a_l","-9999999999","a_ld","-9999999999","a_ldS","-9999999999","a_ls","1","a_ls","9999999999","a_lds","1","a_lds","9999999999","a_ldsS","1","a_ldsS","9999999999"));
  assertJQ(req("q","id:1"),"/response/numFound==0");
  assertJQ(req("qt","/get","id","1","fl","id, a_f,a_fd,a_fdS   a_fs,a_fds,a_fdsS,  a_d,a_dd,a_ddS,  a_ds,a_dds,a_ddsS,  a_i,a_id,a_idS   a_is,a_ids,a_idsS,   a_l,a_ld,a_ldS   a_ls,a_lds,a_ldsS"),"=={'doc':{'id':'1'" + ", a_f:-1.5, a_fd:-1.5, a_fdS:-1.5,  a_fs:[1.0,2.5],      a_fds:[1.0,2.5],a_fdsS:[1.0,2.5]" + ", a_d:-1.2E99, a_dd:-1.2E99, a_ddS:-1.2E99,              a_ds:[1.0,2.5],a_dds:[1.0,2.5],a_ddsS:[1.0,2.5]"+ ", a_i:-1, a_id:-1, a_idS:-1,                             a_is:[1,2],a_ids:[1,2],a_idsS:[1,2]"+ ", a_l:-9999999999, a_ld:-9999999999, a_ldS:-9999999999,  a_ls:[1,9999999999],a_lds:[1,9999999999],a_ldsS:[1,9999999999]"+ "       }}");
  assertJQ(req("qt","/get","ids","1","fl","id"),"=={" + "  'response':{'numFound':1,'start':0,'docs':[" + "      {"+ "        'id':'1'}]"+ "  }}}");
  assertU(commit());
  assertJQ(req("q","id:1"),"/response/numFound==1");
  assertJQ(req("qt","/get","id","1","fl","id, a_f,a_fd,a_fdS   a_fs,a_fds,a_fdsS,  a_d,a_dd,a_ddS,  a_ds,a_dds,a_ddsS,  a_i,a_id,a_idS   a_is,a_ids,a_idsS,   a_l,a_ld,a_ldS   a_ls,a_lds,a_ldsS"),"=={'doc':{'id':'1'" + ", a_f:-1.5, a_fd:-1.5, a_fdS:-1.5,  a_fs:[1.0,2.5],      a_fds:[1.0,2.5],a_fdsS:[1.0,2.5]" + ", a_d:-1.2E99, a_dd:-1.2E99, a_ddS:-1.2E99,              a_ds:[1.0,2.5],a_dds:[1.0,2.5],a_ddsS:[1.0,2.5]"+ ", a_i:-1, a_id:-1, a_idS:-1,                             a_is:[1,2],a_ids:[1,2],a_idsS:[1,2]"+ ", a_l:-9999999999, a_ld:-9999999999, a_ldS:-9999999999,  a_ls:[1,9999999999],a_lds:[1,9999999999],a_ldsS:[1,9999999999]"+ "       }}");
  assertJQ(req("qt","/get","id","1","fl","id"),"=={'doc':{'id':'1'}}");
  assertJQ(req("qt","/get","ids","1","fl","id"),"=={" + "  'response':{'numFound':1,'start':0,'docs':[" + "      {"+ "        'id':'1'}]"+ "  }}}");
  assertU(delI("1"));
  assertJQ(req("q","id:1"),"/response/numFound==1");
  assertJQ(req("qt","/get","id","1"),"=={'doc':null}");
  assertJQ(req("qt","/get","ids","1"),"=={'response':{'numFound':0,'start':0,'docs':[]}}");
  assertU(adoc("id","10"));
  assertU(adoc("id","11"));
  assertJQ(req("qt","/get","id","10","fl","id"),"=={'doc':{'id':'10'}}");
  assertU(delQ("id:10 foo_s:abcdef"));
  assertJQ(req("qt","/get","id","10"),"=={'doc':null}");
  assertJQ(req("qt","/get","id","11","fl","id"),"=={'doc':{'id':'11'}}");
  assertU(adoc("id","12","val_ls","1","val_ls","2"));
  assertJQ(req("q","id:12"),"/response/numFound==0");
  assertJQ(req("qt","/get","id","12","fl","id,val_ls"),"=={'doc':{'id':'12', 'val_ls':[1,2]}}");
  assertU(commit());
  assertJQ(req("qt","/get","id","12","fl","id,val_ls"),"=={'doc':{'id':'12', 'val_ls':[1,2]}}");
  assertJQ(req("q","id:12"),"/response/numFound==1");
  SolrQueryRequest req=req();
  RefCounted<SolrIndexSearcher> realtimeHolder=req.getCore().getRealtimeSearcher();
  assertU(adoc("id","12"));
  assertU(adoc("id","13"));
  assertJQ(req("qt","/get","id","11","fl","id","fq","id:11"),"=={doc:{id:'11'}}");
  RefCounted<SolrIndexSearcher> realtimeHolder2=req.getCore().getRealtimeSearcher();
  assertEquals(realtimeHolder.get(),realtimeHolder2.get());
  realtimeHolder2.decref();
  assertJQ(req("qt","/get","id","12","fl","id","fq","id:11"),"=={doc:null}");
  assertJQ(req("qt","/get","id","12","fl","id","fq","id:13"),"=={doc:null}");
  assertJQ(req("qt","/get","id","12","fl","id","fq","id:12"),"=={doc:{id:'12'}}");
  assertU(adoc("id","14"));
  assertU(adoc("id","15"));
  assertJQ(req("qt","/get","ids","12,14,13,15","fl","id","fq","id:[10 TO 14]","fq","id:[13 TO 19]"),"/response/docs==[{id:'14'},{id:'13'}]");
  assertU(adoc("id","16"));
  assertU(adoc("id","17"));
  assertJQ(req("qt","/get","ids","17,16,15,14","fl","id","fq","id:[15 TO 16]"),"/response/docs==[{id:'16'},{id:'15'}]");
  assertJQ(req("qt","/get","ids","17,16,15,14","fl","id","fq","{!frange l=15 u=16}id"),"/response/docs==[{id:'16'},{id:'15'}]");
  realtimeHolder.decref();
  req.close();
}
