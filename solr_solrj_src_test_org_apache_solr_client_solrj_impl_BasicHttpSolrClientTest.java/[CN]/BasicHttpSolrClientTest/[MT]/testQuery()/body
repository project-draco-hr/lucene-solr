{
  DebugServlet.clear();
  try (HttpSolrClient client=new HttpSolrClient(jetty.getBaseUrl().toString() + "/debug/foo")){
    SolrQuery q=new SolrQuery("foo");
    q.setParam("a","\u1234");
    try {
      client.query(q,METHOD.GET);
    }
 catch (    Throwable t) {
    }
    assertEquals("get",DebugServlet.lastMethod);
    assertEquals("Solr[" + HttpSolrClient.class.getName() + "] 1.0",DebugServlet.headers.get("User-Agent"));
    assertEquals(1,DebugServlet.parameters.get(CommonParams.WT).length);
    assertEquals("javabin",DebugServlet.parameters.get(CommonParams.WT)[0]);
    assertEquals(1,DebugServlet.parameters.get(CommonParams.VERSION).length);
    assertEquals(client.getParser().getVersion(),DebugServlet.parameters.get(CommonParams.VERSION)[0]);
    assertEquals("Solr[" + HttpSolrClient.class.getName() + "] 1.0",DebugServlet.headers.get("User-Agent"));
    assertEquals("keep-alive",DebugServlet.headers.get("Connection"));
    assertEquals(null,DebugServlet.headers.get("Content-Type"));
    assertEquals(1,DebugServlet.parameters.get("a").length);
    assertEquals("\u1234",DebugServlet.parameters.get("a")[0]);
    DebugServlet.clear();
    try {
      client.query(q,METHOD.POST);
    }
 catch (    Throwable t) {
    }
    assertEquals("post",DebugServlet.lastMethod);
    assertEquals("Solr[" + HttpSolrClient.class.getName() + "] 1.0",DebugServlet.headers.get("User-Agent"));
    assertEquals(1,DebugServlet.parameters.get(CommonParams.WT).length);
    assertEquals("javabin",DebugServlet.parameters.get(CommonParams.WT)[0]);
    assertEquals(1,DebugServlet.parameters.get(CommonParams.VERSION).length);
    assertEquals(client.getParser().getVersion(),DebugServlet.parameters.get(CommonParams.VERSION)[0]);
    assertEquals(1,DebugServlet.parameters.get("a").length);
    assertEquals("\u1234",DebugServlet.parameters.get("a")[0]);
    assertEquals("Solr[" + HttpSolrClient.class.getName() + "] 1.0",DebugServlet.headers.get("User-Agent"));
    assertEquals("keep-alive",DebugServlet.headers.get("Connection"));
    assertEquals("application/x-www-form-urlencoded; charset=UTF-8",DebugServlet.headers.get("Content-Type"));
    DebugServlet.clear();
    try {
      client.query(q,METHOD.PUT);
    }
 catch (    Throwable t) {
    }
    assertEquals("put",DebugServlet.lastMethod);
    assertEquals("Solr[" + HttpSolrClient.class.getName() + "] 1.0",DebugServlet.headers.get("User-Agent"));
    assertEquals(1,DebugServlet.parameters.get(CommonParams.WT).length);
    assertEquals("javabin",DebugServlet.parameters.get(CommonParams.WT)[0]);
    assertEquals(1,DebugServlet.parameters.get(CommonParams.VERSION).length);
    assertEquals(client.getParser().getVersion(),DebugServlet.parameters.get(CommonParams.VERSION)[0]);
    assertEquals(1,DebugServlet.parameters.get("a").length);
    assertEquals("\u1234",DebugServlet.parameters.get("a")[0]);
    assertEquals("Solr[" + HttpSolrClient.class.getName() + "] 1.0",DebugServlet.headers.get("User-Agent"));
    assertEquals("keep-alive",DebugServlet.headers.get("Connection"));
    assertEquals("application/x-www-form-urlencoded; charset=UTF-8",DebugServlet.headers.get("Content-Type"));
    client.setParser(new XMLResponseParser());
    DebugServlet.clear();
    try {
      client.query(q,METHOD.GET);
    }
 catch (    Throwable t) {
    }
    assertEquals("get",DebugServlet.lastMethod);
    assertEquals("Solr[" + HttpSolrClient.class.getName() + "] 1.0",DebugServlet.headers.get("User-Agent"));
    assertEquals(1,DebugServlet.parameters.get(CommonParams.WT).length);
    assertEquals("xml",DebugServlet.parameters.get(CommonParams.WT)[0]);
    assertEquals(1,DebugServlet.parameters.get(CommonParams.VERSION).length);
    assertEquals(client.getParser().getVersion(),DebugServlet.parameters.get(CommonParams.VERSION)[0]);
    assertEquals(1,DebugServlet.parameters.get("a").length);
    assertEquals("\u1234",DebugServlet.parameters.get("a")[0]);
    assertEquals("Solr[" + HttpSolrClient.class.getName() + "] 1.0",DebugServlet.headers.get("User-Agent"));
    assertEquals("keep-alive",DebugServlet.headers.get("Connection"));
    client.setParser(new XMLResponseParser());
    DebugServlet.clear();
    try {
      client.query(q,METHOD.POST);
    }
 catch (    Throwable t) {
    }
    assertEquals("post",DebugServlet.lastMethod);
    assertEquals("Solr[" + HttpSolrClient.class.getName() + "] 1.0",DebugServlet.headers.get("User-Agent"));
    assertEquals(1,DebugServlet.parameters.get(CommonParams.WT).length);
    assertEquals("xml",DebugServlet.parameters.get(CommonParams.WT)[0]);
    assertEquals(1,DebugServlet.parameters.get(CommonParams.VERSION).length);
    assertEquals(client.getParser().getVersion(),DebugServlet.parameters.get(CommonParams.VERSION)[0]);
    assertEquals(1,DebugServlet.parameters.get("a").length);
    assertEquals("\u1234",DebugServlet.parameters.get("a")[0]);
    assertEquals("Solr[" + HttpSolrClient.class.getName() + "] 1.0",DebugServlet.headers.get("User-Agent"));
    assertEquals("keep-alive",DebugServlet.headers.get("Connection"));
    assertEquals("application/x-www-form-urlencoded; charset=UTF-8",DebugServlet.headers.get("Content-Type"));
    client.setParser(new XMLResponseParser());
    DebugServlet.clear();
    try {
      client.query(q,METHOD.PUT);
    }
 catch (    Throwable t) {
    }
    assertEquals("put",DebugServlet.lastMethod);
    assertEquals("Solr[" + HttpSolrClient.class.getName() + "] 1.0",DebugServlet.headers.get("User-Agent"));
    assertEquals(1,DebugServlet.parameters.get(CommonParams.WT).length);
    assertEquals("xml",DebugServlet.parameters.get(CommonParams.WT)[0]);
    assertEquals(1,DebugServlet.parameters.get(CommonParams.VERSION).length);
    assertEquals(client.getParser().getVersion(),DebugServlet.parameters.get(CommonParams.VERSION)[0]);
    assertEquals(1,DebugServlet.parameters.get("a").length);
    assertEquals("\u1234",DebugServlet.parameters.get("a")[0]);
    assertEquals("Solr[" + HttpSolrClient.class.getName() + "] 1.0",DebugServlet.headers.get("User-Agent"));
    assertEquals("keep-alive",DebugServlet.headers.get("Connection"));
    assertEquals("application/x-www-form-urlencoded; charset=UTF-8",DebugServlet.headers.get("Content-Type"));
  }
 }
