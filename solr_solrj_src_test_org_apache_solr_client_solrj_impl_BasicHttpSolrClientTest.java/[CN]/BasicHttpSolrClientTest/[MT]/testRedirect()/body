{
  try (HttpSolrClient client=new HttpSolrClient(jetty.getBaseUrl().toString() + "/redirect/foo")){
    SolrQuery q=new SolrQuery("*:*");
    try {
      client.query(q);
      fail("Should have thrown an exception.");
    }
 catch (    SolrServerException e) {
      assertTrue(e.getMessage().contains("redirect"));
    }
    client.setFollowRedirects(true);
    client.query(q);
    client.setFollowRedirects(false);
    try {
      client.query(q);
      fail("Should have thrown an exception.");
    }
 catch (    SolrServerException e) {
      assertTrue(e.getMessage().contains("redirect"));
    }
  }
 }
