{
  final String clientUrl=jetty.getBaseUrl().toString() + "/redirect/foo";
  try (HttpSolrClient client=getHttpSolrClient(clientUrl)){
    SolrQuery q=new SolrQuery("*:*");
    try {
      client.query(q);
      fail("Should have thrown an exception.");
    }
 catch (    SolrServerException e) {
      assertTrue(e.getMessage().contains("redirect"));
    }
    client.setFollowRedirects(true);
    client.query(q);
    client.setFollowRedirects(false);
    try {
      client.query(q);
      fail("Should have thrown an exception.");
    }
 catch (    SolrServerException e) {
      assertTrue(e.getMessage().contains("redirect"));
    }
  }
 }
