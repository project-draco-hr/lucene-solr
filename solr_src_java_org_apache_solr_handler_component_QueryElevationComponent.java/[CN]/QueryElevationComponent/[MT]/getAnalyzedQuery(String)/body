{
  if (analyzer == null) {
    return query;
  }
  StringBuilder norm=new StringBuilder();
  TokenStream tokens=analyzer.reusableTokenStream("",new StringReader(query));
  tokens.reset();
  TermAttribute termAtt=(TermAttribute)tokens.addAttribute(TermAttribute.class);
  while (tokens.incrementToken()) {
    norm.append(termAtt.termBuffer(),0,termAtt.termLength());
  }
  return norm.toString();
}
