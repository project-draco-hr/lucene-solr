{
  Query qMinY=NumericRangeQuery.newDoubleRange(field_minY,precisionStep,null,bbox.getMinY(),false,true);
  Query qMaxY=NumericRangeQuery.newDoubleRange(field_maxY,precisionStep,bbox.getMaxY(),null,true,false);
  Query yConditions=this.makeQuery(BooleanClause.Occur.MUST,qMinY,qMaxY);
  Query xConditions;
  if (!bbox.getCrossesDateLine()) {
    Query qMinX=NumericRangeQuery.newDoubleRange(field_minX,precisionStep,null,bbox.getMinX(),false,true);
    Query qMaxX=NumericRangeQuery.newDoubleRange(field_maxX,precisionStep,bbox.getMaxX(),null,true,false);
    Query qMinMax=this.makeQuery(BooleanClause.Occur.MUST,qMinX,qMaxX);
    Query qNonXDL=this.makeXDL(false,qMinMax);
    Query qXDLLeft=NumericRangeQuery.newDoubleRange(field_minX,precisionStep,null,bbox.getMinX(),false,true);
    Query qXDLRight=NumericRangeQuery.newDoubleRange(field_maxX,precisionStep,bbox.getMaxX(),null,true,false);
    Query qXDLLeftRight=this.makeQuery(BooleanClause.Occur.SHOULD,qXDLLeft,qXDLRight);
    Query qXDL=this.makeXDL(true,qXDLLeftRight);
    xConditions=this.makeQuery(BooleanClause.Occur.SHOULD,qNonXDL,qXDL);
  }
 else {
    Query qXDLLeft=NumericRangeQuery.newDoubleRange(field_minX,precisionStep,null,bbox.getMinX(),false,true);
    Query qXDLRight=NumericRangeQuery.newDoubleRange(field_maxX,precisionStep,bbox.getMaxX(),null,true,false);
    Query qXDLLeftRight=this.makeQuery(BooleanClause.Occur.MUST,qXDLLeft,qXDLRight);
    xConditions=this.makeXDL(true,qXDLLeftRight);
  }
  return this.makeQuery(BooleanClause.Occur.MUST,xConditions,yConditions);
}
