{
  Directory indexDir=new RAMDirectory();
  TaxonomyWriter tw=new LuceneTaxonomyWriter(indexDir);
  fillTaxonomy(tw);
  tw.close();
  TaxonomyReader tr=new LuceneTaxonomyReader(indexDir);
  int[] parents=tr.getParentArray();
  assertEquals(tr.getSize(),parents.length);
  for (int i=0; i < tr.getSize(); i++) {
    assertEquals(tr.getParent(i),parents[i]);
  }
  tr.close();
}
