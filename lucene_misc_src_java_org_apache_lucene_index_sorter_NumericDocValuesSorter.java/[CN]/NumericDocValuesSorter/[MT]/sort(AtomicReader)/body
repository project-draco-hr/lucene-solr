{
  final NumericDocValues ndv=reader.getNumericDocValues(fieldName);
  final DocComparator comparator;
  if (ascending) {
    comparator=new DocComparator(){
      @Override public int compare(      int docID1,      int docID2){
        final long v1=ndv.get(docID1);
        final long v2=ndv.get(docID2);
        return v1 < v2 ? -1 : v1 == v2 ? 0 : 1;
      }
    }
;
  }
 else {
    comparator=new DocComparator(){
      @Override public int compare(      int docID1,      int docID2){
        final long v1=ndv.get(docID1);
        final long v2=ndv.get(docID2);
        return v1 > v2 ? -1 : v1 == v2 ? 0 : 1;
      }
    }
;
  }
  return sort(reader.maxDoc(),comparator);
}
