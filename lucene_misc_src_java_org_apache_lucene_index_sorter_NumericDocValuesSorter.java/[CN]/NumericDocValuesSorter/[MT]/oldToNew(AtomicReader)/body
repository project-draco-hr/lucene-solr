{
  final NumericDocValues ndv=reader.getNumericDocValues(fieldName);
  final int maxDoc=reader.maxDoc();
  final int[] docs=new int[maxDoc];
  final List<Long> values=new AbstractList<Long>(){
    @Override public Long get(    int doc){
      return ndv.get(doc);
    }
    @Override public int size(){
      return reader.maxDoc();
    }
  }
;
  for (int i=0; i < maxDoc; i++) {
    docs[i]=i;
  }
  return compute(docs,values);
}
