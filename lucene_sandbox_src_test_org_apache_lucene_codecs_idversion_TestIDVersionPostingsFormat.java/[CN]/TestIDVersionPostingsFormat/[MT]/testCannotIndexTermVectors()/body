{
  Directory dir=newDirectory();
  IndexWriterConfig iwc=newIndexWriterConfig(new MockAnalyzer(random()));
  iwc.setCodec(TestUtil.alwaysPostingsFormat(new IDVersionPostingsFormat()));
  RandomIndexWriter w=new RandomIndexWriter(random(),dir,iwc);
  Document doc=new Document();
  FieldType ft=new FieldType(StringAndPayloadField.TYPE);
  ft.setStoreTermVectors(true);
  SingleTokenWithPayloadTokenStream ts=new SingleTokenWithPayloadTokenStream();
  BytesRef payload=new BytesRef(8);
  payload.length=8;
  IDVersionPostingsFormat.longToBytes(17,payload);
  ts.setValue("foo",payload);
  Field field=new Field("id",ts,ft);
  doc.add(new Field("id",ts,ft));
  try {
    w.addDocument(doc);
    w.commit();
    fail("didn't hit expected exception");
  }
 catch (  IllegalArgumentException iae) {
  }
  w.close();
  dir.close();
}
