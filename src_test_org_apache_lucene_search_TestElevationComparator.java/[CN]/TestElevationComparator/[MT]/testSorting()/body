{
  Directory directory=new MockRAMDirectory();
  IndexWriter writer=new IndexWriter(directory,new WhitespaceAnalyzer(TEST_VERSION_CURRENT),true,IndexWriter.MaxFieldLength.LIMITED);
  writer.setMaxBufferedDocs(2);
  writer.setMergeFactor(1000);
  writer.addDocument(adoc(new String[]{"id","a","title","ipod","str_s","a"}));
  writer.addDocument(adoc(new String[]{"id","b","title","ipod ipod","str_s","b"}));
  writer.addDocument(adoc(new String[]{"id","c","title","ipod ipod ipod","str_s","c"}));
  writer.addDocument(adoc(new String[]{"id","x","title","boosted","str_s","x"}));
  writer.addDocument(adoc(new String[]{"id","y","title","boosted boosted","str_s","y"}));
  writer.addDocument(adoc(new String[]{"id","z","title","boosted boosted boosted","str_s","z"}));
  IndexReader r=writer.getReader();
  writer.close();
  IndexSearcher searcher=new IndexSearcher(r);
  runTest(searcher,true);
  runTest(searcher,false);
  searcher.close();
  r.close();
  directory.close();
}
