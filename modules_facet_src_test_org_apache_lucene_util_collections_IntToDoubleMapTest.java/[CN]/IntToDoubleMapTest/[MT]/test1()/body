{
  IntToDoubleMap map=new IntToDoubleMap();
  for (int i=0; i < 100; ++i) {
    map.put(i,Integer.valueOf(100 + i));
  }
  HashSet<Double> set=new HashSet<Double>();
  for (DoubleIterator iterator=map.iterator(); iterator.hasNext(); ) {
    set.add(iterator.next());
  }
  assertEquals(set.size(),map.size());
  for (int i=0; i < 100; ++i) {
    assertTrue(set.contains(Double.valueOf(100 + i)));
  }
  set.clear();
  for (DoubleIterator iterator=map.iterator(); iterator.hasNext(); ) {
    double d=iterator.next();
    if (d % 2 == 1) {
      iterator.remove();
      continue;
    }
    set.add(d);
  }
  assertEquals(set.size(),map.size());
  for (int i=0; i < 100; i+=2) {
    assertTrue(set.contains(Double.valueOf(100 + i)));
  }
}
