{
  VariableResolver vr=context.getVariableResolver();
  String expr=context.getEntityAttribute(LOG_TEMPLATE);
  String level=vr.replaceTokens(context.getEntityAttribute(LOG_LEVEL));
  if (expr == null || level == null)   return row;
  if ("info".equals(level)) {
    if (LOG.isInfoEnabled())     LOG.info(vr.replaceTokens(expr));
  }
 else   if ("trace".equals(level)) {
    if (LOG.isTraceEnabled())     LOG.trace(vr.replaceTokens(expr));
  }
 else   if ("warn".equals(level)) {
    if (LOG.isWarnEnabled())     LOG.warn(vr.replaceTokens(expr));
  }
 else   if ("error".equals(level)) {
    if (LOG.isErrorEnabled())     LOG.error(vr.replaceTokens(expr));
  }
 else   if ("debug".equals(level)) {
    if (LOG.isDebugEnabled())     LOG.debug(vr.replaceTokens(expr));
  }
  return row;
}
