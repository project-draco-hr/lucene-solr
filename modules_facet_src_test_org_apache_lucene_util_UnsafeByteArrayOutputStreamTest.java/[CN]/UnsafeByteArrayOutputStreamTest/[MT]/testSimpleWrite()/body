{
  int length=100;
  byte[] buffer=new byte[length];
  UnsafeByteArrayOutputStream ubaos=new UnsafeByteArrayOutputStream(buffer);
  for (int i=0; i < 100; i++) {
    ubaos.write((byte)i);
  }
  byte[] result=ubaos.toByteArray();
  assertEquals(length,ubaos.length());
  for (int j=0; j < length; ++j) {
    assertEquals(result[j],j);
  }
}
