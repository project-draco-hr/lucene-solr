{
  final int[] start=new int[docValuesIdx.length];
  TypePromoter promoter=TypePromoter.getIdentityPromoter();
  for (int i=0; i < docValuesIdx.length; i++) {
    start[i]=docValuesIdx[i].start;
    if (!(docValuesIdx[i].docValues instanceof EmptyDocValues)) {
      final TypePromoter incomingPromoter=TypePromoter.create(docValuesIdx[i].docValues.type(),docValuesIdx[i].docValues.getValueSize());
      promoter=promoter.promote(incomingPromoter);
      if (promoter == null) {
        throw new IllegalStateException("Can not promote " + incomingPromoter);
      }
    }
  }
  this.type=promoter.type();
  this.valueSize=promoter.getValueSize();
  this.starts=start;
  this.docValuesIdx=docValuesIdx;
  return this;
}
