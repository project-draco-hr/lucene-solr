{
  if (random().nextInt(4) > 0) {
    this.ctx=SpatialContext.GEO;
  }
 else {
    SpatialContextFactory factory=new SpatialContextFactory();
    factory.geo=false;
    factory.worldBounds=new RectangleImpl(-300,300,-100,100,null);
    this.ctx=factory.newSpatialContext();
  }
  this.strategy=new BBoxStrategy(ctx,"bbox");
  if (random().nextBoolean()) {
    BBoxStrategy bboxStrategy=(BBoxStrategy)strategy;
    FieldType fieldType=new FieldType(bboxStrategy.getFieldType());
    fieldType.setDocValueType(null);
    bboxStrategy.setFieldType(fieldType);
  }
  for (  SpatialOperation operation : SpatialOperation.values()) {
    if (operation == SpatialOperation.Overlaps)     continue;
    testOperationRandomShapes(operation);
    deleteAll();
    commit();
  }
}
