{
  SchemaField sf=fcontext.searcher.getSchema().getField(field);
  FieldType ft=sf.getType();
  boolean multiToken=sf.multiValued() || ft.multiValuedFieldCache();
  if (method == FacetMethod.ENUM && sf.indexed()) {
    throw new UnsupportedOperationException();
  }
 else   if (method == FacetMethod.STREAM && sf.indexed()) {
    return new FacetFieldProcessorStream(fcontext,this,sf);
  }
  if (!multiToken || sf.hasDocValues()) {
    return new FacetFieldProcessorDV(fcontext,this,sf);
  }
  if (multiToken) {
    return new FacetFieldProcessorUIF(fcontext,this,sf);
  }
 else {
    return new FacetFieldProcessorFC(fcontext,this,sf);
  }
}
