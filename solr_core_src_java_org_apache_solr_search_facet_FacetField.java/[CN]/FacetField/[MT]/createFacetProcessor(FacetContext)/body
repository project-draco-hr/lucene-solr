{
  SchemaField sf=fcontext.searcher.getSchema().getField(field);
  FieldType ft=sf.getType();
  boolean multiToken=sf.multiValued() || ft.multiValuedFieldCache();
  if (method == FacetMethod.ENUM && sf.indexed()) {
    throw new UnsupportedOperationException();
  }
 else   if (method == FacetMethod.STREAM && sf.indexed()) {
    return new FacetFieldProcessorStream(fcontext,this,sf);
  }
  org.apache.lucene.document.FieldType.LegacyNumericType ntype=ft.getNumericType();
  if (sf.hasDocValues() && ntype == null) {
    return new FacetFieldProcessorDV(fcontext,this,sf);
  }
  if (!multiToken) {
    if (sf.getType().getNumericType() != null) {
      return new FacetFieldProcessorNumeric(fcontext,this,sf);
    }
 else {
      return new FacetFieldProcessorDV(fcontext,this,sf);
    }
  }
  if (method == FacetMethod.DV) {
    return new FacetFieldProcessorDV(fcontext,this,sf);
  }
  return new FacetFieldProcessorUIF(fcontext,this,sf);
}
