{
  File tmpFile=null;
  try {
    tmpFile=File.createTempFile("solr",".xml",configFile.getParentFile());
    java.io.FileOutputStream out=new java.io.FileOutputStream(tmpFile);
synchronized (cores) {
      Writer writer=new BufferedWriter(new OutputStreamWriter(out,"UTF-8"));
      persist(writer);
      writer.flush();
      writer.close();
      out.close();
      if (tmpFile.renameTo(configFile))       tmpFile=null;
 else       fileCopy(tmpFile,configFile);
    }
  }
 catch (  java.io.FileNotFoundException xnf) {
    throw new SolrException(SolrException.ErrorCode.SERVER_ERROR,xnf);
  }
catch (  java.io.IOException xio) {
    throw new SolrException(SolrException.ErrorCode.SERVER_ERROR,xio);
  }
 finally {
    if (tmpFile != null) {
      if (!tmpFile.delete())       tmpFile.deleteOnExit();
    }
  }
}
