{
  String input="1234\ud801\udc1c789123\ud801\ud801\udc1c\ud801";
  CharacterUtils instance=CharacterUtils.getInstance(Version.LUCENE_30);
  Reader reader=new StringReader(input);
  CharacterBuffer buffer=CharacterUtils.newCharacterBuffer(5);
  assertTrue(instance.fill(buffer,reader));
  assertEquals(5,buffer.getLength());
  assertEquals("1234\ud801",new String(buffer.getBuffer(),buffer.getOffset(),buffer.getLength()));
  assertTrue(instance.fill(buffer,reader));
  assertEquals(5,buffer.getLength());
  assertEquals("\udc1c7891",new String(buffer.getBuffer()));
  buffer=CharacterUtils.newCharacterBuffer(6);
  assertTrue(instance.fill(buffer,reader));
  assertEquals(6,buffer.getLength());
  assertEquals("23\ud801\ud801\udc1c\ud801",new String(buffer.getBuffer(),buffer.getOffset(),buffer.getLength()));
  assertFalse(instance.fill(buffer,reader));
}
