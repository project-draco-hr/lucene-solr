{
  String startDate=getLocalizedDate(2002,1,1,false);
  String endDate=getLocalizedDate(2002,1,4,false);
  Calendar endDateExpected=Calendar.getInstance();
  endDateExpected.set(2002,1,4,23,59,59);
  endDateExpected.set(Calendar.MILLISECOND,999);
  final String defaultField="default";
  final String monthField="month";
  final String hourField="hour";
  QueryParserWrapper qp=new QueryParserWrapper("field",new SimpleAnalyzer());
  assertDateRangeQueryEquals(qp,defaultField,startDate,endDate,endDateExpected.getTime(),null);
  qp.setDateResolution(monthField,DateTools.Resolution.MONTH);
  assertDateRangeQueryEquals(qp,defaultField,startDate,endDate,endDateExpected.getTime(),null);
  qp.setDateResolution(DateTools.Resolution.MILLISECOND);
  qp.setDateResolution(hourField,DateTools.Resolution.HOUR);
  assertDateRangeQueryEquals(qp,defaultField,startDate,endDate,endDateExpected.getTime(),DateTools.Resolution.MILLISECOND);
  assertDateRangeQueryEquals(qp,monthField,startDate,endDate,endDateExpected.getTime(),DateTools.Resolution.MONTH);
  assertDateRangeQueryEquals(qp,hourField,startDate,endDate,endDateExpected.getTime(),DateTools.Resolution.HOUR);
}
