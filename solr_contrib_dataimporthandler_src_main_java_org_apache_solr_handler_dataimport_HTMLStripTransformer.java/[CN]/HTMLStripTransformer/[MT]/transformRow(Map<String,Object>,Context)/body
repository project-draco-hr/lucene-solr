{
  List<Map<String,String>> fields=context.getAllEntityFields();
  for (  Map<String,String> field : fields) {
    String col=field.get(DataImporter.COLUMN);
    String splitHTML=context.replaceTokens(field.get(STRIP_HTML));
    if (!TRUE.equals(splitHTML))     continue;
    Object tmpVal=row.get(col);
    if (tmpVal == null)     continue;
    if (tmpVal instanceof List) {
      List<String> inputs=(List<String>)tmpVal;
      List results=new ArrayList();
      for (      String input : inputs) {
        if (input == null)         continue;
        Object o=stripHTML(input,col);
        if (o != null)         results.add(o);
      }
      row.put(col,results);
    }
 else {
      String value=tmpVal.toString();
      Object o=stripHTML(value,col);
      if (o != null)       row.put(col,o);
    }
  }
  return row;
}
