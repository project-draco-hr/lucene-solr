{
  int cnt=random().nextInt(2) + 1;
  for (int i=0; i < cnt; i++) {
    createAndDeleteCollection();
  }
  if (testRestartIntoSafeMode) {
    createCollection(DELETE_DATA_DIR_COLLECTION,1,1,1);
    waitForRecoveriesToFinish(DELETE_DATA_DIR_COLLECTION,false);
    ChaosMonkey.stop(jettys.get(0));
    NameNodeAdapter.enterSafeMode(dfsCluster.getNameNode(),false);
    int rnd=LuceneTestCase.random().nextInt(10000);
    Timer timer=new Timer();
    timer.schedule(new TimerTask(){
      @Override public void run(){
        NameNodeAdapter.leaveSafeMode(dfsCluster.getNameNode());
      }
    }
,rnd);
    ChaosMonkey.start(jettys.get(0));
    waitForRecoveriesToFinish(DELETE_DATA_DIR_COLLECTION,false);
  }
}
