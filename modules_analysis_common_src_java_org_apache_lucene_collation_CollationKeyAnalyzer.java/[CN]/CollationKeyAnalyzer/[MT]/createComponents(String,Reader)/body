{
  if (matchVersion.onOrAfter(Version.LUCENE_40)) {
    KeywordTokenizer tokenizer=new KeywordTokenizer(factory,reader,KeywordTokenizer.DEFAULT_BUFFER_SIZE);
    return new TokenStreamComponents(tokenizer,tokenizer);
  }
 else {
    KeywordTokenizer tokenizer=new KeywordTokenizer(reader);
    return new TokenStreamComponents(tokenizer,new CollationKeyFilter(tokenizer,collator));
  }
}
