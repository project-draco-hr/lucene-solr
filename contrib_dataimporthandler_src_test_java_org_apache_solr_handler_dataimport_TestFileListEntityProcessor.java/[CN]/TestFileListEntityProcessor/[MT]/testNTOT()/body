{
  long time=System.currentTimeMillis();
  File tmpdir=new File("." + time);
  tmpdir.mkdir();
  tmpdir.deleteOnExit();
  createFile(tmpdir,"a.xml","a.xml".getBytes(),true);
  createFile(tmpdir,"b.xml","b.xml".getBytes(),true);
  createFile(tmpdir,"c.props","c.props".getBytes(),true);
  Map attrs=AbstractDataImportHandlerTest.createMap(FileListEntityProcessor.FILE_NAME,"xml$",FileListEntityProcessor.BASE_DIR,tmpdir.getAbsolutePath(),FileListEntityProcessor.OLDER_THAN,"'NOW'");
  Context c=AbstractDataImportHandlerTest.getContext(null,new VariableResolverImpl(),null,0,Collections.EMPTY_LIST,attrs);
  FileListEntityProcessor fileListEntityProcessor=new FileListEntityProcessor();
  fileListEntityProcessor.init(c);
  List<String> fList=new ArrayList<String>();
  while (true) {
    Map<String,Object> f=fileListEntityProcessor.nextRow();
    if (f == null)     break;
    fList.add((String)f.get(FileListEntityProcessor.ABSOLUTE_FILE));
  }
  System.out.println("List of files when given OLDER_THAN -- " + fList);
  Assert.assertEquals(2,fList.size());
  attrs=AbstractDataImportHandlerTest.createMap(FileListEntityProcessor.FILE_NAME,".xml$",FileListEntityProcessor.BASE_DIR,tmpdir.getAbsolutePath(),FileListEntityProcessor.NEWER_THAN,"'NOW-2HOURS'");
  c=AbstractDataImportHandlerTest.getContext(null,new VariableResolverImpl(),null,0,Collections.EMPTY_LIST,attrs);
  fileListEntityProcessor.init(c);
  fList.clear();
  while (true) {
    Map<String,Object> f=fileListEntityProcessor.nextRow();
    if (f == null)     break;
    fList.add((String)f.get(FileListEntityProcessor.ABSOLUTE_FILE));
  }
  System.out.println("List of files when given NEWER_THAN -- " + fList);
  Assert.assertEquals(2,fList.size());
}
