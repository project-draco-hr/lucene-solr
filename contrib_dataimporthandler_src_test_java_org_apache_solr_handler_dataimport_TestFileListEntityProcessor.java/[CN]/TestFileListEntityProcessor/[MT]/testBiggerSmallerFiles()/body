{
  long time=System.currentTimeMillis();
  File tmpdir=new File("." + time);
  tmpdir.mkdir();
  tmpdir.deleteOnExit();
  long minLength=Long.MAX_VALUE;
  String smallestFile="";
  byte[] content="abcdefgij".getBytes("UTF-8");
  createFile(tmpdir,"a.xml",content,false);
  if (minLength > content.length) {
    minLength=content.length;
    smallestFile="a.xml";
  }
  content="abcdefgij".getBytes("UTF-8");
  createFile(tmpdir,"b.xml",content,false);
  if (minLength > content.length) {
    minLength=content.length;
    smallestFile="b.xml";
  }
  content="abc".getBytes("UTF-8");
  createFile(tmpdir,"c.props",content,false);
  if (minLength > content.length) {
    minLength=content.length;
    smallestFile="c.props";
  }
  Map attrs=AbstractDataImportHandlerTest.createMap(FileListEntityProcessor.FILE_NAME,".*",FileListEntityProcessor.BASE_DIR,tmpdir.getAbsolutePath(),FileListEntityProcessor.BIGGER_THAN,String.valueOf(minLength));
  List<String> fList=getFiles(null,attrs);
  Assert.assertEquals(2,fList.size());
  Set<String> l=new HashSet<String>();
  l.add(new File(tmpdir,"a.xml").getAbsolutePath());
  l.add(new File(tmpdir,"b.xml").getAbsolutePath());
  Assert.assertEquals(l,new HashSet<String>(fList));
  attrs=AbstractDataImportHandlerTest.createMap(FileListEntityProcessor.FILE_NAME,".*",FileListEntityProcessor.BASE_DIR,tmpdir.getAbsolutePath(),FileListEntityProcessor.SMALLER_THAN,String.valueOf(minLength + 1));
  fList=getFiles(null,attrs);
  l.clear();
  l.add(new File(tmpdir,smallestFile).getAbsolutePath());
  Assert.assertEquals(l,new HashSet<String>(fList));
  attrs=AbstractDataImportHandlerTest.createMap(FileListEntityProcessor.FILE_NAME,".*",FileListEntityProcessor.BASE_DIR,tmpdir.getAbsolutePath(),FileListEntityProcessor.SMALLER_THAN,"${a.x}");
  VariableResolverImpl resolver=new VariableResolverImpl();
  resolver.addNamespace("a",AbstractDataImportHandlerTest.createMap("x","4"));
  fList=getFiles(resolver,attrs);
  Assert.assertEquals(l,new HashSet<String>(fList));
}
