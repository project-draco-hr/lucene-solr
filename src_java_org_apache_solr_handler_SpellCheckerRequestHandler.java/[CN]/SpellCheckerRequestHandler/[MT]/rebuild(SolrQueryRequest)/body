{
  if (null == termSourceField) {
    throw new SolrException(SolrException.ErrorCode.SERVER_ERROR,"can't rebuild spellchecker index without termSourceField configured");
  }
  Float threshold;
  try {
    threshold=req.getParams().getFloat("sp.dictionary.threshold",DEFAULT_DICTIONARY_THRESHOLD);
  }
 catch (  NumberFormatException e) {
    throw new RuntimeException("Threshold must be a valid positive float",e);
  }
  IndexReader indexReader=req.getSearcher().getReader();
  Dictionary dictionary=new HighFrequencyDictionary(indexReader,termSourceField,threshold);
  spellChecker.clearIndex();
  spellChecker.indexDictionary(dictionary);
  reopen();
}
