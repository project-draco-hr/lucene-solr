{
  Facets facets;
  if (random().nextBoolean()) {
    facets=new FastTaxonomyFacetCounts(taxoReader,config,c);
  }
 else {
    OrdinalsReader ordsReader=new DocValuesOrdinalsReader();
    if (random().nextBoolean()) {
      ordsReader=new CachedOrdinalsReader(ordsReader);
    }
    facets=new TaxonomyFacetCounts(ordsReader,taxoReader,config,c);
  }
  return facets;
}
