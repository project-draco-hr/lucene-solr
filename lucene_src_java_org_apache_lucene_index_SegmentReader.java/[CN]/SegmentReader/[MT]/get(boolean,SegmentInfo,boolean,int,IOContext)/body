{
  SegmentReader instance=new SegmentReader(readOnly,si);
  boolean success=false;
  try {
    instance.core=new SegmentCoreReaders(instance,si.dir,si,context,termInfosIndexDivisor);
    if (doOpenStores) {
      instance.core.openDocStores(si);
    }
    instance.loadLiveDocs(context);
    success=true;
  }
  finally {
    if (!success) {
      instance.doClose();
    }
  }
  return instance;
}
