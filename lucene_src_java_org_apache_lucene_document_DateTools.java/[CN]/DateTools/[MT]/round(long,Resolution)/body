{
  final Calendar calInstance=FORMATS.get().calInstance;
  calInstance.setTimeInMillis(time);
switch (resolution) {
case YEAR:
    calInstance.set(Calendar.MONTH,0);
  calInstance.set(Calendar.DAY_OF_MONTH,1);
calInstance.set(Calendar.HOUR_OF_DAY,0);
calInstance.set(Calendar.MINUTE,0);
calInstance.set(Calendar.SECOND,0);
calInstance.set(Calendar.MILLISECOND,0);
break;
case MONTH:
calInstance.set(Calendar.DAY_OF_MONTH,1);
calInstance.set(Calendar.HOUR_OF_DAY,0);
calInstance.set(Calendar.MINUTE,0);
calInstance.set(Calendar.SECOND,0);
calInstance.set(Calendar.MILLISECOND,0);
break;
case DAY:
calInstance.set(Calendar.HOUR_OF_DAY,0);
calInstance.set(Calendar.MINUTE,0);
calInstance.set(Calendar.SECOND,0);
calInstance.set(Calendar.MILLISECOND,0);
break;
case HOUR:
calInstance.set(Calendar.MINUTE,0);
calInstance.set(Calendar.SECOND,0);
calInstance.set(Calendar.MILLISECOND,0);
break;
case MINUTE:
calInstance.set(Calendar.SECOND,0);
calInstance.set(Calendar.MILLISECOND,0);
break;
case SECOND:
calInstance.set(Calendar.MILLISECOND,0);
break;
case MILLISECOND:
break;
default :
throw new IllegalArgumentException("unknown resolution " + resolution);
}
return calInstance.getTimeInMillis();
}
