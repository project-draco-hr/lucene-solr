{
  if (random == null || size <= 3L)   return 0L;
  return (random.nextLong() & Long.MAX_VALUE) % (size / 3);
}
