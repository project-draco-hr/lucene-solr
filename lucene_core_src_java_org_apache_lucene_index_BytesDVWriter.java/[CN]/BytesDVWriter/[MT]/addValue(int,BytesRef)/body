{
  final int oldBytesUsed=bytesUsed;
  if (value == null) {
    throw new IllegalArgumentException("null binaryValue not allowed (field=" + fieldInfo.name + ")");
  }
  mergeLength(value.length);
  while (pending.size() < docID) {
    pending.add(BytesRef.EMPTY_BYTES);
    bytesUsed+=(int)(RamUsageEstimator.NUM_BYTES_OBJECT_REF * 1.25);
    mergeLength(0);
  }
  byte[] bytes=new byte[value.length];
  System.arraycopy(value.bytes,value.offset,bytes,0,value.length);
  pending.add(bytes);
  bytesUsed+=(int)(bytes.length + RamUsageEstimator.NUM_BYTES_ARRAY_HEADER + (RamUsageEstimator.NUM_BYTES_OBJECT_REF * 1.25));
  iwBytesUsed.addAndGet(bytesUsed - oldBytesUsed);
}
