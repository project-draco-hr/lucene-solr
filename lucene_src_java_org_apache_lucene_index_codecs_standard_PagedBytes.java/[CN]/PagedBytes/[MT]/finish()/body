{
  if (upto < blockSize) {
    final byte[] newBlock=new byte[upto];
    System.arraycopy(currentBlock,0,newBlock,0,upto);
    currentBlock=newBlock;
  }
  if (currentBlock == null) {
    currentBlock=EMPTY_BYTES;
  }
  blocks.add(currentBlock);
  currentBlock=null;
}
