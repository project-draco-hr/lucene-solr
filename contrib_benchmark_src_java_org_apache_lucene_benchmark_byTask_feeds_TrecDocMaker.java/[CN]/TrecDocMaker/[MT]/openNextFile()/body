{
  closeInputs();
  int retries=0;
  while (true) {
    File f=null;
synchronized (this) {
      if (nextFile >= inputFiles.size()) {
        if (!forever) {
          throw new NoMoreDataException();
        }
        nextFile=0;
        iteration++;
      }
      f=(File)inputFiles.get(nextFile++);
    }
    System.out.println("opening: " + f + " length: "+ f.length());
    try {
      zis=new GZIPInputStream(new BufferedInputStream(new FileInputStream(f)));
      reader=new BufferedReader(new InputStreamReader(zis));
      return;
    }
 catch (    Exception e) {
      retries++;
      if (retries < 20) {
        System.out.println("Skipping 'bad' file " + f.getAbsolutePath() + "  #retries="+ retries);
        continue;
      }
 else {
        throw new NoMoreDataException();
      }
    }
  }
}
