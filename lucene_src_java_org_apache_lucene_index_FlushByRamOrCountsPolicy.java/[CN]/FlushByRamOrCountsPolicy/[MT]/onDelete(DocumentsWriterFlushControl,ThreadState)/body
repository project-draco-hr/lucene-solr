{
  if (flushOnDeleteTerms()) {
    final int maxBufferedDeleteTerms=indexWriterConfig.getMaxBufferedDeleteTerms();
    if (control.getNumGlobalTermDeletes() >= maxBufferedDeleteTerms) {
      control.setApplyAllDeletes();
    }
  }
  final DocumentsWriter writer=this.writer.get();
  if ((flushOnRAM() && writer.deleteQueue.bytesUsed() > (1024 * 1024 * indexWriterConfig.getRAMBufferSizeMB() / 2))) {
    control.setApplyAllDeletes();
    if (writer.infoStream != null) {
      writer.message("force apply deletes bytesUsed=" + writer.deleteQueue.bytesUsed() + " vs ramBuffer="+ (1024 * 1024 * indexWriterConfig.getRAMBufferSizeMB()));
    }
  }
}
