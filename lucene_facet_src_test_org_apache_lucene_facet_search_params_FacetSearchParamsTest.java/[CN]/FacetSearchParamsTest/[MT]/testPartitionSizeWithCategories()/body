{
  Directory dir=newDirectory();
  TaxonomyWriter tw=new DirectoryTaxonomyWriter(dir);
  tw.addCategory(new CategoryPath("a"));
  tw.commit();
  tw.close();
  TaxonomyReader tr=new DirectoryTaxonomyReader(dir);
  assertEquals("unexpected partition offset for 1 categories",2,PartitionsUtils.partitionOffset(FacetIndexingParams.ALL_PARENTS,1,tr));
  assertEquals("unexpected partition size for 1 categories",2,PartitionsUtils.partitionSize(FacetIndexingParams.ALL_PARENTS,tr));
  tr.close();
  dir.close();
}
