{
  try {
    this.authenticated=authenticateAccount(request,AccountRole.USERADMINISTRATOR);
    if (this.authenticated) {
      GDataServerRegistry registry=GDataServerRegistry.getRegistry();
      ServiceFactory factory=registry.lookup(ServiceFactory.class,ComponentType.SERVICEFACTORY);
      try {
        GDataAccount account=getAccountFromRequest(request);
        if (!account.requiredValuesSet()) {
          setError(HttpServletResponse.SC_INTERNAL_SERVER_ERROR,"requiered server component not available");
          throw new AccountHandlerException("requiered values are not set -- account can not be saved -- " + account);
        }
        this.service=factory.getAdminService();
        processServiceAction(account);
      }
 catch (      ServiceException e) {
        LOG.error("Can't process account action -- " + e.getMessage(),e);
        setError(HttpServletResponse.SC_INTERNAL_SERVER_ERROR,"");
      }
catch (      Exception e) {
        LOG.error("Can't process account action -- " + e.getMessage(),e);
      }
    }
 else {
      setError(HttpServletResponse.SC_UNAUTHORIZED,"Authorization failed");
    }
    sendResponse(response);
  }
  finally {
    if (this.service != null)     this.service.close();
  }
}
