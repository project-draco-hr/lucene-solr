{
  String rootThrowable=null;
  if (e instanceof RemoteSolrException) {
    rootThrowable=((RemoteSolrException)e).getRootThrowable();
  }
  if (e != null && (rootThrowable == null || !okayExceptions.contains(rootThrowable))) {
    log.error("Error from shard: " + shard,e);
    SimpleOrderedMap failure=(SimpleOrderedMap)results.get("failure");
    if (failure == null) {
      failure=new SimpleOrderedMap();
      results.add("failure",failure);
    }
    failure.add(nodeName,e.getClass().getName() + ":" + e.getMessage());
  }
 else {
    SimpleOrderedMap success=(SimpleOrderedMap)results.get("success");
    if (success == null) {
      success=new SimpleOrderedMap();
      results.add("success",success);
    }
    success.add(nodeName,solrResponse.getResponse());
  }
}
