{
  Map<String,Replica> shards=slice.getReplicasMap();
  Set<Map.Entry<String,Replica>> shardEntries=shards.entrySet();
  for (  Map.Entry<String,Replica> shardEntry : shardEntries) {
    final ZkNodeProps node=shardEntry.getValue();
    if (clusterState.liveNodesContain(node.getStr(ZkStateReader.NODE_NAME_PROP)) && (stateMatcher == null || Replica.State.getState(node.getStr(ZkStateReader.STATE_PROP)) == stateMatcher)) {
      ModifiableSolrParams cloneParams=new ModifiableSolrParams();
      cloneParams.add(params);
      cloneParams.set(CoreAdminParams.CORE,node.getStr(ZkStateReader.CORE_NAME_PROP));
      String replica=node.getStr(ZkStateReader.BASE_URL_PROP);
      ShardRequest sreq=new ShardRequest();
      sreq.nodeName=node.getStr(ZkStateReader.NODE_NAME_PROP);
      cloneParams.set("qt",adminPath);
      sreq.purpose=1;
      sreq.shards=new String[]{replica};
      sreq.actualShards=sreq.shards;
      sreq.params=cloneParams;
      log.info("Collection Admin sending CoreAdmin cmd to " + replica + " params:"+ sreq.params);
      shardHandler.submit(sreq,replica,sreq.params);
    }
  }
}
