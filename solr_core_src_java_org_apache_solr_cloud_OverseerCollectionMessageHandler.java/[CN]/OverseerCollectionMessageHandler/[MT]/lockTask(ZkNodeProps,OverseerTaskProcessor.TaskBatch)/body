{
  if (lockSession == null || sessionId != taskBatch.getId()) {
    if (taskBatch.getRunningTasks() == 0)     lockTree.clear();
    lockSession=lockTree.getSession();
  }
  return lockSession.lock(getCollectionAction(message.getStr(Overseer.QUEUE_OPERATION)),Arrays.asList(getTaskKey(message),message.getStr(ZkStateReader.SHARD_ID_PROP),message.getStr(ZkStateReader.REPLICA_PROP)));
}
