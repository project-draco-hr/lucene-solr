{
  BytesRef bytes=new BytesRef(values.length);
  for (int i=100; i != 0; --i) {
    IntsRef data=newIntsRef(values);
    encoder.encode(data,bytes);
  }
  long encodeTime=0;
  for (int factor=loopFactor; factor > 0; --factor) {
    IntsRef data=newIntsRef(values);
    long start=System.currentTimeMillis();
    encoder.encode(data,bytes);
    encodeTime+=System.currentTimeMillis() - start;
  }
  IntsRef decoded=new IntsRef(values.length);
  int encodedSize=bytes.length;
  IntDecoder decoder=encoder.createMatchingDecoder();
  for (int i=100; i != 0; --i) {
    decoder.decode(bytes,decoded);
  }
  long decodeTime=0;
  for (int i=loopFactor; i > 0; --i) {
    long start=System.currentTimeMillis();
    decoder.decode(bytes,decoded);
    decodeTime+=System.currentTimeMillis() - start;
  }
  if (decoded.length != values.length) {
    throw new RuntimeException("wrong num values. expected=" + values.length + " actual="+ decoded.length+ " decoder="+ decoder);
  }
  System.out.println(String.format(Locale.ROOT,resultsFormat,encoder,nf.format(encodedSize * 8.0 / values.length),encodeTime,nf.format(encodeTime * 1000000.0 / (loopFactor * values.length)),decodeTime,nf.format(decodeTime * 1000000.0 / (loopFactor * values.length))));
}
