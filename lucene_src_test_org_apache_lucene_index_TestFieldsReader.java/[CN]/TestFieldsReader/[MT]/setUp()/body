{
  super.setUp();
  fieldInfos=new FieldInfos();
  DocHelper.setupDoc(testDoc);
  fieldInfos.add(testDoc);
  dir=newDirectory();
  IndexWriterConfig conf=newIndexWriterConfig(TEST_VERSION_CURRENT,new MockAnalyzer());
  ((LogMergePolicy)conf.getMergePolicy()).setUseCompoundFile(false);
  ((LogMergePolicy)conf.getMergePolicy()).setUseCompoundDocStore(false);
  IndexWriter writer=new IndexWriter(dir,conf);
  writer.addDocument(testDoc);
  writer.close();
  FaultyIndexInput.doFail=false;
}
