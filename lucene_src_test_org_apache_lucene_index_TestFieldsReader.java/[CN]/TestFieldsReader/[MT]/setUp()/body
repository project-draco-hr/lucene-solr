{
  super.setUp();
  fieldInfos=new FieldInfos();
  DocHelper.setupDoc(testDoc);
  _TestUtil.add(testDoc,fieldInfos);
  dir=newDirectory();
  IndexWriterConfig conf=newIndexWriterConfig(TEST_VERSION_CURRENT,new MockAnalyzer(random)).setMergePolicy(newLogMergePolicy());
  ((LogMergePolicy)conf.getMergePolicy()).setUseCompoundFile(false);
  IndexWriter writer=new IndexWriter(dir,conf);
  writer.addDocument(testDoc);
  writer.close();
  FaultyIndexInput.doFail=false;
}
