{
  Similarity similarity=getSimilarity();
  float[] normDecoder=Similarity.getNormDecoder();
  while (doc < end) {
    int f=freqs[pointer];
    float score=f < SCORE_CACHE_SIZE ? scoreCache[f] : similarity.tf(f) * weightValue;
    score*=normDecoder[norms[doc] & 0xFF];
    c.collect(doc,score);
    if (++pointer >= pointerMax) {
      pointerMax=termDocs.read(docs,freqs);
      if (pointerMax != 0) {
        pointer=0;
      }
 else {
        termDocs.close();
        doc=Integer.MAX_VALUE;
        return false;
      }
    }
    doc=docs[pointer];
  }
  return true;
}
