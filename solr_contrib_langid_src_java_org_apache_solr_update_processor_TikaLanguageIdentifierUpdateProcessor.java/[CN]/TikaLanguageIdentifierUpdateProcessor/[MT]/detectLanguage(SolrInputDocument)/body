{
  List<DetectedLanguage> languages=new ArrayList<>();
  String content=concatFields(doc);
  if (content.length() != 0) {
    LanguageIdentifier identifier=new LanguageIdentifier(content);
    Double distance=Double.parseDouble(tikaSimilarityPattern.matcher(identifier.toString()).replaceFirst("$1"));
    Double certainty=1 - (5 * distance);
    certainty=(certainty < 0) ? 0 : certainty;
    DetectedLanguage language=new DetectedLanguage(identifier.getLanguage(),certainty);
    languages.add(language);
    log.debug("Language detected as " + language + " with a certainty of "+ language.getCertainty()+ " (Tika distance="+ identifier.toString()+ ")");
  }
 else {
    log.debug("No input text to detect language from, returning empty list");
  }
  return languages;
}
