{
  if (sortComparator == null) {
    sortComparator=BytesRef.getUTF8SortedAsUnicodeComparator();
  }
  if (fixedSize) {
    if (mode == Mode.STRAIGHT) {
      return new FixedStraightBytesImpl.FixedStraightReader(dir,id,maxDoc,context);
    }
 else     if (mode == Mode.DEREF) {
      return new FixedDerefBytesImpl.FixedDerefReader(dir,id,maxDoc,context);
    }
 else     if (mode == Mode.SORTED) {
      return new FixedSortedBytesImpl.Reader(dir,id,maxDoc,context,Type.BYTES_FIXED_SORTED,sortComparator);
    }
  }
 else {
    if (mode == Mode.STRAIGHT) {
      return new VarStraightBytesImpl.VarStraightReader(dir,id,maxDoc,context);
    }
 else     if (mode == Mode.DEREF) {
      return new VarDerefBytesImpl.VarDerefReader(dir,id,maxDoc,context);
    }
 else     if (mode == Mode.SORTED) {
      return new VarSortedBytesImpl.Reader(dir,id,maxDoc,context,Type.BYTES_VAR_SORTED,sortComparator);
    }
  }
  throw new IllegalArgumentException("Illegal Mode: " + mode);
}
