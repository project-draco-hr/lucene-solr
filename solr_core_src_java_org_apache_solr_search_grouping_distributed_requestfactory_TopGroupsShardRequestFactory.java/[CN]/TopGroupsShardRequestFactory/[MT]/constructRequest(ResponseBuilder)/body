{
  boolean containsGroupByQuery=rb.getGroupingSpec().getQueries().length > 0;
  if (rb.isNeedDocSet() || containsGroupByQuery) {
    return createRequestForAllShards(rb);
  }
 else {
    return createRequestForSpecificShards(rb);
  }
}
