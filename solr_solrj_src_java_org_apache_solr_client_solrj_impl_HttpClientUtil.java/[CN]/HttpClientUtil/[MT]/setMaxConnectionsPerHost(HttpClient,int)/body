{
  if (httpClient.getConnectionManager() instanceof ThreadSafeClientConnManager) {
    ThreadSafeClientConnManager mgr=(ThreadSafeClientConnManager)httpClient.getConnectionManager();
    mgr.setDefaultMaxPerRoute(max);
  }
 else   if (httpClient.getConnectionManager() instanceof PoolingClientConnectionManager) {
    PoolingClientConnectionManager mgr=(PoolingClientConnectionManager)httpClient.getConnectionManager();
    mgr.setDefaultMaxPerRoute(max);
  }
}
