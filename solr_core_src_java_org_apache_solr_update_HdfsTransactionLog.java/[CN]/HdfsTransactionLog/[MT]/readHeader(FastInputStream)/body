{
  boolean closeFis=false;
  if (fis == null)   closeFis=true;
  fis=fis != null ? fis : new FSDataFastInputStream(fs.open(tlogFile),0);
  Map header=null;
  try {
    LogCodec codec=new LogCodec(resolver);
    header=(Map)codec.unmarshal(fis);
    fis.readInt();
  }
  finally {
    if (fis != null && closeFis) {
      fis.close();
    }
  }
synchronized (this) {
    globalStringList=(List<String>)header.get("strings");
    globalStringMap=new HashMap<>(globalStringList.size());
    for (int i=0; i < globalStringList.size(); i++) {
      globalStringMap.put(globalStringList.get(i),i + 1);
    }
  }
}
