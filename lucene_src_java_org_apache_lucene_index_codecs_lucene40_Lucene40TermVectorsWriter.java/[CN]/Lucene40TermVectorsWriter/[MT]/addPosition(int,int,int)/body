{
  if (positions && offsets) {
    tvf.writeVInt(position - lastPosition);
    lastPosition=position;
    offsetStartBuffer[offsetIndex]=startOffset;
    offsetEndBuffer[offsetIndex]=endOffset;
    offsetIndex++;
    if (offsetIndex == offsetFreq) {
      for (int i=0; i < offsetIndex; i++) {
        tvf.writeVInt(offsetStartBuffer[i] - lastOffset);
        tvf.writeVInt(offsetEndBuffer[i] - offsetStartBuffer[i]);
        lastOffset=offsetEndBuffer[i];
      }
    }
  }
 else   if (positions) {
    tvf.writeVInt(position - lastPosition);
    lastPosition=position;
  }
 else   if (offsets) {
    tvf.writeVInt(startOffset - lastOffset);
    tvf.writeVInt(endOffset - startOffset);
    lastOffset=endOffset;
  }
}
