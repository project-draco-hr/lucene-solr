{
  if (hitDocs.size() > min) {
    min=hitDocs.size();
  }
  int n=min * 2;
  TopDocs topDocs=(sort == null) ? searcher.search(weight,filter,n) : searcher.search(weight,filter,n,sort);
  length=topDocs.totalHits;
  ScoreDoc[] scoreDocs=topDocs.scoreDocs;
  float scoreNorm=1.0f;
  if (length > 0 && topDocs.getMaxScore() > 1.0f) {
    scoreNorm=1.0f / topDocs.getMaxScore();
  }
  int end=scoreDocs.length < length ? scoreDocs.length : length;
  for (int i=hitDocs.size(); i < end; i++) {
    hitDocs.addElement(new HitDoc(scoreDocs[i].score * scoreNorm,scoreDocs[i].doc));
  }
}
