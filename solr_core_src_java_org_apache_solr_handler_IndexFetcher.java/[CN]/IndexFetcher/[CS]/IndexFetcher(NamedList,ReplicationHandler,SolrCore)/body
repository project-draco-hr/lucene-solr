{
  solrCore=sc;
  String masterUrl=(String)initArgs.get(MASTER_URL);
  if (masterUrl == null)   throw new SolrException(SolrException.ErrorCode.SERVER_ERROR,"'masterUrl' is required for a slave");
  if (masterUrl.endsWith("/replication")) {
    masterUrl=masterUrl.substring(0,masterUrl.length() - 12);
    LOG.warn("'masterUrl' must be specified without the /replication suffix");
  }
  this.masterUrl=masterUrl;
  this.replicationHandler=handler;
  String compress=(String)initArgs.get(COMPRESSION);
  useInternalCompression=INTERNAL.equals(compress);
  useExternalCompression=EXTERNAL.equals(compress);
  String connTimeout=(String)initArgs.get(HttpClientUtil.PROP_CONNECTION_TIMEOUT);
  String readTimeout=(String)initArgs.get(HttpClientUtil.PROP_SO_TIMEOUT);
  String httpBasicAuthUser=(String)initArgs.get(HttpClientUtil.PROP_BASIC_AUTH_USER);
  String httpBasicAuthPassword=(String)initArgs.get(HttpClientUtil.PROP_BASIC_AUTH_PASS);
  myHttpClient=createHttpClient(solrCore,connTimeout,readTimeout,httpBasicAuthUser,httpBasicAuthPassword,useExternalCompression);
}
