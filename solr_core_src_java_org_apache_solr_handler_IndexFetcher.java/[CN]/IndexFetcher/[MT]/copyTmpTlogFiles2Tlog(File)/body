{
  Path tlogDir=FileSystems.getDefault().getPath(solrCore.getUpdateHandler().getUpdateLog().getLogDir());
  Path backupTlogDir=FileSystems.getDefault().getPath(tlogDir.getParent().toAbsolutePath().toString(),tmpTlogDir.getName());
  try {
    Files.move(tlogDir,backupTlogDir,StandardCopyOption.ATOMIC_MOVE);
  }
 catch (  IOException e) {
    SolrException.log(LOG,"Unable to rename: " + tlogDir + " to: "+ backupTlogDir,e);
    return false;
  }
  Path src=FileSystems.getDefault().getPath(backupTlogDir.toAbsolutePath().toString(),tmpTlogDir.getName());
  try {
    Files.move(src,tlogDir,StandardCopyOption.ATOMIC_MOVE);
  }
 catch (  IOException e) {
    SolrException.log(LOG,"Unable to rename: " + src + " to: "+ tlogDir,e);
    try {
      Files.move(backupTlogDir,tlogDir,StandardCopyOption.ATOMIC_MOVE);
    }
 catch (    IOException e2) {
      throw new SolrException(SolrException.ErrorCode.SERVER_ERROR,"Unable to rename: " + backupTlogDir + " to: "+ tlogDir);
    }
    return false;
  }
  return true;
}
