{
  LOG.debug("Moving file: {}",fname);
  boolean success=false;
  try {
    if (slowFileExists(indexDir,fname)) {
      LOG.warn("Cannot complete replication attempt because file already exists:" + fname);
      return false;
    }
  }
 catch (  IOException e) {
    SolrException.log(LOG,"could not check if a file exists",e);
    return false;
  }
  try {
    solrCore.getDirectoryFactory().move(tmpIdxDir,indexDir,fname,DirectoryFactory.IOCONTEXT_NO_CACHE);
    success=true;
  }
 catch (  IOException e) {
    SolrException.log(LOG,"Could not move file",e);
  }
  return success;
}
