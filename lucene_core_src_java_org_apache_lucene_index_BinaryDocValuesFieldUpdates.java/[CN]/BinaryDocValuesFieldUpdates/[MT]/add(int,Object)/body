{
  if (size == Integer.MAX_VALUE) {
    throw new IllegalStateException("cannot support more than Integer.MAX_VALUE doc/value entries");
  }
  BytesRef val=(BytesRef)value;
  if (docs.size() == size) {
    docs=docs.grow(size + 1);
    offsets=offsets.grow(size + 1);
    lengths=lengths.grow(size + 1);
  }
  docs.set(size,doc);
  offsets.set(size,values.length());
  lengths.set(size,val.length);
  values.append(val);
  ++size;
}
