{
  final PagedMutable docs=this.docs;
  final PagedGrowableWriter offsets=this.offsets;
  final PagedGrowableWriter lengths=this.lengths;
  final BytesRef values=this.values.get();
  new InPlaceMergeSorter(){
    @Override protected void swap(    int i,    int j){
      long tmpDoc=docs.get(j);
      docs.set(j,docs.get(i));
      docs.set(i,tmpDoc);
      long tmpOffset=offsets.get(j);
      offsets.set(j,offsets.get(i));
      offsets.set(i,tmpOffset);
      long tmpLength=lengths.get(j);
      lengths.set(j,lengths.get(i));
      lengths.set(i,tmpLength);
    }
    @Override protected int compare(    int i,    int j){
      int x=(int)docs.get(i);
      int y=(int)docs.get(j);
      return (x < y) ? -1 : ((x == y) ? 0 : 1);
    }
  }
.sort(0,size);
  return new Iterator(size,offsets,lengths,docs,values);
}
