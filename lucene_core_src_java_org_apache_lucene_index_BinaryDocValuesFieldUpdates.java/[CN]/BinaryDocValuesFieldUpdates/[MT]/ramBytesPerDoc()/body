{
  long bytesPerDoc=(long)Math.ceil((double)(bitsPerValue + 1) / 8);
  final int capacity=estimateCapacity(size);
  bytesPerDoc+=(long)Math.ceil((double)offsets.ramBytesUsed() / capacity);
  bytesPerDoc+=(long)Math.ceil((double)lengths.ramBytesUsed() / capacity);
  bytesPerDoc+=(long)Math.ceil((double)values.length / size);
  return bytesPerDoc;
}
