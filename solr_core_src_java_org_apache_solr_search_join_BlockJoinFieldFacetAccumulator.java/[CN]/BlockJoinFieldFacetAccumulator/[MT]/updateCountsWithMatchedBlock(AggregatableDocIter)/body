{
  if (segmentSDV != null) {
    for (iter.reset(); iter.hasNext(); ) {
      final int docNum=iter.nextDoc();
      if (docNum > segmentSDV.docID()) {
        segmentSDV.advance(docNum);
      }
      int term;
      if (docNum == segmentSDV.docID()) {
        term=segmentSDV.ordValue();
      }
 else {
        term=-1;
      }
      accumulateTermOrd(term,iter.getAggKey());
    }
  }
 else {
    for (iter.reset(); iter.hasNext(); ) {
      final int docNum=iter.nextDoc();
      if (docNum > segmentSSDV.docID()) {
        segmentSSDV.advance(docNum);
      }
      if (docNum == segmentSSDV.docID()) {
        int term=(int)segmentSSDV.nextOrd();
        do {
          accumulateTermOrd(term,iter.getAggKey());
        }
 while (term >= 0 && (term=(int)segmentSSDV.nextOrd()) >= 0);
      }
    }
  }
}
