{
  this.fieldName=fieldName;
  schemaField=searcher.getSchema().getField(fieldName);
  fieldType=schemaField.getType();
  ordinalMap=null;
  if (schemaField.multiValued()) {
    topSSDV=searcher.getSlowAtomicReader().getSortedSetDocValues(fieldName);
    if (topSSDV instanceof MultiDocValues.MultiSortedSetDocValues) {
      ordinalMap=((MultiDocValues.MultiSortedSetDocValues)topSSDV).mapping;
    }
  }
 else {
    SortedDocValues single=searcher.getSlowAtomicReader().getSortedDocValues(fieldName);
    if (single instanceof MultiDocValues.MultiSortedDocValues) {
      ordinalMap=((MultiDocValues.MultiSortedDocValues)single).mapping;
    }
    if (single != null) {
      topSSDV=DocValues.singleton(single);
    }
  }
}
