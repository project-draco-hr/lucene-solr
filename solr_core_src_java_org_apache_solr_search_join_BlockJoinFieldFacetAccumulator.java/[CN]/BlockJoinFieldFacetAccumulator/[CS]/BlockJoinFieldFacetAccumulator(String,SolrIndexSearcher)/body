{
  this.fieldName=fieldName;
  schemaField=searcher.getSchema().getField(fieldName);
  fieldType=schemaField.getType();
  ordinalMap=null;
  if (schemaField.multiValued()) {
    topSSDV=searcher.getLeafReader().getSortedSetDocValues(fieldName);
    if (topSSDV instanceof MultiDocValues.MultiSortedSetDocValues) {
      ordinalMap=((MultiDocValues.MultiSortedSetDocValues)topSSDV).mapping;
    }
  }
 else {
    SortedDocValues single=searcher.getLeafReader().getSortedDocValues(fieldName);
    topSSDV=single == null ? null : DocValues.singleton(single);
    if (single instanceof MultiDocValues.MultiSortedDocValues) {
      ordinalMap=((MultiDocValues.MultiSortedDocValues)single).mapping;
    }
  }
}
