{
  ChecksumIndexInput input=new BufferedChecksumIndexInput(in);
  BytesRef scratch=new BytesRef(10);
  TreeMap<String,Long> fields=new TreeMap<>();
  while (true) {
    SimpleTextUtil.readLine(input,scratch);
    if (scratch.equals(END)) {
      SimpleTextUtil.checkFooter(input,CHECKSUM);
      return fields;
    }
 else     if (StringHelper.startsWith(scratch,FIELD)) {
      String fieldName=new String(scratch.bytes,scratch.offset + FIELD.length,scratch.length - FIELD.length,StandardCharsets.UTF_8);
      fields.put(fieldName,input.getFilePointer());
    }
  }
}
