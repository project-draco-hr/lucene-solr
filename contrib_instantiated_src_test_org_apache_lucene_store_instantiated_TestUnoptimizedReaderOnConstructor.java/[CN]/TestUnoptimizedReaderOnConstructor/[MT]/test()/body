{
  Directory dir=new RAMDirectory();
  IndexWriter iw=new IndexWriter(dir,new WhitespaceAnalyzer(),true,IndexWriter.MaxFieldLength.UNLIMITED);
  addDocument(iw,"Hello, world!");
  addDocument(iw,"All work and no play makes jack a dull boy");
  iw.commit("a");
  iw.close();
  iw=new IndexWriter(dir,new WhitespaceAnalyzer(),false,IndexWriter.MaxFieldLength.UNLIMITED);
  addDocument(iw,"Hello, tellus!");
  addDocument(iw,"All work and no play makes danny a dull boy");
  iw.commit("b");
  iw.close();
  iw=new IndexWriter(dir,new WhitespaceAnalyzer(),false,IndexWriter.MaxFieldLength.UNLIMITED);
  addDocument(iw,"Hello, earth!");
  addDocument(iw,"All work and no play makes wendy a dull girl");
  iw.commit("c");
  iw.close();
  IndexReader unoptimizedReader=IndexReader.open(dir);
  unoptimizedReader.deleteDocument(2);
  InstantiatedIndex ii=new InstantiatedIndex(unoptimizedReader);
}
