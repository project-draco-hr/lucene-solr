{
  Directory dir=new RAMDirectory();
  IndexWriter iw=new IndexWriter(dir,new WhitespaceAnalyzer(),true,IndexWriter.MaxFieldLength.UNLIMITED);
  addDocument(iw,"Hello, world!");
  addDocument(iw,"All work and no play makes jack a dull boy");
  iw.close();
  iw=new IndexWriter(dir,new WhitespaceAnalyzer(),false,IndexWriter.MaxFieldLength.UNLIMITED);
  addDocument(iw,"Hello, tellus!");
  addDocument(iw,"All work and no play makes danny a dull boy");
  iw.close();
  iw=new IndexWriter(dir,new WhitespaceAnalyzer(),false,IndexWriter.MaxFieldLength.UNLIMITED);
  addDocument(iw,"Hello, earth!");
  addDocument(iw,"All work and no play makes wendy a dull girl");
  iw.close();
  IndexReader unoptimizedReader=IndexReader.open(dir);
  unoptimizedReader.deleteDocument(2);
  InstantiatedIndex ii;
  try {
    ii=new InstantiatedIndex(unoptimizedReader);
  }
 catch (  Exception e) {
    fail("No exceptions when loading an unoptimized reader!");
  }
}
