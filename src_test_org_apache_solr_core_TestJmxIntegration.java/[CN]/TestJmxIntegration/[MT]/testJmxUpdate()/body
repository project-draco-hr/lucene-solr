{
  List<MBeanServer> servers=MBeanServerFactory.findMBeanServer(null);
  System.out.println("Servers in testJmxUpdate: " + servers);
  boolean found=false;
  Set<ObjectInstance> objects=null;
  MBeanServer mbeanServer=null;
  for (  MBeanServer server : servers) {
    objects=server.queryMBeans(null,Query.match(Query.attr("numDocs"),Query.value("*")));
    if (!objects.isEmpty()) {
      found=true;
      mbeanServer=server;
      break;
    }
  }
  if (!found) {
    assertFalse("No MBean for SolrIndexSearcher found in MBeanServer",objects.isEmpty());
  }
  int oldNumDocs=Integer.valueOf((String)mbeanServer.getAttribute(objects.iterator().next().getObjectName(),"numDocs"));
  assertU(adoc("id","1"));
  assertU(commit());
  objects=mbeanServer.queryMBeans(null,Query.match(Query.attr("numDocs"),Query.value("*")));
  assertFalse("No MBean for SolrIndexSearcher found in MBeanServer",objects.isEmpty());
  int numDocs=Integer.valueOf((String)mbeanServer.getAttribute(objects.iterator().next().getObjectName(),"numDocs"));
  assertTrue("New numDocs is same as old numDocs as reported by JMX",numDocs > oldNumDocs);
}
