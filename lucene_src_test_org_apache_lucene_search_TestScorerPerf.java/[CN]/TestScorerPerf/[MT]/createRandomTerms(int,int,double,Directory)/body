{
  int[] freq=new int[nTerms];
  terms=new Term[nTerms];
  for (int i=0; i < nTerms; i++) {
    int f=(nTerms + 1) - i;
    freq[i]=(int)Math.ceil(Math.pow(f,power));
    terms[i]=new Term("f",Character.toString((char)('A' + i)));
  }
  IndexWriter iw=new IndexWriter(dir,newIndexWriterConfig(TEST_VERSION_CURRENT,new MockAnalyzer(random)).setOpenMode(OpenMode.CREATE));
  for (int i=0; i < nDocs; i++) {
    Document d=new Document();
    for (int j=0; j < nTerms; j++) {
      if (random.nextInt(freq[j]) == 0) {
        d.add(newField("f",terms[j].text(),StringField.TYPE_UNSTORED));
      }
    }
    iw.addDocument(d);
  }
  iw.optimize();
  iw.close();
}
