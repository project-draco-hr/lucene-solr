{
  double result=0;
  String h1=gh1DV.strVal(doc);
  String h2=gh2DV.strVal(doc);
  if (h1 != null && h2 != null && h1.equals(h2) == false) {
    Point p1=GeohashUtils.decode(h1,ctx);
    Point p2=GeohashUtils.decode(h2,ctx);
    result=ctx.getDistCalc().distance(p1,p2) * degreesToDist;
  }
 else   if (h1 == null || h2 == null) {
    result=Double.MAX_VALUE;
  }
  return result;
}
