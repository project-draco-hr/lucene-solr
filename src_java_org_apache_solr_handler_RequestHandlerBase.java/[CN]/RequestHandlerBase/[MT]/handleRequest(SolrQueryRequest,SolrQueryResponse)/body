{
  numRequests++;
  try {
    U.setDefaults(req,defaults,appends,invariants);
    rsp.setHttpCaching(httpCaching);
    handleRequestBody(req,rsp);
    boolean timedOut=(Boolean)rsp.getResponseHeader().get("partialResults") == null ? false : (Boolean)rsp.getResponseHeader().get("partialResults");
    if (timedOut) {
      numTimeouts++;
      rsp.setHttpCaching(false);
    }
  }
 catch (  Exception e) {
    SolrException.log(SolrCore.log,e);
    if (e instanceof ParseException) {
      e=new SolrException(SolrException.ErrorCode.BAD_REQUEST,e);
    }
    rsp.setException(e);
    numErrors++;
  }
  totalTime+=rsp.getEndTime() - req.getStartTime();
}
