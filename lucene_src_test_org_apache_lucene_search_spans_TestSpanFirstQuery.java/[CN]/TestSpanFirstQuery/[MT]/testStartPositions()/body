{
  Directory dir=newDirectory();
  CharacterRunAutomaton stopSet=new CharacterRunAutomaton(new RegExp("the|a|of").toAutomaton());
  Analyzer analyzer=new MockAnalyzer(MockTokenizer.SIMPLE,true,stopSet,true);
  RandomIndexWriter writer=new RandomIndexWriter(random,dir,analyzer);
  Document doc=new Document();
  doc.add(newField("field","the quick brown fox",Field.Index.ANALYZED));
  writer.addDocument(doc);
  Document doc2=new Document();
  doc2.add(newField("field","quick brown fox",Field.Index.ANALYZED));
  writer.addDocument(doc2);
  IndexReader reader=writer.getReader();
  IndexSearcher searcher=newSearcher(reader);
  SpanQuery sfq=new SpanFirstQuery(new SpanTermQuery(new Term("field","quick")),1);
  assertEquals(1,searcher.search(sfq,10).totalHits);
  SpanQuery include=new SpanFirstQuery(new SpanTermQuery(new Term("field","quick")),2);
  sfq=new SpanNotQuery(include,sfq);
  assertEquals(1,searcher.search(sfq,10).totalHits);
  writer.close();
  searcher.close();
  reader.close();
  dir.close();
}
