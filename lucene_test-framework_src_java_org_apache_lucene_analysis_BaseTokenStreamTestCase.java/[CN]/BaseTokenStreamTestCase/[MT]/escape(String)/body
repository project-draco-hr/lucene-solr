{
  int charUpto=0;
  final StringBuilder sb=new StringBuilder();
  while (charUpto < s.length()) {
    final int c=s.charAt(charUpto);
    if (c == 0xa) {
      sb.append("\\n");
    }
 else     if (c == 0xd) {
      sb.append("\\r");
    }
 else     if (c == '"') {
      sb.append("\\\"");
    }
 else     if (c == '\\') {
      sb.append("\\\\");
    }
 else     if (c >= 0x20 && c < 0x80) {
      sb.append((char)c);
    }
 else {
      sb.append(String.format(Locale.ROOT,"\\u%04x",c));
    }
    charUpto++;
  }
  return sb.toString();
}
