{
  Directory dir=new MockRAMDirectory();
  IndexWriter w=new IndexWriter(dir,new WhitespaceAnalyzer(),IndexWriter.MaxFieldLength.UNLIMITED);
  Document doc=new Document();
  doc.add(new Field("field","a b c d",Field.Store.NO,Field.Index.ANALYZED));
  w.addDocument(doc);
  IndexReader r=w.getReader();
  IndexSearcher s=new IndexSearcher(r);
  BooleanQuery q=new BooleanQuery();
  q.add(new TermQuery(new Term("field","a")),BooleanClause.Occur.SHOULD);
  PhraseQuery pq=new PhraseQuery();
  q.add(pq,BooleanClause.Occur.SHOULD);
  assertEquals(1,s.search(q,10).totalHits);
  q=new BooleanQuery();
  pq=new PhraseQuery();
  q.add(new TermQuery(new Term("field","a")),BooleanClause.Occur.SHOULD);
  q.add(pq,BooleanClause.Occur.MUST);
  assertEquals(0,s.search(q,10).totalHits);
  DisjunctionMaxQuery dmq=new DisjunctionMaxQuery(1.0f);
  dmq.add(new TermQuery(new Term("field","a")));
  dmq.add(pq);
  assertEquals(1,s.search(dmq,10).totalHits);
  r.close();
  w.close();
  dir.close();
}
