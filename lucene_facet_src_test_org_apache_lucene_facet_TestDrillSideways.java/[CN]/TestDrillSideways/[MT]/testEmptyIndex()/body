{
  Directory dir=newDirectory();
  Directory taxoDir=newDirectory();
  RandomIndexWriter writer=new RandomIndexWriter(random(),dir);
  DirectoryTaxonomyWriter taxoWriter=new DirectoryTaxonomyWriter(taxoDir,IndexWriterConfig.OpenMode.CREATE);
  IndexSearcher searcher=newSearcher(writer.getReader());
  TaxonomyReader taxoReader=new DirectoryTaxonomyReader(taxoWriter);
  FacetsConfig config=new FacetsConfig();
  DrillSideways ds=new DrillSideways(searcher,config,taxoReader);
  DrillDownQuery ddq=new DrillDownQuery(config);
  ddq.add("Author","Lisa");
  DrillSidewaysResult r=ds.search(ddq,10);
  assertEquals(0,r.hits.totalHits);
  r=ds.search(ddq,null,null,10,new Sort(new SortField("foo",SortField.Type.INT)),false,false);
  assertEquals(0,r.hits.totalHits);
  writer.close();
  IOUtils.close(taxoWriter,searcher.getIndexReader(),taxoReader,dir,taxoDir);
}
