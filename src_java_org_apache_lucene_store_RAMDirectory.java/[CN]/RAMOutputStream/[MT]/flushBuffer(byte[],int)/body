{
  int bufferNumber=pointer / OutputStream.BUFFER_SIZE;
  int bufferOffset=pointer % OutputStream.BUFFER_SIZE;
  int bytesInBuffer=OutputStream.BUFFER_SIZE - bufferOffset;
  int bytesToCopy=bytesInBuffer >= len ? len : bytesInBuffer;
  if (bufferNumber == file.buffers.size())   file.buffers.addElement(new byte[OutputStream.BUFFER_SIZE]);
  byte[] buffer=(byte[])file.buffers.elementAt(bufferNumber);
  System.arraycopy(src,0,buffer,bufferOffset,bytesToCopy);
  if (bytesToCopy < len) {
    int srcOffset=bytesToCopy;
    bytesToCopy=len - bytesToCopy;
    bufferNumber++;
    if (bufferNumber == file.buffers.size())     file.buffers.addElement(new byte[OutputStream.BUFFER_SIZE]);
    buffer=(byte[])file.buffers.elementAt(bufferNumber);
    System.arraycopy(src,srcOffset,buffer,0,bytesToCopy);
  }
  pointer+=len;
  if (pointer > file.length)   file.length=pointer;
  file.lastModified=System.currentTimeMillis();
}
