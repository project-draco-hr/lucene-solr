{
  Directory dir=newDirectory();
  IndexWriterConfig iwc=new IndexWriterConfig(TEST_VERSION_CURRENT,null);
  IndexWriter iw=new IndexWriter(dir,iwc);
  final MyField field1=new MyField();
  iw.addDocument(new IndexDocument(){
    @Override public Iterable<? extends IndexableField> indexableFields(){
      return Collections.singletonList(field1);
    }
    @Override public Iterable<StorableField> storableFields(){
      return Collections.emptyList();
    }
  }
);
  TokenStream previous=field1.lastReturned;
  assertNotNull(previous);
  final MyField field2=new MyField();
  iw.addDocument(new IndexDocument(){
    @Override public Iterable<? extends IndexableField> indexableFields(){
      return Collections.singletonList(field2);
    }
    @Override public Iterable<StorableField> storableFields(){
      return Collections.emptyList();
    }
  }
);
  assertSame(previous,field2.lastSeen);
  iw.shutdown();
  dir.close();
}
