{
  FieldType ft=new FieldType();
  ft.setStored(true);
  IndexableField binaryFldStored=new BinaryField("binaryStored",binaryValStored.getBytes());
  IndexableField stringFldStored=new Field("stringStored",binaryValStored,ft);
  Document doc=new Document();
  doc.add(binaryFldStored);
  doc.add(stringFldStored);
  assertEquals(2,doc.getFields().size());
  Directory dir=newDirectory();
  RandomIndexWriter writer=new RandomIndexWriter(random,dir);
  writer.addDocument(doc);
  IndexReader reader=writer.getReader();
  Document docFromReader=reader.document(0);
  assertTrue(docFromReader != null);
  BytesRef bytes=docFromReader.getBinaryValue("binaryStored");
  assertNotNull(bytes);
  String binaryFldStoredTest=new String(bytes.bytes,bytes.offset,bytes.length);
  assertTrue(binaryFldStoredTest.equals(binaryValStored));
  String stringFldStoredTest=docFromReader.get("stringStored");
  assertTrue(stringFldStoredTest.equals(binaryValStored));
  writer.close();
  reader.close();
  reader=IndexReader.open(dir,false);
  reader.deleteDocument(0);
  assertEquals(0,reader.numDocs());
  reader.close();
  dir.close();
}
