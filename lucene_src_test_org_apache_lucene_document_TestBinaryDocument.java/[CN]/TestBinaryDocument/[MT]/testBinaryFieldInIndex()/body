{
  Fieldable binaryFldStored=new Field("binaryStored",binaryValStored.getBytes());
  Fieldable stringFldStored=new Field("stringStored",binaryValStored,Field.Store.YES,Field.Index.NO,Field.TermVector.NO);
  try {
    new Field("fail",binaryValStored.getBytes(),Field.Store.NO);
    fail();
  }
 catch (  IllegalArgumentException iae) {
  }
  Document doc=new Document();
  doc.add(binaryFldStored);
  doc.add(stringFldStored);
  assertEquals(2,doc.fields.size());
  Random random=newRandom();
  MockRAMDirectory dir=newDirectory(random);
  RandomIndexWriter writer=new RandomIndexWriter(random,dir);
  writer.addDocument(doc);
  IndexReader reader=writer.getReader();
  Document docFromReader=reader.document(0);
  assertTrue(docFromReader != null);
  String binaryFldStoredTest=new String(docFromReader.getBinaryValue("binaryStored"));
  assertTrue(binaryFldStoredTest.equals(binaryValStored));
  String stringFldStoredTest=docFromReader.get("stringStored");
  assertTrue(stringFldStoredTest.equals(binaryValStored));
  writer.close();
  reader.close();
  reader=IndexReader.open(dir,false);
  reader.deleteDocument(0);
  assertEquals(0,reader.numDocs());
  reader.close();
  dir.close();
}
