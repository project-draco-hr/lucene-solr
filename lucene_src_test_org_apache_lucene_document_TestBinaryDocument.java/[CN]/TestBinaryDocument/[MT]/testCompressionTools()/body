{
  Fieldable binaryFldCompressed=new Field("binaryCompressed",CompressionTools.compress(binaryValCompressed.getBytes()));
  Fieldable stringFldCompressed=new Field("stringCompressed",CompressionTools.compressString(binaryValCompressed));
  Document doc=new Document();
  doc.add(binaryFldCompressed);
  doc.add(stringFldCompressed);
  Random random=newRandom();
  MockRAMDirectory dir=newDirectory(random);
  RandomIndexWriter writer=new RandomIndexWriter(random,dir);
  writer.addDocument(doc);
  IndexReader reader=writer.getReader();
  Document docFromReader=reader.document(0);
  assertTrue(docFromReader != null);
  String binaryFldCompressedTest=new String(CompressionTools.decompress(docFromReader.getBinaryValue("binaryCompressed")));
  assertTrue(binaryFldCompressedTest.equals(binaryValCompressed));
  assertTrue(CompressionTools.decompressString(docFromReader.getBinaryValue("stringCompressed")).equals(binaryValCompressed));
  writer.close();
  reader.close();
  dir.close();
}
