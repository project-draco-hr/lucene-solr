{
  datIn=dir.openInput(IndexFileNames.segmentFileName(id,Bytes.DV_SEGMENT_SUFFIX,DocValuesWriterBase.DATA_EXTENSION),context);
  this.numDocs=numDocs;
  boolean success=false;
  try {
    CodecUtil.checkHeader(datIn,CODEC_NAME,VERSION_START,VERSION_START);
    type=datIn.readByte();
    values=type == FIXED_64 ? DocValuesArraySource.forType(Type.FIXED_INTS_64) : null;
    success=true;
  }
  finally {
    if (!success) {
      IOUtils.closeWhileHandlingException(datIn);
    }
  }
}
