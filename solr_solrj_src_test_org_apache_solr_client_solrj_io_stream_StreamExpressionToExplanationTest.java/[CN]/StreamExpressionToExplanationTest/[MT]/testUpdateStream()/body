{
  StreamExpression expression=StreamExpressionParser.parse("update(" + "collection2, " + "batchSize=5, "+ "search("+ "collection1, "+ "q=*:*, "+ "fl=\"id,a_s,a_i,a_f\", "+ "sort=\"a_f asc, a_i asc\"))");
  UpdateStream updateStream=new UpdateStream(expression,factory);
  Explanation explanation=updateStream.toExplanation(factory);
  Assert.assertEquals("solr (collection2)",explanation.getFunctionName());
  Assert.assertEquals("Solr/Lucene",explanation.getImplementingClass());
  StreamExplanation updateExplanation=(StreamExplanation)explanation;
  Assert.assertEquals(1,updateExplanation.getChildren().size());
  Assert.assertEquals("update",updateExplanation.getChildren().get(0).getFunctionName());
  Assert.assertEquals(UpdateStream.class.getName(),updateExplanation.getChildren().get(0).getImplementingClass());
}
