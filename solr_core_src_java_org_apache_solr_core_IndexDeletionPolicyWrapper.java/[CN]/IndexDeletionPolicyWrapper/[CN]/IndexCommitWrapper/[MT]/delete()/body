{
  Long gen=delegate.getGeneration();
  Long reserve=reserves.get(gen);
  if (reserve != null && System.nanoTime() < reserve)   return;
  if (savedCommits.containsKey(gen))   return;
  if (snapshotMgr.isSnapshotted(gen))   return;
  delegate.delete();
}
