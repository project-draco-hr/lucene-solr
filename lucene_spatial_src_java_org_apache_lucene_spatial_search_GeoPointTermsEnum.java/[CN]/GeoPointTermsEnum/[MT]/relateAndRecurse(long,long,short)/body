{
  final double minLon=GeoUtils.mortonUnhashLon(start);
  final double minLat=GeoUtils.mortonUnhashLat(start);
  final double maxLon=GeoUtils.mortonUnhashLon(end);
  final double maxLat=GeoUtils.mortonUnhashLat(end);
  final short level=(short)((GeoUtils.BITS << 1) - res >>> 1);
  final boolean within=res % GeoPointField.PRECISION_STEP == 0 && cellWithin(minLon,minLat,maxLon,maxLat);
  if (within || (level == DETAIL_LEVEL && cellIntersectsShape(minLon,minLat,maxLon,maxLat))) {
    final short nextRes=(short)(res - 1);
    if (nextRes % GeoPointField.PRECISION_STEP == 0) {
      rangeBounds.add(new Range(start,nextRes,!within));
      rangeBounds.add(new Range(start | (1L << nextRes),nextRes,!within));
    }
 else {
      rangeBounds.add(new Range(start,res,!within));
    }
  }
 else   if (level < DETAIL_LEVEL && cellIntersectsMBR(minLon,minLat,maxLon,maxLat)) {
    computeRange(start,(short)(res - 1));
  }
}
