{
  int numGroups=collapsedSet.size();
  this.nullValue=nullValue;
  groups=new LongObjectHashMap<>(numGroups);
  Iterator<LongCursor> iterator=groupSet.iterator();
  while (iterator.hasNext()) {
    LongCursor cursor=iterator.next();
    Collector collector=(sort == null) ? TopScoreDocCollector.create(limit) : TopFieldCollector.create(sort,limit,false,false,false);
    groups.put(cursor.value,collector);
  }
  this.field=field;
  this.collapsedSet=collapsedSet;
}
