{
  int numGroups=collapsedSet.size();
  groups=new IntObjectOpenHashMap<>(numGroups * 2);
  DocIdSetIterator iterator=groupBits.iterator();
  int group=-1;
  while ((group=iterator.nextDoc()) != DocIdSetIterator.NO_MORE_DOCS) {
    Collector collector=(sort == null) ? TopScoreDocCollector.create(limit,true) : TopFieldCollector.create(sort,limit,false,false,false,true);
    groups.put(group,collector);
  }
  this.collapsedSet=collapsedSet;
  this.groupBits=groupBits;
  this.docValues=docValues;
}
