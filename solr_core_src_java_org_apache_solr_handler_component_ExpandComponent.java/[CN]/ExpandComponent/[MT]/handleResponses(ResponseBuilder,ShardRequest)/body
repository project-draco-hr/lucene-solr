{
  if (!rb.doExpand) {
    return;
  }
  if ((sreq.purpose & ShardRequest.PURPOSE_GET_FIELDS) != 0) {
    SolrQueryRequest req=rb.req;
    Map expanded=(Map)req.getContext().get("expanded");
    if (expanded == null) {
      expanded=new HashMap();
      req.getContext().put("expanded",expanded);
    }
    for (    ShardResponse srsp : sreq.responses) {
      NamedList response=srsp.getSolrResponse().getResponse();
      Map ex=(Map)response.get("expanded");
      for (      Map.Entry<String,SolrDocumentList> entry : (Iterable<Map.Entry<String,SolrDocumentList>>)ex.entrySet()) {
        String name=entry.getKey();
        SolrDocumentList val=entry.getValue();
        expanded.put(name,val);
      }
    }
  }
}
