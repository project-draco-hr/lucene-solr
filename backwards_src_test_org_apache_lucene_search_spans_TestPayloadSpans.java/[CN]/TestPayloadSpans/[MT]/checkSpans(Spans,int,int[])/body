{
  int cnt=0;
  while (spans.next() == true) {
    if (DEBUG)     System.out.println("\nSpans Dump --");
    if (spans.isPayloadAvailable()) {
      Collection payload=spans.getPayload();
      if (DEBUG)       System.out.println("payloads for span:" + payload.size());
      Iterator it=payload.iterator();
      while (it.hasNext()) {
        byte[] bytes=(byte[])it.next();
        if (DEBUG)         System.out.println("doc:" + spans.doc() + " s:"+ spans.start()+ " e:"+ spans.end()+ " "+ new String(bytes));
      }
      assertEquals(numPayloads[cnt],payload.size());
    }
 else {
      assertFalse("Expected spans:" + numPayloads[cnt] + " found: 0",numPayloads.length > 0 && numPayloads[cnt] > 0);
    }
    cnt++;
  }
  assertEquals(numSpans,cnt);
}
