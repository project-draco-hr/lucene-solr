{
  if (count <= maxPointsSortInHeap) {
    int size=Math.toIntExact(count);
    return new HeapPointWriter(size,size,packedBytesLength);
  }
 else {
    return new OfflinePointWriter(tempDir,tempFileNamePrefix,packedBytesLength);
  }
}
