{
  if (leafCount > 0) {
    writeLeafBlock();
    leafCount=0;
  }
  if (valueCount == 0) {
    return -1;
  }
  pointCount=valueCount;
  long indexFP=out.getFilePointer();
  int numInnerNodes=leafBlockStartValues.size();
  byte[] index=new byte[(1 + numInnerNodes) * (1 + bytesPerDim)];
  rotateToTree(1,0,numInnerNodes,index,leafBlockStartValues);
  long[] arr=new long[leafBlockFPs.size()];
  for (int i=0; i < leafBlockFPs.size(); i++) {
    arr[i]=leafBlockFPs.get(i);
  }
  writeIndex(out,arr,index);
  return indexFP;
}
