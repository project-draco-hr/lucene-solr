{
  try {
    if (!isOpen) {
      open();
      isOpen=true;
    }
  }
 catch (  IOException e) {
    throw new SolrException(SolrException.ErrorCode.SERVER_ERROR,e);
  }
  return Collections.singletonMap("docs",new Iterator<Tuple>(){
    Tuple tuple;
    boolean isEOF=false;
    @Override public boolean hasNext(){
      if (isEOF)       return false;
      if (tuple != null)       return true;
      try {
        tuple=read();
        if (tuple != null && tuple.EOF)         close();
        return tuple != null;
      }
 catch (      IOException e) {
        throw new SolrException(SolrException.ErrorCode.SERVER_ERROR,e);
      }
    }
    @Override public Tuple next(){
      Tuple tmp=tuple;
      tuple=null;
      isEOF=tmp == null || tmp.EOF;
      return tmp;
    }
  }
);
}
