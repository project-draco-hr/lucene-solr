{
  for (int i=0; i < readers.length; i++) {
    final CompositeReader reader=readers[i];
    final List<? extends IndexReader> subs=reader.getSequentialSubReaders();
    if (reader.maxDoc() != maxDoc) {
      throw new IllegalArgumentException("All readers must have same maxDoc: " + maxDoc + "!="+ reader.maxDoc());
    }
    final int noSubs=subs.size();
    if (noSubs != childMaxDoc.length) {
      throw new IllegalArgumentException("All readers must have same number of subReaders");
    }
    for (int subIDX=0; subIDX < noSubs; subIDX++) {
      final IndexReader r=subs.get(subIDX);
      if (r.maxDoc() != childMaxDoc[subIDX]) {
        throw new IllegalArgumentException("All readers must have same corresponding subReader maxDoc");
      }
      if (!(childAtomic[subIDX] ? (r instanceof LeafReader) : (r instanceof CompositeReader))) {
        throw new IllegalArgumentException("All readers must have same corresponding subReader types (atomic or composite)");
      }
    }
  }
}
