{
synchronized (modifyCurrentIndexLock) {
    ensureOpen();
    final Directory dir=this.spellIndex;
    final IndexWriter writer=new IndexWriter(dir,config);
    IndexSearcher indexSearcher=obtainSearcher();
    final List<TermsEnum> termsEnums=new ArrayList<TermsEnum>();
    final IndexReader reader=searcher.getIndexReader();
    if (reader.maxDoc() > 0) {
      new ReaderUtil.Gather(reader){
        @Override protected void add(        int base,        IndexReader r) throws IOException {
          Terms terms=r.terms(F_WORD);
          if (terms != null)           termsEnums.add(terms.iterator(null));
        }
      }
.run();
    }
    boolean isEmpty=termsEnums.isEmpty();
    try {
      Iterator<String> iter=dict.getWordsIterator();
      BytesRef currentTerm=new BytesRef();
      terms:       while (iter.hasNext()) {
        String word=iter.next();
        int len=word.length();
        if (len < 3) {
          continue;
        }
        if (!isEmpty) {
          currentTerm.copy(word);
          for (          TermsEnum te : termsEnums) {
            if (te.seekExact(currentTerm,false)) {
              continue terms;
            }
          }
        }
        Document doc=createDocument(word,getMin(len),getMax(len));
        writer.addDocument(doc);
      }
    }
  finally {
      releaseSearcher(indexSearcher);
    }
    if (fullMerge) {
      writer.forceMerge(1);
    }
    writer.close();
    swapSearcher(dir);
  }
}
