{
  segment=si.name;
  this.readBufferSize=readBufferSize;
  this.dir=dir;
  boolean success=false;
  try {
    Directory dir0=dir;
    if (si.getUseCompoundFile()) {
      cfsReader=new CompoundFileReader(dir,segment + "." + IndexFileNames.COMPOUND_FILE_EXTENSION,readBufferSize);
      dir0=cfsReader;
    }
    cfsDir=dir0;
    fieldInfos=new FieldInfos(cfsDir,segment + "." + IndexFileNames.FIELD_INFOS_EXTENSION);
    this.termsIndexDivisor=termsIndexDivisor;
    TermInfosReader reader=new TermInfosReader(cfsDir,segment,fieldInfos,readBufferSize,termsIndexDivisor);
    if (termsIndexDivisor == -1) {
      tisNoIndex=reader;
    }
 else {
      tis=reader;
      tisNoIndex=null;
    }
    freqStream=cfsDir.openInput(segment + "." + IndexFileNames.FREQ_EXTENSION,readBufferSize);
    if (fieldInfos.hasProx()) {
      proxStream=cfsDir.openInput(segment + "." + IndexFileNames.PROX_EXTENSION,readBufferSize);
    }
 else {
      proxStream=null;
    }
    success=true;
  }
  finally {
    if (!success) {
      decRef();
    }
  }
}
