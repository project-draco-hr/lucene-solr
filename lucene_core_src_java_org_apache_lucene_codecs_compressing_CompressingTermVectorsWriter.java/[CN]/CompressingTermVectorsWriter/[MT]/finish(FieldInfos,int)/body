{
  if (!pendingDocs.isEmpty()) {
    flush();
    numDirtyChunks++;
  }
  if (numDocs != this.numDocs) {
    throw new RuntimeException("Wrote " + this.numDocs + " docs, finish called with numDocs="+ numDocs);
  }
  indexWriter.finish(numDocs,vectorsStream.getFilePointer());
  vectorsStream.writeVLong(numChunks);
  vectorsStream.writeVLong(numDirtyChunks);
  CodecUtil.writeFooter(vectorsStream);
}
