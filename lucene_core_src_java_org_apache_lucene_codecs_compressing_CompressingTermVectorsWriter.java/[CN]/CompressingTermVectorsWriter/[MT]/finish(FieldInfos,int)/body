{
  if (!pendingDocs.isEmpty()) {
    flush();
  }
  if (numDocs != this.numDocs) {
    throw new RuntimeException("Wrote " + this.numDocs + " docs, finish called with numDocs="+ numDocs);
  }
  indexWriter.finish(numDocs,vectorsStream.getFilePointer());
  CodecUtil.writeFooter(vectorsStream);
}
