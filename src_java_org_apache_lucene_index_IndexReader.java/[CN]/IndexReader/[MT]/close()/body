{
  if (!closed) {
    commit();
    doClose();
    if (directoryOwner)     closed=true;
    if (closeDirectory)     directory.close();
  }
}
