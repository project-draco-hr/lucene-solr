{
  return (IndexReader)new SegmentInfos.FindSegmentsFile(directory){
    protected Object doBody(    String segmentFileName) throws CorruptIndexException, IOException {
      SegmentInfos infos=new SegmentInfos();
      infos.read(directory,segmentFileName);
      if (infos.size() == 1) {
        return SegmentReader.get(infos,infos.info(0),closeDirectory);
      }
 else {
        IndexReader[] readers=new IndexReader[infos.size()];
        for (int i=infos.size() - 1; i >= 0; i--) {
          try {
            readers[i]=SegmentReader.get(infos.info(i));
          }
 catch (          IOException e) {
            for (i++; i < infos.size(); i++) {
              readers[i].close();
            }
            throw e;
          }
        }
        return new MultiReader(directory,infos,closeDirectory,readers);
      }
    }
  }
.run();
}
