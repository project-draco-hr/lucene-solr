{
  LOG.debug("getSuggestions: " + options.tokens);
  if (lookup == null) {
    LOG.info("Lookup is null - invoke spellchecker.build first");
    return EMPTY_RESULT;
  }
  SpellingResult res=new SpellingResult();
  CharsRef scratch=new CharsRef();
  for (  Token t : options.tokens) {
    scratch.chars=t.buffer();
    scratch.offset=0;
    scratch.length=t.length();
    List<LookupResult> suggestions=lookup.lookup(scratch,options.onlyMorePopular,options.count);
    if (suggestions == null) {
      continue;
    }
    if (!options.onlyMorePopular) {
      Collections.sort(suggestions);
    }
    for (    LookupResult lr : suggestions) {
      res.add(t,lr.key.toString(),(int)lr.value);
    }
  }
  return res;
}
