{
  Directory dir1=new RAMDirectory();
  norms=new ArrayList();
  modifiedNorms=new ArrayList();
  createIndex(dir1);
  doTestNorms(dir1);
  ArrayList norms1=norms;
  ArrayList modifiedNorms1=modifiedNorms;
  int numDocNorms1=numDocNorms;
  norms=new ArrayList();
  modifiedNorms=new ArrayList();
  numDocNorms=0;
  Directory dir2=new RAMDirectory();
  createIndex(dir2);
  doTestNorms(dir2);
  Directory dir3=new RAMDirectory();
  createIndex(dir3);
  IndexWriter iw=new IndexWriter(dir3,anlzr,false,IndexWriter.MaxFieldLength.LIMITED);
  iw.setMaxBufferedDocs(5);
  iw.setMergeFactor(3);
  iw.addIndexesNoOptimize(new Directory[]{dir1,dir2});
  iw.optimize();
  iw.close();
  norms1.addAll(norms);
  norms=norms1;
  modifiedNorms1.addAll(modifiedNorms);
  modifiedNorms=modifiedNorms1;
  numDocNorms+=numDocNorms1;
  verifyIndex(dir3);
  doTestNorms(dir3);
  iw=new IndexWriter(dir3,anlzr,false,IndexWriter.MaxFieldLength.LIMITED);
  iw.setMaxBufferedDocs(5);
  iw.setMergeFactor(3);
  iw.optimize();
  iw.close();
  verifyIndex(dir3);
  dir1.close();
  dir2.close();
  dir3.close();
}
