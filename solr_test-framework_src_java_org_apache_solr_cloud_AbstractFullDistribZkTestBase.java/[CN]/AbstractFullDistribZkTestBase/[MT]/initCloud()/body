{
  assert(cloudInit == false);
  cloudInit=true;
  try {
    CloudSolrServer server=new CloudSolrServer(zkServer.getZkAddress());
    server.setDefaultCollection(DEFAULT_COLLECTION);
    server.getLbServer().getHttpClient().getParams().setParameter(CoreConnectionPNames.CONNECTION_TIMEOUT,5000);
    server.getLbServer().getHttpClient().getParams().setParameter(CoreConnectionPNames.SO_TIMEOUT,20000);
    cloudClient=server;
    cloudClient.connect();
  }
 catch (  MalformedURLException e) {
    throw new RuntimeException(e);
  }
  ZkStateReader zkStateReader=cloudClient.getZkStateReader();
  chaosMonkey=new ChaosMonkey(zkServer,zkStateReader,DEFAULT_COLLECTION,shardToJetty,shardToLeaderJetty);
}
