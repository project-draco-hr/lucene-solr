{
  String fieldName="field1";
  Directory rd1=newDirectory();
  RandomIndexWriter w1=new RandomIndexWriter(random(),rd1);
  Document doc=new Document();
  doc.add(newStringField(fieldName,"content1",Field.Store.YES));
  w1.addDocument(doc);
  IndexReader reader1=w1.getReader();
  w1.close();
  fieldName="field2";
  Directory rd2=newDirectory();
  RandomIndexWriter w2=new RandomIndexWriter(random(),rd2);
  doc=new Document();
  doc.add(newStringField(fieldName,"content2",Field.Store.YES));
  w2.addDocument(doc);
  IndexReader reader2=w2.getReader();
  w2.close();
  TermsFilter tf=new TermsFilter(new Term(fieldName,"content1"));
  MultiReader multi=new MultiReader(reader1,reader2);
  for (  LeafReaderContext context : multi.leaves()) {
    DocIdSet docIdSet=tf.getDocIdSet(context,context.reader().getLiveDocs());
    if (context.reader().docFreq(new Term(fieldName,"content1")) == 0) {
      assertNull(docIdSet);
    }
 else {
      FixedBitSet bits=(FixedBitSet)docIdSet;
      assertTrue("Must be >= 0",bits.cardinality() >= 0);
    }
  }
  multi.close();
  reader1.close();
  reader2.close();
  rd1.close();
  rd2.close();
}
