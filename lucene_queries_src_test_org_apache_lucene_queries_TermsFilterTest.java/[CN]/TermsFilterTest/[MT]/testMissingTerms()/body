{
  String fieldName="field1";
  Directory rd=newDirectory();
  RandomIndexWriter w=new RandomIndexWriter(random(),rd);
  for (int i=0; i < 100; i++) {
    Document doc=new Document();
    int term=i * 10;
    doc.add(newStringField(fieldName,"" + term,Field.Store.YES));
    w.addDocument(doc);
  }
  IndexReader reader=SlowCompositeReaderWrapper.wrap(w.getReader());
  assertTrue(reader.getContext() instanceof LeafReaderContext);
  LeafReaderContext context=(LeafReaderContext)reader.getContext();
  w.close();
  List<Term> terms=new ArrayList<>();
  terms.add(new Term(fieldName,"19"));
  FixedBitDocIdSet bits=(FixedBitDocIdSet)termsFilter(random().nextBoolean(),terms).getDocIdSet(context,context.reader().getLiveDocs());
  assertNull("Must match nothing",bits);
  terms.add(new Term(fieldName,"20"));
  bits=(FixedBitDocIdSet)termsFilter(random().nextBoolean(),terms).getDocIdSet(context,context.reader().getLiveDocs());
  assertEquals("Must match 1",1,bits.bits().cardinality());
  terms.add(new Term(fieldName,"10"));
  bits=(FixedBitDocIdSet)termsFilter(random().nextBoolean(),terms).getDocIdSet(context,context.reader().getLiveDocs());
  assertEquals("Must match 2",2,bits.bits().cardinality());
  terms.add(new Term(fieldName,"00"));
  bits=(FixedBitDocIdSet)termsFilter(random().nextBoolean(),terms).getDocIdSet(context,context.reader().getLiveDocs());
  assertEquals("Must match 2",2,bits.bits().cardinality());
  reader.close();
  rd.close();
}
