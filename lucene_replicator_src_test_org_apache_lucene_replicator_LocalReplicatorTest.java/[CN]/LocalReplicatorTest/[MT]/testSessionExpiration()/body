{
  replicator.publish(createRevision(1));
  SessionToken session=replicator.checkForUpdate(null);
  replicator.setExpirationThreshold(5);
  Thread.sleep(50);
  try {
    replicator.obtainFile(session.id,session.sourceFiles.keySet().iterator().next(),session.sourceFiles.values().iterator().next().get(0).fileName);
    fail("should have failed to obtain a file for an expired session");
  }
 catch (  SessionExpiredException e) {
  }
}
