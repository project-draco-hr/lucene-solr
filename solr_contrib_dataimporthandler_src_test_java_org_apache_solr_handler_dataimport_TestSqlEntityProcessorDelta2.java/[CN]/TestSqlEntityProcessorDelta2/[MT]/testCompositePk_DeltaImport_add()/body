{
  add1document();
  MockDataSource.clearCache();
  List deltaRow=new ArrayList();
  deltaRow.add(createMap("id","2"));
  MockDataSource.setIterator(DELTA_QUERY,deltaRow.iterator());
  List parentRow=new ArrayList();
  parentRow.add(createMap("id","2"));
  MockDataSource.setIterator("select * from x where id='2'",parentRow.iterator());
  List childRow=new ArrayList();
  childRow.add(createMap("desc","goodbye"));
  MockDataSource.setIterator("select * from y where y.A='2'",childRow.iterator());
  super.runDeltaImport(dataConfig_delta2);
  assertQ(req("*:* OR testCompositePk_DeltaImport_add"),"//*[@numFound='2']");
  assertQ(req("solr_id:prefix-1"),"//*[@numFound='1']");
  assertQ(req("solr_id:prefix-2"),"//*[@numFound='1']");
  assertQ(req("desc:hello"),"//*[@numFound='1']");
  assertQ(req("desc:goodbye"),"//*[@numFound='1']");
}
