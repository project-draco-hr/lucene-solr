{
  DocValueHolder valueHolder=new DocValueHolder();
  float[] sourceArray=new float[]{1,2,3};
  Directory dir=newDirectory();
  final Counter trackBytes=Counter.newCounter();
  DocValuesConsumer w=Floats.getWriter(dir,"test",trackBytes,newIOContext(random),Type.FLOAT_32);
  for (int i=0; i < sourceArray.length; i++) {
    valueHolder.floatValue=sourceArray[i];
    w.add(i,valueHolder);
  }
  w.finish(sourceArray.length);
  DocValues r=Floats.getValues(dir,"test",3,newIOContext(random),Type.FLOAT_32);
  Source source=r.getSource();
  assertTrue(source.hasArray());
  float[] loaded=((float[])source.getArray());
  assertEquals(loaded.length,sourceArray.length);
  for (int i=0; i < loaded.length; i++) {
    assertEquals("value didn't match at index " + i,sourceArray[i],loaded[i],0.0f);
  }
  r.close();
  dir.close();
}
