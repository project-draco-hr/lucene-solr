{
  final TimeOut timeout=new TimeOut(maxWait,TimeUnit.MILLISECONDS);
  while (queue.peek() != null) {
    if (timeout.hasTimedOut())     fail("Queue not empty within " + maxWait + " ms");
    Thread.sleep(100);
  }
}
