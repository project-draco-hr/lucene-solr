{
  List<SubmitCapture> submitCaptures=new ArrayList<SubmitCapture>();
  for (int i=0; i < (numberOfSlices * numberOfReplica); i++) {
    SubmitCapture submitCapture=new SubmitCapture();
    shardHandlerMock.submit(capture(submitCapture.shardRequestCapture),capture(submitCapture.nodeUrlsWithoutProtocolPartCapture),capture(submitCapture.params));
    expectLastCall();
    submitCaptures.add(submitCapture);
    ShardResponse shardResponseWithoutException=new ShardResponse();
    shardResponseWithoutException.setSolrResponse(new QueryResponse());
    expect(shardHandlerMock.takeCompletedOrError()).andReturn(shardResponseWithoutException);
  }
  expect(shardHandlerMock.takeCompletedOrError()).andReturn(null);
  return submitCaptures;
}
