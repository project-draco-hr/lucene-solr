{
  final int size=hash.size();
  final long[] addresses=new long[size + 1];
  final IndexOutput datOut=getOrCreateDataOut();
  int addr=1;
  final BytesRef bytesRef=new BytesRef();
  for (int i=0; i < size; i++) {
    hash.get(i,bytesRef);
    addresses[i + 1]=addr;
    addr+=writePrefixLength(datOut,bytesRef) + bytesRef.length;
    datOut.writeBytes(bytesRef.bytes,bytesRef.offset,bytesRef.length);
  }
  final IndexOutput idxOut=getOrCreateIndexOut();
  idxOut.writeLong(addr - 1);
  writeIndex(idxOut,docCount,addresses[size],addresses,docToEntry);
}
