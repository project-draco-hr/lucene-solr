{
  if (bytes.length == 0)   return;
  if (datOut == null)   initDataOut();
  final int e=hash.add(bytes);
  if (docID >= docToAddress.length) {
    final int oldSize=docToAddress.length;
    docToAddress=ArrayUtil.grow(docToAddress,1 + docID);
    bytesUsed.addAndGet(RamUsageEstimator.NUM_BYTES_INT * (docToAddress.length - oldSize));
  }
  final int docAddress;
  if (e >= 0) {
    docAddress=array.address[e]=address;
    address+=writePrefixLength(datOut,bytes);
    datOut.writeBytes(bytes.bytes,bytes.offset,bytes.length);
    address+=bytes.length;
  }
 else {
    docAddress=array.address[(-e) - 1];
  }
  docToAddress[docID]=docAddress;
}
