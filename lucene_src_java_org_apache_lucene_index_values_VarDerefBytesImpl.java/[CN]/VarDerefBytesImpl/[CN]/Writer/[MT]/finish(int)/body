{
  if (datOut == null)   return;
  initIndexOut();
  idxOut.writeInt(address - 1);
  final PackedInts.Writer w=PackedInts.getWriter(idxOut,docCount,PackedInts.bitsRequired(address - 1));
  final int limit;
  if (docCount > docToAddress.length) {
    limit=docToAddress.length;
  }
 else {
    limit=docCount;
  }
  for (int i=0; i < limit; i++) {
    w.add(docToAddress[i]);
  }
  for (int i=limit; i < docCount; i++) {
    w.add(0);
  }
  w.finish();
  hash.clear(true);
  super.finish(docCount);
}
