{
  dir.list(new FilenameFilter(){
    @Override public boolean accept(    File dir,    String name){
      File fileObj=new File(dir,name);
      if (fileObj.isDirectory()) {
        if (recursive)         getFolderFiles(fileObj,fileDetails);
      }
 else       if (fileNamePattern == null) {
        addDetails(fileDetails,dir,name);
      }
 else       if (fileNamePattern.matcher(name).find()) {
        if (excludesPattern != null && excludesPattern.matcher(name).find())         return false;
        addDetails(fileDetails,dir,name);
      }
      return false;
    }
  }
);
}
