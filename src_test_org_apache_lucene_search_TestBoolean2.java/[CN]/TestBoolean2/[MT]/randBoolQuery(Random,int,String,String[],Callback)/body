{
  BooleanQuery current=new BooleanQuery();
  for (int i=0; i < rnd.nextInt(vals.length) + 1; i++) {
    int qType=0;
    if (level > 0) {
      qType=rnd.nextInt(10);
    }
    Query q;
    if (qType < 7)     q=new TermQuery(new Term(field,vals[rnd.nextInt(vals.length)]));
 else     q=randBoolQuery(rnd,level - 1,field,vals,cb);
    int r=rnd.nextInt(10);
    BooleanClause.Occur occur;
    if (r < 2)     occur=BooleanClause.Occur.MUST_NOT;
 else     if (r < 5)     occur=BooleanClause.Occur.MUST;
 else     occur=BooleanClause.Occur.SHOULD;
    current.add(q,occur);
  }
  if (cb != null)   cb.postCreate(current);
  return current;
}
