{
  Analyzer analyzer=new MockAnalyzer(random(),MockTokenizer.WHITESPACE,true,MockTokenFilter.ENGLISH_STOPSET);
  CompletionAnalyzer completionAnalyzer=new CompletionAnalyzer(analyzer,false,true);
  RandomIndexWriter iw=new RandomIndexWriter(random(),dir,iwcWithSuggestField(completionAnalyzer,"suggest_field_no_p_sep"));
  Document document=new Document();
  document.add(new SuggestField("suggest_field_no_p_sep","foobar",7));
  document.add(new SuggestField("suggest_field_no_p_sep","foo bar",8));
  document.add(new SuggestField("suggest_field_no_p_sep","the fo",9));
  document.add(new SuggestField("suggest_field_no_p_sep","the foo bar",10));
  iw.addDocument(document);
  DirectoryReader reader=iw.getReader();
  SuggestIndexSearcher indexSearcher=new SuggestIndexSearcher(reader);
  CompletionQuery query=new PrefixCompletionQuery(analyzer,new Term("suggest_field_no_p_sep","fo"));
  TopSuggestDocs suggest=indexSearcher.suggest(query,4);
  assertSuggestions(suggest,new Entry("the foo bar",10),new Entry("the fo",9),new Entry("foo bar",8),new Entry("foobar",7));
  query=new PrefixCompletionQuery(analyzer,new Term("suggest_field_no_p_sep","foob"));
  suggest=indexSearcher.suggest(query,4);
  assertSuggestions(suggest,new Entry("the foo bar",10),new Entry("foo bar",8),new Entry("foobar",7));
  reader.close();
  iw.close();
}
