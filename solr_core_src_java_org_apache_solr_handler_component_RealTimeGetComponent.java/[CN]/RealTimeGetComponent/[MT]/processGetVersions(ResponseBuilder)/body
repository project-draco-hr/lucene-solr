{
  SolrQueryRequest req=rb.req;
  SolrQueryResponse rsp=rb.rsp;
  SolrParams params=req.getParams();
  if (!params.getBool(COMPONENT_NAME,true)) {
    return;
  }
  int nVersions=params.getInt("getVersions",-1);
  if (nVersions == -1)   return;
  boolean doFingerprint=params.getBool("fingerprint",false);
  String sync=params.get("sync");
  if (sync != null) {
    processSync(rb,nVersions,sync);
    return;
  }
  UpdateLog ulog=req.getCore().getUpdateHandler().getUpdateLog();
  if (ulog == null)   return;
  long maxVersion=Long.MAX_VALUE;
  if (doFingerprint) {
    IndexFingerprint fingerprint=IndexFingerprint.getFingerprint(req.getCore(),Long.MAX_VALUE);
    rb.rsp.add("fingerprint",fingerprint.toObject());
    maxVersion=fingerprint.getMaxVersionEncountered();
  }
  try (UpdateLog.RecentUpdates recentUpdates=ulog.getRecentUpdates()){
    List<Long> versions=recentUpdates.getVersions(nVersions,maxVersion);
    rb.rsp.add("versions",versions);
  }
 }
