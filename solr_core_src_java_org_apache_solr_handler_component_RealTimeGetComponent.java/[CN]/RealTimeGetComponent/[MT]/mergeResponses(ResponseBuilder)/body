{
  SolrDocumentList docList=new SolrDocumentList();
  for (  ShardRequest sreq : rb.finished) {
    for (    ShardResponse srsp : sreq.responses) {
      SolrResponse sr=srsp.getSolrResponse();
      NamedList nl=sr.getResponse();
      SolrDocumentList subList=(SolrDocumentList)nl.get("response");
      docList.addAll(subList);
    }
  }
  if (docList.size() <= 1 && rb.req.getParams().getParams("ids") == null) {
    rb.rsp.add("doc",docList.size() > 0 ? docList.get(0) : null);
  }
 else {
    docList.setNumFound(docList.size());
    rb.rsp.addResponse(docList);
  }
}
