{
  final String contextKey=IdsRequsted.class.toString() + "_PARSED_ID_PARAMS";
  if (req.getContext().containsKey(contextKey)) {
    return (IdsRequsted)req.getContext().get(contextKey);
  }
  final SolrParams params=req.getParams();
  final String id[]=params.getParams("id");
  final String ids[]=params.getParams("ids");
  if (id == null && ids == null) {
    IdsRequsted result=new IdsRequsted(Collections.<String>emptyList(),true);
    req.getContext().put(contextKey,result);
    return result;
  }
  final List<String> allIds=new ArrayList<>((null == id ? 0 : id.length) + (null == ids ? 0 : (2 * ids.length)));
  if (null != id) {
    for (    String singleId : id) {
      allIds.add(singleId);
    }
  }
  if (null != ids) {
    for (    String idList : ids) {
      allIds.addAll(StrUtils.splitSmart(idList,",",true));
    }
  }
  IdsRequsted result=new IdsRequsted(allIds,(ids == null && allIds.size() <= 1));
  req.getContext().put(contextKey,result);
  return result;
}
