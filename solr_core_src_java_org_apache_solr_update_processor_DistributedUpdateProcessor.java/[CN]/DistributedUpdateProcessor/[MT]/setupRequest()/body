{
  List<Node> nodes=null;
  String shardId=cloudDesc.getShardId();
  try {
    ZkCoreNodeProps leaderProps=new ZkCoreNodeProps(zkController.getZkStateReader().getLeaderProps(collection,shardId));
    String leaderNodeName=leaderProps.getCoreNodeName();
    String coreName=req.getCore().getName();
    String coreNodeName=zkController.getNodeName() + "_" + coreName;
    isLeader=coreNodeName.equals(leaderNodeName);
    forwardToLeader=false;
    List<ZkCoreNodeProps> replicaProps=zkController.getZkStateReader().getReplicaProps(collection,shardId,zkController.getNodeName(),coreName);
    if (replicaProps != null) {
      nodes=new ArrayList<Node>(replicaProps.size());
      for (      ZkCoreNodeProps props : replicaProps) {
        nodes.add(new StdNode(props));
      }
    }
  }
 catch (  InterruptedException e) {
    Thread.currentThread().interrupt();
    throw new ZooKeeperException(SolrException.ErrorCode.SERVER_ERROR,"",e);
  }
  return nodes;
}
