{
  Collection<Slice> allSlices=coll.getSlices();
  List<Node> nodes=null;
  for (  Slice aslice : allSlices) {
    if (Slice.CONSTRUCTION.equals(aslice.getState())) {
      DocRouter.Range myRange=coll.getSlice(shardId).getRange();
      if (myRange == null)       myRange=new DocRouter.Range(Integer.MIN_VALUE,Integer.MAX_VALUE);
      boolean isSubset=aslice.getRange() != null && aslice.getRange().isSubsetOf(myRange);
      if (isSubset && (docId == null || (docId != null && coll.getRouter().isTargetSlice(docId,doc,req.getParams(),aslice.getName(),coll)))) {
        Replica sliceLeader=aslice.getLeader();
        if (sliceLeader != null && zkController.getClusterState().liveNodesContain(sliceLeader.getNodeName())) {
          if (nodes == null)           nodes=new ArrayList<Node>();
          ZkCoreNodeProps nodeProps=new ZkCoreNodeProps(sliceLeader);
          nodes.add(new StdNode(nodeProps));
        }
      }
    }
  }
  return nodes;
}
