{
  String shardHandlerConfig="";
  Matcher shfMatcher=SHARD_HANDLER_TAG.matcher(originalXML);
  if (shfMatcher.find()) {
    shardHandlerConfig=shfMatcher.group(0);
  }
  Matcher popMatcher=POPULATED_CORES_TAG.matcher(originalXML);
  if (popMatcher.matches()) {
    return new StringBuilder(popMatcher.group(1)).append(CORES_PLACEHOLDER).append(shardHandlerConfig).append(popMatcher.group(3)).toString();
  }
  Matcher emptyMatcher=EMPTY_CORES_TAG.matcher(originalXML);
  if (emptyMatcher.matches())   return new StringBuilder(emptyMatcher.group(1)).append(">").append(CORES_PLACEHOLDER).append("</cores>").append(emptyMatcher.group(2)).toString();
  return originalXML.replace("</solr>","<cores>" + CORES_PLACEHOLDER + "</cores></solr>");
}
