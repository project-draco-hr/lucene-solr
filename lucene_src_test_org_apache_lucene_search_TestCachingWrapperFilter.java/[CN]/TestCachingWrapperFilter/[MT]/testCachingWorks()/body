{
  Directory dir=newDirectory(rand);
  RandomIndexWriter writer=new RandomIndexWriter(rand,dir);
  writer.close();
  IndexReader reader=IndexReader.open(dir,true);
  MockFilter filter=new MockFilter();
  CachingWrapperFilter cacher=new CachingWrapperFilter(filter);
  cacher.getDocIdSet(reader);
  assertTrue("first time",filter.wasCalled());
  cacher.getDocIdSet(reader);
  filter.clear();
  cacher.getDocIdSet(reader);
  assertFalse("second time",filter.wasCalled());
  reader.close();
  dir.close();
}
