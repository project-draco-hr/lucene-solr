{
  super.setUp();
  System.setProperty("solr.solr.home",ExternalPaths.EXAMPLE_HOME);
  File dataDir=new File(SolrTestCaseJ4.TEMP_DIR,getClass().getName() + "-" + System.currentTimeMillis());
  dataDir.mkdirs();
  System.setProperty("solr.data.dir",dataDir.getCanonicalPath());
  String path=ExternalPaths.WEBAPP_HOME;
  server=new Server(port);
  server.setSessionIdManager(new HashSessionIdManager(new Random(random.nextLong())));
  new WebAppContext(server,path,context);
  SocketConnector connector=new SocketConnector();
  connector.setMaxIdleTime(1000 * 60 * 60);
  connector.setSoLingerTime(-1);
  connector.setPort(0);
  server.setConnectors(new Connector[]{connector});
  server.setStopAtShutdown(true);
  server.start();
  port=connector.getLocalPort();
}
