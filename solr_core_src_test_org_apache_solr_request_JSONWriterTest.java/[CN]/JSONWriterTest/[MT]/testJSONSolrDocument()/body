{
  SolrQueryRequest req=req(CommonParams.WT,"json",CommonParams.FL,"id,score");
  SolrQueryResponse rsp=new SolrQueryResponse();
  JSONResponseWriter w=new JSONResponseWriter();
  ReturnFields returnFields=new ReturnFields(req);
  rsp.setReturnFields(returnFields);
  StringWriter buf=new StringWriter();
  SolrDocument solrDoc=new SolrDocument();
  solrDoc.addField("id","1");
  solrDoc.addField("subject","hello2");
  solrDoc.addField("title","hello3");
  solrDoc.addField("score","0.7");
  SolrDocumentList list=new SolrDocumentList();
  list.setNumFound(1);
  list.setStart(0);
  list.setMaxScore(0.7f);
  list.add(solrDoc);
  rsp.add("response",list);
  w.write(buf,req,rsp);
  String result=buf.toString();
  assertFalse("response contains unexpected fields: " + result,result.contains("hello") || result.contains("\"subject\"") || result.contains("\"title\""));
  assertTrue("response doesn't contain expected fields: " + result,result.contains("\"id\"") && result.contains("\"score\""));
  req.close();
}
