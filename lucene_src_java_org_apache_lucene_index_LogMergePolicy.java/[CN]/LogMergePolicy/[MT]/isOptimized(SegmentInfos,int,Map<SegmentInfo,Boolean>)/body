{
  final int numSegments=infos.size();
  int numToOptimize=0;
  SegmentInfo optimizeInfo=null;
  boolean segmentIsOriginal=false;
  for (int i=0; i < numSegments && numToOptimize <= maxNumSegments; i++) {
    final SegmentInfo info=infos.info(i);
    final Boolean isOriginal=segmentsToOptimize.get(info);
    if (isOriginal != null) {
      segmentIsOriginal=isOriginal;
      numToOptimize++;
      optimizeInfo=info;
    }
  }
  return numToOptimize <= maxNumSegments && (numToOptimize != 1 || !segmentIsOriginal || isOptimized(optimizeInfo));
}
