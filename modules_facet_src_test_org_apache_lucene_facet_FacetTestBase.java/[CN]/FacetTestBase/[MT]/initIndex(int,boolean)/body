{
  if (VERBOSE) {
    System.out.println("Partition Size: " + partitionSize + "  onDisk: "+ onDisk);
  }
  if (onDisk) {
    File indexFile=new File(TEMP_DIR,"index");
    indexDir=FSDirectory.open(indexFile);
    taxoDir=FSDirectory.open(new File(indexFile,"facets"));
  }
 else {
    indexDir=new RAMDirectory();
    taxoDir=new RAMDirectory();
  }
  IndexWriter iw=new IndexWriter(indexDir,new IndexWriterConfig(TEST_VERSION_CURRENT,getAnalyzer()));
  TaxonomyWriter taxo=new LuceneTaxonomyWriter(taxoDir,OpenMode.CREATE);
  populateIndex(iw,taxo,getFacetIndexingParams(partitionSize));
  taxo.commit();
  iw.commit();
  taxo.close();
  iw.close();
  taxoReader=new LuceneTaxonomyReader(taxoDir);
  indexReader=IndexReader.open(indexDir);
  searcher=new IndexSearcher(indexReader);
}
