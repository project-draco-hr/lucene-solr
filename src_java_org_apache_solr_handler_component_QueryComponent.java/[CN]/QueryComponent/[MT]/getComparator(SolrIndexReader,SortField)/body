{
  ScoreDocComparator comparator=null;
  String fieldname=sortField.getField();
switch (sortField.getType()) {
case SortField.INT:
    comparator=comparatorInt(reader,fieldname,sortField.getParser());
  break;
case SortField.FLOAT:
comparator=comparatorFloat(reader,fieldname,sortField.getParser());
break;
case SortField.LONG:
comparator=comparatorLong(reader,fieldname,sortField.getParser());
break;
case SortField.DOUBLE:
comparator=comparatorDouble(reader,fieldname,sortField.getParser());
break;
case SortField.STRING:
if (sortField.getLocale() != null) comparator=comparatorStringLocale(reader,fieldname,sortField.getLocale());
 else comparator=comparatorString(reader,fieldname);
break;
case SortField.CUSTOM:
comparator=sortField.getFactory().newComparator(reader,fieldname);
break;
default :
throw new RuntimeException("unknown field type: " + sortField.getType());
}
return comparator;
}
