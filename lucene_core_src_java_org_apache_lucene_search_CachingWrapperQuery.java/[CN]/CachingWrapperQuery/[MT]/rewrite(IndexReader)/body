{
  final Query rewritten=query.rewrite(reader);
  if (query == rewritten) {
    return super.rewrite(reader);
  }
 else {
    CachingWrapperQuery clone;
    try {
      clone=(CachingWrapperQuery)clone();
      clone.query=rewritten;
      return clone;
    }
 catch (    CloneNotSupportedException e) {
      throw new AssertionError(e);
    }
  }
}
