{
  super(coreNodeName,ZkStateReader.COLLECTIONS_ZKNODE + "/" + collection+ "/leader_elect/"+ shardId,ZkStateReader.getShardLeadersPath(collection,shardId),props,zkStateReader.getZkClient());
  this.leaderElector=leaderElector;
  this.zkClient=zkStateReader.getZkClient();
  this.shardId=shardId;
  this.collection=collection;
  Map previousMDCContext=MDC.getCopyOfContextMap();
  MDCUtils.setMDC(collection,shardId,null,null);
  try {
    new ZkCmdExecutor(zkStateReader.getZkClient().getZkClientTimeout()).ensureExists(ZkStateReader.COLLECTIONS_ZKNODE + "/" + collection,zkClient);
  }
 catch (  KeeperException e) {
    throw new SolrException(ErrorCode.SERVER_ERROR,e);
  }
catch (  InterruptedException e) {
    Thread.currentThread().interrupt();
    throw new SolrException(ErrorCode.SERVER_ERROR,e);
  }
 finally {
    MDCUtils.cleanupMDC(previousMDCContext);
  }
}
