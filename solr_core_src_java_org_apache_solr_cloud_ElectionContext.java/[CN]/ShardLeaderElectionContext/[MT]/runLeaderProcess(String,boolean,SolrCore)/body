{
  if (cc != null) {
    String coreName=leaderProps.get(ZkStateReader.CORE_NAME_PROP);
    SolrCore core=null;
    try {
      if (startupCore == null) {
        core=cc.getCore(coreName);
      }
 else {
        core=startupCore;
      }
      if (core == null) {
        throw new SolrException(ErrorCode.SERVER_ERROR,"Core not found:" + coreName);
      }
      if (weAreReplacement && !shouldIBeLeader(leaderProps)) {
        rejoinLeaderElection(leaderSeqPath,core);
        return;
      }
      if (weAreReplacement) {
        if (zkClient.exists(leaderPath,true)) {
          zkClient.delete(leaderPath,-1,true);
        }
        boolean success=syncStrategy.sync(zkController,core,leaderProps);
        if (!success) {
          core.getUpdateHandler().getSolrCoreState().doRecovery(core);
          rejoinLeaderElection(leaderSeqPath,core);
          return;
        }
      }
      core.getUpdateHandler().getSolrCoreState().cancelRecovery();
      zkController.publish(core.getCoreDescriptor(),ZkStateReader.ACTIVE);
    }
  finally {
      if (core != null && startupCore == null) {
        core.close();
      }
    }
  }
  super.runLeaderProcess(leaderSeqPath,weAreReplacement,startupCore);
}
