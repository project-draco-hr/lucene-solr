{
  CloudState cloudState=zkController.getZkStateReader().getCloudState();
  Map<String,Slice> slices=cloudState.getSlices(this.collection);
  Slice slice=slices.get(shardId);
  Map<String,ZkNodeProps> shards=slice.getShards();
  boolean foundSomeoneElseActive=false;
  for (  Map.Entry<String,ZkNodeProps> shard : shards.entrySet()) {
    String state=shard.getValue().get(ZkStateReader.STATE_PROP);
    if (new ZkCoreNodeProps(shard.getValue()).getCoreUrl().equals(new ZkCoreNodeProps(leaderProps).getCoreUrl())) {
      if (state.equals(ZkStateReader.ACTIVE) && cloudState.liveNodesContain(shard.getValue().get(ZkStateReader.NODE_NAME_PROP))) {
        return true;
      }
    }
    if ((state.equals(ZkStateReader.ACTIVE)) && cloudState.liveNodesContain(shard.getValue().get(ZkStateReader.NODE_NAME_PROP)) && !new ZkCoreNodeProps(shard.getValue()).getCoreUrl().equals(new ZkCoreNodeProps(leaderProps).getCoreUrl())) {
      foundSomeoneElseActive=true;
    }
  }
  return !foundSomeoneElseActive;
}
