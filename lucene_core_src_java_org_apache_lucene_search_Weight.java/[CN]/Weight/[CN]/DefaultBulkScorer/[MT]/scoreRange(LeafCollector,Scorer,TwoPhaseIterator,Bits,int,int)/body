{
  if (twoPhase == null) {
    while (currentDoc < end) {
      if (acceptDocs == null || acceptDocs.get(currentDoc)) {
        collector.collect(currentDoc);
      }
      currentDoc=scorer.nextDoc();
    }
    return currentDoc;
  }
 else {
    final DocIdSetIterator approximation=twoPhase.approximation();
    while (currentDoc < end) {
      if ((acceptDocs == null || acceptDocs.get(currentDoc)) && twoPhase.matches()) {
        collector.collect(currentDoc);
      }
      currentDoc=approximation.nextDoc();
    }
    return currentDoc;
  }
}
