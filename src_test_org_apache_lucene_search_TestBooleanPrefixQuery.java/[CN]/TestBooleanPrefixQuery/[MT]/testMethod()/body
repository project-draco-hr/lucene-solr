{
  RAMDirectory directory=new RAMDirectory();
  String[] categories=new String[]{"food","foodanddrink","foodanddrinkandgoodtimes","food and drink"};
  Query rw1=null;
  Query rw2=null;
  try {
    IndexWriter writer=new IndexWriter(directory,new WhitespaceAnalyzer(),true);
    for (int i=0; i < categories.length; i++) {
      Document doc=new Document();
      doc.add(new Field("category",categories[i],Field.Store.YES,Field.Index.UN_TOKENIZED));
      writer.addDocument(doc);
    }
    writer.close();
    IndexReader reader=IndexReader.open(directory);
    PrefixQuery query=new PrefixQuery(new Term("category","foo"));
    rw1=query.rewrite(reader);
    BooleanQuery bq=new BooleanQuery();
    bq.add(query,BooleanClause.Occur.MUST);
    rw2=bq.rewrite(reader);
  }
 catch (  IOException e) {
    fail(e.getMessage());
  }
  BooleanQuery bq1=null;
  if (rw1 instanceof BooleanQuery) {
    bq1=(BooleanQuery)rw1;
  }
  BooleanQuery bq2=null;
  if (rw2 instanceof BooleanQuery) {
    bq2=(BooleanQuery)rw2;
  }
 else {
    fail("Rewrite");
  }
  assertEquals("Number of Clauses Mismatch",bq1.getClauses().length,bq2.getClauses().length);
}
