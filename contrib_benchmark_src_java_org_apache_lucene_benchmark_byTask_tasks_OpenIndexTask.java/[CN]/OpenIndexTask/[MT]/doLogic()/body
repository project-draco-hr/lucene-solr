{
  PerfRunData runData=getRunData();
  Config config=runData.getConfig();
  final IndexCommit ic;
  if (commitUserData != null) {
    ic=OpenReaderTask.findIndexCommit(runData.getDirectory(),commitUserData);
  }
 else {
    ic=null;
  }
  IndexWriter writer=new IndexWriter(runData.getDirectory(),runData.getAnalyzer(),CreateIndexTask.getIndexDeletionPolicy(config),IndexWriter.MaxFieldLength.UNLIMITED,ic);
  CreateIndexTask.setIndexWriterConfig(writer,config);
  runData.setIndexWriter(writer);
  return 1;
}
