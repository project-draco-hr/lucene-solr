{
  setLockFactory(NoLockFactory.getNoLockFactory());
  this.hdfsDirPath=hdfsDirPath;
  this.configuration=configuration;
  fileSystem=FileSystem.newInstance(hdfsDirPath.toUri(),configuration);
  try {
    if (!fileSystem.exists(hdfsDirPath)) {
      fileSystem.mkdirs(hdfsDirPath);
    }
  }
 catch (  Exception e) {
    org.apache.solr.util.IOUtils.closeQuietly(fileSystem);
    throw new RuntimeException("Problem creating directory: " + hdfsDirPath,e);
  }
}
