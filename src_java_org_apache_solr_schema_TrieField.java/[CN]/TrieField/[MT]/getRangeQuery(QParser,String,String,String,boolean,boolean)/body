{
  Query query=null;
switch (type) {
case INTEGER:
    query=new IntTrieRangeQuery(field,precisionStep,min == null ? null : Integer.parseInt(min),max == null ? null : Integer.parseInt(max),minInclusive,maxInclusive);
  break;
case FLOAT:
query=new IntTrieRangeQuery(field,precisionStep,min == null ? null : TrieUtils.floatToSortableInt(Float.parseFloat(min)),max == null ? null : TrieUtils.floatToSortableInt(Float.parseFloat(max)),minInclusive,maxInclusive);
break;
case LONG:
query=new LongTrieRangeQuery(field,precisionStep,min == null ? null : Long.parseLong(min),max == null ? null : Long.parseLong(max),minInclusive,maxInclusive);
break;
case DOUBLE:
query=new LongTrieRangeQuery(field,precisionStep,min == null ? null : TrieUtils.doubleToSortableLong(Double.parseDouble(min)),max == null ? null : TrieUtils.doubleToSortableLong(Double.parseDouble(max)),minInclusive,maxInclusive);
break;
case DATE:
query=new LongTrieRangeQuery(field,precisionStep,min == null ? null : dateField.parseMath(null,min).getTime(),max == null ? null : dateField.parseMath(null,max).getTime(),minInclusive,maxInclusive);
break;
default :
throw new SolrException(SolrException.ErrorCode.SERVER_ERROR,"Unknown type for trie field");
}
return query;
}
