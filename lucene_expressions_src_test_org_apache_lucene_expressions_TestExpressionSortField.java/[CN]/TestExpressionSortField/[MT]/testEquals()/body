{
  Expression expr=JavascriptCompiler.compile("sqrt(_score) + ln(popularity)");
  SimpleBindings bindings=new SimpleBindings();
  bindings.add(new SortField("_score",SortField.Type.SCORE));
  bindings.add(new SortField("popularity",SortField.Type.INT));
  SimpleBindings otherBindings=new SimpleBindings();
  bindings.add(new SortField("_score",SortField.Type.LONG));
  bindings.add(new SortField("popularity",SortField.Type.INT));
  SortField sf1=expr.getSortField(bindings,true);
  SortField sf2=expr.getSortField(bindings,false);
  assertFalse(sf1.equals(sf2));
  sf2=expr.getSortField(otherBindings,true);
  assertFalse(sf1.equals(sf2));
  Expression other=JavascriptCompiler.compile("popularity/2");
  sf2=other.getSortField(bindings,true);
  assertFalse(sf1.equals(sf2));
  assertFalse(sf1.equals(null));
  assertEquals(sf1,sf1);
}
