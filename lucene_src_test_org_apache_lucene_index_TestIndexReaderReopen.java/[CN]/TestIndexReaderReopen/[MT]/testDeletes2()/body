{
  Directory dir=newDirectory();
  createIndex(random,dir,false);
  modifyIndex(0,dir);
  IndexReader r1=IndexReader.open(dir,false);
  modifyIndex(5,dir);
  IndexReader r2=r1.reopen();
  assertTrue(r1 != r2);
  IndexReader[] rs2=r2.getSequentialSubReaders();
  SegmentReader sr1=getOnlySegmentReader(r1);
  SegmentReader sr2=(SegmentReader)rs2[0];
  assertTrue(sr1.liveDocs == sr2.liveDocs);
  final BitVector liveDocs=sr1.liveDocs;
  r1.close();
  r2.deleteDocument(0);
  assertTrue(liveDocs == sr2.liveDocs);
  r2.close();
  dir.close();
}
