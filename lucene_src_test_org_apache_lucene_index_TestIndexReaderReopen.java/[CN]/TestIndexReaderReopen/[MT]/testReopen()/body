{
  final Directory dir1=newDirectory();
  createIndex(random,dir1,false);
  performDefaultTests(new TestReopen(){
    @Override protected void modifyIndex(    int i) throws IOException {
      TestIndexReaderReopen.modifyIndex(i,dir1);
    }
    @Override protected IndexReader openReader() throws IOException {
      return IndexReader.open(dir1,false);
    }
  }
);
  dir1.close();
  final Directory dir2=newDirectory();
  createIndex(random,dir2,true);
  performDefaultTests(new TestReopen(){
    @Override protected void modifyIndex(    int i) throws IOException {
      TestIndexReaderReopen.modifyIndex(i,dir2);
    }
    @Override protected IndexReader openReader() throws IOException {
      return IndexReader.open(dir2,false);
    }
  }
);
  dir2.close();
}
