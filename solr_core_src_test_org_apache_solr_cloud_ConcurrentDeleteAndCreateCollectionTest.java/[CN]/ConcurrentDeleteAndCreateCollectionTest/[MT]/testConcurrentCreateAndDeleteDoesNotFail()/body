{
  final File configDir=getFile("solrj").toPath().resolve("solr/configsets/configset-2/conf").toFile();
  final AtomicReference<Exception> failure=new AtomicReference<>();
  final int timeToRunSec=30;
  final Thread[] threads=new Thread[10];
  for (int i=0; i < threads.length; i++) {
    final String collectionName="collection" + i;
    uploadConfig(configDir,collectionName);
    final SolrClient solrClient=new HttpSolrClient(solrCluster.getJettySolrRunners().get(0).getBaseUrl().toString());
    threads[i]=new CreateDeleteCollectionThread("create-delete-" + i,collectionName,timeToRunSec,solrClient,failure);
  }
  startAll(threads);
  joinAll(threads);
  assertNull("concurrent create and delete collection failed: " + failure.get(),failure.get());
}
