{
  final String configName="testconfig";
  uploadConfig(configset("configset-2"),configName);
  final String baseUrl=solrCluster.getJettySolrRunners().get(0).getBaseUrl().toString();
  final SolrClient solrClient=getHttpSolrClient(baseUrl);
  final AtomicReference<Exception> failure=new AtomicReference<>();
  final int timeToRunSec=30;
  final Thread[] threads=new Thread[2];
  for (int i=0; i < threads.length; i++) {
    final String collectionName="collection" + i;
    threads[i]=new CreateDeleteCollectionThread("create-delete-" + i,collectionName,configName,timeToRunSec,solrClient,failure);
  }
  startAll(threads);
  joinAll(threads);
  assertNull("concurrent create and delete collection failed: " + failure.get(),failure.get());
  try {
    solrClient.close();
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
}
