{
  final String configName="testconfig";
  final File configDir=getFile("solr").toPath().resolve("configsets/configset-2/conf").toFile();
  uploadConfig(configDir,configName);
  final SolrClient solrClient=new HttpSolrClient(solrCluster.getJettySolrRunners().get(0).getBaseUrl().toString());
  final AtomicReference<Exception> failure=new AtomicReference<>();
  final int timeToRunSec=30;
  final Thread[] threads=new Thread[2];
  for (int i=0; i < threads.length; i++) {
    final String collectionName="collection" + i;
    threads[i]=new CreateDeleteCollectionThread("create-delete-" + i,collectionName,configName,timeToRunSec,solrClient,failure);
  }
  startAll(threads);
  joinAll(threads);
  assertNull("concurrent create and delete collection failed: " + failure.get(),failure.get());
  try {
    solrClient.close();
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
}
