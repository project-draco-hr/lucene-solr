{
  Directory directory=FSDirectory.getDirectory(indexDir,false);
  SegmentReader r1=SegmentReader.get(new SegmentInfo(seg1,docCount1,directory));
  SegmentReader r2=SegmentReader.get(new SegmentInfo(seg2,docCount2,directory));
  SegmentMerger merger=new SegmentMerger(directory,merged);
  merger.add(r1);
  merger.add(r2);
  merger.merge();
  merger.closeReaders();
  if (useCompoundFile) {
    Vector filesToDelete=merger.createCompoundFile(merged + ".cfs");
    for (Iterator iter=filesToDelete.iterator(); iter.hasNext(); )     directory.deleteFile((String)iter.next());
  }
  directory.close();
}
