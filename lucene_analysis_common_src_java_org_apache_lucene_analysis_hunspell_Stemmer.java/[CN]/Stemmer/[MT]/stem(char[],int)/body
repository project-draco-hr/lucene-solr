{
  if (dictionary.needsInputCleaning) {
    scratchSegment.setLength(0);
    scratchSegment.append(word,0,length);
    CharSequence cleaned=dictionary.cleanInput(scratchSegment,segment);
    scratchBuffer=ArrayUtil.grow(scratchBuffer,cleaned.length());
    length=segment.length();
    segment.getChars(0,length,scratchBuffer,0);
    word=scratchBuffer;
  }
  List<CharsRef> stems=new ArrayList<CharsRef>();
  IntsRef forms=dictionary.lookupWord(word,0,length);
  if (forms != null) {
    for (int i=0; i < forms.length; i++) {
      stems.add(newStem(word,length));
    }
  }
  stems.addAll(stem(word,length,-1,-1,-1,0,true,true,false,false));
  return stems;
}
