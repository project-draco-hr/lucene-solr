{
  boolean success=false;
  try {
    initFlushState(true);
    closedFiles.clear();
    consumer.closeDocStore(flushState);
    String s=docStoreSegment;
    docStoreSegment=null;
    docStoreOffset=0;
    numDocsInStore=0;
    success=true;
    return s;
  }
  finally {
    if (!success) {
      parent.abort();
    }
  }
}
