{
  this.directory=directory;
  this.parent=parent;
  this.fieldInfos=fieldInfos.newFieldInfosWithGlobalFieldNumberMap();
  this.writer=parent.indexWriter;
  this.infoStream=parent.indexWriter.getInfoStream();
  this.docState=new DocState(this);
  this.docState.similarityProvider=parent.indexWriter.getConfig().getSimilarityProvider();
  consumer=indexingChain.getChain(this);
  if (consumer instanceof DocFieldProcessor) {
    docFieldProcessor=(DocFieldProcessor)consumer;
  }
}
