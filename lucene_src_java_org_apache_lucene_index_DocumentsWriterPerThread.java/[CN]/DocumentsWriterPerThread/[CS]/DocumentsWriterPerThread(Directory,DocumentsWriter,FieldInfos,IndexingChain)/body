{
  this.directory=directory;
  this.parent=parent;
  this.fieldInfos=fieldInfos;
  this.writer=parent.indexWriter;
  this.infoStream=parent.infoStream;
  this.docState=new DocState(this);
  this.docState.similarityProvider=parent.indexWriter.getConfig().getSimilarityProvider();
  bytesUsed=Counter.newCounter();
  byteBlockAllocator=new DirectTrackingAllocator(bytesUsed);
  consumer=indexingChain.getChain(this);
  pendingDeletes=new BufferedDeletes();
  initialize();
}
