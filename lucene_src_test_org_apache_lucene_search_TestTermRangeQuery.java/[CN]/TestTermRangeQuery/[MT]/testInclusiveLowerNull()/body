{
  Analyzer analyzer=new SingleCharAnalyzer();
  Query query=TermRangeQuery.newStringRange("content",null,"C",true,true);
  initializeIndex(new String[]{"A","B","","C","D"},analyzer);
  IndexReader reader=IndexReader.open(dir);
  IndexSearcher searcher=new IndexSearcher(reader);
  int numHits=searcher.search(query,null,1000).totalHits;
  assertEquals("A,B,<empty string>,C,D => A,B,<empty string>,C in range",4,numHits);
  reader.close();
  initializeIndex(new String[]{"A","B","","D"},analyzer);
  reader=IndexReader.open(dir);
  searcher=new IndexSearcher(reader);
  numHits=searcher.search(query,null,1000).totalHits;
  assertEquals("A,B,<empty string>,D - A, B and <empty string> in range",3,numHits);
  reader.close();
  addDoc("C");
  reader=IndexReader.open(dir);
  searcher=new IndexSearcher(reader);
  numHits=searcher.search(query,null,1000).totalHits;
  assertEquals("C added => A,B,<empty string>,C in range",4,numHits);
  reader.close();
}
