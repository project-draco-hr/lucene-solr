{
  destTaxoWriter.addTaxonomy(srcTaxoDir,map);
  int ordinalMap[]=map.getMap();
  DirectoryReader reader=DirectoryReader.open(srcIndexDir);
  try {
    List<LeafReaderContext> leaves=reader.leaves();
    int numReaders=leaves.size();
    CodecReader wrappedLeaves[]=new CodecReader[numReaders];
    for (int i=0; i < numReaders; i++) {
      wrappedLeaves[i]=SlowCodecReaderWrapper.wrap(new OrdinalMappingLeafReader(leaves.get(i).reader(),ordinalMap,srcConfig));
    }
    destIndexWriter.addIndexes(wrappedLeaves);
    destTaxoWriter.commit();
    destIndexWriter.commit();
  }
  finally {
    reader.close();
  }
}
