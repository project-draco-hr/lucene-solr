{
  while (true) {
    Tuple a=streamA.read();
    Tuple b=streamB.read();
    if (a.EOF) {
      return a;
    }
    if (b.EOF) {
      streamB.pushBack(b);
      return a;
    }
    if (!eq.test(a,b) && streamA.getStreamSort().compare(a,b) < 0) {
      streamB.pushBack(b);
      return a;
    }
    if (eq.test(a,b)) {
      streamB.pushBack(b);
    }
 else {
      streamA.pushBack(a);
    }
  }
}
