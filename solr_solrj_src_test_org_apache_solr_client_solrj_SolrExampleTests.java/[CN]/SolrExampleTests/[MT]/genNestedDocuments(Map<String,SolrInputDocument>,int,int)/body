{
  String id="" + (idCounter++);
  SolrInputDocument sdoc=new SolrInputDocument();
  allDocs.put(id,sdoc);
  sdoc.addField("id",id);
  sdoc.addField("level_i",thisLevel);
  sdoc.addField("name",names[TestUtil.nextInt(random(),0,names.length - 1)]);
  if (0 < maxDepth) {
    int numKids=TestUtil.nextInt(random(),-2,7);
    for (int i=0; i < numKids; i++) {
      sdoc.addChildDocument(genNestedDocuments(allDocs,thisLevel + 1,maxDepth - 1));
    }
  }
  return sdoc;
}
