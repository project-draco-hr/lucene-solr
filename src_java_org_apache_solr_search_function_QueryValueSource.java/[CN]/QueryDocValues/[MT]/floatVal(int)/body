{
  try {
    if (doc < lastDocRequested) {
      scorer=weight.scorer(reader);
      boolean more=scorer.next();
      if (more) {
        scorerDoc=scorer.doc();
      }
 else {
        scorerDoc=Integer.MAX_VALUE;
      }
    }
    lastDocRequested=doc;
    if (scorerDoc < doc) {
      boolean more=scorer.skipTo(doc);
      if (more) {
        scorerDoc=scorer.doc();
      }
 else {
        scorerDoc=Integer.MAX_VALUE;
      }
    }
    if (scorerDoc > doc) {
      return defVal;
    }
    return scorer.score();
  }
 catch (  IOException e) {
    throw new SolrException(SolrException.ErrorCode.SERVER_ERROR,"caught exception in QueryDocVals(" + q + ") doc="+ doc,e);
  }
}
