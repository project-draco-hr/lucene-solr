{
  Directory dir=newDirectory();
  Directory taxoDir=newDirectory();
  writer=new RandomIndexWriter(random(),dir);
  taxoWriter=new DirectoryTaxonomyWriter(taxoDir,IndexWriterConfig.OpenMode.CREATE);
  IndexSearcher searcher=newSearcher(writer.getReader());
  writer.close();
  TaxonomyReader taxoReader=new DirectoryTaxonomyReader(taxoWriter);
  taxoWriter.close();
  FacetSearchParams fsp=new FacetSearchParams(new CountFacetRequest(new CategoryPath("Author"),10));
  DrillSideways ds=new DrillSideways(searcher,taxoReader);
  DrillDownQuery ddq=new DrillDownQuery(fsp.indexingParams,new MatchAllDocsQuery());
  ddq.add(new CategoryPath("Author","Lisa"));
  DrillSidewaysResult r=ds.search(null,ddq,10,fsp);
  assertEquals(0,r.hits.totalHits);
  r=ds.search(ddq,null,null,10,new Sort(new SortField("foo",Type.INT)),false,false,fsp);
  assertEquals(0,r.hits.totalHits);
  IOUtils.close(searcher.getIndexReader(),taxoReader,dir,taxoDir);
}
