{
  CharacterUtils java4=CharacterUtils.getJava4Instance();
  CharacterUtils java5=CharacterUtils.getInstance(TEST_VERSION_CURRENT);
  for (int i=0; i < 10; ++i) {
    final char[] s=TestUtil.randomUnicodeString(random()).toCharArray();
    final int index=TestUtil.nextInt(random(),0,s.length);
    final int offset=random().nextInt(7) - 3;
    try {
      final int o=java4.offsetByCodePoints(s,0,s.length,index,offset);
      assertEquals(o,index + offset);
    }
 catch (    IndexOutOfBoundsException e) {
      assertTrue((index + offset) < 0 || (index + offset) > s.length);
    }
    int o;
    try {
      o=java5.offsetByCodePoints(s,0,s.length,index,offset);
    }
 catch (    IndexOutOfBoundsException e) {
      try {
        Character.offsetByCodePoints(s,0,s.length,index,offset);
        fail();
      }
 catch (      IndexOutOfBoundsException e2) {
      }
      o=-1;
    }
    if (o >= 0) {
      assertEquals(Character.offsetByCodePoints(s,0,s.length,index,offset),o);
    }
  }
}
