{
  String algLines[]={"# ----- properties ","content.source=org.apache.lucene.benchmark.byTask.feeds.SortableSingleDocSource","doc.term.vector=false","log.step.AddDoc=10000","content.source.forever=true","directory=RAMDirectory","doc.reuse.fields=false","doc.stored=false","doc.tokenized=false","doc.index.props=true","# ----- alg ","CreateIndex","[ { AddDoc > : 250 ] : 4","CloseIndex"};
  CountingSearchTestTask.numSearches=0;
  Benchmark benchmark=execBenchmark(algLines);
  IndexReader r=IndexReader.open(benchmark.getRunData().getDirectory());
  DocTermsIndex idx=FieldCache.DEFAULT.getTermsIndex(new SlowMultiReaderWrapper(r),"country");
  final int maxDoc=r.maxDoc();
  assertEquals(1000,maxDoc);
  BytesRef br=new BytesRef();
  for (int i=0; i < 1000; i++) {
    assertNotNull("doc " + i + " has null country",idx.getTerm(i,br));
  }
  r.close();
}
