{
  String json="{\n" + "  \"id\" : \"123\",\n" + "  \"description\": \"Testing /json/docs srcField 1\",\n"+ "\n"+ "  \"nested_data\" : {\n"+ "    \"nested_inside\" : \"check check check 1\"\n"+ "  }\n"+ "}";
  String json2=" {\n" + "  \"id\" : \"345\",\n" + "  \"description\": \"Testing /json/docs srcField 2\",\n"+ "\n"+ "  \"nested_data\" : {\n"+ "    \"nested_inside\" : \"check check check 2\"\n"+ "  }\n"+ "}";
  JsonRecordReader streamer=JsonRecordReader.getInst("/",Arrays.asList("id:/id"));
  RecordingJSONParser parser=new RecordingJSONParser(new StringReader(json + json2));
  streamer.streamRecords(parser,new JsonRecordReader.Handler(){
    int count=0;
    @Override public void handle(    Map<String,Object> record,    String path){
      count++;
      String buf=parser.getBuf();
      parser.resetBuf();
      Map m=(Map)Utils.fromJSONString(buf);
      if (count == 1) {
        assertEquals(m.get("id"),"123");
        assertEquals(m.get("description"),"Testing /json/docs srcField 1");
        assertEquals(((Map)m.get("nested_data")).get("nested_inside"),"check check check 1");
      }
      if (count++ == 2) {
        assertEquals(m.get("id"),"345");
        assertEquals(m.get("description"),"Testing /json/docs srcField 2");
        assertEquals(((Map)m.get("nested_data")).get("nested_inside"),"check check check 2");
      }
    }
  }
);
}
