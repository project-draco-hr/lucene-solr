{
  Directory input=newDirectory();
  DirectoryTaxonomyWriter taxoWriter=new DirectoryTaxonomyWriter(input);
  taxoWriter.addCategory(new CategoryPath("a"));
  taxoWriter.close();
  Directory dir=newDirectory();
  taxoWriter=new DirectoryTaxonomyWriter(dir);
  int ordinal=taxoWriter.addCategory(new CategoryPath("b"));
  taxoWriter.addCategory(new CategoryPath("c"));
  taxoWriter.commit();
  long origEpoch=getEpoch(dir);
  taxoWriter.replaceTaxonomy(input);
  int newOrdinal=taxoWriter.addCategory(new CategoryPath("b"));
  assertNotSame("new ordinal cannot be the original ordinal",ordinal,newOrdinal);
  assertEquals("ordinal should have been 2 since only one category was added by replaceTaxonomy",2,newOrdinal);
  taxoWriter.close();
  long newEpoch=getEpoch(dir);
  assertTrue("index epoch should have been updated after replaceTaxonomy",origEpoch < newEpoch);
  dir.close();
  input.close();
}
