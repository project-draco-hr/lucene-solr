{
  long startTimestamp=System.nanoTime();
  long actualResultSize=0;
  while (true) {
    if (System.nanoTime() - startTimestamp > TimeUnit.MILLISECONDS.toNanos(timeoutMS) || actualResultSize > expectedResultSize) {
      fail("expected: " + expectedResultSize + ", actual: "+ actualResultSize);
    }
    SolrParams queryAll=new SolrQuery("*:*");
    cloudClient.setDefaultCollection(collection);
    QueryResponse queryResponse=cloudClient.query(queryAll);
    actualResultSize=queryResponse.getResults().getNumFound();
    if (expectedResultSize == actualResultSize) {
      return;
    }
    Thread.sleep(1000);
  }
}
