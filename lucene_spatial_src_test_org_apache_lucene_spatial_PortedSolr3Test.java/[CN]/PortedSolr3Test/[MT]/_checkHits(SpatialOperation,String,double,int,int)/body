{
  Point pt=(Point)ctx.readShape(ptStr);
  Shape shape=ctx.makeCircle(pt,dist);
  SpatialArgs args=new SpatialArgs(op,shape);
  Query query;
  if (random().nextBoolean()) {
    query=strategy.makeQuery(args);
  }
 else {
    query=new FilteredQuery(new MatchAllDocsQuery(),strategy.makeFilter(args));
  }
  SearchResults results=executeQuery(query,100);
  assertEquals("" + shape,assertNumFound,results.numFound);
  if (assertIds != null) {
    Set<Integer> resultIds=new HashSet<Integer>();
    for (    SearchResult result : results.results) {
      resultIds.add(Integer.valueOf(result.document.get("id")));
    }
    for (    int assertId : assertIds) {
      assertTrue("has " + assertId,resultIds.contains(assertId));
    }
  }
}
