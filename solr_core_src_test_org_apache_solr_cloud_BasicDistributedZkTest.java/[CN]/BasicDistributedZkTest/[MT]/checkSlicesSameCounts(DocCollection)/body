{
  long docTotal=0;
  for (  Slice slice : dColl.getActiveSlices()) {
    long sliceDocCount=-1;
    for (    Replica rep : slice.getReplicas()) {
      HttpSolrClient one=new HttpSolrClient(rep.getCoreUrl());
      SolrQuery query=new SolrQuery("*:*");
      query.setDistrib(false);
      QueryResponse resp=one.query(query);
      long hits=resp.getResults().getNumFound();
      if (sliceDocCount == -1) {
        sliceDocCount=hits;
        docTotal+=hits;
      }
 else {
        if (hits != sliceDocCount) {
          return -1;
        }
      }
    }
  }
  return docTotal;
}
