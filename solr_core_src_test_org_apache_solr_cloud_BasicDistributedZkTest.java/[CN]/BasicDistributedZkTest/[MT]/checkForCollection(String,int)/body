{
  long timeoutAt=System.currentTimeMillis() + 60000;
  boolean found=false;
  boolean sliceMatch=false;
  while (System.currentTimeMillis() < timeoutAt) {
    ClusterState clusterState=solrj.getZkStateReader().getClusterState();
    Map<String,DocCollection> collections=clusterState.getCollectionStates();
    if (collections.containsKey(collectionName)) {
      Map<String,Slice> slices=collections.get(collectionName).getSlicesMap();
      if (slices.size() == expectedSlices) {
        sliceMatch=true;
      }
      found=true;
      break;
    }
    Thread.sleep(500);
  }
  if (!found) {
    if (!sliceMatch) {
      fail("Could not find new " + expectedSlices + " slice collection called "+ collectionName);
    }
  }
}
