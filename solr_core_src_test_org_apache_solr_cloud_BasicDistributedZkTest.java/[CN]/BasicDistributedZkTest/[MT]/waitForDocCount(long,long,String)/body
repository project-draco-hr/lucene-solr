{
  RTimer timer=new RTimer();
  long timeout=(long)timer.getTime() + waitMillis;
  while (cloudClient.query(new SolrQuery("*:*")).getResults().getNumFound() != expectedNumFound) {
    if (timeout <= (long)timer.getTime()) {
      fail(failureMessage);
    }
    Thread.sleep(100);
  }
  for (  SolrClient client : clients) {
    assertEquals(failureMessage,expectedNumFound,client.query(new SolrQuery("*:*")).getResults().getNumFound());
  }
}
