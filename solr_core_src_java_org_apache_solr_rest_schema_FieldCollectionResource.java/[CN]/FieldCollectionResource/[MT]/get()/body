{
  try {
    final List<SimpleOrderedMap<Object>> props=new ArrayList<>();
    if (null == getRequestedFields()) {
      SortedSet<String> fieldNames=new TreeSet<>(getSchema().getFields().keySet());
      for (      String fieldName : fieldNames) {
        props.add(getFieldProperties(getSchema().getFields().get(fieldName)));
      }
    }
 else {
      if (0 == getRequestedFields().size()) {
        String message="Empty " + CommonParams.FL + " parameter value";
        throw new SolrException(ErrorCode.BAD_REQUEST,message);
      }
      for (      String fieldName : getRequestedFields()) {
        final SchemaField field;
        if (includeDynamic) {
          field=getSchema().getFieldOrNull(fieldName);
        }
 else {
          field=getSchema().getFields().get(fieldName);
        }
        if (null == field) {
          log.info("Requested field '" + fieldName + "' not found.");
        }
 else {
          props.add(getFieldProperties(field));
        }
      }
    }
    getSolrResponse().add(IndexSchema.FIELDS,props);
  }
 catch (  Exception e) {
    getSolrResponse().setException(e);
  }
  handlePostExecution(log);
  return new SolrOutputRepresentation();
}
