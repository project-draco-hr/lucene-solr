{
  if (last == null) {
    throw new UnderflowException();
  }
  if (last.size() <= 0) {
    queueBlocks.removeLast();
    numBlocks--;
    if (numBlocks == 1) {
      last=first;
    }
 else     if (numBlocks == 0) {
      first=last=null;
      throw new UnderflowException();
    }
 else     if (numBlocks < 0) {
      System.err.println("CachingQueue.remove: numBlocks<0!");
      throw new UnderflowException();
    }
 else {
      last=(QueueBlock)queueBlocks.getLast();
    }
  }
  --size;
  return last.remove();
}
