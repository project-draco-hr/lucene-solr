{
  StoredField binaryFldCompressed=new StoredField("binaryCompressed",CompressionTools.compress(binaryValCompressed.getBytes(StandardCharsets.UTF_8)));
  StoredField stringFldCompressed=new StoredField("stringCompressed",CompressionTools.compressString(binaryValCompressed));
  Document doc=new Document();
  doc.add(binaryFldCompressed);
  doc.add(stringFldCompressed);
  Directory dir=newDirectory();
  RandomIndexWriter writer=new RandomIndexWriter(random(),dir);
  writer.addDocument(doc);
  IndexReader reader=writer.getReader();
  StoredDocument docFromReader=reader.document(0);
  assertTrue(docFromReader != null);
  String binaryFldCompressedTest=new String(CompressionTools.decompress(docFromReader.getBinaryValue("binaryCompressed")),StandardCharsets.UTF_8);
  assertTrue(binaryFldCompressedTest.equals(binaryValCompressed));
  assertTrue(CompressionTools.decompressString(docFromReader.getBinaryValue("stringCompressed")).equals(binaryValCompressed));
  writer.close();
  reader.close();
  dir.close();
}
