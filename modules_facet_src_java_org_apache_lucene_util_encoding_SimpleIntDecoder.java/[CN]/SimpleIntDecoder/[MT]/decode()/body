{
  int offset=0;
  while (offset < 4) {
    int nRead=in.read(buffer,offset,4 - offset);
    if (nRead == -1) {
      if (offset > 0) {
        throw new StreamCorruptedException("Need 4 bytes for decoding an int, got only " + offset);
      }
      return EOS;
    }
    offset+=nRead;
  }
  int v=buffer[3] & 0xff;
  v|=(buffer[2] << 8) & 0xff00;
  v|=(buffer[1] << 16) & 0xff0000;
  v|=(buffer[0] << 24) & 0xff000000;
  return v;
}
