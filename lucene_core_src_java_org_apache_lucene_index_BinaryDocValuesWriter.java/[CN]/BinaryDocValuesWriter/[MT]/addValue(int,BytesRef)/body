{
  if (docID < addedValues) {
    throw new IllegalArgumentException("DocValuesField \"" + fieldInfo.name + "\" appears more than once in this document (only one value is allowed per field)");
  }
  if (value == null) {
    throw new IllegalArgumentException("field=\"" + fieldInfo.name + "\": null value not allowed");
  }
  if (value.length > (BYTE_BLOCK_SIZE - 2)) {
    throw new IllegalArgumentException("DocValuesField \"" + fieldInfo.name + "\" is too large, must be <= "+ (BYTE_BLOCK_SIZE - 2));
  }
  while (addedValues < docID) {
    addedValues++;
    lengths.add(0);
  }
  addedValues++;
  lengths.add(value.length);
  try {
    bytesWriter.writeBytes(value.bytes,value.offset,value.length);
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
  updateBytesUsed();
}
