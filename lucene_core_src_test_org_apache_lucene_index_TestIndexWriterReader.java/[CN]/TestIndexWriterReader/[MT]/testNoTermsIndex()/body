{
  IndexWriterConfig conf=newIndexWriterConfig(TEST_VERSION_CURRENT,new MockAnalyzer(random())).setReaderTermsIndexDivisor(-1);
  final String format=_TestUtil.getPostingsFormat("f");
  assumeFalse("Format: " + format + " does not support ReaderTermsIndexDivisor!",(format.equals("SimpleText") || format.equals("Memory") || format.equals("Direct")|| format.equals("TempFST")|| format.equals("TempFSTOrd")));
  Directory dir=newDirectory();
  IndexWriter w=new IndexWriter(dir,conf);
  Document doc=new Document();
  doc.add(new TextField("f","val",Field.Store.NO));
  w.addDocument(doc);
  SegmentReader r=getOnlySegmentReader(DirectoryReader.open(w,true));
  try {
    _TestUtil.docs(random(),r,"f",new BytesRef("val"),null,null,DocsEnum.FLAG_NONE);
    fail("should have failed to seek since terms index was not loaded.");
  }
 catch (  IllegalStateException e) {
  }
 finally {
    r.close();
    w.close();
    dir.close();
  }
}
