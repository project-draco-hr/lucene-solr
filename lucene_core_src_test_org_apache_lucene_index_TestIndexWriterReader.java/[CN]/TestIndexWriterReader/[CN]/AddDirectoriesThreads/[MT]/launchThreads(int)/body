{
  for (int i=0; i < numThreads; i++) {
    threads[i]=new Thread(){
      @Override public void run(){
        try {
          final Directory[] dirs=new Directory[numDirs];
          for (int k=0; k < numDirs; k++)           dirs[k]=new MockDirectoryWrapper(random,new RAMDirectory(addDir,newIOContext(random)));
          for (int x=0; x < numIter; x++) {
            doBody(x,dirs);
          }
        }
 catch (        Throwable t) {
          handle(t);
        }
      }
    }
;
  }
  for (int i=0; i < numThreads; i++)   threads[i].start();
}
