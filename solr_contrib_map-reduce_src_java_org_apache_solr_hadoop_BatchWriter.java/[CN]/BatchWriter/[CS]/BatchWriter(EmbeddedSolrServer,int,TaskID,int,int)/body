{
  this.solr=solr;
  this.writerThreads=writerThreads;
  this.queueSize=queueSize;
  taskId=tid;
  if (writerThreads != 0) {
    batchPool=new ExecutorUtil.MDCAwareThreadPoolExecutor(writerThreads,writerThreads,5,TimeUnit.SECONDS,new LinkedBlockingQueue<Runnable>(queueSize),new ThreadPoolExecutor.CallerRunsPolicy());
  }
 else {
    batchPool=null;
  }
}
