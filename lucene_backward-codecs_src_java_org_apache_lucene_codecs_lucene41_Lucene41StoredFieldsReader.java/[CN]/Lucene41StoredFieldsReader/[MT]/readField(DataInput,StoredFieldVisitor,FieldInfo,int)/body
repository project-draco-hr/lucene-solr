{
switch (bits & TYPE_MASK) {
case BYTE_ARR:
    int length=in.readVInt();
  byte[] data=new byte[length];
in.readBytes(data,0,length);
visitor.binaryField(info,data);
break;
case STRING:
length=in.readVInt();
data=new byte[length];
in.readBytes(data,0,length);
visitor.stringField(info,new String(data,StandardCharsets.UTF_8));
break;
case NUMERIC_INT:
visitor.intField(info,in.readInt());
break;
case NUMERIC_FLOAT:
visitor.floatField(info,Float.intBitsToFloat(in.readInt()));
break;
case NUMERIC_LONG:
visitor.longField(info,in.readLong());
break;
case NUMERIC_DOUBLE:
visitor.doubleField(info,Double.longBitsToDouble(in.readLong()));
break;
default :
throw new AssertionError("Unknown type flag: " + Integer.toHexString(bits));
}
}
