{
  if (fields.length != flags.length)   throw new IllegalArgumentException("fields.length != flags.length");
  BooleanQuery bQuery=new BooleanQuery();
  for (int i=0; i < fields.length; i++) {
    QueryParser qp=new QueryParser(fields[i],analyzer);
    Query q=qp.parse(query);
    int flag=flags[i];
switch (flag) {
case REQUIRED_FIELD:
      bQuery.add(q,BooleanClause.Occur.MUST);
    break;
case PROHIBITED_FIELD:
  bQuery.add(q,BooleanClause.Occur.MUST_NOT);
break;
default :
bQuery.add(q,BooleanClause.Occur.SHOULD);
break;
}
}
return bQuery;
}
