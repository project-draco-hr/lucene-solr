{
  TokenStream tokenStream=analyzer.tokenStream(fieldName,text);
  SimpleHTMLFormatter formatter=new SimpleHTMLFormatter();
  QueryScorer scorer=new QueryScorer(query,fieldName,FIELD_NAME);
  Highlighter highlighter=new Highlighter(formatter,scorer);
  highlighter.setTextFragmenter(new SimpleFragmenter(Integer.MAX_VALUE));
  String rv=highlighter.getBestFragments(tokenStream,text,1,"(FIELD TEXT TRUNCATED)");
  return rv.length() == 0 ? text : rv;
}
