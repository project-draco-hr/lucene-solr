{
  String val=container.getContainerProperties().getProperty("solr.persistent","false");
  if (!Boolean.parseBoolean(val))   return;
  File parent=new File(container.getSolrHome());
  File props=new File(parent,SOLR_PROPERTIES_FILE);
  Properties propsOut=new Properties();
  propsOut.putAll(container.getContainerProperties());
  for (  String prop : origsolrprops.stringPropertyNames()) {
    String toTest=origsolrprops.getProperty(prop);
    if (toTest.indexOf("$") != -1) {
      propsOut.put(prop,toTest);
    }
  }
  OutputStream os=null;
  try {
    os=new FileOutputStream(props);
    propsOut.store(os,null);
  }
 catch (  IOException e) {
    log.error("Failed to persist file " + props.getAbsolutePath(),e);
  }
 finally {
    IOUtils.closeQuietly(os);
  }
}
