{
  FieldInfo fi=fieldInfos.fieldInfo(field);
  if (fi == null) {
    return null;
  }
  if (!DocValues.isSortedBytes(fi.getDocValuesType())) {
    throw new IllegalArgumentException("field \"" + field + "\" was not indexed as a sorted doc values field");
  }
  if (direct) {
    return simpleDVProducer.getDirectSorted(fi);
  }
 else {
    if (!docValuesCache.containsKey(fi)) {
      SortedDocValues dv=simpleDVProducer.getSorted(fi);
      if (dv != null) {
        docValuesCache.put(fi,dv);
      }
    }
    return (SortedDocValues)docValuesCache.get(fi);
  }
}
