{
  FieldInfo fi=fieldInfos.fieldInfo(field);
  if (fi == null) {
    return null;
  }
  if (!DocValues.isNumber(fi.getDocValuesType())) {
    throw new IllegalArgumentException("field \"" + field + "\" was not indexed as a numeric doc values field");
  }
  if (direct) {
    return simpleDVProducer.getDirectNumeric(fi);
  }
 else {
    if (!docValuesCache.containsKey(fi)) {
      NumericDocValues dv=simpleDVProducer.getNumeric(fi);
      if (dv != null) {
        docValuesCache.put(fi,dv);
      }
    }
    return (NumericDocValues)docValuesCache.get(fi);
  }
}
