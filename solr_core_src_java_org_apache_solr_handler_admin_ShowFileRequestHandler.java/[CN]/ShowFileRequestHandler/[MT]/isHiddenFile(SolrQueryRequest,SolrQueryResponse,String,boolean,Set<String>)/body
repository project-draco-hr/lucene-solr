{
  String fname=fnameIn.toUpperCase(Locale.ROOT);
  if (hiddenFiles.contains(fname) || hiddenFiles.contains("*")) {
    if (reportError) {
      log.error("Cannot access " + fname);
      rsp.setException(new SolrException(SolrException.ErrorCode.FORBIDDEN,"Can not access: " + fnameIn));
    }
    return true;
  }
  if (fname.indexOf("..") >= 0 || fname.startsWith(".")) {
    if (reportError) {
      log.error("Invalid path: " + fname);
      rsp.setException(new SolrException(SolrException.ErrorCode.FORBIDDEN,"Invalid path: " + fnameIn));
    }
    return true;
  }
  return false;
}
