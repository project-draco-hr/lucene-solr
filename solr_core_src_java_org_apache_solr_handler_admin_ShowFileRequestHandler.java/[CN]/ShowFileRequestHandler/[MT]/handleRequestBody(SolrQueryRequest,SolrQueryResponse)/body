{
  CoreContainer coreContainer=req.getCore().getCoreDescriptor().getCoreContainer();
  String op=req.getParams().get(OP_PARAM);
  if (op == null) {
    if (coreContainer.isZooKeeperAware()) {
      showFromZooKeeper(req,rsp,coreContainer);
    }
 else {
      showFromFileSystem(req,rsp);
    }
  }
 else   if (OP_WRITE.equalsIgnoreCase(op) || OP_TEST.equalsIgnoreCase(op)) {
    String fname=req.getParams().get("file",null);
    if (fname == null) {
      rsp.setException(new SolrException(ErrorCode.BAD_REQUEST,"No file name specified for write operation."));
    }
 else {
      fname=fname.replace('\\','/');
      if (isHiddenFile(req,rsp,fname,true) == false) {
        if (coreContainer.isZooKeeperAware()) {
          writeToZooKeeper(req,rsp);
        }
 else {
          writeToFileSystem(req,rsp);
        }
      }
    }
  }
}
