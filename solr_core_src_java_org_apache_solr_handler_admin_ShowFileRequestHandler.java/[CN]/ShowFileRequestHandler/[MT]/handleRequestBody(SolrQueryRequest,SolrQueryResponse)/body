{
  CoreContainer coreContainer=req.getCore().getCoreDescriptor().getCoreContainer();
  String op=req.getParams().get("op");
  if (op == null) {
    if (coreContainer.isZooKeeperAware()) {
      showFromZooKeeper(req,rsp,coreContainer);
    }
 else {
      showFromFileSystem(req,rsp);
    }
  }
 else   if ("write".equalsIgnoreCase(op)) {
    String fname=req.getParams().get("file",null);
    if (fname == null) {
      rsp.setException(new SolrException(ErrorCode.BAD_REQUEST,"No file name specified for write operation."));
    }
 else {
      if (coreContainer.isZooKeeperAware()) {
        if (isHiddenFile(rsp,fname) == false) {
          writeToZooKeeper(req,rsp,coreContainer);
        }
      }
 else {
        fname=fname.replace('\\','/');
        if (isHiddenFile(rsp,fname) == false) {
          writeToFileSystem(req,rsp);
        }
      }
    }
  }
}
