{
  CoreContainer coreContainer=req.getCore().getCoreDescriptor().getCoreContainer();
  SolrZkClient zkClient=coreContainer.getZkController().getZkClient();
  String adminFile=getAdminFileFromZooKeeper(req,rsp,zkClient);
  ContentStream stream=getOneInputStream(req,rsp);
  if (stream == null) {
    return;
  }
  byte[] data=IOUtils.toByteArray(new InputStreamReader(stream.getStream(),"UTF-8"),"UTF-8");
  String fname=req.getParams().get("file",null);
  if (OP_TEST.equals(req.getParams().get(OP_PARAM))) {
    testReloadSuccess(req,rsp,stream);
    return;
  }
  try {
    zkClient.setData(adminFile,data,true);
    log.info("Saved " + fname + " to ZooKeeper successfully.");
  }
 catch (  KeeperException.BadVersionException e) {
    log.error("Cannot save file: " + fname + " to Zookeeper, "+ "ZooKeeper error: "+ e.getMessage());
    rsp.setException(new SolrException(ErrorCode.SERVER_ERROR,"Cannot save file: " + fname + " to Zookeeper, "+ "ZooKeeper error: "+ e.getMessage()));
  }
}
