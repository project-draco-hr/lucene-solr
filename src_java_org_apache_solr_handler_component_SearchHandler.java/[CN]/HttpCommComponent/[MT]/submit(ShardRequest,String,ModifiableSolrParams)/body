{
  Callable<ShardResponse> task=new Callable<ShardResponse>(){
    public ShardResponse call() throws Exception {
      ShardResponse srsp=new ShardResponse();
      srsp.setShardRequest(sreq);
      srsp.setShard(shard);
      SimpleSolrResponse ssr=new SimpleSolrResponse();
      srsp.setSolrResponse(ssr);
      long startTime=System.currentTimeMillis();
      try {
        String url="http://" + shard;
        params.remove(CommonParams.WT);
        params.remove(CommonParams.VERSION);
        SolrServer server=new CommonsHttpSolrServer(url,client);
        QueryRequest req=new QueryRequest(params);
        req.setMethod(SolrRequest.METHOD.POST);
        req.setResponseParser(new BinaryResponseParser());
        ssr.nl=server.request(req);
      }
 catch (      Throwable th) {
        srsp.setException(th);
        if (th instanceof SolrException) {
          srsp.setResponseCode(((SolrException)th).code());
        }
 else {
          srsp.setResponseCode(-1);
        }
      }
      ssr.elapsedTime=System.currentTimeMillis() - startTime;
      return srsp;
    }
  }
;
  pending.add(completionService.submit(task));
}
