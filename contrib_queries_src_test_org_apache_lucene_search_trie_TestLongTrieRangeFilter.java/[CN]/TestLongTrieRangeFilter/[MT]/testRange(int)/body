{
  String field="field" + precisionStep;
  int count=3000;
  long lower=(distance * 3 / 2) + startOffset, upper=lower + count * distance + (distance / 3);
  LongTrieRangeFilter f=new LongTrieRangeFilter(field,precisionStep,new Long(lower),new Long(upper),true,true);
  TopDocs topDocs=searcher.search(f.asQuery(),null,noDocs,Sort.INDEXORDER);
  System.out.println("Found " + f.getLastNumberOfTerms() + " distinct terms in range for field '"+ field+ "'.");
  ScoreDoc[] sd=topDocs.scoreDocs;
  assertNotNull(sd);
  assertEquals("Score doc count",count,sd.length);
  Document doc=searcher.doc(sd[0].doc);
  assertEquals("First doc",2 * distance + startOffset,TrieUtils.prefixCodedToLong(doc.get("value")));
  doc=searcher.doc(sd[sd.length - 1].doc);
  assertEquals("Last doc",(1 + count) * distance + startOffset,TrieUtils.prefixCodedToLong(doc.get("value")));
}
