{
  try {
    final String baseUrl=getBaseUrl((HttpSolrServer)clients.get(0));
    HttpSolrServer server=new HttpSolrServer(baseUrl);
    server.setConnectionTimeout(15000);
    server.setSoTimeout(30000);
    Create createCmd=new Create();
    createCmd.setRoles("none");
    createCmd.setCoreName(ONE_NODE_COLLECTION + "core");
    createCmd.setCollection(ONE_NODE_COLLECTION);
    createCmd.setNumShards(1);
    createCmd.setDataDir(getDataDir(dataDir.getAbsolutePath() + File.separator + ONE_NODE_COLLECTION));
    server.request(createCmd);
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail(e.getMessage());
  }
  waitForCollection(cloudClient.getZkStateReader(),ONE_NODE_COLLECTION,1);
  waitForRecoveriesToFinish(ONE_NODE_COLLECTION,cloudClient.getZkStateReader(),false);
  cloudClient.getZkStateReader().getLeaderRetry(ONE_NODE_COLLECTION,"shard1",30000);
  final String baseUrl2=getBaseUrl((HttpSolrServer)clients.get(1));
  HttpSolrServer qclient=new HttpSolrServer(baseUrl2 + "/onenodecollection" + "core");
  SolrInputDocument doc=new SolrInputDocument();
  doc.addField("id","1");
  qclient.add(doc);
  qclient.commit();
  SolrQuery query=new SolrQuery("*:*");
  QueryResponse results=qclient.query(query);
  assertEquals(1,results.getResults().getNumFound());
  qclient=new HttpSolrServer(baseUrl2 + "/onenodecollection");
  results=qclient.query(query);
  assertEquals(1,results.getResults().getNumFound());
  doc=new SolrInputDocument();
  doc.addField("id","2");
  qclient.add(doc);
  qclient.commit();
  query=new SolrQuery("*:*");
  query.set("rows",0);
  results=qclient.query(query);
  assertEquals(2,results.getResults().getNumFound());
}
