{
  try {
    for (    DocumentsWriterPerThread dwpt : flushQueue) {
      doAfterFlush(dwpt);
    }
    for (    BlockedFlush blockedFlush : blockedFlushes) {
      flushingWriters.put(blockedFlush.dwpt,Long.valueOf(blockedFlush.bytes));
      doAfterFlush(blockedFlush.dwpt);
    }
  }
  finally {
    fullFlush=false;
    flushQueue.clear();
    blockedFlushes.clear();
    stallControl.updateStalled(this);
  }
}
