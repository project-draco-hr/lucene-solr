{
  if (numPending > 0) {
    final Iterator<ThreadState> allActiveThreads=perThreadPool.getActivePerThreadsIterator();
    while (allActiveThreads.hasNext() && numPending > 0) {
      ThreadState next=allActiveThreads.next();
      if (next.flushPending) {
        DocumentsWriterPerThread dwpt=tryCheckoutForFlush(next,false);
        if (dwpt != null) {
          return dwpt;
        }
      }
    }
  }
  return null;
}
