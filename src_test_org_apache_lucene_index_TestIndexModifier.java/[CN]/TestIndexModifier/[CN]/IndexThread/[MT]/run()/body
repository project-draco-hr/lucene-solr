{
  try {
    for (int i=0; i < ITERATIONS; i++) {
      int rand=random.nextInt(101);
      if (rand < 5) {
        index.optimize();
      }
 else       if (rand < 60) {
        Document doc=getDocument();
        index.addDocument(doc);
        idStack.push(doc.get("id"));
        added++;
      }
 else {
        if (idStack.size() == 0) {
        }
 else {
          String delId=(String)idStack.pop();
          index.delete(new Term("id",new Integer(delId).toString()));
          deleted++;
        }
      }
      if (maxWait > 0) {
        try {
          rand=random.nextInt(maxWait);
          Thread.sleep(rand);
        }
 catch (        InterruptedException e) {
          e.printStackTrace();
        }
      }
    }
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
}
