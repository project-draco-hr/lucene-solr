{
  SolrXMLSerializer serializer=new SolrXMLSerializer();
  SolrXMLDef solrXMLDef=getTestSolrXMLDef(defaultCoreNameKey,defaultCoreNameVal,peristentKey,persistentVal,sharedLibKey,sharedLibVal,adminPathKey,adminPathVal,shareSchemaKey,shareSchemaVal,instanceDirKey,instanceDirVal);
  StringWriter w=new StringWriter();
  try {
    serializer.persist(w,solrXMLDef);
  }
  finally {
    w.close();
  }
  assertResults(w.toString().getBytes(StandardCharsets.UTF_8));
  File tmpFile=new File(createTempDir(),"solr.xml");
  serializer.persistFile(tmpFile,solrXMLDef);
  assertResults(FileUtils.readFileToByteArray(tmpFile));
  tmpFile.delete();
}
