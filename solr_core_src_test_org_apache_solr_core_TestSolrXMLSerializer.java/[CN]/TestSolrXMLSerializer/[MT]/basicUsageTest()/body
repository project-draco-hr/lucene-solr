{
  SolrXMLSerializer serializer=new SolrXMLSerializer();
  SolrXMLDef solrXMLDef=getTestSolrXMLDef(defaultCoreNameKey,defaultCoreNameVal,peristentKey,persistentVal,sharedLibKey,sharedLibVal,adminPathKey,adminPathVal,shareSchemaKey,shareSchemaVal,instanceDirKey,instanceDirVal);
  Writer w=new StringWriter();
  try {
    serializer.persist(w,solrXMLDef);
  }
  finally {
    w.close();
  }
  assertResults(((StringWriter)w).getBuffer().toString().getBytes("UTF-8"));
  File tmpFile=_TestUtil.createTempFile("solr.xml",null,TEMP_DIR);
  serializer.persistFile(tmpFile,solrXMLDef);
  assertResults(FileUtils.readFileToString(tmpFile,"UTF-8").getBytes("UTF-8"));
  tmpFile.delete();
}
