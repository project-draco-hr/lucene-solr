{
  super(directoryFactory.get(path,config.lockType,forceNewDirectory),config.toIndexWriterConfig(schema).setOpenMode(create ? IndexWriterConfig.OpenMode.CREATE : IndexWriterConfig.OpenMode.APPEND).setIndexDeletionPolicy(delPolicy).setCodec(codec).setInfoStream(toInfoStream(config)));
  log.debug("Opened Writer " + name);
  this.name=name;
  this.directoryFactory=directoryFactory;
  numOpens.incrementAndGet();
}
