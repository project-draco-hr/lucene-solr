{
  try {
    super.rollback();
  }
  finally {
    isClosed=true;
    directoryFactory.release(getDirectory());
    numCloses.incrementAndGet();
  }
}
