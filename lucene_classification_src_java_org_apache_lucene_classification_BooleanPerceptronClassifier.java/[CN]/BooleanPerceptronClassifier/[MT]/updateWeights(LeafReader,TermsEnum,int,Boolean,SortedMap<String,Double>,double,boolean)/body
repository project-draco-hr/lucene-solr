{
  TermsEnum cte=textTerms.iterator(reuse);
  Terms terms=leafReader.getTermVector(docId,textFieldName);
  if (terms == null) {
    throw new IOException("term vectors must be stored for field " + textFieldName);
  }
  TermsEnum termsEnum=terms.iterator(null);
  BytesRef term;
  while ((term=termsEnum.next()) != null) {
    cte.seekExact(term);
    if (assignedClass != null) {
      long termFreqLocal=termsEnum.totalTermFreq();
      Long previousValue=Util.get(fst,term);
      String termString=term.utf8ToString();
      weights.put(termString,previousValue + modifier * termFreqLocal);
    }
  }
  if (updateFST) {
    updateFST(weights);
  }
  reuse=cte;
  return reuse;
}
