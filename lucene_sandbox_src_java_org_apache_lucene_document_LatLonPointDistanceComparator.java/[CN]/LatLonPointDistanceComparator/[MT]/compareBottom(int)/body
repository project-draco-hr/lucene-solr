{
  if (doc > currentDocs.docID()) {
    currentDocs.advance(doc);
  }
  if (doc < currentDocs.docID()) {
    return Double.compare(bottom,Double.POSITIVE_INFINITY);
  }
  setValues();
  int numValues=currentDocs.docValueCount();
  int cmp=-1;
  for (int i=0; i < numValues; i++) {
    long encoded=currentValues[i];
    int latitudeBits=(int)(encoded >> 32);
    if (latitudeBits < minLat || latitudeBits > maxLat) {
      continue;
    }
    int longitudeBits=(int)(encoded & 0xFFFFFFFF);
    if ((longitudeBits < minLon || longitudeBits > maxLon) && (longitudeBits < minLon2)) {
      continue;
    }
    double docLatitude=decodeLatitude(latitudeBits);
    double docLongitude=decodeLongitude(longitudeBits);
    cmp=Math.max(cmp,Double.compare(bottom,SloppyMath.haversinSortKey(latitude,longitude,docLatitude,docLongitude)));
    if (cmp > 0) {
      return cmp;
    }
  }
  return cmp;
}
