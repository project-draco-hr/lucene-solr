{
  this.documentsWriter.set(documentsWriter);
  this.globalFieldMap=globalFieldMap;
  for (int i=0; i < perThreads.length; i++) {
    final FieldInfos infos=new FieldInfos(globalFieldMap);
    perThreads[i]=new ThreadState(new DocumentsWriterPerThread(documentsWriter.directory,documentsWriter,infos,documentsWriter.chain));
  }
}
