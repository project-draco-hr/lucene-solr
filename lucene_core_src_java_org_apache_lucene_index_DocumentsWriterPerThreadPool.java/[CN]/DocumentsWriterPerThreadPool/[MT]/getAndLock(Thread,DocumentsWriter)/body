{
  ThreadState threadState=null;
synchronized (this) {
    while (true) {
      if (freeCount > 0) {
        threadState=freeList[freeCount - 1];
        if (threadState.dwpt == null) {
          for (int i=0; i < freeCount; i++) {
            if (freeList[i].dwpt != null) {
              ThreadState ts=freeList[i];
              freeList[i]=threadState;
              threadState=ts;
              break;
            }
          }
        }
        freeCount--;
        break;
      }
 else       if (numThreadStatesActive < threadStates.length) {
        return newThreadState();
      }
 else {
        try {
          wait();
        }
 catch (        InterruptedException ie) {
          throw new ThreadInterruptedException(ie);
        }
      }
    }
  }
  threadState.lock();
  return threadState;
}
