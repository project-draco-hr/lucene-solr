{
  Files.createDirectories(destDir);
  FSDirectory destFSDir=FSDirectory.open(destDir);
  SegmentInfos destInfos=new SegmentInfos();
  destInfos.counter=infos.counter;
  for (  String n : segs) {
    SegmentCommitInfo infoPerCommit=getInfo(n);
    SegmentInfo info=infoPerCommit.info;
    SegmentInfo newInfo=new SegmentInfo(destFSDir,info.getVersion(),info.name,info.maxDoc(),info.getUseCompoundFile(),info.getCodec(),info.getDiagnostics(),info.getId(),new HashMap<>(),null);
    destInfos.add(new SegmentCommitInfo(newInfo,infoPerCommit.getDelCount(),infoPerCommit.getDelGen(),infoPerCommit.getFieldInfosGen(),infoPerCommit.getDocValuesGen()));
    Collection<String> files=infoPerCommit.files();
    for (    final String srcName : files) {
      Path srcFile=dir.resolve(srcName);
      Path destFile=destDir.resolve(srcName);
      Files.copy(srcFile,destFile);
    }
  }
  destInfos.changed();
  destInfos.commit(destFSDir);
}
