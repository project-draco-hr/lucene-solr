{
  FilteredTermEnum enumerator=query.getEnum(reader);
  BooleanQuery result=new BooleanQuery(true);
  int count=0;
  try {
    do {
      Term t=enumerator.term();
      if (t != null) {
        TermQuery tq=new TermQuery(t);
        tq.setBoost(query.getBoost() * enumerator.difference());
        result.add(tq,BooleanClause.Occur.SHOULD);
        count++;
      }
    }
 while (enumerator.next());
  }
  finally {
    enumerator.close();
  }
  query.incTotalNumberOfTerms(count);
  return result;
}
