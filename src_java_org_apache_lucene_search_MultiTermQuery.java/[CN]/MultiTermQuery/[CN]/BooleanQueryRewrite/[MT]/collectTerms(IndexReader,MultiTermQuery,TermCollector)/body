{
  final FilteredTermEnum enumerator=query.getEnum(reader);
  int count=0;
  try {
    do {
      Term t=enumerator.term();
      if (t != null) {
        if (collector.collect(t,enumerator.difference())) {
          count++;
        }
 else {
          break;
        }
      }
    }
 while (enumerator.next());
  }
  finally {
    enumerator.close();
  }
  return count;
}
