{
  List<TermFreqPayload> freqs=new ArrayList<TermFreqPayload>();
  Random rnd=random();
  for (int i=0; i < 2500 + rnd.nextInt(2500); i++) {
    int weight=rnd.nextInt(100);
    freqs.add(new TermFreqPayload("" + rnd.nextLong(),weight));
  }
  FSTCompletionLookup lookup=new FSTCompletionLookup();
  lookup.build(new TermFreqPayloadArrayIterator(freqs.toArray(new TermFreqPayload[freqs.size()])));
  for (  TermFreqPayload tf : freqs) {
    final String term=tf.term.utf8ToString();
    for (int i=1; i < term.length(); i++) {
      String prefix=term.substring(0,i);
      for (      LookupResult lr : lookup.lookup(stringToCharSequence(prefix),true,10)) {
        assertTrue(lr.key.toString().startsWith(prefix));
      }
    }
  }
}
