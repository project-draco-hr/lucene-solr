{
  try (CloudSolrClient client=createCloudClient(null)){
    int replicationFactor=1;
    int maxShardsPerNode=5;
    Map<String,Object> props=Utils.makeMap("router.name",ImplicitDocRouter.NAME,ZkStateReader.REPLICATION_FACTOR,replicationFactor,ZkStateReader.MAX_SHARDS_PER_NODE,maxShardsPerNode,NUM_SLICES,1,SHARDS_PROP,"a,b");
    Map<String,List<Integer>> collectionInfos=new HashMap<>();
    String collectionName="customcollreplicadeletion";
    createCollection(collectionInfos,collectionName,props,client);
    waitForRecoveriesToFinish(collectionName,false);
    DocCollection testcoll=getCommonCloudSolrClient().getZkStateReader().getClusterState().getCollection(collectionName);
    Replica replica=testcoll.getSlice("a").getReplicas().iterator().next();
    removeAndWaitForReplicaGone(client,collectionName,replica,"a",replicationFactor - 1);
  }
 }
