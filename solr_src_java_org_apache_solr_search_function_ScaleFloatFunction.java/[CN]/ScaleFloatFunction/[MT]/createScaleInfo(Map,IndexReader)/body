{
  IndexReader.ReaderContext ctx=ValueSource.readerToContext(context,reader);
  while (ctx.parent != null)   ctx=ctx.parent;
  final AtomicReaderContext[] leaves=ReaderUtil.leaves(ctx);
  float minVal=Float.POSITIVE_INFINITY;
  float maxVal=Float.NEGATIVE_INFINITY;
  for (  AtomicReaderContext leaf : leaves) {
    int maxDoc=leaf.reader.maxDoc();
    DocValues vals=source.getValues(context,leaf.reader);
    for (int i=0; i < maxDoc; i++) {
      float val=vals.floatVal(i);
      if ((Float.floatToRawIntBits(val) & (0xff << 23)) == 0xff << 23) {
        continue;
      }
      if (val < minVal) {
        minVal=val;
      }
      if (val > maxVal) {
        maxVal=val;
      }
    }
  }
  if (minVal == Float.POSITIVE_INFINITY) {
    minVal=maxVal=0;
  }
  ScaleInfo scaleInfo=new ScaleInfo();
  scaleInfo.minVal=minVal;
  scaleInfo.maxVal=maxVal;
  context.put(this.source,scaleInfo);
  return scaleInfo;
}
