{
  if (query instanceof ExtendedQuery) {
    ExtendedQuery eq=(ExtendedQuery)query;
    if (!eq.getCache()) {
      if (query instanceof WrappedQuery) {
        query=((WrappedQuery)query).getWrappedQuery();
      }
      query=QueryUtils.makeQueryable(query);
      return getDocSetNC(query,null);
    }
  }
  Query absQ=QueryUtils.getAbs(query);
  boolean positive=query == absQ;
  if (filterCache != null) {
    DocSet absAnswer=filterCache.get(absQ);
    if (absAnswer != null) {
      if (positive)       return absAnswer;
 else       return getLiveDocs().andNot(absAnswer);
    }
  }
  DocSet absAnswer=getDocSetNC(absQ,null);
  DocSet answer=positive ? absAnswer : getLiveDocs().andNot(absAnswer);
  if (filterCache != null) {
    filterCache.put(absQ,absAnswer);
  }
  return answer;
}
