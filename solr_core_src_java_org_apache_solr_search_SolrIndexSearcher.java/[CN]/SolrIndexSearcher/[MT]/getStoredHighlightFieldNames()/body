{
synchronized (this) {
    if (storedHighlightFieldNames == null) {
      storedHighlightFieldNames=new LinkedList<>();
      for (      FieldInfo fieldInfo : fieldInfos) {
        final String fieldName=fieldInfo.name;
        try {
          SchemaField field=schema.getField(fieldName);
          if (field.stored() && ((field.getType() instanceof org.apache.solr.schema.TextField) || (field.getType() instanceof org.apache.solr.schema.StrField))) {
            storedHighlightFieldNames.add(fieldName);
          }
        }
 catch (        RuntimeException e) {
          log.warn("Field [{}] found in index, but not defined in schema.",fieldName);
        }
      }
    }
    return storedHighlightFieldNames;
  }
}
