{
  DocSetCollector collector=new DocSetCollector(maxDoc() >> 6,maxDoc());
  try {
    if (filter != null) {
      Filter luceneFilter=filter.getTopFilter();
      query=new BooleanQuery.Builder().add(query,Occur.MUST).add(luceneFilter,Occur.FILTER).build();
    }
    super.search(query,collector);
  }
 catch (  ExitableDirectoryReader.ExitingReaderException e) {
    log.warn("Query: " + query + "; "+ e.getMessage());
  }
  return collector.getDocSet();
}
