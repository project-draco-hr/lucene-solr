{
  DocSetCollector collector=new DocSetCollector(maxDoc() >> 6,maxDoc());
  if (filter == null) {
    super.search(query,null,collector);
  }
 else {
    Filter luceneFilter=filter.getTopFilter();
    super.search(query,luceneFilter,collector);
  }
  return collector.getDocSet();
}
