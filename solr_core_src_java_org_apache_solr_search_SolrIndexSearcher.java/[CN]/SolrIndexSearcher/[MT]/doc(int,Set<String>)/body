{
  Document d;
  if (documentCache != null) {
    d=documentCache.get(i);
    if (d != null)     return d;
  }
  if (!enableLazyFieldLoading || fields == null) {
    d=getIndexReader().document(i);
  }
 else {
    final FieldSelectorVisitor visitor=new FieldSelectorVisitor(new SetNonLazyFieldSelector(fields));
    getIndexReader().document(i,visitor);
    d=visitor.getDocument();
  }
  if (documentCache != null) {
    documentCache.put(i,d);
  }
  return d;
}
