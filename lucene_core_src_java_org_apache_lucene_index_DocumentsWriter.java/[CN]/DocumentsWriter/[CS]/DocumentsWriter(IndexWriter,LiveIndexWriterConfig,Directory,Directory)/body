{
  this.directoryOrig=directoryOrig;
  this.directory=directory;
  this.config=config;
  this.infoStream=config.getInfoStream();
  this.perThreadPool=config.getIndexerThreadPool();
  flushPolicy=config.getFlushPolicy();
  this.writer=writer;
  this.events=new ConcurrentLinkedQueue<>();
  flushControl=new DocumentsWriterFlushControl(this,config,writer.bufferedUpdatesStream);
}
