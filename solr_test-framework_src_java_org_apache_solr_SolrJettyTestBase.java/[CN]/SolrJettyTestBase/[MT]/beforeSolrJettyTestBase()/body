{
  final boolean trySsl=random().nextBoolean();
  final boolean trySslClientAuth=random().nextBoolean();
  if (null == getExampleKeystoreFile()) {
    log.info("Solr's example keystore not defined (not a solr test?) skipping SSL randomization");
    manageSslProps=false;
    return;
  }
  assertTrue("test keystore does not exist, randomized ssl testing broken: " + getExampleKeystoreFile().getAbsolutePath(),getExampleKeystoreFile().exists());
  final Map<Object,Object> sysprops=System.getProperties();
  for (  String prop : SSL_PROPS.keySet()) {
    if (sysprops.containsKey(prop)) {
      log.info("System property explicitly set, so skipping randomized ssl properties: " + prop);
      manageSslProps=false;
      return;
    }
  }
  if (manageSslProps) {
    log.info("Randomized ssl ({}) and clientAuth ({})",trySsl,trySslClientAuth);
    for (    String prop : SSL_PROPS.keySet()) {
      System.setProperty(prop,SSL_PROPS.get(prop));
    }
    System.setProperty("tests.jettySsl",String.valueOf(trySsl));
    System.setProperty("tests.jettySsl.clientAuth",String.valueOf(trySslClientAuth));
  }
}
