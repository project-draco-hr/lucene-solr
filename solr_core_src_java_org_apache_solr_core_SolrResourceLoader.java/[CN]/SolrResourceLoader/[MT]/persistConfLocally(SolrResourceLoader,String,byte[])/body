{
  File confFile=new File(loader.getConfigDir(),resourceName);
  OutputStreamWriter writer=null;
  try {
    File parentDir=confFile.getParentFile();
    if (!parentDir.isDirectory()) {
      if (!parentDir.mkdirs()) {
        final String msg="Can't create managed schema directory " + parentDir.getAbsolutePath();
        log.error(msg);
        throw new SolrException(SolrException.ErrorCode.SERVER_ERROR,msg);
      }
    }
    final FileOutputStream out=new FileOutputStream(confFile);
    out.write(content);
    log.info("Written confile " + resourceName);
  }
 catch (  IOException e) {
    final String msg="Error persisting conf file " + resourceName;
    log.error(msg,e);
    throw new SolrException(SolrException.ErrorCode.SERVER_ERROR,msg,e);
  }
 finally {
    org.apache.commons.io.IOUtils.closeQuietly(writer);
    try {
      FileUtils.sync(confFile);
    }
 catch (    IOException e) {
      final String msg="Error syncing conf file " + resourceName;
      log.error(msg,e);
    }
  }
}
