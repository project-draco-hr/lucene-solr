{
  if (instanceDir == null) {
    this.instanceDir=SolrResourceLoader.locateSolrHome().toAbsolutePath().normalize();
    log.info("new SolrResourceLoader for deduced Solr Home: '{}'",this.instanceDir);
  }
 else {
    this.instanceDir=instanceDir.toAbsolutePath().normalize();
    log.info("new SolrResourceLoader for directory: '{}'",this.instanceDir);
  }
  if (parent == null)   parent=Thread.currentThread().getContextClassLoader();
  this.classLoader=new URLClassLoader(new URL[0],parent);
  if (!this.instanceDir.equals(SolrResourceLoader.locateSolrHome())) {
    Path libDir=this.instanceDir.resolve("lib");
    if (Files.exists(libDir)) {
      try {
        addToClassLoader(getURLs(libDir));
      }
 catch (      IOException e) {
        log.warn("Couldn't add files from {} to classpath: {}",libDir,e.getMessage());
      }
      reloadLuceneSPI();
    }
  }
  this.coreProperties=coreProperties;
}
