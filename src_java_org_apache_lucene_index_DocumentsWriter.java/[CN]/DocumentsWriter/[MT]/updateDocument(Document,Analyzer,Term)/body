{
  final ThreadState state=getThreadState(doc,delTerm);
  boolean success=false;
  int maxTermHit;
  try {
    state.processDocument(analyzer);
    maxTermHit=state.maxTermHit;
    finishDocument(state);
    success=true;
  }
  finally {
    if (!success) {
      state.isIdle=true;
      abort();
    }
  }
  int status=maxTermHit << 1;
  if (state.doFlushAfter || timeToFlushDeletes())   status+=1;
  return status;
}
