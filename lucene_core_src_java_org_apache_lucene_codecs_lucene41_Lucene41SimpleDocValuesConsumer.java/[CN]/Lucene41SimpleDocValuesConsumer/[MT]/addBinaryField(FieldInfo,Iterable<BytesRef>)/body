{
  meta.writeVInt(field.number);
  meta.writeByte(BYTES);
  int minLength=Integer.MAX_VALUE;
  int maxLength=Integer.MIN_VALUE;
  final long startFP=data.getFilePointer();
  for (  BytesRef v : values) {
    minLength=Math.min(minLength,v.length);
    maxLength=Math.max(maxLength,v.length);
    data.writeBytes(v.bytes,v.offset,v.length);
  }
  meta.writeLong(startFP);
  meta.writeLong(data.getFilePointer() - startFP);
  meta.writeVInt(minLength);
  meta.writeVInt(maxLength);
  if (minLength != maxLength) {
    addNumericField(field,new Iterable<Number>(){
      @Override public Iterator<Number> iterator(){
        final Iterator<BytesRef> inner=values.iterator();
        return new Iterator<Number>(){
          long addr=0;
          @Override public boolean hasNext(){
            return inner.hasNext();
          }
          @Override public Number next(){
            BytesRef b=inner.next();
            addr+=b.length;
            return Long.valueOf(addr);
          }
          @Override public void remove(){
            throw new UnsupportedOperationException();
          }
        }
;
      }
    }
);
  }
}
