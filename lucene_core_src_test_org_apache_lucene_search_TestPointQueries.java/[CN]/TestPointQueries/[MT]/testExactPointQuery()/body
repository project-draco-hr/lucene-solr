{
  Directory dir=newDirectory();
  IndexWriterConfig iwc=newIndexWriterConfig();
  iwc.setCodec(getCodec());
  IndexWriter w=new IndexWriter(dir,iwc);
  Document doc=new Document();
  doc.add(new LongPoint("long",5L));
  w.addDocument(doc);
  doc=new Document();
  doc.add(new IntPoint("int",42));
  w.addDocument(doc);
  doc=new Document();
  doc.add(new FloatPoint("float",2.0f));
  w.addDocument(doc);
  doc=new Document();
  doc.add(new DoublePoint("double",1.0));
  w.addDocument(doc);
  IndexReader r=DirectoryReader.open(w);
  IndexSearcher s=newSearcher(r);
  assertEquals(1,s.count(ExactPointQuery.new1DIntExact("int",42)));
  assertEquals(0,s.count(ExactPointQuery.new1DIntExact("int",41)));
  assertEquals(1,s.count(ExactPointQuery.new1DLongExact("long",5L)));
  assertEquals(0,s.count(ExactPointQuery.new1DLongExact("long",-1L)));
  assertEquals(1,s.count(ExactPointQuery.new1DFloatExact("float",2.0f)));
  assertEquals(0,s.count(ExactPointQuery.new1DFloatExact("float",1.0f)));
  assertEquals(1,s.count(ExactPointQuery.new1DDoubleExact("double",1.0)));
  assertEquals(0,s.count(ExactPointQuery.new1DDoubleExact("double",2.0)));
  w.close();
  r.close();
  dir.close();
}
