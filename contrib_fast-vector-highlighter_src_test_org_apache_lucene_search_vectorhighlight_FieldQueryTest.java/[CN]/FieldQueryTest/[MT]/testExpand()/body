{
  Query dummy=pqF("DUMMY");
  FieldQuery fq=new FieldQuery(dummy,true,true);
  Set<Query> flatQueries=new HashSet<Query>();
  flatQueries.add(pqF("a","b"));
  flatQueries.add(pqF("b","c"));
  assertCollectionQueries(fq.expand(flatQueries),pqF("a","b"),pqF("b","c"),pqF("a","b","c"));
  flatQueries=new HashSet<Query>();
  flatQueries.add(pqF("a","b"));
  flatQueries.add(pqF("b","c","d"));
  assertCollectionQueries(fq.expand(flatQueries),pqF("a","b"),pqF("b","c","d"),pqF("a","b","c","d"));
  flatQueries=new HashSet<Query>();
  flatQueries.add(pqF("a","b","c"));
  flatQueries.add(pqF("b","c","d"));
  assertCollectionQueries(fq.expand(flatQueries),pqF("a","b","c"),pqF("b","c","d"),pqF("a","b","c","d"));
  flatQueries=new HashSet<Query>();
  flatQueries.add(pqF("a","b","c"));
  flatQueries.add(pqF("c","d","e"));
  assertCollectionQueries(fq.expand(flatQueries),pqF("a","b","c"),pqF("c","d","e"),pqF("a","b","c","d","e"));
  flatQueries=new HashSet<Query>();
  flatQueries.add(pqF("a","b","b"));
  flatQueries.add(pqF("b","c"));
  assertCollectionQueries(fq.expand(flatQueries),pqF("a","b","b"),pqF("b","c"),pqF("a","b","b","c"));
  flatQueries=new HashSet<Query>();
  flatQueries.add(pqF("a","b"));
  flatQueries.add(pqF("b","a"));
  assertCollectionQueries(fq.expand(flatQueries),pqF("a","b"),pqF("b","a"),pqF("a","b","a"),pqF("b","a","b"));
  flatQueries=new HashSet<Query>();
  flatQueries.add(pqF("a","b"));
  flatQueries.add(pqF("a","b","c"));
  assertCollectionQueries(fq.expand(flatQueries),pqF("a","b"),pqF("a","b","c"));
}
