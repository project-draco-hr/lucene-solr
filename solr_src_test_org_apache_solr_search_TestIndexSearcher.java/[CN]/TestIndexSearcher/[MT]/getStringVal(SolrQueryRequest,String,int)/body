{
  SchemaField sf=sqr.getSchema().getField(field);
  ValueSource vs=sf.getType().getValueSource(sf,null);
  Map context=ValueSource.newContext(sqr.getSearcher());
  vs.createWeight(context,sqr.getSearcher());
  ReaderContext topReaderContext=sqr.getSearcher().getTopReaderContext();
  AtomicReaderContext[] leaves=ReaderUtil.leaves(topReaderContext);
  int idx=ReaderUtil.subIndex(doc,leaves);
  AtomicReaderContext leaf=leaves[idx];
  DocValues vals=vs.getValues(context,leaf.reader);
  return vals.strVal(doc - leaf.docBase);
}
