{
  int id=docIterator.nextDoc();
  idx++;
  SolrDocument sdoc=null;
  if (onlyPseudoFields) {
    sdoc=new SolrDocument();
  }
 else {
    try {
      Document doc=rctx.getSearcher().doc(id,fnames);
      sdoc=getDoc(doc,rctx.getSearcher().getSchema());
      if (dvFieldsToReturn != null) {
        rctx.getSearcher().decorateDocValueFields(sdoc,id,dvFieldsToReturn);
      }
    }
 catch (    IOException e) {
      throw new SolrException(SolrException.ErrorCode.SERVER_ERROR,"Error reading document with docId " + id,e);
    }
  }
  if (transformer != null) {
    boolean doScore=rctx.wantsScores();
    try {
      transformer.transform(sdoc,id,doScore ? docIterator.score() : 0);
    }
 catch (    IOException e) {
      throw new SolrException(SolrException.ErrorCode.SERVER_ERROR,"Error applying transformer",e);
    }
  }
  return sdoc;
}
