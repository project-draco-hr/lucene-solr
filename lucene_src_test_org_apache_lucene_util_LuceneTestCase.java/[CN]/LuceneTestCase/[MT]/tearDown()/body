{
  assertTrue("ensure your setUp() calls super.setUp()!!!",setup);
  setup=false;
  Thread.setDefaultUncaughtExceptionHandler(savedUncaughtExceptionHandler);
  BooleanQuery.setMaxClauseCount(savedBoolMaxClauseCount);
  if (!getClass().getName().startsWith("org.apache.solr"))   threadCleanup("test method: '" + getName() + "'");
  try {
    if (!uncaughtExceptions.isEmpty()) {
      testsFailed=true;
      reportAdditionalFailureInfo();
      System.err.println("The following exceptions were thrown by threads:");
      for (      UncaughtExceptionEntry entry : uncaughtExceptions) {
        System.err.println("*** Thread: " + entry.thread.getName() + " ***");
        entry.exception.printStackTrace(System.err);
      }
      fail("Some threads threw uncaught exceptions!");
    }
    assertSaneFieldCaches(getTestLabel());
  }
  finally {
    purgeFieldCache(FieldCache.DEFAULT);
  }
}
