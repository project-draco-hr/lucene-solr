{
  LogMergePolicy logmp=r.nextBoolean() ? new LogDocMergePolicy() : new LogByteSizeMergePolicy();
  logmp.setUseCompoundFile(r.nextBoolean());
  logmp.setCalibrateSizeByDeletes(r.nextBoolean());
  if (r.nextInt(3) == 2) {
    logmp.setMergeFactor(2);
  }
 else {
    logmp.setMergeFactor(_TestUtil.nextInt(r,2,20));
  }
  return logmp;
}
