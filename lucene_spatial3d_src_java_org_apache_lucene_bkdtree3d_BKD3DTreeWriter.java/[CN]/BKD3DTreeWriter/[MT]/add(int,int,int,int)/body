{
  if (pointCount >= maxPointsSortInHeap) {
    if (offlineWriter == null) {
      switchToOffline();
    }
    scratchBytesOutput.reset(scratchBytes);
    scratchBytesOutput.writeInt(x);
    scratchBytesOutput.writeInt(y);
    scratchBytesOutput.writeInt(z);
    scratchBytesOutput.writeVInt(docID);
    scratchBytesOutput.writeVLong(pointCount);
    offlineWriter.write(scratchBytes,0,scratchBytes.length);
  }
 else {
    heapWriter.append(x,y,z,pointCount,docID);
  }
  pointCount++;
}
