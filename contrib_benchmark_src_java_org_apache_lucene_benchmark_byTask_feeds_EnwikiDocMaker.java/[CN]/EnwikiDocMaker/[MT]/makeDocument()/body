{
  DocState ds=reuseFields ? getDocState() : localDocState;
  DocData dd=source.getNextDocData(ds.docData);
  Document doc=reuseFields ? ds.doc : new Document();
  doc.getFields().clear();
  Field body=ds.getField(BODY_FIELD,storeVal,Index.ANALYZED,termVecVal);
  body.setValue(dd.getBody());
  doc.add(body);
  Field title=ds.getField(TITLE_FIELD,storeVal,Index.ANALYZED,termVecVal);
  title.setValue(dd.getTitle());
  doc.add(title);
  Field date=ds.getField(DATE_FIELD,storeVal,Index.ANALYZED,termVecVal);
  date.setValue(dd.getDate());
  doc.add(date);
  Field id=ds.getField(ID_FIELD,Store.YES,Index.NOT_ANALYZED_NO_NORMS,TermVector.NO);
  id.setValue(dd.getName());
  doc.add(id);
  return doc;
}
