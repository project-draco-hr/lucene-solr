{
  for (int i=0; i < 1000; i++) {
    double lat=GeoTestUtil.nextLatitude();
    double lon=GeoTestUtil.nextLongitude();
    double radius=50000000 * random().nextDouble();
    GeoRect box=GeoRect.fromPointDistance(lat,lon,radius);
    if (box.maxLon - lon < 90 && lon - box.minLon < 90) {
      double minPartialDistance=Math.max(SloppyMath.haversinSortKey(lat,lon,lat,box.maxLon),SloppyMath.haversinSortKey(lat,lon,box.maxLat,lon));
      for (int j=0; j < 10000; j++) {
        double lat2=GeoTestUtil.nextLatitude();
        double lon2=GeoTestUtil.nextLongitude();
        if (SloppyMath.haversinMeters(lat,lon,lat2,lon2) <= radius) {
          assertTrue(SloppyMath.haversinSortKey(lat,lon,lat2,lon2) <= minPartialDistance);
        }
      }
    }
  }
}
