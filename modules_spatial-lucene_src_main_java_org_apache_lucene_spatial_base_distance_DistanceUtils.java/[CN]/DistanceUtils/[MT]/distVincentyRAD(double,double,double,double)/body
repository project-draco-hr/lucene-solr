{
  if (lat1 == lat2 && lon1 == lon2)   return 0.0;
  double cosLat1=Math.cos(lat1);
  double cosLat2=Math.cos(lat2);
  double sinLat1=Math.sin(lat1);
  double sinLat2=Math.sin(lat2);
  double dLon=lon2 - lon1;
  double cosDLon=Math.cos(dLon);
  double sinDLon=Math.sin(dLon);
  double a=cosLat2 * sinDLon;
  double b=cosLat1 * sinLat2 - sinLat1 * cosLat2 * cosDLon;
  double c=sinLat1 * sinLat2 + cosLat1 * cosLat2 * cosDLon;
  return Math.atan2(Math.sqrt(a * a + b * b),c);
}
