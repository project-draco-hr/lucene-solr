{
  final SpatialOperation op=args.getOperation();
  if (!SpatialOperation.is(op,SpatialOperation.IsWithin,SpatialOperation.Intersects,SpatialOperation.BBoxWithin,SpatialOperation.BBoxIntersects))   throw new UnsupportedSpatialOperation(op);
  Shape shape=args.getShape();
  int detailLevel=grid.getMaxLevelForPrecision(shape,args.getDistPrecision());
  return new RecursivePrefixTreeFilter(getFieldName(),grid,shape,prefixGridScanLevel,detailLevel);
}
