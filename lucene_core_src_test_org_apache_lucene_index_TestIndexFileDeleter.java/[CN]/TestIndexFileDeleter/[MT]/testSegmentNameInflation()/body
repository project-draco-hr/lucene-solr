{
  MockDirectoryWrapper dir=newMockDirectory();
  new IndexWriter(dir,new IndexWriterConfig(null)).close();
  SegmentInfos sis=new SegmentInfos();
  sis.read(dir);
  assertEquals(0,sis.counter);
  IndexFileDeleter.inflateGens(sis,Arrays.asList(dir.listAll()),InfoStream.getDefault());
  assertEquals(0,sis.counter);
  dir.createOutput(IndexFileNames.segmentFileName("_0","","foo"),IOContext.DEFAULT).close();
  IndexFileDeleter.inflateGens(sis,Arrays.asList(dir.listAll()),InfoStream.getDefault());
  assertEquals(1,sis.counter);
  dir.createOutput(IndexFileNames.segmentFileName("_3","","foo"),IOContext.DEFAULT).close();
  IndexFileDeleter.inflateGens(sis,Arrays.asList(dir.listAll()),InfoStream.getDefault());
  assertEquals(4,sis.counter);
  IndexWriter iw=new IndexWriter(dir,new IndexWriterConfig(null));
  iw.addDocument(new Document());
  iw.commit();
  iw.close();
  sis=new SegmentInfos();
  sis.read(dir);
  assertEquals("_4",sis.info(0).info.name);
  assertEquals(5,sis.counter);
  dir.close();
}
