{
  IndexWriterConfig iwc=newIndexWriterConfig(random(),analyzer);
  iwc.setMergePolicy(newLogMergePolicy());
  Codec filterCodec=new Lucene50Codec(){
    PostingsFormat postingsFormat=new Completion50PostingsFormat();
    @Override public PostingsFormat getPostingsFormatForField(    String field){
      if (suggestFields.contains(field)) {
        return postingsFormat;
      }
      return super.getPostingsFormatForField(field);
    }
  }
;
  iwc.setCodec(filterCodec);
  return iwc;
}
