{
  boolean succeeded=false;
  lock(iwLock.readLock());
  try {
synchronized (this) {
      if (core == null) {
        initRefCntWriter();
        if (refCntWriter == null)         return null;
      }
 else {
        if (indexWriter == null) {
          indexWriter=createMainIndexWriter(core,"DirectUpdateHandler2");
        }
        initRefCntWriter();
      }
      refCntWriter.incref();
      succeeded=true;
      return refCntWriter;
    }
  }
  finally {
    if (!succeeded) {
      iwLock.readLock().unlock();
    }
  }
}
