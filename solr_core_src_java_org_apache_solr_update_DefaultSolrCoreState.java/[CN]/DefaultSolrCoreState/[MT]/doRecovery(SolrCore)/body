{
  cancelRecovery();
synchronized (recoveryLock) {
    while (recoveryRunning) {
      try {
        recoveryLock.wait(1000);
      }
 catch (      InterruptedException e) {
      }
      if (closed)       return;
    }
    boolean recoveringAfterStartup=recoveryStrat == null;
    recoveryStrat=new RecoveryStrategy(core);
    recoveryStrat.setRecoveringAfterStartup(recoveringAfterStartup);
    recoveryStrat.start();
    recoveryRunning=true;
  }
}
