{
  if (matcher == null)   return null;
  while (true) {
    int start=pos;
    int end;
    boolean isMatch=matcher.find();
    if (isMatch) {
      end=matcher.start();
      pos=matcher.end();
    }
 else {
      end=str.length();
      matcher=null;
    }
    if (start != end) {
      String text=str.substring(start,end);
      if (toLowerCase)       text=text.toLowerCase(locale);
      return new Token(text,start,end);
    }
    if (!isMatch)     return null;
  }
}
