{
  final int maxDoc=128;
  final FixedBitSet liveDocs=new FixedBitSet(maxDoc);
  MergeState.DocMap docMap1=MergeState.DocMap.buildDelCountDocmap(maxDoc,maxDoc,liveDocs,PackedInts.COMPACT);
  MergeState.DocMap docMap2=MergeState.DocMap.buildDirectDocMap(maxDoc,0,liveDocs,PackedInts.COMPACT);
  assertTrue(equals(docMap1,docMap2));
  liveDocs.set(1);
  for (int i=7; i < 79; ++i) {
    liveDocs.set(i);
  }
  liveDocs.set(80);
  liveDocs.set(88);
  int numDocs=liveDocs.cardinality();
  docMap1=MergeState.DocMap.buildDelCountDocmap(maxDoc,maxDoc - numDocs,liveDocs,PackedInts.COMPACT);
  docMap2=MergeState.DocMap.buildDirectDocMap(maxDoc,numDocs,liveDocs,PackedInts.COMPACT);
  assertTrue(equals(docMap1,docMap2));
  liveDocs.set(0,maxDoc);
  docMap1=MergeState.DocMap.buildDelCountDocmap(maxDoc,0,liveDocs,PackedInts.COMPACT);
  docMap2=MergeState.DocMap.buildDirectDocMap(maxDoc,maxDoc,liveDocs,PackedInts.COMPACT);
  assertTrue(equals(docMap1,docMap2));
}
