{
  setMeUp();
  addCoreWithProps("core1",makeCorePropFile("core1",false,true,"dataDir=core1"));
  addCoreWithProps("core2",makeCorePropFile("core2",false,false,"dataDir=core2"));
  addCoreWithProps("lazy1",makeCorePropFile("lazy1",true,false,"dataDir=lazy1"));
  CoreContainer cc=init();
  try {
    assertEquals(CoreContainer.DEFAULT_DEFAULT_CORE_NAME,cc.getDefaultCoreName());
    TestLazyCores.checkInCores(cc,"core1");
    TestLazyCores.checkNotInCores(cc,"lazy1","core2","collection1");
    SolrCore core1=cc.getCore("core1");
    CoreDescriptor desc=core1.getCoreDescriptor();
    assertEquals("core1",desc.getProperty("solr.core.name"));
    assertFalse("InstanceDir should be ignored",desc.getProperty("solr.core.instanceDir").contains("totallybogus"));
    assertNotNull(desc.getProperty("solr.core.instanceDir"));
    assertEquals("core1",desc.getProperty("solr.core.dataDir"));
    assertEquals("solrconfig-minimal.xml",desc.getProperty("solr.core.configName"));
    assertEquals("schema-tiny.xml",desc.getProperty("solr.core.schemaName"));
    SolrCore core2=cc.getCore("core2");
    SolrCore lazy1=cc.getCore("lazy1");
    TestLazyCores.checkInCores(cc,"core1","core2","lazy1");
    core1.close();
    core2.close();
    lazy1.close();
  }
  finally {
    cc.shutdown();
  }
}
