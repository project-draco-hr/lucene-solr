{
  setMeUp();
  addCoreWithProps(makeCorePropFile("core1",true,false,"dataDir=" + solrHomeDirectory + "datadir"));
  addCoreWithProps(makeCorePropFile("core2",true,false,"dataDir=" + solrHomeDirectory + "datadir"));
  CoreContainer cc=null;
  try {
    cc=init();
    String msg=cc.getBadCoreMessage("core1");
    assertFalse("Should have found multiple cores with same name",msg.contains("More than one core defined for core named 'core1'"));
    assertTrue("Should have found multiple cores with same data dir",msg.contains("More than one core points to data dir"));
    try {
      cc.getCore("core1");
    }
 catch (    SolrException se) {
      assertEquals("Should be returning proper error code of 500",500,se.code());
      msg=se.getMessage();
      assertFalse("Should have found multiple cores with same name",msg.contains("More than one core defined for core named 'core1'"));
      assertTrue("Should have found multiple cores with same data dir",msg.contains("More than one core points to data dir"));
    }
  }
  finally {
    if (cc != null) {
      cc.shutdown();
    }
  }
}
