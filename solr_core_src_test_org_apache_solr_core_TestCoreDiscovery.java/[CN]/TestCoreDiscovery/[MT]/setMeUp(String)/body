{
  if (solrHomeDirectory.exists()) {
    FileUtils.deleteDirectory(solrHomeDirectory);
  }
  assertTrue("Failed to mkdirs workDir",solrHomeDirectory.mkdirs());
  System.setProperty("solr.solr.home",solrHomeDirectory.getAbsolutePath());
  String xmlStr=SOLR_XML;
  if (alternateCoreDir != null) {
    xmlStr=xmlStr.replace("<solr>","<solr> <str name=\"coreRootDirectory\">" + alternateCoreDir + "</str> ");
  }
  File tmpFile=new File(solrHomeDirectory,ConfigSolr.SOLR_XML_FILE);
  FileUtils.write(tmpFile,xmlStr,IOUtils.CHARSET_UTF_8.toString());
}
