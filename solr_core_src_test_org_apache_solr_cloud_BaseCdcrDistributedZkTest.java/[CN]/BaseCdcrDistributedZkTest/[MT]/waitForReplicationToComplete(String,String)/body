{
  int cnt=15;
  while (cnt > 0) {
    log.info("Checking queue size @ {}:{}",collectionName,shardId);
    long size=this.getQueueSize(collectionName,shardId);
    if (size == 0) {
      return;
    }
    log.info("Waiting for replication to complete. Queue size: {} @ {}:{}",size,collectionName,shardId);
    cnt--;
    Thread.sleep(1000);
  }
  throw new RuntimeException("Timeout waiting for CDCR replication to complete @" + collectionName + ":"+ shardId);
}
