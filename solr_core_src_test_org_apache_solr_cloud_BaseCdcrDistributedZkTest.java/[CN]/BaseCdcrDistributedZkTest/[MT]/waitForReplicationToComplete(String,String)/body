{
  while (true) {
    log.info("Checking queue size @ {}:{}",collectionName,shardId);
    long size=this.getQueueSize(collectionName,shardId);
    if (size <= 0) {
      return;
    }
    log.info("Waiting for replication to complete. Queue size: {} @ {}:{}",size,collectionName,shardId);
    Thread.sleep(1000);
  }
}
