{
  CollectionInfo info=collectInfo(collection);
  Map<String,List<CollectionInfo.CoreInfo>> shardToCoresMap=info.getShardToCoresMap();
  int leaderLogs=0;
  ArrayList<Integer> replicasLogs=new ArrayList<>(Collections.nCopies(replicationFactor - 1,0));
  for (  String shard : shardToCoresMap.keySet()) {
    leaderLogs+=numberOfFiles(info.getLeader(shard).ulogDir);
    for (int i=0; i < replicationFactor - 1; i++) {
      replicasLogs.set(i,replicasLogs.get(i) + numberOfFiles(info.getReplicas(shard).get(i).ulogDir));
    }
  }
  for (  Integer replicaLogs : replicasLogs) {
    log.info("Number of logs in update log on leader {} and on replica {}",leaderLogs,replicaLogs);
    assertTrue(String.format(Locale.ENGLISH,"Number of tlogs on replica: %d is different than on leader: %d.",replicaLogs,leaderLogs),leaderLogs <= replicaLogs);
    assertTrue(String.format(Locale.ENGLISH,"Number of tlogs on leader: %d is superior to: %d.",leaderLogs,maxNumberOfTLogs),maxNumberOfTLogs >= leaderLogs);
    assertTrue(String.format(Locale.ENGLISH,"Number of tlogs on replica: %d is superior to: %d.",replicaLogs,maxNumberOfTLogs),maxNumberOfTLogs >= replicaLogs);
  }
}
