{
  CloudSolrClient client=createCloudClient(collection);
  try {
    int cnt=30;
    AssertionError lastAssertionError=null;
    while (cnt > 0) {
      try {
        assertEquals(expectedNumDocs,client.query(new SolrQuery("*:*")).getResults().getNumFound());
        return;
      }
 catch (      AssertionError e) {
        lastAssertionError=e;
        cnt--;
        Thread.sleep(500);
      }
    }
    throw new AssertionError("Timeout while trying to assert number of documents on collection: " + collection,lastAssertionError);
  }
  finally {
    client.close();
  }
}
