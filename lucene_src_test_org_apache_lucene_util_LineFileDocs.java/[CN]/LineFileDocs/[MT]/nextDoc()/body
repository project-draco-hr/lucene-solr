{
  String line;
synchronized (this) {
    line=reader.readLine();
    if (line == null) {
      if (forever) {
        if (LuceneTestCase.VERBOSE) {
          System.out.println("TEST: LineFileDocs: now rewind file...");
        }
        close();
        open();
        line=reader.readLine();
      }
      return null;
    }
  }
  DocState docState=threadDocs.get();
  if (docState == null) {
    docState=new DocState();
    threadDocs.set(docState);
  }
  int spot=line.indexOf(SEP);
  if (spot == -1) {
    throw new RuntimeException("line: [" + line + "] is in an invalid format !");
  }
  int spot2=line.indexOf(SEP,1 + spot);
  if (spot2 == -1) {
    throw new RuntimeException("line: [" + line + "] is in an invalid format !");
  }
  docState.body.setValue(line.substring(1 + spot2,line.length()));
  final String title=line.substring(0,spot);
  docState.title.setValue(title);
  docState.titleTokenized.setValue(title);
  docState.date.setValue(line.substring(1 + spot,spot2));
  docState.id.setValue(Integer.toString(id.getAndIncrement()));
  return docState.doc;
}
