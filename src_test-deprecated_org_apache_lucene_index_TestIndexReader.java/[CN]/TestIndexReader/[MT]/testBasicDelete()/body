{
  Directory dir=new RAMDirectory();
  IndexWriter writer=null;
  IndexReader reader=null;
  Term searchTerm=new Term("content","aaa");
  writer=new IndexWriter(dir,new WhitespaceAnalyzer(),true);
  for (int i=0; i < 100; i++) {
    addDoc(writer,searchTerm.text());
  }
  writer.close();
  reader=IndexReader.open(dir);
  assertEquals("first docFreq",100,reader.docFreq(searchTerm));
  assertTermDocsCount("first reader",reader,searchTerm,100);
  int deleted=0;
  reader=IndexReader.open(dir);
  deleted=reader.delete(searchTerm);
  assertEquals("deleted count",100,deleted);
  assertEquals("deleted docFreq",100,reader.docFreq(searchTerm));
  assertTermDocsCount("deleted termDocs",reader,searchTerm,0);
  reader.close();
  reader=IndexReader.open(dir);
  assertEquals("deleted docFreq",100,reader.docFreq(searchTerm));
  assertTermDocsCount("deleted termDocs",reader,searchTerm,0);
  reader.close();
}
