{
  indexStream.seek(n * 8L);
  long position=indexStream.readLong();
  fieldsStream.seek(position);
  Document doc=new Document();
  int numFields=fieldsStream.readVInt();
  for (int i=0; i < numFields; i++) {
    int fieldNumber=fieldsStream.readVInt();
    FieldInfo fi=fieldInfos.fieldInfo(fieldNumber);
    byte bits=fieldsStream.readByte();
    Field.Index index;
    boolean tokenize=(bits & 1) != 0;
    if (fi.isIndexed && tokenize)     index=Field.Index.TOKENIZED;
 else     if (fi.isIndexed && !tokenize)     index=Field.Index.UN_TOKENIZED;
 else     index=Field.Index.NO;
    doc.add(new Field(fi.name,fieldsStream.readString(),Field.Store.YES,index,fi.storeTermVector ? Field.TermVector.YES : Field.TermVector.NO));
  }
  return doc;
}
