{
  if (isDone)   throw new IllegalStateException("Can't call done() more than once");
  if (points.size() < 3)   throw new IllegalArgumentException("Polygon needs at least three points.");
  if (isInternalReturnEdge)   isInternalEdges.set(points.size() - 1);
  isDone=true;
  edges=new SidedPlane[points.size()];
  notableEdgePoints=new GeoPoint[points.size()][];
  for (int i=0; i < points.size(); i++) {
    final GeoPoint start=points.get(i);
    final GeoPoint end=points.get(legalIndex(i + 1));
    final double distance=start.arcDistance(end);
    if (distance > fullDistance)     fullDistance=distance;
    final GeoPoint check=points.get(legalIndex(i + 2));
    final SidedPlane sp=new SidedPlane(check,start,end);
    edges[i]=sp;
    notableEdgePoints[i]=new GeoPoint[]{start,end};
  }
  createCenterPoint();
}
