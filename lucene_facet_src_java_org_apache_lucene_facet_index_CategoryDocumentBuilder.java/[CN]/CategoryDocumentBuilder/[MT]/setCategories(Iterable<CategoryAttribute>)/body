{
  fieldList.clear();
  if (categories == null) {
    return this;
  }
  fillCategoriesMap(categories);
  for (  Entry<String,List<CategoryAttribute>> e : categoriesMap.entrySet()) {
    CategoryAttributesStream categoryAttributesStream=new CategoryAttributesStream(e.getValue());
    CategoryParentsStream parentsStream=(CategoryParentsStream)getParentsStream(categoryAttributesStream);
    CategoryListTokenizer categoryListTokenizer=getCategoryListTokenizer(parentsStream);
    CategoryTokenizer stream=getCategoryTokenizer(categoryListTokenizer);
    FieldType ft=new FieldType(TextField.TYPE_UNSTORED);
    ft.setOmitNorms(true);
    fieldList.add(new Field(e.getKey(),stream,ft));
  }
  return this;
}
