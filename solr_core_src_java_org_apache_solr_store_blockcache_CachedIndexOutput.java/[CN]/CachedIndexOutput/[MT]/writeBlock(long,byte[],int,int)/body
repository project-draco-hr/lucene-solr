{
  long blockId=BlockDirectory.getBlock(position);
  int blockOffset=(int)BlockDirectory.getPosition(position);
  int lengthToWriteInBlock=Math.min(length,blockSize - blockOffset);
  dest.writeBytes(b,offset,lengthToWriteInBlock);
  cache.update(location,blockId,blockOffset,b,offset,lengthToWriteInBlock);
  return lengthToWriteInBlock;
}
