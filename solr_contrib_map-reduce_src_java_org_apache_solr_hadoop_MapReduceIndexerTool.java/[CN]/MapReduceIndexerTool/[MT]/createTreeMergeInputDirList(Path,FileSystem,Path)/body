{
  FileStatus[] dirs=listSortedOutputShardDirs(outputReduceDir,fs);
  int numFiles=0;
  FSDataOutputStream out=fs.create(fullInputList);
  try {
    Writer writer=new BufferedWriter(new OutputStreamWriter(out,StandardCharsets.UTF_8));
    for (    FileStatus stat : dirs) {
      LOG.debug("Adding path {}",stat.getPath());
      Path dir=new Path(stat.getPath(),"data/index");
      if (!fs.isDirectory(dir)) {
        throw new IllegalStateException("Not a directory: " + dir);
      }
      writer.write(dir.toString() + "\n");
      numFiles++;
    }
    writer.close();
  }
  finally {
    out.close();
  }
  return numFiles;
}
