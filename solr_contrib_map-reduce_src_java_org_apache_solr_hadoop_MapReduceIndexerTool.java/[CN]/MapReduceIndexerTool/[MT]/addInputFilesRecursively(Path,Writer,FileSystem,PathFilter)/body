{
  long numFiles=0;
  for (  FileStatus stat : fs.listStatus(path,pathFilter)) {
    LOG.debug("Adding path {}",stat.getPath());
    if (stat.isDirectory()) {
      numFiles+=addInputFilesRecursively(stat.getPath(),writer,fs,pathFilter);
    }
 else {
      writer.write(stat.getPath().toString() + "\n");
      numFiles++;
    }
  }
  return numFiles;
}
