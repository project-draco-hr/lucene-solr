{
  final GenericTermsCollector termsCollector;
  if (multipleValuesPerDocument) {
    Function<SortedSetDocValues> mvFunction=DocValuesTermsCollector.sortedNumericAsSortedSetDocValues(fromField,numericType);
    termsCollector=GenericTermsCollector.createCollectorMV(mvFunction,scoreMode);
  }
 else {
    Function<BinaryDocValues> svFunction=DocValuesTermsCollector.numericAsBinaryDocValues(fromField,numericType);
    termsCollector=GenericTermsCollector.createCollectorSV(svFunction,scoreMode);
  }
  return createJoinQuery(multipleValuesPerDocument,toField,fromQuery,fromSearcher,scoreMode,termsCollector);
}
