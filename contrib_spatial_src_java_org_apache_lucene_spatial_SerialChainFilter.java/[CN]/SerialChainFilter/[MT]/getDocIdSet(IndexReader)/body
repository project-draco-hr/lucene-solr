{
  BitSet bits=new BitSet(reader.maxDoc());
  int chainSize=chain.length;
  int actionSize=actionType.length;
  int i=0;
  if (actionType[i] == AND) {
    try {
      bits=(BitSet)((DocIdBitSet)chain[i].getDocIdSet(reader)).getBitSet().clone();
    }
 catch (    IOException e) {
      e.printStackTrace();
    }
    ++i;
  }
  for (; i < chainSize; i++) {
    int action=(i < actionSize) ? actionType[i] : DEFAULT;
switch (action) {
case (SERIALAND):
      try {
        bits.and(((ISerialChainFilter)chain[i]).bits(reader,bits));
      }
 catch (      CorruptIndexException e) {
        e.printStackTrace();
      }
catch (      IOException e) {
        e.printStackTrace();
      }
catch (      Exception e) {
        e.printStackTrace();
      }
    break;
case (SERIALOR):
  try {
    bits.or(((ISerialChainFilter)chain[i]).bits(reader,bits));
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
break;
case (AND):
bits.and(((DocIdBitSet)chain[i].getDocIdSet(reader)).getBitSet());
break;
case (OR):
bits.or(((DocIdBitSet)chain[i].getDocIdSet(reader)).getBitSet());
break;
}
}
return new DocIdBitSet(bits);
}
