{
  Collection<IndexSchemaField> fields=this.schema.getFields();
  GDataIndexDocument document=new GDataIndexDocument(this.action,this.entry.getId(),this.entry.getFeedId(),this.commitAfter,this.optimizeAfter);
  if (this.action != IndexAction.DELETE) {
    int addedFields=0;
    for (    IndexSchemaField field : fields) {
      ContentStrategy strategy=ContentStrategy.getFieldStrategy(field);
      if (LOG.isInfoEnabled())       LOG.info("Process indexable for " + field);
      try {
        strategy.processIndexable(Indexable.getIndexable(this.entry));
        addedFields++;
      }
 catch (      NotIndexableException e) {
        LOG.warn("Can not create field for " + field + " field will be skipped -- reason: ",e);
        continue;
      }
      document.addField(strategy);
    }
    if (addedFields == 0)     throw new GdataIndexerException("No field added to document for Schema: " + this.schema);
  }
  return (T)document;
}
