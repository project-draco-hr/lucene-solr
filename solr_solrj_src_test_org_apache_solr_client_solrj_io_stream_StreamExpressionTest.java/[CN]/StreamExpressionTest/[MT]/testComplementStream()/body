{
  indexr(id,"0","a_s","setA","a_i","0");
  indexr(id,"2","a_s","setA","a_i","1");
  indexr(id,"3","a_s","setA","a_i","2");
  indexr(id,"4","a_s","setA","a_i","3");
  indexr(id,"5","a_s","setB","a_i","2");
  indexr(id,"6","a_s","setB","a_i","3");
  indexr(id,"9","a_s","setB","a_i","5");
  indexr(id,"7","a_s","setAB","a_i","0");
  indexr(id,"8","a_s","setAB","a_i","6");
  commit();
  StreamExpression expression;
  TupleStream stream;
  List<Tuple> tuples;
  StreamFactory factory=new StreamFactory().withCollectionZkHost("collection1",zkServer.getZkAddress()).withFunctionName("search",CloudSolrStream.class).withFunctionName("complement",ComplementStream.class);
  expression=StreamExpressionParser.parse("complement(" + "search(collection1, q=a_s:(setA || setAB), fl=\"id,a_s,a_i\", sort=\"a_i asc, a_s asc\")," + "search(collection1, q=a_s:(setB || setAB), fl=\"id,a_s,a_i\", sort=\"a_i asc\"),"+ "on=\"a_i\")");
  stream=new ComplementStream(expression,factory);
  tuples=getTuples(stream);
  assert(tuples.size() == 1);
  assertOrder(tuples,2);
  del("*:*");
  commit();
}
