{
  BooleanQuery q1=new BooleanQuery();
  q1.add(new TermQuery(new Term(TEXT_FIELD,"first")),BooleanClause.Occur.SHOULD);
  q1.add(new TermQuery(new Term(TEXT_FIELD,"aid")),BooleanClause.Occur.SHOULD);
  q1.add(new TermQuery(new Term(TEXT_FIELD,"text")),BooleanClause.Occur.SHOULD);
  final Query q=new CustomExternalQuery(q1);
  log(q);
  IndexReader r=IndexReader.open(dir);
  IndexSearcher s=new IndexSearcher(r);
  TopDocs hits=s.search(q,1000);
  assertEquals(N_DOCS,hits.totalHits);
  for (int i=0; i < N_DOCS; i++) {
    final int doc=hits.scoreDocs[i].doc;
    final float score=hits.scoreDocs[i].score;
    assertEquals("doc=" + doc,(float)1 + (4 * doc) % N_DOCS,score,0.0001);
  }
  s.close();
  r.close();
}
