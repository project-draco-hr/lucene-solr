{
  RandomIndexWriter writer=new RandomIndexWriter(random,indexDir,newIndexWriterConfig(TEST_VERSION_CURRENT,new MockAnalyzer(random,MockTokenizer.KEYWORD,false)));
  TaxonomyWriter taxoWriter=new LuceneTaxonomyWriter(taxoDir);
  for (  CategoryPath[] categories : perDocCategories) {
    writer.addDocument(new CategoryDocumentBuilder(taxoWriter,iParams).setCategoryPaths(Arrays.asList(categories)).build(new Document()));
  }
  taxoWriter.commit();
  writer.commit();
  taxoWriter.close();
  writer.close();
}
