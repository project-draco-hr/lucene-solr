{
  Path dir=FilterPath.unwrap(createTempDir());
  FileSystem fs=new FilterFileSystemProvider("test://",dir.getFileSystem()).getFileSystem(URI.create("file:///"));
  Path wrapped=new FilterPath(dir,fs);
  OutputStream file=Files.newOutputStream(wrapped.resolve("foo"));
  file.write(5);
  file.close();
  file=Files.newOutputStream(wrapped.resolve("bar"));
  file.write(5);
  file.close();
  try (DirectoryStream<Path> stream=Files.newDirectoryStream(wrapped,"f*")){
    int count=0;
    for (    Path path : stream) {
      assertTrue(path instanceof FilterPath);
      ++count;
    }
    assertEquals(1,count);
  }
   dir=FilterPath.unwrap(createTempDir());
  fs=new LeakFS(dir.getFileSystem()).getFileSystem(URI.create("file:///"));
  wrapped=new FilterPath(dir,fs);
  file=Files.newOutputStream(wrapped.resolve("foo"));
  file.write(5);
  file.close();
  file=Files.newOutputStream(wrapped.resolve("bar"));
  file.write(5);
  file.close();
  try (DirectoryStream<Path> stream=Files.newDirectoryStream(wrapped,"f*")){
    int count=0;
    for (    Path path : stream) {
      assertTrue(path instanceof FilterPath);
      ++count;
    }
    assertEquals(1,count);
  }
 }
