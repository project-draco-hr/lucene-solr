{
  MockDirectoryWrapper dir=newMockDirectory();
  dir.setMaxSizeInBytes(3);
  final byte[] bytes=new byte[]{1,2};
  IndexOutput out=dir.createOutput("foo",IOContext.DEFAULT);
  out.writeBytes(bytes,bytes.length);
  out.close();
  out=dir.createOutput("bar",IOContext.DEFAULT);
  try {
    out.writeBytes(bytes,bytes.length);
    fail("should have failed on disk full");
  }
 catch (  IOException e) {
  }
  out.close();
  dir.close();
  dir=newMockDirectory();
  dir.setMaxSizeInBytes(3);
  out=dir.createOutput("foo",IOContext.DEFAULT);
  out.copyBytes(new ByteArrayDataInput(bytes),bytes.length);
  out.close();
  out=dir.createOutput("bar",IOContext.DEFAULT);
  try {
    out.copyBytes(new ByteArrayDataInput(bytes),bytes.length);
    fail("should have failed on disk full");
  }
 catch (  IOException e) {
  }
  out.close();
  dir.close();
}
