{
  Document d=new Document();
  ArrayList<Field> fields=new ArrayList<Field>();
  String idString=getIdString();
  Field idField=newField("id",idString,Field.Store.YES,Field.Index.NOT_ANALYZED_NO_NORMS);
  fields.add(idField);
  int nFields=nextInt(maxFields);
  for (int i=0; i < nFields; i++) {
    Field.TermVector tvVal=Field.TermVector.NO;
switch (nextInt(4)) {
case 0:
      tvVal=Field.TermVector.NO;
    break;
case 1:
  tvVal=Field.TermVector.YES;
break;
case 2:
tvVal=Field.TermVector.WITH_POSITIONS;
break;
case 3:
tvVal=Field.TermVector.WITH_POSITIONS_OFFSETS;
break;
}
switch (nextInt(4)) {
case 0:
fields.add(newField("f" + nextInt(100),getString(1),Field.Store.YES,Field.Index.NOT_ANALYZED_NO_NORMS,tvVal));
break;
case 1:
fields.add(newField("f" + nextInt(100),getString(0),Field.Store.NO,Field.Index.ANALYZED,tvVal));
break;
case 2:
fields.add(newField("f" + nextInt(100),getString(0),Field.Store.YES,Field.Index.NO,Field.TermVector.NO));
break;
case 3:
fields.add(newField("f" + nextInt(100),getString(bigFieldSize),Field.Store.YES,Field.Index.ANALYZED,tvVal));
break;
}
}
if (sameFieldOrder) {
Collections.sort(fields,fieldNameComparator);
}
 else {
Collections.swap(fields,nextInt(fields.size()),0);
}
for (int i=0; i < fields.size(); i++) {
d.add(fields.get(i));
}
if (VERBOSE) {
System.out.println(Thread.currentThread().getName() + ": indexing id:" + idString);
}
w.updateDocument(new Term("id",idString),d);
docs.put(idString,d);
}
