{
  r=newRandom();
  Directory dir=new MockRAMDirectory();
  DocsAndWriter dw=indexRandomIWReader(10,10,100,dir);
  IndexReader r=dw.writer.getReader();
  dw.writer.commit();
  verifyEquals(r,dir,"id");
  FlexTestUtil.verifyFlexVsPreFlex(this.r,r);
  FlexTestUtil.verifyFlexVsPreFlex(this.r,dir);
  r.close();
  dw.writer.close();
  dir.close();
}
