{
  IndexWriter w=new IndexWriter(dir,LuceneTestCase.newIndexWriterConfig(random,TEST_VERSION_CURRENT,new MockAnalyzer(random)).setMergePolicy(newLogMergePolicy()));
  Iterator<Document> iter=docs.values().iterator();
  while (iter.hasNext()) {
    Document d=iter.next();
    ArrayList<IndexableField> fields=new ArrayList<IndexableField>();
    fields.addAll(d.getFields());
    Collections.sort(fields,fieldNameComparator);
    Document d1=new Document();
    for (int i=0; i < fields.size(); i++) {
      d1.add(fields.get(i));
    }
    w.addDocument(d1);
  }
  w.close();
}
