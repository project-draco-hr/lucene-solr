{
  r=newRandom();
  Directory dir1=new MockRAMDirectory();
  Directory dir2=new MockRAMDirectory();
  int maxThreadStates=1 + r.nextInt(10);
  Map<String,Document> docs=indexRandom(10,10,100,dir1,maxThreadStates);
  indexSerial(docs,dir2);
  verifyEquals(dir1,dir2,"id");
}
