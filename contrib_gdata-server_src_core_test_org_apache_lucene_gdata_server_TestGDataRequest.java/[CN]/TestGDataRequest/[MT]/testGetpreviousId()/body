{
  String host="www.apache.org";
  String feedAndEntryID="/" + ProvidedServiceStub.SERVICE_NAME + "/feed/entryid";
  String queryString="max-results=25";
  Enumeration enu=new StringTokenizer("max-results",",");
  this.control.expectAndDefaultReturn(this.request.getParameterMap(),this.parametermap);
  this.control.expectAndDefaultReturn(this.request.getParameterNames(),enu);
  this.control.expectAndDefaultReturn(this.request.getHeader("Host"),host);
  this.control.expectAndDefaultReturn(this.request.getRequestURI(),"/" + ProvidedServiceStub.SERVICE_NAME + "/feed/");
  this.control.expectAndDefaultReturn(this.request.getPathInfo(),"/" + ProvidedServiceStub.SERVICE_NAME + "/feed/");
  this.control.expectAndReturn(this.request.getParameter("start-index"),null);
  this.control.expectAndDefaultReturn(this.request.getParameter("alt"),null);
  this.control.expectAndDefaultReturn(this.request.getQueryString(),queryString);
  this.control.replay();
  this.feedRequest.initializeRequest();
  assertNull(this.feedRequest.getPreviousId());
  this.control.verify();
  this.control.reset();
  String startIndex="start-index=";
  enu=new StringTokenizer("alt,max-results,start-index",",");
  queryString="alt=rss&max-results=25&start-index=26";
  this.control.expectAndDefaultReturn(this.request.getParameterMap(),this.parametermap);
  this.control.expectAndDefaultReturn(this.request.getHeader("Host"),host);
  this.control.expectAndDefaultReturn(this.request.getRequestURI(),"/" + ProvidedServiceStub.SERVICE_NAME + "/feed/");
  this.control.expectAndDefaultReturn(this.request.getPathInfo(),"/" + ProvidedServiceStub.SERVICE_NAME + "/feed/");
  this.control.expectAndReturn(this.request.getParameter("max-results"),"25",4);
  this.control.expectAndReturn(this.request.getParameter("start-index"),"26",4);
  this.control.expectAndDefaultReturn(this.request.getParameter("alt"),"rss");
  this.control.expectAndDefaultReturn(this.request.getQueryString(),queryString);
  this.control.expectAndDefaultReturn(this.request.getParameterNames(),enu);
  this.control.replay();
  this.feedRequest.initializeRequest();
  String prevId="http://" + host + "/"+ ProvidedServiceStub.SERVICE_NAME+ "/feed"+ "?alt=rss&max-results=25&start-index=1";
  assertEquals("prevID",prevId,this.feedRequest.getPreviousId());
  this.control.reset();
  queryString="";
  this.control.expectAndDefaultReturn(this.request.getParameterMap(),this.parametermap);
  this.control.expectAndDefaultReturn(this.request.getHeader("Host"),host);
  this.control.expectAndDefaultReturn(this.request.getRequestURI(),"/" + ProvidedServiceStub.SERVICE_NAME + "/feed/");
  this.control.expectAndDefaultReturn(this.request.getPathInfo(),"/" + ProvidedServiceStub.SERVICE_NAME + "/feed/entryId/15");
  this.control.expectAndDefaultReturn(this.request.getParameter("max-results"),null);
  this.control.expectAndDefaultReturn(this.request.getParameter("alt"),null);
  this.control.expectAndDefaultReturn(this.request.getQueryString(),null);
  this.control.replay();
  this.feedRequest.initializeRequest();
  assertNull(this.feedRequest.getPreviousId());
  this.control.reset();
  this.control.expectAndDefaultReturn(this.request.getParameterMap(),this.parametermap);
  this.control.expectAndDefaultReturn(this.request.getHeader("Host"),host);
  this.control.expectAndDefaultReturn(this.request.getRequestURI(),"/" + ProvidedServiceStub.SERVICE_NAME + "/feed/");
  this.control.expectAndDefaultReturn(this.request.getPathInfo(),"/" + ProvidedServiceStub.SERVICE_NAME + "/feed/entryId/15");
  this.control.expectAndReturn(this.request.getParameter("max-results"),"35",3);
  this.control.expectAndReturn(this.request.getParameter("start-index"),"5",3);
  this.control.expectAndDefaultReturn(this.request.getParameter("alt"),null);
  this.control.expectAndDefaultReturn(this.request.getQueryString(),"max-results=35&start-index=5");
  this.control.replay();
  this.feedRequest.initializeRequest();
  prevId="http://" + host + "/"+ ProvidedServiceStub.SERVICE_NAME+ "/feed"+ "?max-results=35&start-index=1";
  assertEquals("prevID",prevId,this.feedRequest.getPreviousId());
}
