{
  List ff1=d1.getFields();
  List ff2=d2.getFields();
  Collections.sort(ff1,fieldNameComparator);
  Collections.sort(ff2,fieldNameComparator);
  if (ff1.size() != ff2.size()) {
    System.out.println(ff1);
    System.out.println(ff2);
    assertEquals(ff1.size(),ff2.size());
  }
  for (int i=0; i < ff1.size(); i++) {
    Fieldable f1=(Fieldable)ff1.get(i);
    Fieldable f2=(Fieldable)ff2.get(i);
    if (f1.isBinary()) {
      assert(f2.isBinary());
    }
 else {
      String s1=f1.stringValue();
      String s2=f2.stringValue();
      if (!s1.equals(s2)) {
        System.out.println(ff1);
        System.out.println(ff2);
        assertEquals(s1,s2);
      }
    }
  }
}
