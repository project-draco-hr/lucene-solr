{
  BufferedReader input=null;
  ArrayList<String> lines;
  boolean success=false;
  try {
    input=getBufferedReader(IOUtils.getDecodingReader(stream,charset));
    lines=new ArrayList<>();
    for (String word=null; (word=input.readLine()) != null; ) {
      if (lines.isEmpty() && word.length() > 0 && word.charAt(0) == '\uFEFF')       word=word.substring(1);
      if (word.startsWith("#"))       continue;
      word=word.trim();
      if (word.length() == 0)       continue;
      lines.add(word);
    }
    success=true;
    return lines;
  }
  finally {
    if (success) {
      IOUtils.close(input);
    }
 else {
      IOUtils.closeWhileHandlingException(input);
    }
  }
}
