{
  if (valueCount >= maxValuesSortInHeap) {
    if (writer == null) {
      switchToOffline();
    }
    scratchBytesOutput.reset(scratchBytes);
    scratchBytesOutput.writeLong(value);
    scratchBytesOutput.writeVInt(docID);
    scratchBytesOutput.writeVLong(valueCount);
    writer.write(scratchBytes,0,scratchBytes.length);
  }
 else {
    heapWriter.append(value,valueCount,docID);
  }
  valueCount++;
  globalMaxValue=Math.max(value,globalMaxValue);
  globalMinValue=Math.min(value,globalMinValue);
}
