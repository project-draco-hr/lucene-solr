{
  this.writeLock.lock();
  try {
    if (this.isClosed.get())     throw new IllegalStateException("Lock has been closed");
    Thread t=Thread.currentThread();
    if (!this.threads.containsKey(t))     return false;
    if (!this.locks.containsKey(key))     return false;
    if (t != this.locks.get(key))     throw new ConcurrencyException("Illegal lock access -- current thread is not owner");
    this.locks.remove(key);
    this.threads.remove(t);
    return true;
  }
  finally {
    this.writeLock.unlock();
  }
}
