{
  log.info("Deleting index files for index commit with generation {} in directory {}",indexCommit.getGeneration(),dir);
  for (  String fileName : indexCommit.getFileNames()) {
    try {
      int ref=refCounts.getOrDefault(fileName,0);
      log.debug("Reference count for file {} is {}",fileName,ref);
      if (ref == 0) {
        dir.deleteFile(fileName);
      }
    }
 catch (    IOException e) {
      log.warn("Unable to delete file {} in directory {} due to exception {}",fileName,dir,e.getMessage());
    }
  }
}
