{
  List<IndexCommit> commits=DirectoryReader.listCommits(dir);
  Map<String,Integer> refCounts=buildRefCounts(snapshots,commits);
  for (  IndexCommit ic : commits) {
    if (ic.getGeneration() == gen) {
      deleteIndexFiles(dir,refCounts,ic);
      break;
    }
  }
}
