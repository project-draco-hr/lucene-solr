{
  deleteSnapshotIndexFiles(core,dir,new IndexDeletionPolicy(){
    @Override public void onInit(    List<? extends IndexCommit> commits) throws IOException {
      for (      IndexCommit ic : commits) {
        if (gen == ic.getGeneration()) {
          log.info("Deleting non-snapshotted index commit with generation {}",ic.getGeneration());
          ic.delete();
        }
      }
    }
    @Override public void onCommit(    List<? extends IndexCommit> commits) throws IOException {
    }
  }
);
}
