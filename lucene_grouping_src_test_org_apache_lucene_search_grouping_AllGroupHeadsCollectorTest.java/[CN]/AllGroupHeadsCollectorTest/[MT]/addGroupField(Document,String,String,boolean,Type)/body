{
  doc.add(new TextField(groupField,value,Field.Store.YES));
  if (canUseIDV) {
    Field valuesField=null;
switch (valueType) {
case BYTES_VAR_DEREF:
      valuesField=new DerefBytesDocValuesField(groupField + "_dv",new BytesRef(value));
    break;
case BYTES_VAR_STRAIGHT:
  valuesField=new StraightBytesDocValuesField(groupField + "_dv",new BytesRef(value));
break;
case BYTES_VAR_SORTED:
valuesField=new SortedBytesDocValuesField(groupField + "_dv",new BytesRef(value));
break;
default :
fail("unhandled type");
}
doc.add(valuesField);
}
}
