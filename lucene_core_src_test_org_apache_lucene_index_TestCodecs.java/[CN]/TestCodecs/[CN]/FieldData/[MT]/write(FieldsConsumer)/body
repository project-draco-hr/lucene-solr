{
  Arrays.sort(terms);
  final TermsConsumer termsConsumer=consumer.addField(fieldInfo);
  long sumTotalTermCount=0;
  long sumDF=0;
  OpenBitSet visitedDocs=new OpenBitSet();
  for (  final TermData term : terms) {
    for (int i=0; i < term.docs.length; i++) {
      visitedDocs.set(term.docs[i]);
    }
    sumDF+=term.docs.length;
    sumTotalTermCount+=term.write(termsConsumer);
  }
  termsConsumer.finish(omitTF ? -1 : sumTotalTermCount,sumDF,(int)visitedDocs.cardinality());
}
