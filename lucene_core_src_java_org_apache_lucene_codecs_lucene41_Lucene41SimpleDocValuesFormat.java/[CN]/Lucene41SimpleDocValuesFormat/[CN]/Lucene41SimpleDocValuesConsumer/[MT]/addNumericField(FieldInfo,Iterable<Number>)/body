{
  meta.writeVInt(field.number);
  long minValue=Long.MAX_VALUE;
  long maxValue=Long.MIN_VALUE;
  for (  Number nv : values) {
    long v=nv.longValue();
    minValue=Math.min(minValue,v);
    maxValue=Math.max(maxValue,v);
  }
  meta.writeLong(minValue);
  long delta=maxValue - minValue;
  final int bitsPerValue;
  if (delta < 0) {
    bitsPerValue=64;
  }
 else {
    bitsPerValue=PackedInts.bitsRequired(delta);
  }
  FormatAndBits formatAndBits=PackedInts.fastestFormatAndBits(maxDoc,bitsPerValue,PackedInts.COMPACT);
  CodecUtil.writeHeader(meta,PackedInts.CODEC_NAME,PackedInts.VERSION_CURRENT);
  meta.writeVInt(bitsPerValue);
  meta.writeVInt(maxDoc);
  meta.writeVInt(formatAndBits.format.getId());
  meta.writeLong(data.getFilePointer());
  final PackedInts.Writer writer=PackedInts.getWriterNoHeader(data,formatAndBits.format,maxDoc,formatAndBits.bitsPerValue,0);
  for (  Number nv : values) {
    writer.add(nv.longValue() - minValue);
  }
  writer.finish();
}
