{
  rollbackCommands.incrementAndGet();
  boolean error=true;
  iwCommit.lock();
  try {
    log.info("start " + cmd);
    rollbackWriter();
    tracker.didRollback();
    log.info("end_rollback");
    error=false;
  }
  finally {
    iwCommit.unlock();
    addCommands.set(0);
    deleteByIdCommands.set(0);
    deleteByQueryCommands.set(0);
    numErrors.set(error ? 1 : 0);
  }
}
