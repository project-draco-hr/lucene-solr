{
  rollbackCommands.incrementAndGet();
  boolean error=true;
  iwCommit.lock();
  try {
    log.info("start " + cmd);
    rollbackWriter();
    tracker.didRollback();
    log.info("end_rollback");
    error=false;
  }
  finally {
    iwCommit.unlock();
    addCommandsCumulative.set(addCommandsCumulative.get() - addCommands.getAndSet(0));
    deleteByIdCommandsCumulative.set(deleteByIdCommandsCumulative.get() - deleteByIdCommands.getAndSet(0));
    deleteByQueryCommandsCumulative.set(deleteByQueryCommandsCumulative.get() - deleteByQueryCommands.getAndSet(0));
    numErrors.set(error ? 1 : 0);
  }
}
