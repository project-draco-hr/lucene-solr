{
  if (cmd.indexedId == null) {
    cmd.indexedId=getIndexedId(cmd.doc);
  }
synchronized (this) {
    Integer saveCount=pset.get(cmd.indexedId);
    if (saveCount != null && saveCount != 0) {
      return 0;
    }
    pset.put(cmd.indexedId,ONE);
    doAdd(cmd.doc);
    return 1;
  }
}
