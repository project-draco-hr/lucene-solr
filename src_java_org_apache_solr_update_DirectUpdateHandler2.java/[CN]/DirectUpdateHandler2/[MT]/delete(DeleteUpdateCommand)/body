{
  deleteByIdCommands.incrementAndGet();
  deleteByIdCommandsCumulative.incrementAndGet();
  if (!cmd.fromPending && !cmd.fromCommitted) {
    numErrors.incrementAndGet();
    numErrorsCumulative.incrementAndGet();
    throw new SolrException(SolrException.ErrorCode.BAD_REQUEST,"meaningless command: " + cmd);
  }
  if (!cmd.fromPending || !cmd.fromCommitted) {
    numErrors.incrementAndGet();
    numErrorsCumulative.incrementAndGet();
    throw new SolrException(SolrException.ErrorCode.BAD_REQUEST,"operation not supported" + cmd);
  }
  iwCommit.lock();
  try {
    openWriter();
    writer.deleteDocuments(idTerm.createTerm(idFieldType.toInternal(cmd.id)));
  }
  finally {
    iwCommit.unlock();
  }
  if (tracker.timeUpperBound > 0) {
    tracker.scheduleCommitWithin(tracker.timeUpperBound);
  }
}
